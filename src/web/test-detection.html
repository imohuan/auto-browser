<!DOCTYPE html>
<html lang="zh-CN">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Electron åæ£€æµ‹æµ‹è¯•</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Arial, sans-serif;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      padding: 20px;
      min-height: 100vh;
    }

    .container {
      max-width: 900px;
      margin: 0 auto;
      background: white;
      border-radius: 16px;
      box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
      padding: 30px;
    }

    h1 {
      color: #333;
      text-align: center;
      margin-bottom: 30px;
      font-size: 28px;
    }

    .test-item {
      background: #f8f9fa;
      border-radius: 8px;
      padding: 15px;
      margin-bottom: 15px;
      border-left: 4px solid #ddd;
    }

    .test-item.pass {
      border-left-color: #28a745;
      background: #d4edda;
    }

    .test-item.fail {
      border-left-color: #dc3545;
      background: #f8d7da;
    }

    .test-name {
      font-weight: bold;
      color: #333;
      margin-bottom: 8px;
      font-size: 16px;
    }

    .test-result {
      color: #666;
      font-family: 'Courier New', monospace;
      font-size: 14px;
      word-break: break-all;
    }

    .status {
      display: inline-block;
      padding: 4px 12px;
      border-radius: 12px;
      font-size: 12px;
      font-weight: bold;
      margin-left: 10px;
    }

    .status.pass {
      background: #28a745;
      color: white;
    }

    .status.fail {
      background: #dc3545;
      color: white;
    }

    .summary {
      text-align: center;
      padding: 20px;
      margin-top: 20px;
      background: #e9ecef;
      border-radius: 8px;
    }

    .summary-score {
      font-size: 48px;
      font-weight: bold;
      color: #667eea;
      margin-bottom: 10px;
    }

    .summary-text {
      font-size: 18px;
      color: #666;
    }

    button {
      background: #667eea;
      color: white;
      border: none;
      padding: 12px 30px;
      border-radius: 8px;
      font-size: 16px;
      cursor: pointer;
      display: block;
      margin: 20px auto;
      transition: background 0.3s;
    }

    button:hover {
      background: #5568d3;
    }

    .test-section {
      margin-bottom: 30px;
    }

    .section-title {
      font-size: 20px;
      color: #667eea;
      margin-bottom: 15px;
      padding-bottom: 10px;
      border-bottom: 2px solid #667eea;
    }
  </style>
</head>

<body>
  <div class="container">
    <h1>ğŸ›¡ï¸ Electron åçˆ¬è™«æ£€æµ‹æµ‹è¯•</h1>

    <button onclick="runTests()">ğŸ”„ é‡æ–°æµ‹è¯•</button>

    <div class="test-section">
      <div class="section-title">åŸºç¡€æ£€æµ‹é¡¹</div>
      <div id="basic-tests"></div>
    </div>

    <div class="test-section">
      <div class="section-title">é«˜çº§æ£€æµ‹é¡¹</div>
      <div id="advanced-tests"></div>
    </div>

    <div class="test-section">
      <div class="section-title">æµè§ˆå™¨æŒ‡çº¹</div>
      <div id="fingerprint-tests"></div>
    </div>

    <div class="summary" id="summary">
      <div class="summary-score" id="score">0/0</div>
      <div class="summary-text" id="summary-text">æ­£åœ¨æµ‹è¯•...</div>
    </div>
  </div>

  <script>
    let passCount = 0;
    let totalCount = 0;

    function createTestItem(name, result, isPassed, containerId) {
      totalCount++;
      if (isPassed) passCount++;

      const item = document.createElement('div');
      item.className = `test-item ${isPassed ? 'pass' : 'fail'}`;
      item.innerHTML = `
                <div class="test-name">
                    ${name}
                    <span class="status ${isPassed ? 'pass' : 'fail'}">
                        ${isPassed ? 'âœ“ é€šè¿‡' : 'âœ— å¤±è´¥'}
                    </span>
                </div>
                <div class="test-result">${result}</div>
            `;
      document.getElementById(containerId).appendChild(item);
    }

    function runTests() {
      passCount = 0;
      totalCount = 0;

      document.getElementById('basic-tests').innerHTML = '';
      document.getElementById('advanced-tests').innerHTML = '';
      document.getElementById('fingerprint-tests').innerHTML = '';

      // ============================================
      // åŸºç¡€æ£€æµ‹é¡¹
      // ============================================

      // 1. navigator.webdriver
      const webdriver = navigator.webdriver;
      createTestItem(
        '1. navigator.webdriver',
        `å€¼: ${webdriver} (åº”è¯¥æ˜¯ undefined)`,
        webdriver === undefined,
        'basic-tests'
      );

      // 2. window.chrome
      const hasChrome = !!window.chrome;
      createTestItem(
        '2. window.chrome å¯¹è±¡',
        `å­˜åœ¨: ${hasChrome} (åº”è¯¥æ˜¯ true)`,
        hasChrome,
        'basic-tests'
      );

      // 3. navigator.plugins
      const pluginsCount = navigator.plugins.length;
      createTestItem(
        '3. navigator.plugins',
        `æ’ä»¶æ•°é‡: ${pluginsCount} (åº”è¯¥ > 0)`,
        pluginsCount > 0,
        'basic-tests'
      );

      // 4. navigator.languages
      const languages = navigator.languages;
      createTestItem(
        '4. navigator.languages',
        `è¯­è¨€åˆ—è¡¨: ${JSON.stringify(languages)} (åº”è¯¥å¤šäº1ä¸ª)`,
        languages.length > 1,
        'basic-tests'
      );

      // 5. User-Agent
      const ua = navigator.userAgent;
      const hasElectron = ua.includes('Electron');
      createTestItem(
        '5. User-Agent',
        `${ua.substring(0, 80)}... (ä¸åº”åŒ…å« "Electron")`,
        !hasElectron,
        'basic-tests'
      );

      // ============================================
      // é«˜çº§æ£€æµ‹é¡¹
      // ============================================

      // 6. Permissions API
      let permissionsPass = false;
      if (navigator.permissions) {
        permissionsPass = true;
        createTestItem(
          '6. Permissions API',
          'Permissions API å­˜åœ¨å¹¶ä¸”æ­£å¸¸',
          true,
          'advanced-tests'
        );
      } else {
        createTestItem(
          '6. Permissions API',
          'Permissions API ä¸å­˜åœ¨',
          false,
          'advanced-tests'
        );
      }

      // 7. window.chrome.runtime
      const hasChromeRuntime = window.chrome && window.chrome.runtime;
      createTestItem(
        '7. window.chrome.runtime',
        `å­˜åœ¨: ${hasChromeRuntime} (åº”è¯¥æ˜¯ true)`,
        hasChromeRuntime,
        'advanced-tests'
      );

      // 8. window.chrome.loadTimes
      const hasChromeLoadTimes = window.chrome && typeof window.chrome.loadTimes === 'function';
      createTestItem(
        '8. window.chrome.loadTimes',
        `å­˜åœ¨: ${hasChromeLoadTimes} (åº”è¯¥æ˜¯ true)`,
        hasChromeLoadTimes,
        'advanced-tests'
      );

      // 9. navigator.mimeTypes
      const mimeTypesCount = navigator.mimeTypes.length;
      createTestItem(
        '9. navigator.mimeTypes',
        `MIME ç±»å‹æ•°é‡: ${mimeTypesCount} (åº”è¯¥ > 0)`,
        mimeTypesCount > 0,
        'advanced-tests'
      );

      // 10. æ£€æŸ¥æ˜¯å¦æœ‰ Electron å…¨å±€å˜é‡
      const hasElectronGlobal = window.require || window.electron || window._electron;
      createTestItem(
        '10. Electron å…¨å±€å˜é‡',
        `æ£€æµ‹åˆ° Electron ç‰¹å¾: ${hasElectronGlobal} (åº”è¯¥æ˜¯ undefined)`,
        !hasElectronGlobal,
        'advanced-tests'
      );

      // ============================================
      // æµè§ˆå™¨æŒ‡çº¹
      // ============================================

      // 11. Canvas æŒ‡çº¹
      try {
        const canvas = document.createElement('canvas');
        const ctx = canvas.getContext('2d');
        ctx.fillText('Test', 10, 10);
        const canvasData = canvas.toDataURL();
        createTestItem(
          '11. Canvas æŒ‡çº¹',
          `Canvas å¯ç”¨ï¼Œé•¿åº¦: ${canvasData.length}`,
          canvasData.length > 0,
          'fingerprint-tests'
        );
      } catch (e) {
        createTestItem(
          '11. Canvas æŒ‡çº¹',
          `Canvas é”™è¯¯: ${e.message}`,
          false,
          'fingerprint-tests'
        );
      }

      // 12. WebGL æŒ‡çº¹
      try {
        const canvas = document.createElement('canvas');
        const gl = canvas.getContext('webgl') || canvas.getContext('experimental-webgl');
        if (gl) {
          const vendor = gl.getParameter(gl.VENDOR);
          const renderer = gl.getParameter(gl.RENDERER);
          createTestItem(
            '12. WebGL æŒ‡çº¹',
            `ä¾›åº”å•†: ${vendor}, æ¸²æŸ“å™¨: ${renderer}`,
            vendor && renderer,
            'fingerprint-tests'
          );
        } else {
          createTestItem(
            '12. WebGL æŒ‡çº¹',
            'WebGL ä¸å¯ç”¨',
            false,
            'fingerprint-tests'
          );
        }
      } catch (e) {
        createTestItem(
          '12. WebGL æŒ‡çº¹',
          `WebGL é”™è¯¯: ${e.message}`,
          false,
          'fingerprint-tests'
        );
      }

      // 13. navigator.hardwareConcurrency
      const hardwareConcurrency = navigator.hardwareConcurrency;
      createTestItem(
        '13. CPU æ ¸å¿ƒæ•°',
        `æ ¸å¿ƒæ•°: ${hardwareConcurrency} (åº”è¯¥æ˜¯åˆç†çš„æ•°å€¼)`,
        hardwareConcurrency >= 2 && hardwareConcurrency <= 64,
        'fingerprint-tests'
      );

      // 14. navigator.deviceMemory
      const deviceMemory = navigator.deviceMemory;
      createTestItem(
        '14. è®¾å¤‡å†…å­˜',
        `å†…å­˜: ${deviceMemory}GB (åº”è¯¥æ˜¯åˆç†çš„æ•°å€¼)`,
        deviceMemory === undefined || (deviceMemory >= 2 && deviceMemory <= 64),
        'fingerprint-tests'
      );

      // 15. navigator.maxTouchPoints
      const maxTouchPoints = navigator.maxTouchPoints;
      createTestItem(
        '15. è§¦æ§ç‚¹æ•°é‡',
        `è§¦æ§ç‚¹: ${maxTouchPoints}`,
        maxTouchPoints >= 0,
        'fingerprint-tests'
      );

      // ============================================
      // æ›´æ–°æ€»ç»“
      // ============================================
      updateSummary();
    }

    function updateSummary() {
      const percentage = Math.round((passCount / totalCount) * 100);
      document.getElementById('score').textContent = `${passCount}/${totalCount}`;

      const summaryText = document.getElementById('summary-text');
      if (percentage >= 90) {
        summaryText.textContent = 'ğŸ‰ ä¼˜ç§€ï¼åæ£€æµ‹é…ç½®éå¸¸å®Œå–„';
        summaryText.style.color = '#28a745';
      } else if (percentage >= 70) {
        summaryText.textContent = 'ğŸ‘ è‰¯å¥½ï¼å¤§éƒ¨åˆ†æ£€æµ‹é¡¹å·²é€šè¿‡';
        summaryText.style.color = '#ffc107';
      } else if (percentage >= 50) {
        summaryText.textContent = 'âš ï¸ ä¸€èˆ¬ï¼Œå»ºè®®ä¼˜åŒ–åæ£€æµ‹é…ç½®';
        summaryText.style.color = '#ff9800';
      } else {
        summaryText.textContent = 'âŒ è¾ƒå·®ï¼Œå¼ºçƒˆå»ºè®®é…ç½®åæ£€æµ‹è„šæœ¬';
        summaryText.style.color = '#dc3545';
      }
    }

    // é¡µé¢åŠ è½½æ—¶è‡ªåŠ¨è¿è¡Œæµ‹è¯•
    window.onload = runTests;
  </script>
</body>

</html>
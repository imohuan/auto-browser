import{A as e,B as t,Et as n,F as r,M as i,N as a,O as o,Ot as s,P as c,Tt as l,V as u,bt as d,et as f,it as p,j as m,k as h,kt as g,nt as _,z as v}from"./index-B7qcHONN.js";import{t as y}from"./_plugin-vue_export-helper-DEnkkObV.js";import{n as b,t as x}from"./useEditableDrag-CB53J2oW.js";var S={},C={t:`1762605194920`,class:`icon`,viewBox:`0 0 1024 1024`,version:`1.1`,xmlns:`http://www.w3.org/2000/svg`,"p-id":`7514`,stroke:`currentColor`,fill:`currentColor`};function w(e,t){return f(),r(`svg`,C,[...t[0]||=[i(`path`,{d:`M728.223744 520.22784a42.467328 42.467328 0 0 1-11.393024 20.503552L374.90688 882.65728c-16.662528 16.662528-43.677696 16.662528-60.340224 0s-16.662528-43.677696 0-60.340224L626.449408 510.43328 314.614784 198.598656c-16.662528-16.662528-16.662528-43.677696 0-60.340224 16.661504-16.662528 43.676672-16.662528 60.3392 0L716.879872 480.18432c10.860544 10.860544 14.642176 26.120192 11.343872 40.04352z`,"p-id":`7515`},null,-1)]])}var T=y(S,[[`render`,w]]),E={class:`flex items-center gap-1.5`},D={key:0,class:`text-emerald-600 text-xs`},O={key:1,class:`text-blue-600 text-xs`},k={key:2,class:`text-[10px] opacity-70`},A={key:3,class:`text-[10px] opacity-70`},j={key:1,class:`w-3 h-3 shrink-0`},M=[`title`],N={class:`text-[10px] px-2 py-0.5 rounded-full bg-slate-100 text-slate-500 opacity-0 group-hover:opacity-100 transition-opacity shrink-0`},P={key:0,class:`space-y-0.5`},F=u({name:`VariableTreeItem`,__name:`VariableTreeItem`,props:{node:{},level:{default:0},enableDrag:{type:Boolean,default:!0},expandedNodeIds:{}},emits:[`toggle`,`toggleWithFirst`],setup(u,{emit:y}){let S=y,C=u,w=m(()=>C.expandedNodeIds?C.expandedNodeIds.has(C.node.id):F.value),F=d(C.level<1),I=m(()=>Array.isArray(C.node.children)&&C.node.children.length>0),{showDragFollower:L,dragPosition:R,dropTargetState:z,dragFollowerStyle:B,startDrag:V}=x({eventName:`variable-drop`}),H=m(()=>{let e=C.node.value;return e===null?`null`:e===void 0?`undefined`:Array.isArray(e)?`Array(${e.length})`:typeof e==`object`?`Object(${Object.keys(e).length})`:typeof e==`string`?`"${e}"`:String(e)}),U=m(()=>({string:`text-green-600`,number:`text-blue-600`,boolean:`text-orange-600`,null:`text-slate-400 italic`,undefined:`text-slate-400 italic`,array:`text-slate-500`,object:`text-slate-500`})[C.node.valueType]||`text-slate-600`);function W(){if(C.expandedNodeIds){let e=!w.value;S(`toggle`,C.node.id,e)}else F.value=!F.value}function G(){I.value&&(C.level===0&&!w.value&&C.expandedNodeIds!==void 0?S(`toggleWithFirst`,C.node.id):W())}function K(e){if(!C.enableDrag||!C.node.reference)return;let t=C.node.reference.trim(),n={payload:{reference:t,type:C.node.valueType,label:C.node.label},reference:t};V(e,n)}return(d,m)=>{let y=p(`VariableTreeItem`,!0);return f(),r(`div`,null,[(f(),a(e,{to:`body`},[l(z)===`default`?c(``,!0):(f(),r(`div`,{key:0,class:`fixed pointer-events-none z-10001 w-8 h-8 flex items-center justify-center`,style:s({left:l(R).x+`px`,top:l(R).y+`px`,transform:`translate(-50%, -50%)`})},[t(b,{class:`w-5 h-5 text-slate-800`})],4)),l(L)?(f(),r(`div`,{key:1,class:n([`fixed pointer-events-none z-10000 scale-100 px-3 py-1 text-xs font-medium rounded-lg shadow-lg backdrop-blur`,[l(z)===`empty`?`bg-emerald-100/95 border-2 border-emerald-400 text-emerald-700`:l(z)===`hasContent`?`bg-blue-100/95 border-2 border-blue-400 text-blue-700`:`bg-red-100/95 border-2 border-red-400 text-red-700`]]),style:s(l(B))},[i(`div`,E,[l(z)===`empty`?(f(),r(`span`,D,`⇱`)):l(z)===`hasContent`?(f(),r(`span`,O,`↓`)):c(``,!0),v(` `+g(u.node.label)+` `,1),l(z)===`empty`?(f(),r(`span`,k,`吸附左侧`)):l(z)===`hasContent`?(f(),r(`span`,A,`插入位置`)):c(``,!0)])],6)):c(``,!0)])),i(`div`,{class:n([`flex items-center gap-2 px-2 py-1 rounded-md transition-colors duration-150 group hover:bg-slate-100/70`,{"cursor-pointer":I.value}]),style:s({paddingLeft:`${u.level*12+6}px`}),onClick:G},[I.value?(f(),r(`button`,{key:0,class:`w-3 h-3 flex items-center justify-center text-slate-400 hover:text-slate-600 transition-colors shrink-0`,onClick:o(W,[`stop`])},[t(T,{class:n([`transition-transform`,{"rotate-90":w.value}])},null,8,[`class`])])):(f(),r(`span`,j)),i(`span`,{class:n([`px-2 py-0.5 text-xs font-medium text-slate-800 bg-white/90 rounded-lg shadow-sm border border-slate-200 shrink-0 transition-all duration-150 hover:shadow-md`,{"cursor-grab":u.node.reference&&C.enableDrag,"cursor-default":!C.enableDrag||!u.node.reference}]),onMousedown:o(K,[`stop`])},g(u.node.label),35),u.node.valueType===`node`?c(``,!0):(f(),r(h,{key:2},[m[2]||=i(`span`,{class:`text-xs text-slate-300 shrink-0`},`:`,-1),i(`span`,{class:n([U.value,`text-xs truncate flex-1 min-w-0 font-mono`]),title:H.value},g(H.value),11,M),i(`span`,N,g(u.node.valueType),1)],64))],6),w.value&&I.value?(f(),r(`div`,P,[(f(!0),r(h,null,_(u.node.children,e=>(f(),a(y,{key:e.id,node:e,level:u.level+1,"enable-drag":C.enableDrag,"expanded-node-ids":C.expandedNodeIds,onToggle:m[0]||=(e,t)=>S(`toggle`,e,t),onToggleWithFirst:m[1]||=e=>S(`toggleWithFirst`,e)},null,8,[`node`,`level`,`enable-drag`,`expanded-node-ids`]))),128))])):c(``,!0)])}}});function I(e){return e===null?`null`:e===void 0?`undefined`:Array.isArray(e)?`array`:typeof e}function L(e){return`{{ ${e} }}`}function R(e,t=`data`){let n=I(e),r=t,i;if(t===`data`)i=`root`;else{let e=t.split(`.`),n=e[e.length-1]||``;i=/^\d+$/.test(n)?`[${n}]`:n}if(Array.isArray(e)){let a=e.map((e,n)=>{let r=`${t}.${n}`;return R(e,r)});return{id:r,label:t===`data`?`root`:i,valueType:n,reference:L(t),value:e,children:a.length>0?a:void 0}}if(typeof e==`object`&&e){let a=Object.entries(e).map(([e,n])=>{let r=`${t}.${e}`;return R(n,r)});return{id:r,label:t===`data`?`root`:i,valueType:n,reference:L(t),value:e,children:a.length>0?a:void 0}}return{id:r,label:t===`data`?`root`:i,valueType:n,reference:L(t),value:e}}export{F as n,R as t};
import{C as e,S as t,T as n,_ as r,a as i,b as a,c as o,d as s,f as c,g as l,h as u,i as d,l as f,m as p,n as m,o as h,p as g,r as _,s as v,t as y,u as b,v as x,w as S,x as C,y as w}from"./ui-BKGKT1-n.js";import{$ as T,A as E,At as D,B as O,C as k,Ct as A,D as j,Dt as M,E as ee,Et as N,F as P,G as te,H as ne,I as re,J as F,K as ie,L as ae,M as I,Mt as oe,N as L,O as se,Ot as R,P as z,Q as ce,R as le,S as ue,St as de,T as fe,Tt as B,U as pe,V,W as H,X as me,Y as he,Z as ge,_ as _e,_t as ve,a as ye,at as be,bt as U,c as xe,ct as W,d as Se,dt as Ce,et as G,f as we,ft as Te,g as Ee,gt as De,h as Oe,ht as ke,i as Ae,it as K,j as q,k as je,kt as J,l as Me,lt as Ne,m as Pe,mt as Fe,n as Ie,nt as Le,o as Re,ot as ze,p as Be,pt as Ve,q as He,r as Ue,rt as We,s as Ge,st as Ke,tt as qe,u as Je,ut as Y,vt as Ye,wt as Xe,x as Ze,xt as Qe,y as $e,yt as et,z as X}from"./index-B7qcHONN.js";import"./editor.api-C3--bZyW.js";import"./monaco.contribution-zlJWm1f5.js";import{n as tt,t as nt}from"./events-DYHBDbVc.js";import{t as Z}from"./_plugin-vue_export-helper-DEnkkObV.js";import{n as rt,t as it}from"./IconReset-B0wjf6Ff.js";import{t as at}from"./IconChevronRight-CSVGKrG2.js";import{t as ot}from"./IconSearch-D6ePBVBL.js";import{t as st}from"./CodeEditor-B6Xge8TJ.js";import{n as ct,t as lt}from"./jsonToVariableTree-QFw_qP8f.js";import"./useEditableDrag-CB53J2oW.js";import{t as ut}from"./JsonTreeViewer-B0xyBWRC.js";function dt(e){return Fe()?(ve(e),!0):!1}function ft(e){return typeof e==`function`?e():B(e)}var pt=typeof window<`u`&&typeof document<`u`,mt=e=>e!==void 0,ht=Object.prototype.toString,gt=e=>ht.call(e)===`[object Object]`,_t=()=>{};function vt(e,t){function n(...n){return new Promise((r,i)=>{Promise.resolve(e(()=>t.apply(this,n),{fn:t,thisArg:this,args:n})).then(r).catch(i)})}return n}var yt=e=>e();function bt(e=yt){let t=U(!0);function n(){t.value=!1}function r(){t.value=!0}return{isActive:et(t),pause:n,resume:r,eventFilter:(...n)=>{t.value&&e(...n)}}}function xt(e,t=!1,n=`Timeout`){return new Promise((r,i)=>{t?setTimeout(()=>i(n),e):setTimeout(r,e)})}function St(e,t,n={}){let{eventFilter:r=yt,...i}=n;return W(e,vt(r,t),i)}function Ct(e,t,n={}){let{eventFilter:r,...i}=n,{eventFilter:a,pause:o,resume:s,isActive:c}=bt(r);return{stop:St(e,t,{...i,eventFilter:a}),pause:o,resume:s,isActive:c}}function wt(e,t={}){if(!ke(e))return A(e);let n=Array.isArray(e.value)?Array.from({length:e.value.length}):{};for(let r in e.value)n[r]=Te(()=>({get(){return e.value[r]},set(n){if(ft(t.replaceRef)??!0)if(Array.isArray(e.value)){let t=[...e.value];t[r]=n,e.value=t}else{let t={...e.value,[r]:n};Object.setPrototypeOf(t,Object.getPrototypeOf(e.value)),e.value=t}else e.value[r]=n}}));return n}function Tt(e,t=!1){function n(n,{flush:r=`sync`,deep:i=!1,timeout:a,throwOnTimeout:o}={}){let s=null,c=[new Promise(a=>{s=W(e,e=>{n(e)!==t&&(s?.(),a(e))},{flush:r,deep:i,immediate:!0})})];return a!=null&&c.push(xt(a,o).then(()=>ft(e)).finally(()=>s?.())),Promise.race(c)}function r(r,i){if(!ke(r))return n(e=>e===r,i);let{flush:a=`sync`,deep:o=!1,timeout:s,throwOnTimeout:c}=i??{},l=null,u=[new Promise(n=>{l=W([e,r],([e,r])=>{t!==(e===r)&&(l?.(),n(e))},{flush:a,deep:o,immediate:!0})})];return s!=null&&u.push(xt(s,c).then(()=>ft(e)).finally(()=>(l?.(),ft(e)))),Promise.race(u)}function i(e){return n(e=>!!e,e)}function a(e){return r(null,e)}function o(e){return r(void 0,e)}function s(e){return n(Number.isNaN,e)}function c(e,t){return n(t=>{let n=Array.from(t);return n.includes(e)||n.includes(ft(e))},t)}function l(e){return u(1,e)}function u(e=1,t){let r=-1;return n(()=>(r+=1,r>=e),t)}return Array.isArray(ft(e))?{toMatch:n,toContains:c,changed:l,changedTimes:u,get not(){return Tt(e,!t)}}:{toMatch:n,toBe:r,toBeTruthy:i,toBeNull:a,toBeNaN:s,toBeUndefined:o,changed:l,changedTimes:u,get not(){return Tt(e,!t)}}}function Et(e){return Tt(e)}function Dt(e){let t=ft(e);return t?.$el??t}var Ot=pt?window:void 0;function kt(...e){let t,n,r,i;if(typeof e[0]==`string`||Array.isArray(e[0])?([n,r,i]=e,t=Ot):[t,n,r,i]=e,!t)return _t;Array.isArray(n)||(n=[n]),Array.isArray(r)||(r=[r]);let a=[],o=()=>{a.forEach(e=>e()),a.length=0},s=(e,t,n,r)=>(e.addEventListener(t,n,r),()=>e.removeEventListener(t,n,r)),c=W(()=>[Dt(t),ft(i)],([e,t])=>{if(o(),!e)return;let i=gt(t)?{...t}:t;a.push(...n.flatMap(t=>r.map(n=>s(e,t,n,i))))},{immediate:!0,flush:`post`}),l=()=>{c(),o()};return dt(l),l}function At(e){return typeof e==`function`?e:typeof e==`string`?t=>t.key===e:Array.isArray(e)?t=>e.includes(t.key):()=>!0}function jt(...e){let t,n,r={};e.length===3?(t=e[0],n=e[1],r=e[2]):e.length===2?typeof e[1]==`object`?(t=!0,n=e[0],r=e[1]):(t=e[0],n=e[1]):(t=!0,n=e[0]);let{target:i=Ot,eventName:a=`keydown`,passive:o=!1,dedupe:s=!1}=r,c=At(t);return kt(i,a,e=>{e.repeat&&ft(s)||c(e)&&n(e)},o)}function Mt(e){return JSON.parse(JSON.stringify(e))}function Nt(e,t,n,r={}){let{clone:i=!1,passive:a=!1,eventName:o,deep:s=!1,defaultValue:c,shouldEmit:l}=r,u=ne(),d=n||u?.emit||(u?.$emit)?.bind(u)||(u?.proxy?.$emit)?.bind(u?.proxy),f=o;t||=`modelValue`,f||=`update:${t.toString()}`;let p=e=>i?typeof i==`function`?i(e):Mt(e):e,m=()=>mt(e[t])?p(e[t]):c,h=e=>{l?l(e)&&d(f,e):d(f,e)};if(a){let n=m(),r=U(n),i=!1;return W(()=>e[t],e=>{i||(i=!0,r.value=p(e),F(()=>i=!1))}),W(r,n=>{!i&&(n!==e[t]||s)&&h(n)},{deep:s}),r}else return q({get(){return m()},set(e){h(e)}})}var Pt={value:()=>{}};function Ft(){for(var e=0,t=arguments.length,n={},r;e<t;++e){if(!(r=arguments[e]+``)||r in n||/[\s.]/.test(r))throw Error(`illegal type: `+r);n[r]=[]}return new It(n)}function It(e){this._=e}function Lt(e,t){return e.trim().split(/^|\s+/).map(function(e){var n=``,r=e.indexOf(`.`);if(r>=0&&(n=e.slice(r+1),e=e.slice(0,r)),e&&!t.hasOwnProperty(e))throw Error(`unknown type: `+e);return{type:e,name:n}})}It.prototype=Ft.prototype={constructor:It,on:function(e,t){var n=this._,r=Lt(e+``,n),i,a=-1,o=r.length;if(arguments.length<2){for(;++a<o;)if((i=(e=r[a]).type)&&(i=Rt(n[i],e.name)))return i;return}if(t!=null&&typeof t!=`function`)throw Error(`invalid callback: `+t);for(;++a<o;)if(i=(e=r[a]).type)n[i]=zt(n[i],e.name,t);else if(t==null)for(i in n)n[i]=zt(n[i],e.name,null);return this},copy:function(){var e={},t=this._;for(var n in t)e[n]=t[n].slice();return new It(e)},call:function(e,t){if((i=arguments.length-2)>0)for(var n=Array(i),r=0,i,a;r<i;++r)n[r]=arguments[r+2];if(!this._.hasOwnProperty(e))throw Error(`unknown type: `+e);for(a=this._[e],r=0,i=a.length;r<i;++r)a[r].value.apply(t,n)},apply:function(e,t,n){if(!this._.hasOwnProperty(e))throw Error(`unknown type: `+e);for(var r=this._[e],i=0,a=r.length;i<a;++i)r[i].value.apply(t,n)}};function Rt(e,t){for(var n=0,r=e.length,i;n<r;++n)if((i=e[n]).name===t)return i.value}function zt(e,t,n){for(var r=0,i=e.length;r<i;++r)if(e[r].name===t){e[r]=Pt,e=e.slice(0,r).concat(e.slice(r+1));break}return n!=null&&e.push({name:t,value:n}),e}var Bt=`http://www.w3.org/1999/xhtml`,Vt={svg:`http://www.w3.org/2000/svg`,xhtml:Bt,xlink:`http://www.w3.org/1999/xlink`,xml:`http://www.w3.org/XML/1998/namespace`,xmlns:`http://www.w3.org/2000/xmlns/`};function Ht(e){var t=e+=``,n=t.indexOf(`:`);return n>=0&&(t=e.slice(0,n))!==`xmlns`&&(e=e.slice(n+1)),Vt.hasOwnProperty(t)?{space:Vt[t],local:e}:e}function Ut(e){return function(){var t=this.ownerDocument,n=this.namespaceURI;return n===Bt&&t.documentElement.namespaceURI===Bt?t.createElement(e):t.createElementNS(n,e)}}function Wt(e){return function(){return this.ownerDocument.createElementNS(e.space,e.local)}}function Gt(e){var t=Ht(e);return(t.local?Wt:Ut)(t)}function Kt(){}function qt(e){return e==null?Kt:function(){return this.querySelector(e)}}function Jt(e){typeof e!=`function`&&(e=qt(e));for(var t=this._groups,n=t.length,r=Array(n),i=0;i<n;++i)for(var a=t[i],o=a.length,s=r[i]=Array(o),c,l,u=0;u<o;++u)(c=a[u])&&(l=e.call(c,c.__data__,u,a))&&(`__data__`in c&&(l.__data__=c.__data__),s[u]=l);return new Lr(r,this._parents)}function Yt(e){return e==null?[]:Array.isArray(e)?e:Array.from(e)}function Xt(){return[]}function Zt(e){return e==null?Xt:function(){return this.querySelectorAll(e)}}function Qt(e){return function(){return Yt(e.apply(this,arguments))}}function $t(e){e=typeof e==`function`?Qt(e):Zt(e);for(var t=this._groups,n=t.length,r=[],i=[],a=0;a<n;++a)for(var o=t[a],s=o.length,c,l=0;l<s;++l)(c=o[l])&&(r.push(e.call(c,c.__data__,l,o)),i.push(c));return new Lr(r,i)}function en(e){return function(){return this.matches(e)}}function tn(e){return function(t){return t.matches(e)}}var nn=Array.prototype.find;function rn(e){return function(){return nn.call(this.children,e)}}function an(){return this.firstElementChild}function on(e){return this.select(e==null?an:rn(typeof e==`function`?e:tn(e)))}var sn=Array.prototype.filter;function cn(){return Array.from(this.children)}function ln(e){return function(){return sn.call(this.children,e)}}function un(e){return this.selectAll(e==null?cn:ln(typeof e==`function`?e:tn(e)))}function dn(e){typeof e!=`function`&&(e=en(e));for(var t=this._groups,n=t.length,r=Array(n),i=0;i<n;++i)for(var a=t[i],o=a.length,s=r[i]=[],c,l=0;l<o;++l)(c=a[l])&&e.call(c,c.__data__,l,a)&&s.push(c);return new Lr(r,this._parents)}function fn(e){return Array(e.length)}function pn(){return new Lr(this._enter||this._groups.map(fn),this._parents)}function mn(e,t){this.ownerDocument=e.ownerDocument,this.namespaceURI=e.namespaceURI,this._next=null,this._parent=e,this.__data__=t}mn.prototype={constructor:mn,appendChild:function(e){return this._parent.insertBefore(e,this._next)},insertBefore:function(e,t){return this._parent.insertBefore(e,t)},querySelector:function(e){return this._parent.querySelector(e)},querySelectorAll:function(e){return this._parent.querySelectorAll(e)}};function hn(e){return function(){return e}}function gn(e,t,n,r,i,a){for(var o=0,s,c=t.length,l=a.length;o<l;++o)(s=t[o])?(s.__data__=a[o],r[o]=s):n[o]=new mn(e,a[o]);for(;o<c;++o)(s=t[o])&&(i[o]=s)}function _n(e,t,n,r,i,a,o){var s,c,l=new Map,u=t.length,d=a.length,f=Array(u),p;for(s=0;s<u;++s)(c=t[s])&&(f[s]=p=o.call(c,c.__data__,s,t)+``,l.has(p)?i[s]=c:l.set(p,c));for(s=0;s<d;++s)p=o.call(e,a[s],s,a)+``,(c=l.get(p))?(r[s]=c,c.__data__=a[s],l.delete(p)):n[s]=new mn(e,a[s]);for(s=0;s<u;++s)(c=t[s])&&l.get(f[s])===c&&(i[s]=c)}function vn(e){return e.__data__}function yn(e,t){if(!arguments.length)return Array.from(this,vn);var n=t?_n:gn,r=this._parents,i=this._groups;typeof e!=`function`&&(e=hn(e));for(var a=i.length,o=Array(a),s=Array(a),c=Array(a),l=0;l<a;++l){var u=r[l],d=i[l],f=d.length,p=bn(e.call(u,u&&u.__data__,l,r)),m=p.length,h=s[l]=Array(m),g=o[l]=Array(m),_=c[l]=Array(f);n(u,d,h,g,_,p,t);for(var v=0,y=0,b,x;v<m;++v)if(b=h[v]){for(v>=y&&(y=v+1);!(x=g[y])&&++y<m;);b._next=x||null}}return o=new Lr(o,r),o._enter=s,o._exit=c,o}function bn(e){return typeof e==`object`&&`length`in e?e:Array.from(e)}function xn(){return new Lr(this._exit||this._groups.map(fn),this._parents)}function Sn(e,t,n){var r=this.enter(),i=this,a=this.exit();return typeof e==`function`?(r=e(r),r&&=r.selection()):r=r.append(e+``),t!=null&&(i=t(i),i&&=i.selection()),n==null?a.remove():n(a),r&&i?r.merge(i).order():i}function Cn(e){for(var t=e.selection?e.selection():e,n=this._groups,r=t._groups,i=n.length,a=r.length,o=Math.min(i,a),s=Array(i),c=0;c<o;++c)for(var l=n[c],u=r[c],d=l.length,f=s[c]=Array(d),p,m=0;m<d;++m)(p=l[m]||u[m])&&(f[m]=p);for(;c<i;++c)s[c]=n[c];return new Lr(s,this._parents)}function wn(){for(var e=this._groups,t=-1,n=e.length;++t<n;)for(var r=e[t],i=r.length-1,a=r[i],o;--i>=0;)(o=r[i])&&(a&&o.compareDocumentPosition(a)^4&&a.parentNode.insertBefore(o,a),a=o);return this}function Tn(e){e||=En;function t(t,n){return t&&n?e(t.__data__,n.__data__):!t-!n}for(var n=this._groups,r=n.length,i=Array(r),a=0;a<r;++a){for(var o=n[a],s=o.length,c=i[a]=Array(s),l,u=0;u<s;++u)(l=o[u])&&(c[u]=l);c.sort(t)}return new Lr(i,this._parents).order()}function En(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function Dn(){var e=arguments[0];return arguments[0]=this,e.apply(null,arguments),this}function On(){return Array.from(this)}function kn(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var r=e[t],i=0,a=r.length;i<a;++i){var o=r[i];if(o)return o}return null}function An(){let e=0;for(let t of this)++e;return e}function jn(){return!this.node()}function Mn(e){for(var t=this._groups,n=0,r=t.length;n<r;++n)for(var i=t[n],a=0,o=i.length,s;a<o;++a)(s=i[a])&&e.call(s,s.__data__,a,i);return this}function Nn(e){return function(){this.removeAttribute(e)}}function Pn(e){return function(){this.removeAttributeNS(e.space,e.local)}}function Fn(e,t){return function(){this.setAttribute(e,t)}}function In(e,t){return function(){this.setAttributeNS(e.space,e.local,t)}}function Ln(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttribute(e):this.setAttribute(e,n)}}function Rn(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,n)}}function zn(e,t){var n=Ht(e);if(arguments.length<2){var r=this.node();return n.local?r.getAttributeNS(n.space,n.local):r.getAttribute(n)}return this.each((t==null?n.local?Pn:Nn:typeof t==`function`?n.local?Rn:Ln:n.local?In:Fn)(n,t))}function Bn(e){return e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView}function Vn(e){return function(){this.style.removeProperty(e)}}function Hn(e,t,n){return function(){this.style.setProperty(e,t,n)}}function Un(e,t,n){return function(){var r=t.apply(this,arguments);r==null?this.style.removeProperty(e):this.style.setProperty(e,r,n)}}function Wn(e,t,n){return arguments.length>1?this.each((t==null?Vn:typeof t==`function`?Un:Hn)(e,t,n??``)):Gn(this.node(),e)}function Gn(e,t){return e.style.getPropertyValue(t)||Bn(e).getComputedStyle(e,null).getPropertyValue(t)}function Kn(e){return function(){delete this[e]}}function qn(e,t){return function(){this[e]=t}}function Jn(e,t){return function(){var n=t.apply(this,arguments);n==null?delete this[e]:this[e]=n}}function Yn(e,t){return arguments.length>1?this.each((t==null?Kn:typeof t==`function`?Jn:qn)(e,t)):this.node()[e]}function Xn(e){return e.trim().split(/^|\s+/)}function Zn(e){return e.classList||new Qn(e)}function Qn(e){this._node=e,this._names=Xn(e.getAttribute(`class`)||``)}Qn.prototype={add:function(e){this._names.indexOf(e)<0&&(this._names.push(e),this._node.setAttribute(`class`,this._names.join(` `)))},remove:function(e){var t=this._names.indexOf(e);t>=0&&(this._names.splice(t,1),this._node.setAttribute(`class`,this._names.join(` `)))},contains:function(e){return this._names.indexOf(e)>=0}};function $n(e,t){for(var n=Zn(e),r=-1,i=t.length;++r<i;)n.add(t[r])}function er(e,t){for(var n=Zn(e),r=-1,i=t.length;++r<i;)n.remove(t[r])}function tr(e){return function(){$n(this,e)}}function nr(e){return function(){er(this,e)}}function rr(e,t){return function(){(t.apply(this,arguments)?$n:er)(this,e)}}function ir(e,t){var n=Xn(e+``);if(arguments.length<2){for(var r=Zn(this.node()),i=-1,a=n.length;++i<a;)if(!r.contains(n[i]))return!1;return!0}return this.each((typeof t==`function`?rr:t?tr:nr)(n,t))}function ar(){this.textContent=``}function or(e){return function(){this.textContent=e}}function sr(e){return function(){this.textContent=e.apply(this,arguments)??``}}function cr(e){return arguments.length?this.each(e==null?ar:(typeof e==`function`?sr:or)(e)):this.node().textContent}function lr(){this.innerHTML=``}function ur(e){return function(){this.innerHTML=e}}function dr(e){return function(){this.innerHTML=e.apply(this,arguments)??``}}function fr(e){return arguments.length?this.each(e==null?lr:(typeof e==`function`?dr:ur)(e)):this.node().innerHTML}function pr(){this.nextSibling&&this.parentNode.appendChild(this)}function mr(){return this.each(pr)}function hr(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function gr(){return this.each(hr)}function _r(e){var t=typeof e==`function`?e:Gt(e);return this.select(function(){return this.appendChild(t.apply(this,arguments))})}function vr(){return null}function yr(e,t){var n=typeof e==`function`?e:Gt(e),r=t==null?vr:typeof t==`function`?t:qt(t);return this.select(function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)})}function br(){var e=this.parentNode;e&&e.removeChild(this)}function xr(){return this.each(br)}function Sr(){var e=this.cloneNode(!1),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function Cr(){var e=this.cloneNode(!0),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function wr(e){return this.select(e?Cr:Sr)}function Tr(e){return arguments.length?this.property(`__data__`,e):this.node().__data__}function Er(e){return function(t){e.call(this,t,this.__data__)}}function Dr(e){return e.trim().split(/^|\s+/).map(function(e){var t=``,n=e.indexOf(`.`);return n>=0&&(t=e.slice(n+1),e=e.slice(0,n)),{type:e,name:t}})}function Or(e){return function(){var t=this.__on;if(t){for(var n=0,r=-1,i=t.length,a;n<i;++n)a=t[n],(!e.type||a.type===e.type)&&a.name===e.name?this.removeEventListener(a.type,a.listener,a.options):t[++r]=a;++r?t.length=r:delete this.__on}}}function kr(e,t,n){return function(){var r=this.__on,i,a=Er(t);if(r){for(var o=0,s=r.length;o<s;++o)if((i=r[o]).type===e.type&&i.name===e.name){this.removeEventListener(i.type,i.listener,i.options),this.addEventListener(i.type,i.listener=a,i.options=n),i.value=t;return}}this.addEventListener(e.type,a,n),i={type:e.type,name:e.name,value:t,listener:a,options:n},r?r.push(i):this.__on=[i]}}function Ar(e,t,n){var r=Dr(e+``),i,a=r.length,o;if(arguments.length<2){var s=this.node().__on;if(s){for(var c=0,l=s.length,u;c<l;++c)for(i=0,u=s[c];i<a;++i)if((o=r[i]).type===u.type&&o.name===u.name)return u.value}return}for(s=t?kr:Or,i=0;i<a;++i)this.each(s(r[i],t,n));return this}function jr(e,t,n){var r=Bn(e),i=r.CustomEvent;typeof i==`function`?i=new i(t,n):(i=r.document.createEvent(`Event`),n?(i.initEvent(t,n.bubbles,n.cancelable),i.detail=n.detail):i.initEvent(t,!1,!1)),e.dispatchEvent(i)}function Mr(e,t){return function(){return jr(this,e,t)}}function Nr(e,t){return function(){return jr(this,e,t.apply(this,arguments))}}function Pr(e,t){return this.each((typeof t==`function`?Nr:Mr)(e,t))}function*Fr(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var r=e[t],i=0,a=r.length,o;i<a;++i)(o=r[i])&&(yield o)}var Ir=[null];function Lr(e,t){this._groups=e,this._parents=t}function Rr(){return new Lr([[document.documentElement]],Ir)}function zr(){return this}Lr.prototype=Rr.prototype={constructor:Lr,select:Jt,selectAll:$t,selectChild:on,selectChildren:un,filter:dn,data:yn,enter:pn,exit:xn,join:Sn,merge:Cn,selection:zr,order:wn,sort:Tn,call:Dn,nodes:On,node:kn,size:An,empty:jn,each:Mn,attr:zn,style:Wn,property:Yn,classed:ir,text:cr,html:fr,raise:mr,lower:gr,append:_r,insert:yr,remove:xr,clone:wr,datum:Tr,on:Ar,dispatch:Pr,[Symbol.iterator]:Fr};function Br(e){return typeof e==`string`?new Lr([[document.querySelector(e)]],[document.documentElement]):new Lr([[e]],Ir)}function Vr(e){let t;for(;t=e.sourceEvent;)e=t;return e}function Hr(e,t){if(e=Vr(e),t===void 0&&(t=e.currentTarget),t){var n=t.ownerSVGElement||t;if(n.createSVGPoint){var r=n.createSVGPoint();return r.x=e.clientX,r.y=e.clientY,r=r.matrixTransform(t.getScreenCTM().inverse()),[r.x,r.y]}if(t.getBoundingClientRect){var i=t.getBoundingClientRect();return[e.clientX-i.left-t.clientLeft,e.clientY-i.top-t.clientTop]}}return[e.pageX,e.pageY]}var Ur={passive:!1},Wr={capture:!0,passive:!1};function Gr(e){e.stopImmediatePropagation()}function Kr(e){e.preventDefault(),e.stopImmediatePropagation()}function qr(e){var t=e.document.documentElement,n=Br(e).on(`dragstart.drag`,Kr,Wr);`onselectstart`in t?n.on(`selectstart.drag`,Kr,Wr):(t.__noselect=t.style.MozUserSelect,t.style.MozUserSelect=`none`)}function Jr(e,t){var n=e.document.documentElement,r=Br(e).on(`dragstart.drag`,null);t&&(r.on(`click.drag`,Kr,Wr),setTimeout(function(){r.on(`click.drag`,null)},0)),`onselectstart`in n?r.on(`selectstart.drag`,null):(n.style.MozUserSelect=n.__noselect,delete n.__noselect)}var Yr=e=>()=>e;function Xr(e,{sourceEvent:t,subject:n,target:r,identifier:i,active:a,x:o,y:s,dx:c,dy:l,dispatch:u}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},subject:{value:n,enumerable:!0,configurable:!0},target:{value:r,enumerable:!0,configurable:!0},identifier:{value:i,enumerable:!0,configurable:!0},active:{value:a,enumerable:!0,configurable:!0},x:{value:o,enumerable:!0,configurable:!0},y:{value:s,enumerable:!0,configurable:!0},dx:{value:c,enumerable:!0,configurable:!0},dy:{value:l,enumerable:!0,configurable:!0},_:{value:u}})}Xr.prototype.on=function(){var e=this._.on.apply(this._,arguments);return e===this._?this:e};function Zr(e){return!e.ctrlKey&&!e.button}function Qr(){return this.parentNode}function $r(e,t){return t??{x:e.x,y:e.y}}function ei(){return navigator.maxTouchPoints||`ontouchstart`in this}function ti(){var e=Zr,t=Qr,n=$r,r=ei,i={},a=Ft(`start`,`drag`,`end`),o=0,s,c,l,u,d=0;function f(e){e.on(`mousedown.drag`,p).filter(r).on(`touchstart.drag`,g).on(`touchmove.drag`,_,Ur).on(`touchend.drag touchcancel.drag`,v).style(`touch-action`,`none`).style(`-webkit-tap-highlight-color`,`rgba(0,0,0,0)`)}function p(n,r){if(!(u||!e.call(this,n,r))){var i=y(this,t.call(this,n,r),n,r,`mouse`);i&&(Br(n.view).on(`mousemove.drag`,m,Wr).on(`mouseup.drag`,h,Wr),qr(n.view),Gr(n),l=!1,s=n.clientX,c=n.clientY,i(`start`,n))}}function m(e){if(Kr(e),!l){var t=e.clientX-s,n=e.clientY-c;l=t*t+n*n>d}i.mouse(`drag`,e)}function h(e){Br(e.view).on(`mousemove.drag mouseup.drag`,null),Jr(e.view,l),Kr(e),i.mouse(`end`,e)}function g(n,r){if(e.call(this,n,r)){var i=n.changedTouches,a=t.call(this,n,r),o=i.length,s,c;for(s=0;s<o;++s)(c=y(this,a,n,r,i[s].identifier,i[s]))&&(Gr(n),c(`start`,n,i[s]))}}function _(e){var t=e.changedTouches,n=t.length,r,a;for(r=0;r<n;++r)(a=i[t[r].identifier])&&(Kr(e),a(`drag`,e,t[r]))}function v(e){var t=e.changedTouches,n=t.length,r,a;for(u&&clearTimeout(u),u=setTimeout(function(){u=null},500),r=0;r<n;++r)(a=i[t[r].identifier])&&(Gr(e),a(`end`,e,t[r]))}function y(e,t,r,s,c,l){var u=a.copy(),d=Hr(l||r,t),p,m,h;if((h=n.call(e,new Xr(`beforestart`,{sourceEvent:r,target:f,identifier:c,active:o,x:d[0],y:d[1],dx:0,dy:0,dispatch:u}),s))!=null)return p=h.x-d[0]||0,m=h.y-d[1]||0,function n(r,a,l){var g=d,_;switch(r){case`start`:i[c]=n,_=o++;break;case`end`:delete i[c],--o;case`drag`:d=Hr(l||a,t),_=o;break}u.call(r,e,new Xr(r,{sourceEvent:a,subject:h,target:f,identifier:c,active:_,x:d[0]+p,y:d[1]+m,dx:d[0]-g[0],dy:d[1]-g[1],dispatch:u}),s)}}return f.filter=function(t){return arguments.length?(e=typeof t==`function`?t:Yr(!!t),f):e},f.container=function(e){return arguments.length?(t=typeof e==`function`?e:Yr(e),f):t},f.subject=function(e){return arguments.length?(n=typeof e==`function`?e:Yr(e),f):n},f.touchable=function(e){return arguments.length?(r=typeof e==`function`?e:Yr(!!e),f):r},f.on=function(){var e=a.on.apply(a,arguments);return e===a?f:e},f.clickDistance=function(e){return arguments.length?(d=(e=+e)*e,f):Math.sqrt(d)},f}function ni(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function ri(e,t){var n=Object.create(e.prototype);for(var r in t)n[r]=t[r];return n}function ii(){}var ai=.7,oi=1/ai,si=`\\s*([+-]?\\d+)\\s*`,ci=`\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*`,li=`\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*`,ui=/^#([0-9a-f]{3,8})$/,di=RegExp(`^rgb\\(${si},${si},${si}\\)$`),fi=RegExp(`^rgb\\(${li},${li},${li}\\)$`),pi=RegExp(`^rgba\\(${si},${si},${si},${ci}\\)$`),mi=RegExp(`^rgba\\(${li},${li},${li},${ci}\\)$`),hi=RegExp(`^hsl\\(${ci},${li},${li}\\)$`),gi=RegExp(`^hsla\\(${ci},${li},${li},${ci}\\)$`),_i={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};ni(ii,Si,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:vi,formatHex:vi,formatHex8:yi,formatHsl:bi,formatRgb:xi,toString:xi});function vi(){return this.rgb().formatHex()}function yi(){return this.rgb().formatHex8()}function bi(){return Fi(this).formatHsl()}function xi(){return this.rgb().formatRgb()}function Si(e){var t,n;return e=(e+``).trim().toLowerCase(),(t=ui.exec(e))?(n=t[1].length,t=parseInt(t[1],16),n===6?Ci(t):n===3?new Di(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):n===8?wi(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):n===4?wi(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=di.exec(e))?new Di(t[1],t[2],t[3],1):(t=fi.exec(e))?new Di(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=pi.exec(e))?wi(t[1],t[2],t[3],t[4]):(t=mi.exec(e))?wi(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=hi.exec(e))?Pi(t[1],t[2]/100,t[3]/100,1):(t=gi.exec(e))?Pi(t[1],t[2]/100,t[3]/100,t[4]):_i.hasOwnProperty(e)?Ci(_i[e]):e===`transparent`?new Di(NaN,NaN,NaN,0):null}function Ci(e){return new Di(e>>16&255,e>>8&255,e&255,1)}function wi(e,t,n,r){return r<=0&&(e=t=n=NaN),new Di(e,t,n,r)}function Ti(e){return e instanceof ii||(e=Si(e)),e?(e=e.rgb(),new Di(e.r,e.g,e.b,e.opacity)):new Di}function Ei(e,t,n,r){return arguments.length===1?Ti(e):new Di(e,t,n,r??1)}function Di(e,t,n,r){this.r=+e,this.g=+t,this.b=+n,this.opacity=+r}ni(Di,Ei,ri(ii,{brighter(e){return e=e==null?oi:oi**+e,new Di(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?ai:ai**+e,new Di(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new Di(Mi(this.r),Mi(this.g),Mi(this.b),ji(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Oi,formatHex:Oi,formatHex8:ki,formatRgb:Ai,toString:Ai}));function Oi(){return`#${Ni(this.r)}${Ni(this.g)}${Ni(this.b)}`}function ki(){return`#${Ni(this.r)}${Ni(this.g)}${Ni(this.b)}${Ni((isNaN(this.opacity)?1:this.opacity)*255)}`}function Ai(){let e=ji(this.opacity);return`${e===1?`rgb(`:`rgba(`}${Mi(this.r)}, ${Mi(this.g)}, ${Mi(this.b)}${e===1?`)`:`, ${e})`}`}function ji(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function Mi(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function Ni(e){return e=Mi(e),(e<16?`0`:``)+e.toString(16)}function Pi(e,t,n,r){return r<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new Li(e,t,n,r)}function Fi(e){if(e instanceof Li)return new Li(e.h,e.s,e.l,e.opacity);if(e instanceof ii||(e=Si(e)),!e)return new Li;if(e instanceof Li)return e;e=e.rgb();var t=e.r/255,n=e.g/255,r=e.b/255,i=Math.min(t,n,r),a=Math.max(t,n,r),o=NaN,s=a-i,c=(a+i)/2;return s?(o=t===a?(n-r)/s+(n<r)*6:n===a?(r-t)/s+2:(t-n)/s+4,s/=c<.5?a+i:2-a-i,o*=60):s=c>0&&c<1?0:o,new Li(o,s,c,e.opacity)}function Ii(e,t,n,r){return arguments.length===1?Fi(e):new Li(e,t,n,r??1)}function Li(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}ni(Li,Ii,ri(ii,{brighter(e){return e=e==null?oi:oi**+e,new Li(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?ai:ai**+e,new Li(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*t,i=2*n-r;return new Di(Bi(e>=240?e-240:e+120,i,r),Bi(e,i,r),Bi(e<120?e+240:e-120,i,r),this.opacity)},clamp(){return new Li(Ri(this.h),zi(this.s),zi(this.l),ji(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){let e=ji(this.opacity);return`${e===1?`hsl(`:`hsla(`}${Ri(this.h)}, ${zi(this.s)*100}%, ${zi(this.l)*100}%${e===1?`)`:`, ${e})`}`}}));function Ri(e){return e=(e||0)%360,e<0?e+360:e}function zi(e){return Math.max(0,Math.min(1,e||0))}function Bi(e,t,n){return(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)*255}var Vi=e=>()=>e;function Hi(e,t){return function(n){return e+n*t}}function Ui(e,t,n){return e**=+n,t=t**+n-e,n=1/n,function(r){return(e+r*t)**+n}}function Wi(e){return(e=+e)==1?Gi:function(t,n){return n-t?Ui(t,n,e):Vi(isNaN(t)?n:t)}}function Gi(e,t){var n=t-e;return n?Hi(e,n):Vi(isNaN(e)?t:e)}var Ki=function e(t){var n=Wi(t);function r(e,t){var r=n((e=Ei(e)).r,(t=Ei(t)).r),i=n(e.g,t.g),a=n(e.b,t.b),o=Gi(e.opacity,t.opacity);return function(t){return e.r=r(t),e.g=i(t),e.b=a(t),e.opacity=o(t),e+``}}return r.gamma=e,r}(1);function qi(e,t){t||=[];var n=e?Math.min(t.length,e.length):0,r=t.slice(),i;return function(a){for(i=0;i<n;++i)r[i]=e[i]*(1-a)+t[i]*a;return r}}function Ji(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function Yi(e,t){var n=t?t.length:0,r=e?Math.min(n,e.length):0,i=Array(r),a=Array(n),o;for(o=0;o<r;++o)i[o]=ia(e[o],t[o]);for(;o<n;++o)a[o]=t[o];return function(e){for(o=0;o<r;++o)a[o]=i[o](e);return a}}function Xi(e,t){var n=new Date;return e=+e,t=+t,function(r){return n.setTime(e*(1-r)+t*r),n}}function Zi(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}}function Qi(e,t){var n={},r={},i;for(i in(typeof e!=`object`||!e)&&(e={}),(typeof t!=`object`||!t)&&(t={}),t)i in e?n[i]=ia(e[i],t[i]):r[i]=t[i];return function(e){for(i in n)r[i]=n[i](e);return r}}var $i=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,ea=new RegExp($i.source,`g`);function ta(e){return function(){return e}}function na(e){return function(t){return e(t)+``}}function ra(e,t){var n=$i.lastIndex=ea.lastIndex=0,r,i,a,o=-1,s=[],c=[];for(e+=``,t+=``;(r=$i.exec(e))&&(i=ea.exec(t));)(a=i.index)>n&&(a=t.slice(n,a),s[o]?s[o]+=a:s[++o]=a),(r=r[0])===(i=i[0])?s[o]?s[o]+=i:s[++o]=i:(s[++o]=null,c.push({i:o,x:Zi(r,i)})),n=ea.lastIndex;return n<t.length&&(a=t.slice(n),s[o]?s[o]+=a:s[++o]=a),s.length<2?c[0]?na(c[0].x):ta(t):(t=c.length,function(e){for(var n=0,r;n<t;++n)s[(r=c[n]).i]=r.x(e);return s.join(``)})}function ia(e,t){var n=typeof t,r;return t==null||n===`boolean`?Vi(t):(n===`number`?Zi:n===`string`?(r=Si(t))?(t=r,Ki):ra:t instanceof Si?Ki:t instanceof Date?Xi:Ji(t)?qi:Array.isArray(t)?Yi:typeof t.valueOf!=`function`&&typeof t.toString!=`function`||isNaN(t)?Qi:Zi)(e,t)}var aa=180/Math.PI,oa={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function sa(e,t,n,r,i,a){var o,s,c;return(o=Math.sqrt(e*e+t*t))&&(e/=o,t/=o),(c=e*n+t*r)&&(n-=e*c,r-=t*c),(s=Math.sqrt(n*n+r*r))&&(n/=s,r/=s,c/=s),e*r<t*n&&(e=-e,t=-t,c=-c,o=-o),{translateX:i,translateY:a,rotate:Math.atan2(t,e)*aa,skewX:Math.atan(c)*aa,scaleX:o,scaleY:s}}var ca;function la(e){let t=new(typeof DOMMatrix==`function`?DOMMatrix:WebKitCSSMatrix)(e+``);return t.isIdentity?oa:sa(t.a,t.b,t.c,t.d,t.e,t.f)}function ua(e){return e==null||(ca||=document.createElementNS(`http://www.w3.org/2000/svg`,`g`),ca.setAttribute(`transform`,e),!(e=ca.transform.baseVal.consolidate()))?oa:(e=e.matrix,sa(e.a,e.b,e.c,e.d,e.e,e.f))}function da(e,t,n,r){function i(e){return e.length?e.pop()+` `:``}function a(e,r,i,a,o,s){if(e!==i||r!==a){var c=o.push(`translate(`,null,t,null,n);s.push({i:c-4,x:Zi(e,i)},{i:c-2,x:Zi(r,a)})}else (i||a)&&o.push(`translate(`+i+t+a+n)}function o(e,t,n,a){e===t?t&&n.push(i(n)+`rotate(`+t+r):(e-t>180?t+=360:t-e>180&&(e+=360),a.push({i:n.push(i(n)+`rotate(`,null,r)-2,x:Zi(e,t)}))}function s(e,t,n,a){e===t?t&&n.push(i(n)+`skewX(`+t+r):a.push({i:n.push(i(n)+`skewX(`,null,r)-2,x:Zi(e,t)})}function c(e,t,n,r,a,o){if(e!==n||t!==r){var s=a.push(i(a)+`scale(`,null,`,`,null,`)`);o.push({i:s-4,x:Zi(e,n)},{i:s-2,x:Zi(t,r)})}else (n!==1||r!==1)&&a.push(i(a)+`scale(`+n+`,`+r+`)`)}return function(t,n){var r=[],i=[];return t=e(t),n=e(n),a(t.translateX,t.translateY,n.translateX,n.translateY,r,i),o(t.rotate,n.rotate,r,i),s(t.skewX,n.skewX,r,i),c(t.scaleX,t.scaleY,n.scaleX,n.scaleY,r,i),t=n=null,function(e){for(var t=-1,n=i.length,a;++t<n;)r[(a=i[t]).i]=a.x(e);return r.join(``)}}}var fa=da(la,`px, `,`px)`,`deg)`),pa=da(ua,`, `,`)`,`)`),ma=1e-12;function ha(e){return((e=Math.exp(e))+1/e)/2}function ga(e){return((e=Math.exp(e))-1/e)/2}function _a(e){return((e=Math.exp(2*e))-1)/(e+1)}var va=function e(t,n,r){function i(e,i){var a=e[0],o=e[1],s=e[2],c=i[0],l=i[1],u=i[2],d=c-a,f=l-o,p=d*d+f*f,m,h;if(p<ma)h=Math.log(u/s)/t,m=function(e){return[a+e*d,o+e*f,s*Math.exp(t*e*h)]};else{var g=Math.sqrt(p),_=(u*u-s*s+r*p)/(2*s*n*g),v=(u*u-s*s-r*p)/(2*u*n*g),y=Math.log(Math.sqrt(_*_+1)-_);h=(Math.log(Math.sqrt(v*v+1)-v)-y)/t,m=function(e){var r=e*h,i=ha(y),c=s/(n*g)*(i*_a(t*r+y)-ga(y));return[a+c*d,o+c*f,s*i/ha(t*r+y)]}}return m.duration=h*1e3*t/Math.SQRT2,m}return i.rho=function(t){var n=Math.max(.001,+t),r=n*n,i=r*r;return e(n,r,i)},i}(Math.SQRT2,2,4),ya=0,ba=0,xa=0,Sa=1e3,Ca,wa,Ta=0,Ea=0,Da=0,Oa=typeof performance==`object`&&performance.now?performance:Date,ka=typeof window==`object`&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function Aa(){return Ea||=(ka(ja),Oa.now()+Da)}function ja(){Ea=0}function Ma(){this._call=this._time=this._next=null}Ma.prototype=Na.prototype={constructor:Ma,restart:function(e,t,n){if(typeof e!=`function`)throw TypeError(`callback is not a function`);n=(n==null?Aa():+n)+(t==null?0:+t),!this._next&&wa!==this&&(wa?wa._next=this:Ca=this,wa=this),this._call=e,this._time=n,Ra()},stop:function(){this._call&&(this._call=null,this._time=1/0,Ra())}};function Na(e,t,n){var r=new Ma;return r.restart(e,t,n),r}function Pa(){Aa(),++ya;for(var e=Ca,t;e;)(t=Ea-e._time)>=0&&e._call.call(void 0,t),e=e._next;--ya}function Fa(){Ea=(Ta=Oa.now())+Da,ya=ba=0;try{Pa()}finally{ya=0,La(),Ea=0}}function Ia(){var e=Oa.now(),t=e-Ta;t>Sa&&(Da-=t,Ta=e)}function La(){for(var e,t=Ca,n,r=1/0;t;)t._call?(r>t._time&&(r=t._time),e=t,t=t._next):(n=t._next,t._next=null,t=e?e._next=n:Ca=n);wa=e,Ra(r)}function Ra(e){ya||(ba&&=clearTimeout(ba),e-Ea>24?(e<1/0&&(ba=setTimeout(Fa,e-Oa.now()-Da)),xa&&=clearInterval(xa)):(xa||=(Ta=Oa.now(),setInterval(Ia,Sa)),ya=1,ka(Fa)))}function za(e,t,n){var r=new Ma;return t=t==null?0:+t,r.restart(n=>{r.stop(),e(n+t)},t,n),r}var Ba=Ft(`start`,`end`,`cancel`,`interrupt`),Va=[],Ha=0,Ua=1,Wa=2,Ga=3,Ka=4,qa=5,Ja=6;function Ya(e,t,n,r,i,a){var o=e.__transition;if(!o)e.__transition={};else if(n in o)return;$a(e,n,{name:t,index:r,group:i,on:Ba,tween:Va,time:a.time,delay:a.delay,duration:a.duration,ease:a.ease,timer:null,state:Ha})}function Xa(e,t){var n=Qa(e,t);if(n.state>Ha)throw Error(`too late; already scheduled`);return n}function Za(e,t){var n=Qa(e,t);if(n.state>Ga)throw Error(`too late; already running`);return n}function Qa(e,t){var n=e.__transition;if(!n||!(n=n[t]))throw Error(`transition not found`);return n}function $a(e,t,n){var r=e.__transition,i;r[t]=n,n.timer=Na(a,0,n.time);function a(e){n.state=Ua,n.timer.restart(o,n.delay,n.time),n.delay<=e&&o(e-n.delay)}function o(a){var l,u,d,f;if(n.state!==Ua)return c();for(l in r)if(f=r[l],f.name===n.name){if(f.state===Ga)return za(o);f.state===Ka?(f.state=Ja,f.timer.stop(),f.on.call(`interrupt`,e,e.__data__,f.index,f.group),delete r[l]):+l<t&&(f.state=Ja,f.timer.stop(),f.on.call(`cancel`,e,e.__data__,f.index,f.group),delete r[l])}if(za(function(){n.state===Ga&&(n.state=Ka,n.timer.restart(s,n.delay,n.time),s(a))}),n.state=Wa,n.on.call(`start`,e,e.__data__,n.index,n.group),n.state===Wa){for(n.state=Ga,i=Array(d=n.tween.length),l=0,u=-1;l<d;++l)(f=n.tween[l].value.call(e,e.__data__,n.index,n.group))&&(i[++u]=f);i.length=u+1}}function s(t){for(var r=t<n.duration?n.ease.call(null,t/n.duration):(n.timer.restart(c),n.state=qa,1),a=-1,o=i.length;++a<o;)i[a].call(e,r);n.state===qa&&(n.on.call(`end`,e,e.__data__,n.index,n.group),c())}function c(){for(var i in n.state=Ja,n.timer.stop(),delete r[t],r)return;delete e.__transition}}function eo(e,t){var n=e.__transition,r,i,a=!0,o;if(n){for(o in t=t==null?null:t+``,n){if((r=n[o]).name!==t){a=!1;continue}i=r.state>Wa&&r.state<qa,r.state=Ja,r.timer.stop(),r.on.call(i?`interrupt`:`cancel`,e,e.__data__,r.index,r.group),delete n[o]}a&&delete e.__transition}}function to(e){return this.each(function(){eo(this,e)})}function no(e,t){var n,r;return function(){var i=Za(this,e),a=i.tween;if(a!==n){r=n=a;for(var o=0,s=r.length;o<s;++o)if(r[o].name===t){r=r.slice(),r.splice(o,1);break}}i.tween=r}}function ro(e,t,n){var r,i;if(typeof n!=`function`)throw Error();return function(){var a=Za(this,e),o=a.tween;if(o!==r){i=(r=o).slice();for(var s={name:t,value:n},c=0,l=i.length;c<l;++c)if(i[c].name===t){i[c]=s;break}c===l&&i.push(s)}a.tween=i}}function io(e,t){var n=this._id;if(e+=``,arguments.length<2){for(var r=Qa(this.node(),n).tween,i=0,a=r.length,o;i<a;++i)if((o=r[i]).name===e)return o.value;return null}return this.each((t==null?no:ro)(n,e,t))}function ao(e,t,n){var r=e._id;return e.each(function(){var e=Za(this,r);(e.value||={})[t]=n.apply(this,arguments)}),function(e){return Qa(e,r).value[t]}}function oo(e,t){var n;return(typeof t==`number`?Zi:t instanceof Si?Ki:(n=Si(t))?(t=n,Ki):ra)(e,t)}function so(e){return function(){this.removeAttribute(e)}}function co(e){return function(){this.removeAttributeNS(e.space,e.local)}}function lo(e,t,n){var r,i=n+``,a;return function(){var o=this.getAttribute(e);return o===i?null:o===r?a:a=t(r=o,n)}}function uo(e,t,n){var r,i=n+``,a;return function(){var o=this.getAttributeNS(e.space,e.local);return o===i?null:o===r?a:a=t(r=o,n)}}function fo(e,t,n){var r,i,a;return function(){var o,s=n(this),c;return s==null?void this.removeAttribute(e):(o=this.getAttribute(e),c=s+``,o===c?null:o===r&&c===i?a:(i=c,a=t(r=o,s)))}}function po(e,t,n){var r,i,a;return function(){var o,s=n(this),c;return s==null?void this.removeAttributeNS(e.space,e.local):(o=this.getAttributeNS(e.space,e.local),c=s+``,o===c?null:o===r&&c===i?a:(i=c,a=t(r=o,s)))}}function mo(e,t){var n=Ht(e),r=n===`transform`?pa:oo;return this.attrTween(e,typeof t==`function`?(n.local?po:fo)(n,r,ao(this,`attr.`+e,t)):t==null?(n.local?co:so)(n):(n.local?uo:lo)(n,r,t))}function ho(e,t){return function(n){this.setAttribute(e,t.call(this,n))}}function go(e,t){return function(n){this.setAttributeNS(e.space,e.local,t.call(this,n))}}function _o(e,t){var n,r;function i(){var i=t.apply(this,arguments);return i!==r&&(n=(r=i)&&go(e,i)),n}return i._value=t,i}function vo(e,t){var n,r;function i(){var i=t.apply(this,arguments);return i!==r&&(n=(r=i)&&ho(e,i)),n}return i._value=t,i}function yo(e,t){var n=`attr.`+e;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(t==null)return this.tween(n,null);if(typeof t!=`function`)throw Error();var r=Ht(e);return this.tween(n,(r.local?_o:vo)(r,t))}function bo(e,t){return function(){Xa(this,e).delay=+t.apply(this,arguments)}}function xo(e,t){return t=+t,function(){Xa(this,e).delay=t}}function So(e){var t=this._id;return arguments.length?this.each((typeof e==`function`?bo:xo)(t,e)):Qa(this.node(),t).delay}function Co(e,t){return function(){Za(this,e).duration=+t.apply(this,arguments)}}function wo(e,t){return t=+t,function(){Za(this,e).duration=t}}function To(e){var t=this._id;return arguments.length?this.each((typeof e==`function`?Co:wo)(t,e)):Qa(this.node(),t).duration}function Eo(e,t){if(typeof t!=`function`)throw Error();return function(){Za(this,e).ease=t}}function Do(e){var t=this._id;return arguments.length?this.each(Eo(t,e)):Qa(this.node(),t).ease}function Oo(e,t){return function(){var n=t.apply(this,arguments);if(typeof n!=`function`)throw Error();Za(this,e).ease=n}}function ko(e){if(typeof e!=`function`)throw Error();return this.each(Oo(this._id,e))}function Ao(e){typeof e!=`function`&&(e=en(e));for(var t=this._groups,n=t.length,r=Array(n),i=0;i<n;++i)for(var a=t[i],o=a.length,s=r[i]=[],c,l=0;l<o;++l)(c=a[l])&&e.call(c,c.__data__,l,a)&&s.push(c);return new ss(r,this._parents,this._name,this._id)}function jo(e){if(e._id!==this._id)throw Error();for(var t=this._groups,n=e._groups,r=t.length,i=n.length,a=Math.min(r,i),o=Array(r),s=0;s<a;++s)for(var c=t[s],l=n[s],u=c.length,d=o[s]=Array(u),f,p=0;p<u;++p)(f=c[p]||l[p])&&(d[p]=f);for(;s<r;++s)o[s]=t[s];return new ss(o,this._parents,this._name,this._id)}function Mo(e){return(e+``).trim().split(/^|\s+/).every(function(e){var t=e.indexOf(`.`);return t>=0&&(e=e.slice(0,t)),!e||e===`start`})}function No(e,t,n){var r,i,a=Mo(t)?Xa:Za;return function(){var o=a(this,e),s=o.on;s!==r&&(i=(r=s).copy()).on(t,n),o.on=i}}function Po(e,t){var n=this._id;return arguments.length<2?Qa(this.node(),n).on.on(e):this.each(No(n,e,t))}function Fo(e){return function(){var t=this.parentNode;for(var n in this.__transition)if(+n!==e)return;t&&t.removeChild(this)}}function Io(){return this.on(`end.remove`,Fo(this._id))}function Lo(e){var t=this._name,n=this._id;typeof e!=`function`&&(e=qt(e));for(var r=this._groups,i=r.length,a=Array(i),o=0;o<i;++o)for(var s=r[o],c=s.length,l=a[o]=Array(c),u,d,f=0;f<c;++f)(u=s[f])&&(d=e.call(u,u.__data__,f,s))&&(`__data__`in u&&(d.__data__=u.__data__),l[f]=d,Ya(l[f],t,n,f,l,Qa(u,n)));return new ss(a,this._parents,t,n)}function Ro(e){var t=this._name,n=this._id;typeof e!=`function`&&(e=Zt(e));for(var r=this._groups,i=r.length,a=[],o=[],s=0;s<i;++s)for(var c=r[s],l=c.length,u,d=0;d<l;++d)if(u=c[d]){for(var f=e.call(u,u.__data__,d,c),p,m=Qa(u,n),h=0,g=f.length;h<g;++h)(p=f[h])&&Ya(p,t,n,h,f,m);a.push(f),o.push(u)}return new ss(a,o,t,n)}var zo=Rr.prototype.constructor;function Bo(){return new zo(this._groups,this._parents)}function Vo(e,t){var n,r,i;return function(){var a=Gn(this,e),o=(this.style.removeProperty(e),Gn(this,e));return a===o?null:a===n&&o===r?i:i=t(n=a,r=o)}}function Ho(e){return function(){this.style.removeProperty(e)}}function Uo(e,t,n){var r,i=n+``,a;return function(){var o=Gn(this,e);return o===i?null:o===r?a:a=t(r=o,n)}}function Wo(e,t,n){var r,i,a;return function(){var o=Gn(this,e),s=n(this),c=s+``;return s??(c=s=(this.style.removeProperty(e),Gn(this,e))),o===c?null:o===r&&c===i?a:(i=c,a=t(r=o,s))}}function Go(e,t){var n,r,i,a=`style.`+t,o=`end.`+a,s;return function(){var c=Za(this,e),l=c.on,u=c.value[a]==null?s||=Ho(t):void 0;(l!==n||i!==u)&&(r=(n=l).copy()).on(o,i=u),c.on=r}}function Ko(e,t,n){var r=(e+=``)==`transform`?fa:oo;return t==null?this.styleTween(e,Vo(e,r)).on(`end.style.`+e,Ho(e)):typeof t==`function`?this.styleTween(e,Wo(e,r,ao(this,`style.`+e,t))).each(Go(this._id,e)):this.styleTween(e,Uo(e,r,t),n).on(`end.style.`+e,null)}function qo(e,t,n){return function(r){this.style.setProperty(e,t.call(this,r),n)}}function Jo(e,t,n){var r,i;function a(){var a=t.apply(this,arguments);return a!==i&&(r=(i=a)&&qo(e,a,n)),r}return a._value=t,a}function Yo(e,t,n){var r=`style.`+(e+=``);if(arguments.length<2)return(r=this.tween(r))&&r._value;if(t==null)return this.tween(r,null);if(typeof t!=`function`)throw Error();return this.tween(r,Jo(e,t,n??``))}function Xo(e){return function(){this.textContent=e}}function Zo(e){return function(){this.textContent=e(this)??``}}function Qo(e){return this.tween(`text`,typeof e==`function`?Zo(ao(this,`text`,e)):Xo(e==null?``:e+``))}function $o(e){return function(t){this.textContent=e.call(this,t)}}function es(e){var t,n;function r(){var r=e.apply(this,arguments);return r!==n&&(t=(n=r)&&$o(r)),t}return r._value=e,r}function ts(e){var t=`text`;if(arguments.length<1)return(t=this.tween(t))&&t._value;if(e==null)return this.tween(t,null);if(typeof e!=`function`)throw Error();return this.tween(t,es(e))}function ns(){for(var e=this._name,t=this._id,n=cs(),r=this._groups,i=r.length,a=0;a<i;++a)for(var o=r[a],s=o.length,c,l=0;l<s;++l)if(c=o[l]){var u=Qa(c,t);Ya(c,e,n,l,o,{time:u.time+u.delay+u.duration,delay:0,duration:u.duration,ease:u.ease})}return new ss(r,this._parents,e,n)}function rs(){var e,t,n=this,r=n._id,i=n.size();return new Promise(function(a,o){var s={value:o},c={value:function(){--i===0&&a()}};n.each(function(){var n=Za(this,r),i=n.on;i!==e&&(t=(e=i).copy(),t._.cancel.push(s),t._.interrupt.push(s),t._.end.push(c)),n.on=t}),i===0&&a()})}var os=0;function ss(e,t,n,r){this._groups=e,this._parents=t,this._name=n,this._id=r}function cs(){return++os}var ls=Rr.prototype;ss.prototype={constructor:ss,select:Lo,selectAll:Ro,selectChild:ls.selectChild,selectChildren:ls.selectChildren,filter:Ao,merge:jo,selection:Bo,transition:ns,call:ls.call,nodes:ls.nodes,node:ls.node,size:ls.size,empty:ls.empty,each:ls.each,on:Po,attr:mo,attrTween:yo,style:Ko,styleTween:Yo,text:Qo,textTween:ts,remove:Io,tween:io,delay:So,duration:To,ease:Do,easeVarying:ko,end:rs,[Symbol.iterator]:ls[Symbol.iterator]};function us(e){return((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2}var ds={time:null,delay:0,duration:250,ease:us};function fs(e,t){for(var n;!(n=e.__transition)||!(n=n[t]);)if(!(e=e.parentNode))throw Error(`transition ${t} not found`);return n}function ps(e){var t,n;e instanceof ss?(t=e._id,e=e._name):(t=cs(),(n=ds).time=Aa(),e=e==null?null:e+``);for(var r=this._groups,i=r.length,a=0;a<i;++a)for(var o=r[a],s=o.length,c,l=0;l<s;++l)(c=o[l])&&Ya(c,e,t,l,o,n||fs(c,t));return new ss(r,this._parents,e,t)}Rr.prototype.interrupt=to,Rr.prototype.transition=ps;var ms=e=>()=>e;function hs(e,{sourceEvent:t,target:n,transform:r,dispatch:i}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},target:{value:n,enumerable:!0,configurable:!0},transform:{value:r,enumerable:!0,configurable:!0},_:{value:i}})}function gs(e,t,n){this.k=e,this.x=t,this.y=n}gs.prototype={constructor:gs,scale:function(e){return e===1?this:new gs(this.k*e,this.x,this.y)},translate:function(e,t){return e===0&t===0?this:new gs(this.k,this.x+this.k*e,this.y+this.k*t)},apply:function(e){return[e[0]*this.k+this.x,e[1]*this.k+this.y]},applyX:function(e){return e*this.k+this.x},applyY:function(e){return e*this.k+this.y},invert:function(e){return[(e[0]-this.x)/this.k,(e[1]-this.y)/this.k]},invertX:function(e){return(e-this.x)/this.k},invertY:function(e){return(e-this.y)/this.k},rescaleX:function(e){return e.copy().domain(e.range().map(this.invertX,this).map(e.invert,e))},rescaleY:function(e){return e.copy().domain(e.range().map(this.invertY,this).map(e.invert,e))},toString:function(){return`translate(`+this.x+`,`+this.y+`) scale(`+this.k+`)`}};var _s=new gs(1,0,0);gs.prototype;function vs(e){e.stopImmediatePropagation()}function ys(e){e.preventDefault(),e.stopImmediatePropagation()}function bs(e){return(!e.ctrlKey||e.type===`wheel`)&&!e.button}function xs(){var e=this;return e instanceof SVGElement?(e=e.ownerSVGElement||e,e.hasAttribute(`viewBox`)?(e=e.viewBox.baseVal,[[e.x,e.y],[e.x+e.width,e.y+e.height]]):[[0,0],[e.width.baseVal.value,e.height.baseVal.value]]):[[0,0],[e.clientWidth,e.clientHeight]]}function Ss(){return this.__zoom||_s}function Cs(e){return-e.deltaY*(e.deltaMode===1?.05:e.deltaMode?1:.002)*(e.ctrlKey?10:1)}function ws(){return navigator.maxTouchPoints||`ontouchstart`in this}function Ts(e,t,n){var r=e.invertX(t[0][0])-n[0][0],i=e.invertX(t[1][0])-n[1][0],a=e.invertY(t[0][1])-n[0][1],o=e.invertY(t[1][1])-n[1][1];return e.translate(i>r?(r+i)/2:Math.min(0,r)||Math.max(0,i),o>a?(a+o)/2:Math.min(0,a)||Math.max(0,o))}function Es(){var e=bs,t=xs,n=Ts,r=Cs,i=ws,a=[0,1/0],o=[[-1/0,-1/0],[1/0,1/0]],s=250,c=va,l=Ft(`start`,`zoom`,`end`),u,d,f,p=500,m=150,h=0,g=10;function _(e){e.property(`__zoom`,Ss).on(`wheel.zoom`,w,{passive:!1}).on(`mousedown.zoom`,T).on(`dblclick.zoom`,E).filter(i).on(`touchstart.zoom`,D).on(`touchmove.zoom`,O).on(`touchend.zoom touchcancel.zoom`,k).style(`-webkit-tap-highlight-color`,`rgba(0,0,0,0)`)}_.transform=function(e,t,n,r){var i=e.selection?e.selection():e;i.property(`__zoom`,Ss),e===i?i.interrupt().each(function(){S(this,arguments).event(r).start().zoom(null,typeof t==`function`?t.apply(this,arguments):t).end()}):x(e,t,n,r)},_.scaleBy=function(e,t,n,r){_.scaleTo(e,function(){var e=this.__zoom.k,n=typeof t==`function`?t.apply(this,arguments):t;return e*n},n,r)},_.scaleTo=function(e,r,i,a){_.transform(e,function(){var e=t.apply(this,arguments),a=this.__zoom,s=i==null?b(e):typeof i==`function`?i.apply(this,arguments):i,c=a.invert(s),l=typeof r==`function`?r.apply(this,arguments):r;return n(y(v(a,l),s,c),e,o)},i,a)},_.translateBy=function(e,r,i,a){_.transform(e,function(){return n(this.__zoom.translate(typeof r==`function`?r.apply(this,arguments):r,typeof i==`function`?i.apply(this,arguments):i),t.apply(this,arguments),o)},null,a)},_.translateTo=function(e,r,i,a,s){_.transform(e,function(){var e=t.apply(this,arguments),s=this.__zoom,c=a==null?b(e):typeof a==`function`?a.apply(this,arguments):a;return n(_s.translate(c[0],c[1]).scale(s.k).translate(typeof r==`function`?-r.apply(this,arguments):-r,typeof i==`function`?-i.apply(this,arguments):-i),e,o)},a,s)};function v(e,t){return t=Math.max(a[0],Math.min(a[1],t)),t===e.k?e:new gs(t,e.x,e.y)}function y(e,t,n){var r=t[0]-n[0]*e.k,i=t[1]-n[1]*e.k;return r===e.x&&i===e.y?e:new gs(e.k,r,i)}function b(e){return[(+e[0][0]+ +e[1][0])/2,(+e[0][1]+ +e[1][1])/2]}function x(e,n,r,i){e.on(`start.zoom`,function(){S(this,arguments).event(i).start()}).on(`interrupt.zoom end.zoom`,function(){S(this,arguments).event(i).end()}).tween(`zoom`,function(){var e=this,a=arguments,o=S(e,a).event(i),s=t.apply(e,a),l=r==null?b(s):typeof r==`function`?r.apply(e,a):r,u=Math.max(s[1][0]-s[0][0],s[1][1]-s[0][1]),d=e.__zoom,f=typeof n==`function`?n.apply(e,a):n,p=c(d.invert(l).concat(u/d.k),f.invert(l).concat(u/f.k));return function(e){if(e===1)e=f;else{var t=p(e),n=u/t[2];e=new gs(n,l[0]-t[0]*n,l[1]-t[1]*n)}o.zoom(null,e)}})}function S(e,t,n){return!n&&e.__zooming||new C(e,t)}function C(e,n){this.that=e,this.args=n,this.active=0,this.sourceEvent=null,this.extent=t.apply(e,n),this.taps=0}C.prototype={event:function(e){return e&&(this.sourceEvent=e),this},start:function(){return++this.active===1&&(this.that.__zooming=this,this.emit(`start`)),this},zoom:function(e,t){return this.mouse&&e!==`mouse`&&(this.mouse[1]=t.invert(this.mouse[0])),this.touch0&&e!==`touch`&&(this.touch0[1]=t.invert(this.touch0[0])),this.touch1&&e!==`touch`&&(this.touch1[1]=t.invert(this.touch1[0])),this.that.__zoom=t,this.emit(`zoom`),this},end:function(){return--this.active===0&&(delete this.that.__zooming,this.emit(`end`)),this},emit:function(e){var t=Br(this.that).datum();l.call(e,this.that,new hs(e,{sourceEvent:this.sourceEvent,target:_,type:e,transform:this.that.__zoom,dispatch:l}),t)}};function w(t,...i){if(!e.apply(this,arguments))return;var s=S(this,i).event(t),c=this.__zoom,l=Math.max(a[0],Math.min(a[1],c.k*2**r.apply(this,arguments))),u=Hr(t);if(s.wheel)(s.mouse[0][0]!==u[0]||s.mouse[0][1]!==u[1])&&(s.mouse[1]=c.invert(s.mouse[0]=u)),clearTimeout(s.wheel);else if(c.k===l)return;else s.mouse=[u,c.invert(u)],eo(this),s.start();ys(t),s.wheel=setTimeout(d,m),s.zoom(`mouse`,n(y(v(c,l),s.mouse[0],s.mouse[1]),s.extent,o));function d(){s.wheel=null,s.end()}}function T(t,...r){if(f||!e.apply(this,arguments))return;var i=t.currentTarget,a=S(this,r,!0).event(t),s=Br(t.view).on(`mousemove.zoom`,d,!0).on(`mouseup.zoom`,p,!0),c=Hr(t,i),l=t.clientX,u=t.clientY;qr(t.view),vs(t),a.mouse=[c,this.__zoom.invert(c)],eo(this),a.start();function d(e){if(ys(e),!a.moved){var t=e.clientX-l,r=e.clientY-u;a.moved=t*t+r*r>h}a.event(e).zoom(`mouse`,n(y(a.that.__zoom,a.mouse[0]=Hr(e,i),a.mouse[1]),a.extent,o))}function p(e){s.on(`mousemove.zoom mouseup.zoom`,null),Jr(e.view,a.moved),ys(e),a.event(e).end()}}function E(r,...i){if(e.apply(this,arguments)){var a=this.__zoom,c=Hr(r.changedTouches?r.changedTouches[0]:r,this),l=a.invert(c),u=a.k*(r.shiftKey?.5:2),d=n(y(v(a,u),c,l),t.apply(this,i),o);ys(r),s>0?Br(this).transition().duration(s).call(x,d,c,r):Br(this).call(_.transform,d,c,r)}}function D(t,...n){if(e.apply(this,arguments)){var r=t.touches,i=r.length,a=S(this,n,t.changedTouches.length===i).event(t),o,s,c,l;for(vs(t),s=0;s<i;++s)c=r[s],l=Hr(c,this),l=[l,this.__zoom.invert(l),c.identifier],a.touch0?!a.touch1&&a.touch0[2]!==l[2]&&(a.touch1=l,a.taps=0):(a.touch0=l,o=!0,a.taps=1+!!u);u&&=clearTimeout(u),o&&(a.taps<2&&(d=l[0],u=setTimeout(function(){u=null},p)),eo(this),a.start())}}function O(e,...t){if(this.__zooming){var r=S(this,t).event(e),i=e.changedTouches,a=i.length,s,c,l,u;for(ys(e),s=0;s<a;++s)c=i[s],l=Hr(c,this),r.touch0&&r.touch0[2]===c.identifier?r.touch0[0]=l:r.touch1&&r.touch1[2]===c.identifier&&(r.touch1[0]=l);if(c=r.that.__zoom,r.touch1){var d=r.touch0[0],f=r.touch0[1],p=r.touch1[0],m=r.touch1[1],h=(h=p[0]-d[0])*h+(h=p[1]-d[1])*h,g=(g=m[0]-f[0])*g+(g=m[1]-f[1])*g;c=v(c,Math.sqrt(h/g)),l=[(d[0]+p[0])/2,(d[1]+p[1])/2],u=[(f[0]+m[0])/2,(f[1]+m[1])/2]}else if(r.touch0)l=r.touch0[0],u=r.touch0[1];else return;r.zoom(`touch`,n(y(c,l,u),r.extent,o))}}function k(e,...t){if(this.__zooming){var n=S(this,t).event(e),r=e.changedTouches,i=r.length,a,o;for(vs(e),f&&clearTimeout(f),f=setTimeout(function(){f=null},p),a=0;a<i;++a)o=r[a],n.touch0&&n.touch0[2]===o.identifier?delete n.touch0:n.touch1&&n.touch1[2]===o.identifier&&delete n.touch1;if(n.touch1&&!n.touch0&&(n.touch0=n.touch1,delete n.touch1),n.touch0)n.touch0[1]=this.__zoom.invert(n.touch0[0]);else if(n.end(),n.taps===2&&(o=Hr(o,this),Math.hypot(d[0]-o[0],d[1]-o[1])<g)){var s=Br(this).on(`dblclick.zoom`);s&&s.apply(this,arguments)}}}return _.wheelDelta=function(e){return arguments.length?(r=typeof e==`function`?e:ms(+e),_):r},_.filter=function(t){return arguments.length?(e=typeof t==`function`?t:ms(!!t),_):e},_.touchable=function(e){return arguments.length?(i=typeof e==`function`?e:ms(!!e),_):i},_.extent=function(e){return arguments.length?(t=typeof e==`function`?e:ms([[+e[0][0],+e[0][1]],[+e[1][0],+e[1][1]]]),_):t},_.scaleExtent=function(e){return arguments.length?(a[0]=+e[0],a[1]=+e[1],_):[a[0],a[1]]},_.translateExtent=function(e){return arguments.length?(o[0][0]=+e[0][0],o[1][0]=+e[1][0],o[0][1]=+e[0][1],o[1][1]=+e[1][1],_):[[o[0][0],o[0][1]],[o[1][0],o[1][1]]]},_.constrain=function(e){return arguments.length?(n=e,_):n},_.duration=function(e){return arguments.length?(s=+e,_):s},_.interpolate=function(e){return arguments.length?(c=e,_):c},_.on=function(){var e=l.on.apply(l,arguments);return e===l?_:e},_.clickDistance=function(e){return arguments.length?(h=(e=+e)*e,_):Math.sqrt(h)},_.tapDistance=function(e){return arguments.length?(g=+e,_):g},_}var Q=(e=>(e.Left=`left`,e.Top=`top`,e.Right=`right`,e.Bottom=`bottom`,e))(Q||{}),Ds=(e=>(e.Partial=`partial`,e.Full=`full`,e))(Ds||{}),Os=(e=>(e.Bezier=`default`,e.SimpleBezier=`simple-bezier`,e.Straight=`straight`,e.Step=`step`,e.SmoothStep=`smoothstep`,e))(Os||{}),ks=(e=>(e.Strict=`strict`,e.Loose=`loose`,e))(ks||{}),As=(e=>(e.Arrow=`arrow`,e.ArrowClosed=`arrowclosed`,e))(As||{}),js=(e=>(e.Free=`free`,e.Vertical=`vertical`,e.Horizontal=`horizontal`,e))(js||{}),Ms=(e=>(e.TopLeft=`top-left`,e.TopCenter=`top-center`,e.TopRight=`top-right`,e.BottomLeft=`bottom-left`,e.BottomCenter=`bottom-center`,e.BottomRight=`bottom-right`,e))(Ms||{}),Ns=[`INPUT`,`SELECT`,`TEXTAREA`],Ps=typeof document<`u`?document:null;function Fs(e){let t=e.composedPath?.call(e)?.[0]||e.target,n=typeof t?.hasAttribute==`function`?t.hasAttribute(`contenteditable`):!1,r=typeof t?.closest==`function`?t.closest(`.nokey`):null;return Ns.includes(t?.nodeName)||n||!!r}function Is(e){return e.ctrlKey||e.metaKey||e.shiftKey||e.altKey}function Ls(e,t,n,r){let i=t.replace(`+`,`
`).replace(`

`,`
+`).split(`
`).map(e=>e.trim().toLowerCase());if(i.length===1)return e.toLowerCase()===t.toLowerCase();r||n.add(e.toLowerCase());let a=i.every((e,t)=>n.has(e)&&Array.from(n.values())[t]===i[t]);return r&&n.delete(e.toLowerCase()),a}function Rs(e,t){return n=>{if(!n.code&&!n.key)return!1;let r=zs(n.code,e);return Array.isArray(e)?e.some(e=>Ls(n[r],e,t,n.type===`keyup`)):Ls(n[r],e,t,n.type===`keyup`)}}function zs(e,t){return t.includes(e)?`code`:`key`}function Bs(e,t){let n=q(()=>Xe(t?.target)??Ps),r=Qe(Xe(e)===!0),i=!1,a=new Set,o=c(Xe(e));W(()=>Xe(e),(e,t)=>{typeof t==`boolean`&&typeof e!=`boolean`&&s(),o=c(e)},{immediate:!0}),kt([`blur`,`contextmenu`],s),jt((...e)=>o(...e),e=>{let n=Xe(t?.actInsideInputWithModifier)??!0,a=Xe(t?.preventDefault)??!1;if(i=Is(e),(!i||i&&!n)&&Fs(e))return;let o=e.composedPath?.call(e)?.[0]||e.target,s=o?.nodeName===`BUTTON`||o?.nodeName===`A`;!a&&(i||!s)&&e.preventDefault(),r.value=!0},{eventName:`keydown`,target:n}),jt((...e)=>o(...e),e=>{let n=Xe(t?.actInsideInputWithModifier)??!0;if(r.value){if((!i||i&&!n)&&Fs(e))return;i=!1,r.value=!1}},{eventName:`keyup`,target:n});function s(){i=!1,a.clear(),r.value=Xe(e)===!0}function c(e){return e===null?(s(),()=>!1):typeof e==`boolean`?(s(),r.value=e,()=>!1):Array.isArray(e)||typeof e==`string`?Rs(e,a):e}return r}var Vs=`vue-flow__node-desc`,Hs=`vue-flow__edge-desc`,Us=`vue-flow__aria-live`,Ws=[`Enter`,` `,`Escape`],Gs={ArrowUp:{x:0,y:-1},ArrowDown:{x:0,y:1},ArrowLeft:{x:-1,y:0},ArrowRight:{x:1,y:0}};function Ks(e){return{...e.computedPosition||{x:0,y:0},width:e.dimensions.width||0,height:e.dimensions.height||0}}function qs(e,t){let n=Math.max(0,Math.min(e.x+e.width,t.x+t.width)-Math.max(e.x,t.x)),r=Math.max(0,Math.min(e.y+e.height,t.y+t.height)-Math.max(e.y,t.y));return Math.ceil(n*r)}function Js(e){return{width:e.offsetWidth,height:e.offsetHeight}}function Ys(e,t=0,n=1){return Math.min(Math.max(e,t),n)}function Xs(e,t){return{x:Ys(e.x,t[0][0],t[1][0]),y:Ys(e.y,t[0][1],t[1][1])}}function Zs(e){let t=e.getRootNode();return`elementFromPoint`in t?t:window.document}function Qs(e){return e&&typeof e==`object`&&`id`in e&&`source`in e&&`target`in e}function $s(e){return e&&typeof e==`object`&&`id`in e&&`position`in e&&!Qs(e)}function ec(e){return $s(e)&&`computedPosition`in e}function tc(e){return!Number.isNaN(e)&&Number.isFinite(e)}function nc(e){return tc(e.width)&&tc(e.height)&&tc(e.x)&&tc(e.y)}function rc(e,t,n){let r={id:e.id.toString(),type:e.type??`default`,dimensions:De({width:0,height:0}),computedPosition:De({z:0,...e.position}),handleBounds:{source:[],target:[]},draggable:void 0,selectable:void 0,connectable:void 0,focusable:void 0,selected:!1,dragging:!1,resizing:!1,initialized:!1,isParent:!1,position:{x:0,y:0},data:bl(e.data)?e.data:{},events:De(bl(e.events)?e.events:{})};return Object.assign(t??r,e,{id:e.id.toString(),parentNode:n})}function ic(e,t,n){let r={id:e.id.toString(),type:e.type??t?.type??`default`,source:e.source.toString(),target:e.target.toString(),sourceHandle:e.sourceHandle?.toString(),targetHandle:e.targetHandle?.toString(),updatable:e.updatable??n?.updatable,selectable:e.selectable??n?.selectable,focusable:e.focusable??n?.focusable,data:bl(e.data)?e.data:{},events:De(bl(e.events)?e.events:{}),label:e.label??``,interactionWidth:e.interactionWidth??n?.interactionWidth,...n??{}};return Object.assign(t??r,e,{id:e.id.toString()})}function ac(e,t,n,r){let i=typeof e==`string`?e:e.id,a=new Set,o=r===`source`?`target`:`source`;for(let e of n)e[o]===i&&a.add(e[r]);return t.filter(e=>a.has(e.id))}function oc(...e){if(e.length===3){let[t,n,r]=e;return ac(t,n,r,`target`)}let[t,n]=e,r=typeof t==`string`?t:t.id;return n.filter(e=>Qs(e)&&e.source===r).map(e=>n.find(t=>$s(t)&&t.id===e.target))}function sc(...e){if(e.length===3){let[t,n,r]=e;return ac(t,n,r,`source`)}let[t,n]=e,r=typeof t==`string`?t:t.id;return n.filter(e=>Qs(e)&&e.target===r).map(e=>n.find(t=>$s(t)&&t.id===e.source))}function cc({source:e,sourceHandle:t,target:n,targetHandle:r}){return`vueflow__edge-${e}${t??``}-${n}${r??``}`}function lc(e,t){return t.some(t=>Qs(t)&&t.source===e.source&&t.target===e.target&&(t.sourceHandle===e.sourceHandle||!t.sourceHandle&&!e.sourceHandle)&&(t.targetHandle===e.targetHandle||!t.targetHandle&&!e.targetHandle))}function uc({x:e,y:t},{x:n,y:r,zoom:i}){return{x:e*i+n,y:t*i+r}}function dc({x:e,y:t},{x:n,y:r,zoom:i},a=!1,o=[1,1]){let s={x:(e-n)/i,y:(t-r)/i};return a?rl(s,o):s}function fc(e,t){return{x:Math.min(e.x,t.x),y:Math.min(e.y,t.y),x2:Math.max(e.x2,t.x2),y2:Math.max(e.y2,t.y2)}}function pc({x:e,y:t,width:n,height:r}){return{x:e,y:t,x2:e+n,y2:t+r}}function mc({x:e,y:t,x2:n,y2:r}){return{x:e,y:t,width:n-e,height:r-t}}function hc(e,t){return mc(fc(pc(e),pc(t)))}function gc(e){let t={x:1/0,y:1/0,x2:-1/0,y2:-1/0};for(let n=0;n<e.length;n++){let r=e[n];t=fc(t,pc({...r.computedPosition,...r.dimensions}))}return mc(t)}function _c(e,t,n={x:0,y:0,zoom:1},r=!1,i=!1){let a={...dc(t,n),width:t.width/n.zoom,height:t.height/n.zoom},o=[];for(let t of e){let{dimensions:e,selectable:n=!0,hidden:s=!1}=t,c=e.width??t.width??null,l=e.height??t.height??null;if(i&&!n||s)continue;let u=qs(a,Ks(t)),d=c===null||l===null,f=r&&u>0,p=(c??0)*(l??0);(d||f||u>=p||t.dragging)&&o.push(t)}return o}function vc(e,t){let n=new Set;if(typeof e==`string`)n.add(e);else if(e.length>=1)for(let t of e)n.add(t.id);return t.filter(e=>n.has(e.source)||n.has(e.target))}function yc(e,t){if(typeof e==`number`)return Math.floor((t-t/(1+e))*.5);if(typeof e==`string`&&e.endsWith(`px`)){let t=Number.parseFloat(e);if(!Number.isNaN(t))return Math.floor(t)}if(typeof e==`string`&&e.endsWith(`%`)){let n=Number.parseFloat(e);if(!Number.isNaN(n))return Math.floor(t*n*.01)}return gl(`The padding value "${e}" is invalid. Please provide a number or a string with a valid unit (px or %).`),0}function bc(e,t,n){if(typeof e==`string`||typeof e==`number`){let r=yc(e,n),i=yc(e,t);return{top:r,right:i,bottom:r,left:i,x:i*2,y:r*2}}if(typeof e==`object`){let r=yc(e.top??e.y??0,n),i=yc(e.bottom??e.y??0,n),a=yc(e.left??e.x??0,t),o=yc(e.right??e.x??0,t);return{top:r,right:o,bottom:i,left:a,x:a+o,y:r+i}}return{top:0,right:0,bottom:0,left:0,x:0,y:0}}function xc(e,t,n,r,i,a){let{x:o,y:s}=uc(e,{x:t,y:n,zoom:r}),{x:c,y:l}=uc({x:e.x+e.width,y:e.y+e.height},{x:t,y:n,zoom:r}),u=i-c,d=a-l;return{left:Math.floor(o),top:Math.floor(s),right:Math.floor(u),bottom:Math.floor(d)}}function Sc(e,t,n,r,i,a=.1){let o=bc(a,t,n),s=(t-o.x)/e.width,c=(n-o.y)/e.height,l=Ys(Math.min(s,c),r,i),u=e.x+e.width/2,d=e.y+e.height/2,f=t/2-u*l,p=n/2-d*l,m=xc(e,f,p,l,t,n),h={left:Math.min(m.left-o.left,0),top:Math.min(m.top-o.top,0),right:Math.min(m.right-o.right,0),bottom:Math.min(m.bottom-o.bottom,0)};return{x:f-h.left+h.right,y:p-h.top+h.bottom,zoom:l}}function Cc(e,t){return{x:t.x+e.x,y:t.y+e.y,z:(e.z>t.z?e.z:t.z)+1}}function wc(e,t){if(!e.parentNode)return!1;let n=t.get(e.parentNode);return n?n.selected?!0:wc(n,t):!1}function Tc(e,t){return e===void 0?``:typeof e==`string`?e:`${t?`${t}__`:``}${Object.keys(e).sort().map(t=>`${t}=${e[t]}`).join(`&`)}`}function Ec(e){let t=e.ctrlKey&&tl()?10:1;return-e.deltaY*(e.deltaMode===1?.05:e.deltaMode?1:.002)*t}function Dc(e,t,n){return e<t?Ys(Math.abs(e-t),1,t)/t:e>n?-Ys(Math.abs(e-n),1,t)/t:0}function Oc(e,t,n=15,r=40){let i=Dc(e.x,r,t.width-r)*n,a=Dc(e.y,r,t.height-r)*n;return[i,a]}function kc(e,t){if(t){let n=e.position.x+e.dimensions.width-t.dimensions.width,r=e.position.y+e.dimensions.height-t.dimensions.height;if(n>0||r>0||e.position.x<0||e.position.y<0){let i={};if(typeof t.style==`function`?i={...t.style(t)}:t.style&&(i={...t.style}),i.width=i.width??`${t.dimensions.width}px`,i.height=i.height??`${t.dimensions.height}px`,n>0&&(typeof i.width==`string`?i.width=`${Number(i.width.replace(`px`,``))+n}px`:i.width+=n),r>0&&(typeof i.height==`string`?i.height=`${Number(i.height.replace(`px`,``))+r}px`:i.height+=r),e.position.x<0){let n=Math.abs(e.position.x);t.position.x=t.position.x-n,typeof i.width==`string`?i.width=`${Number(i.width.replace(`px`,``))+n}px`:i.width+=n,e.position.x=0}if(e.position.y<0){let n=Math.abs(e.position.y);t.position.y=t.position.y-n,typeof i.height==`string`?i.height=`${Number(i.height.replace(`px`,``))+n}px`:i.height+=n,e.position.y=0}t.dimensions.width=Number(i.width.toString().replace(`px`,``)),t.dimensions.height=Number(i.height.toString().replace(`px`,``)),typeof t.style==`function`?t.style=e=>{let n=t.style;return{...n(e),...i}}:t.style={...t.style,...i}}}}function Ac(e,t){let n=e.filter(e=>e.type===`add`||e.type===`remove`);for(let e of n)if(e.type===`add`)t.findIndex(t=>t.id===e.item.id)===-1&&t.push(e.item);else if(e.type===`remove`){let n=t.findIndex(t=>t.id===e.id);n!==-1&&t.splice(n,1)}let r=t.map(e=>e.id);for(let n of t)for(let i of e)if(i.id===n.id)switch(i.type){case`select`:n.selected=i.selected;break;case`position`:if(ec(n)&&(i.position!==void 0&&(n.position=i.position),i.dragging!==void 0&&(n.dragging=i.dragging),n.expandParent&&n.parentNode)){let e=t[r.indexOf(n.parentNode)];e&&ec(e)&&kc(n,e)}break;case`dimensions`:if(ec(n)&&(i.dimensions!==void 0&&(n.dimensions=i.dimensions),i.updateStyle!==void 0&&i.updateStyle&&(n.style={...n.style||{},width:`${i.dimensions?.width}px`,height:`${i.dimensions?.height}px`}),i.resizing!==void 0&&(n.resizing=i.resizing),n.expandParent&&n.parentNode)){let e=t[r.indexOf(n.parentNode)];e&&ec(e)&&(e.dimensions.width&&e.dimensions.height?kc(n,e):F(()=>{kc(n,e)}))}break}return t}function jc(e,t){return{id:e,type:`select`,selected:t}}function Mc(e){return{item:e,type:`add`}}function Nc(e){return{id:e,type:`remove`}}function Pc(e,t,n,r,i){return{id:e,source:t,target:n,sourceHandle:r||null,targetHandle:i||null,type:`remove`}}function Fc(e,t=new Set,n=!1){let r=[];for(let[i,a]of e){let e=t.has(i);!(a.selected===void 0&&!e)&&a.selected!==e&&(n&&(a.selected=e),r.push(jc(a.id,e)))}return r}var Ic=()=>{};function $(e){let t=new Set,n=Ic,r=()=>!1,i=()=>t.size>0||r(),a=e=>{n=e},o=()=>{n=Ic},s=e=>{r=e},c=()=>{r=()=>!1},l=e=>{t.delete(e)};return{on:e=>{t.add(e);let n=()=>l(e);return dt(n),{off:n}},off:l,trigger:r=>{let a=[n];return i()?a.push(...t):e&&a.push(e),Promise.allSettled(a.map(e=>e(r)))},hasListeners:i,listeners:t,setEmitter:a,removeEmitter:o,setHasEmitListeners:s,removeHasEmitListeners:c}}function Lc(e,t,n){let r=e;do{if(r&&r.matches(t))return!0;if(r===n)return!1;r=r.parentElement}while(r);return!1}function Rc(e,t,n,r){let i=new Map;for(let[a,o]of e)(o.selected||o.id===r)&&(!o.parentNode||!wc(o,e))&&(o.draggable||t&&o.draggable===void 0)&&e.get(a)&&i.set(a,{id:o.id,position:o.position||{x:0,y:0},distance:{x:n.x-o.computedPosition?.x||0,y:n.y-o.computedPosition?.y||0},from:{x:o.computedPosition.x,y:o.computedPosition.y},extent:o.extent,parentNode:o.parentNode,dimensions:{...o.dimensions},expandParent:o.expandParent});return Array.from(i.values())}function zc({id:e,dragItems:t,findNode:n}){let r=[];for(let e of t){let t=n(e.id);t&&r.push(t)}return[e?r.find(t=>t.id===e):r[0],r]}function Bc(e){if(Array.isArray(e))switch(e.length){case 1:return[e[0],e[0],e[0],e[0]];case 2:return[e[0],e[1],e[0],e[1]];case 3:return[e[0],e[1],e[2],e[1]];case 4:return e;default:return[0,0,0,0]}return[e,e,e,e]}function Vc(e,t,n){let[r,i,a,o]=typeof e==`string`?[0,0,0,0]:Bc(e.padding);return n&&n.computedPosition.x!==void 0&&n.computedPosition.y!==void 0&&n.dimensions.width!==void 0&&n.dimensions.height!==void 0?[[n.computedPosition.x+o,n.computedPosition.y+r],[n.computedPosition.x+n.dimensions.width-i,n.computedPosition.y+n.dimensions.height-a]]:!1}function Hc(e,t,n,r){let i=e.extent||n;if((i===`parent`||!Array.isArray(i)&&i?.range===`parent`)&&!e.expandParent)if(e.parentNode&&r&&e.dimensions.width&&e.dimensions.height){let t=Vc(i,e,r);t&&(i=t)}else t(new Zc(Yc.NODE_EXTENT_INVALID,e.id)),i=n;else if(Array.isArray(i)){let e=r?.computedPosition.x||0,t=r?.computedPosition.y||0;i=[[i[0][0]+e,i[0][1]+t],[i[1][0]+e,i[1][1]+t]]}else if(i!==`parent`&&i?.range&&Array.isArray(i.range)){let[e,t,n,a]=Bc(i.padding),o=r?.computedPosition.x||0,s=r?.computedPosition.y||0;i=[[i.range[0][0]+o+a,i.range[0][1]+s+e],[i.range[1][0]+o-t,i.range[1][1]+s-n]]}return i===`parent`?[[-1/0,-1/0],[1/0,1/0]]:i}function Uc({width:e,height:t},n){return[n[0],[n[1][0]-(e||0),n[1][1]-(t||0)]]}function Wc(e,t,n,r,i){let a=Uc(e.dimensions,Hc(e,n,r,i)),o=Xs(t,a);return{position:{x:o.x-(i?.computedPosition.x||0),y:o.y-(i?.computedPosition.y||0)},computedPosition:o}}function Gc(e,t,n=Q.Left,r=!1){let i=(t?.x??0)+e.computedPosition.x,a=(t?.y??0)+e.computedPosition.y,{width:o,height:s}=t??nl(e);if(r)return{x:i+o/2,y:a+s/2};switch(t?.position??n){case Q.Top:return{x:i+o/2,y:a};case Q.Right:return{x:i+o,y:a+s/2};case Q.Bottom:return{x:i+o/2,y:a+s};case Q.Left:return{x:i,y:a+s/2}}}function Kc(e,t){return e&&(t?e.find(e=>e.id===t):e[0])||null}function qc({sourcePos:e,targetPos:t,sourceWidth:n,sourceHeight:r,targetWidth:i,targetHeight:a,width:o,height:s,viewport:c}){let l={x:Math.min(e.x,t.x),y:Math.min(e.y,t.y),x2:Math.max(e.x+n,t.x+i),y2:Math.max(e.y+r,t.y+a)};l.x===l.x2&&(l.x2+=1),l.y===l.y2&&(l.y2+=1);let u=pc({x:(0-c.x)/c.zoom,y:(0-c.y)/c.zoom,width:o/c.zoom,height:s/c.zoom}),d=Math.max(0,Math.min(u.x2,l.x2)-Math.max(u.x,l.x)),f=Math.max(0,Math.min(u.y2,l.y2)-Math.max(u.y,l.y));return Math.ceil(d*f)>0}function Jc(e,t,n=!1){let r=typeof e.zIndex==`number`,i=r?e.zIndex:0,a=t(e.source),o=t(e.target);return!a||!o?0:(n&&(i=r?e.zIndex:Math.max(a.computedPosition.z||0,o.computedPosition.z||0)),i)}var Yc=(e=>(e.MISSING_STYLES=`MISSING_STYLES`,e.MISSING_VIEWPORT_DIMENSIONS=`MISSING_VIEWPORT_DIMENSIONS`,e.NODE_INVALID=`NODE_INVALID`,e.NODE_NOT_FOUND=`NODE_NOT_FOUND`,e.NODE_MISSING_PARENT=`NODE_MISSING_PARENT`,e.NODE_TYPE_MISSING=`NODE_TYPE_MISSING`,e.NODE_EXTENT_INVALID=`NODE_EXTENT_INVALID`,e.EDGE_INVALID=`EDGE_INVALID`,e.EDGE_NOT_FOUND=`EDGE_NOT_FOUND`,e.EDGE_SOURCE_MISSING=`EDGE_SOURCE_MISSING`,e.EDGE_TARGET_MISSING=`EDGE_TARGET_MISSING`,e.EDGE_TYPE_MISSING=`EDGE_TYPE_MISSING`,e.EDGE_SOURCE_TARGET_SAME=`EDGE_SOURCE_TARGET_SAME`,e.EDGE_SOURCE_TARGET_MISSING=`EDGE_SOURCE_TARGET_MISSING`,e.EDGE_ORPHANED=`EDGE_ORPHANED`,e.USEVUEFLOW_OPTIONS=`USEVUEFLOW_OPTIONS`,e))(Yc||{}),Xc={MISSING_STYLES:()=>`It seems that you haven't loaded the necessary styles. Please import '@vue-flow/core/dist/style.css' to ensure that the graph is rendered correctly`,MISSING_VIEWPORT_DIMENSIONS:()=>`The Vue Flow parent container needs a width and a height to render the graph`,NODE_INVALID:e=>`Node is invalid
Node: ${e}`,NODE_NOT_FOUND:e=>`Node not found
Node: ${e}`,NODE_MISSING_PARENT:(e,t)=>`Node is missing a parent
Node: ${e}
Parent: ${t}`,NODE_TYPE_MISSING:e=>`Node type is missing
Type: ${e}`,NODE_EXTENT_INVALID:e=>`Only child nodes can use a parent extent
Node: ${e}`,EDGE_INVALID:e=>`An edge needs a source and a target
Edge: ${e}`,EDGE_SOURCE_MISSING:(e,t)=>`Edge source is missing
Edge: ${e} 
Source: ${t}`,EDGE_TARGET_MISSING:(e,t)=>`Edge target is missing
Edge: ${e} 
Target: ${t}`,EDGE_TYPE_MISSING:e=>`Edge type is missing
Type: ${e}`,EDGE_SOURCE_TARGET_SAME:(e,t,n)=>`Edge source and target are the same
Edge: ${e} 
Source: ${t} 
Target: ${n}`,EDGE_SOURCE_TARGET_MISSING:(e,t,n)=>`Edge source or target is missing
Edge: ${e} 
Source: ${t} 
Target: ${n}`,EDGE_ORPHANED:e=>`Edge was orphaned (suddenly missing source or target) and has been removed
Edge: ${e}`,EDGE_NOT_FOUND:e=>`Edge not found
Edge: ${e}`,USEVUEFLOW_OPTIONS:()=>`The options parameter is deprecated and will be removed in the next major version. Please use the id parameter instead`},Zc=class extends Error{constructor(e,...t){super(Xc[e]?.call(Xc,...t)),this.name=`VueFlowError`,this.code=e,this.args=t}};function Qc(e){return`clientX`in e}function $c(e){return`sourceEvent`in e}function el(e,t){let n=Qc(e),r,i;return n?(r=e.clientX,i=e.clientY):`touches`in e&&e.touches.length>0?(r=e.touches[0].clientX,i=e.touches[0].clientY):`changedTouches`in e&&e.changedTouches.length>0?(r=e.changedTouches[0].clientX,i=e.changedTouches[0].clientY):(r=0,i=0),{x:r-(t?.left??0),y:i-(t?.top??0)}}var tl=()=>typeof navigator<`u`&&(navigator==null?void 0:navigator.userAgent)?.indexOf(`Mac`)>=0;function nl(e){return{width:e.dimensions?.width??e.width??0,height:e.dimensions?.height??e.height??0}}function rl(e,t=[1,1]){return{x:t[0]*Math.round(e.x/t[0]),y:t[1]*Math.round(e.y/t[1])}}var il=()=>!0;function al(e){e?.classList.remove(`valid`,`connecting`,`vue-flow__handle-valid`,`vue-flow__handle-connecting`)}function ol(e,t,n){let r=[],i={x:e.x-n,y:e.y-n,width:n*2,height:n*2};for(let e of t.values())qs(i,Ks(e))>0&&r.push(e);return r}var sl=250;function cl(e,t,n,r){let i=[],a=1/0,o=ol(e,n,t+sl);for(let n of o){let o=[...n.handleBounds?.source??[],...n.handleBounds?.target??[]];for(let s of o){if(r.nodeId===s.nodeId&&r.type===s.type&&r.id===s.id)continue;let{x:o,y:c}=Gc(n,s,s.position,!0),l=Math.sqrt((o-e.x)**2+(c-e.y)**2);l>t||(l<a?(i=[{...s,x:o,y:c}],a=l):l===a&&i.push({...s,x:o,y:c}))}}if(!i.length)return null;if(i.length>1){let e=r.type===`source`?`target`:`source`;return i.find(t=>t.type===e)??i[0]}return i[0]}function ll(e,{handle:t,connectionMode:n,fromNodeId:r,fromHandleId:i,fromType:a,doc:o,lib:s,flowId:c,isValidConnection:l=il},u,d,f,p){let m=a===`target`,h=t?o.querySelector(`.${s}-flow__handle[data-id="${c}-${t?.nodeId}-${t?.id}-${t?.type}"]`):null,{x:g,y:_}=el(e),v=o.elementFromPoint(g,_),y=v?.classList.contains(`${s}-flow__handle`)?v:h,b={handleDomNode:y,isValid:!1,connection:null,toHandle:null};if(y){let e=ul(void 0,y),t=y.getAttribute(`data-nodeid`),a=y.getAttribute(`data-handleid`),o=y.classList.contains(`connectable`),s=y.classList.contains(`connectableend`);if(!t||!e)return b;let c={source:m?t:r,sourceHandle:m?a:i,target:m?r:t,targetHandle:m?i:a};b.connection=c,b.isValid=o&&s&&(n===ks.Strict?m&&e===`source`||!m&&e===`target`:t!==r||a!==i)&&l(c,{nodes:d,edges:u,sourceNode:f(c.source),targetNode:f(c.target)}),b.toHandle=pl(t,e,a,p,n,!0)}return b}function ul(e,t){return e||(t?.classList.contains(`target`)?`target`:t?.classList.contains(`source`)?`source`:null)}function dl(e,t){let n=null;return t?n=`valid`:e&&!t&&(n=`invalid`),n}function fl(e,t){let n=null;return t?n=!0:e&&!t&&(n=!1),n}function pl(e,t,n,r,i,a=!1){let o=r.get(e);if(!o)return null;let s=i===ks.Strict?o.handleBounds?.[t]:[...o.handleBounds?.source??[],...o.handleBounds?.target??[]],c=(n?s?.find(e=>e.id===n):s?.[0])??null;return c&&a?{...c,...Gc(o,c,c.position,!0)}:c}var ml={[Q.Left]:Q.Right,[Q.Right]:Q.Left,[Q.Top]:Q.Bottom,[Q.Bottom]:Q.Top},hl=[`production`,`prod`];function gl(e,...t){_l()&&console.warn(`[Vue Flow]: ${e}`,...t)}function _l(){return!hl.includes(`production`)}function vl(e,t,n,r,i){let a=t.querySelectorAll(`.vue-flow__handle.${e}`);return a?.length?Array.from(a).map(t=>{let a=t.getBoundingClientRect();return{id:t.getAttribute(`data-handleid`),type:e,nodeId:i,position:t.getAttribute(`data-handlepos`),x:(a.left-n.left)/r,y:(a.top-n.top)/r,...Js(t)}}):null}function yl(e,t,n,r,i,a=!1,o){i.value=!1,e.selected?(a||e.selected&&t)&&(r([e]),F(()=>{o.blur()})):n([e])}function bl(e){return B(e)!==void 0}function xl(e,t,n,r){if(!e||!e.source||!e.target)return n(new Zc(Yc.EDGE_INVALID,e?.id??`[ID UNKNOWN]`)),!1;let i;return i=Qs(e)?e:{...e,id:cc(e)},i=ic(i,void 0,r),lc(i,t)?!1:i}function Sl(e,t,n,r,i){if(!t.source||!t.target)return i(new Zc(Yc.EDGE_INVALID,e.id)),!1;if(!n)return i(new Zc(Yc.EDGE_NOT_FOUND,e.id)),!1;let{id:a,...o}=e;return{...o,id:r?cc(t):a,source:t.source,target:t.target,sourceHandle:t.sourceHandle,targetHandle:t.targetHandle}}function Cl(e,t,n){let r={},i=[];for(let a=0;a<e.length;++a){let o=e[a];if(!$s(o)){n(new Zc(Yc.NODE_INVALID,o?.id));continue}let s=rc(o,t(o.id),o.parentNode);o.parentNode&&(r[o.parentNode]=!0),i[a]=s}for(let e of i){let a=t(e.parentNode)||i.find(t=>t.id===e.parentNode);e.parentNode&&!a&&n(new Zc(Yc.NODE_MISSING_PARENT,e.id,e.parentNode)),(e.parentNode||r[e.id])&&(r[e.id]&&(e.isParent=!0),a&&(a.isParent=!0))}return i}function wl(e,t,n,r,i,a){let o=i,s=r.get(o)||new Map;r.set(o,s.set(n,t)),o=`${i}-${e}`;let c=r.get(o)||new Map;if(r.set(o,c.set(n,t)),a){o=`${i}-${e}-${a}`;let s=r.get(o)||new Map;r.set(o,s.set(n,t))}}function Tl(e,t,n){e.clear();for(let t of n){let{source:n,target:r,sourceHandle:i=null,targetHandle:a=null}=t,o={edgeId:t.id,source:n,target:r,sourceHandle:i,targetHandle:a},s=`${n}-${i}--${r}-${a}`,c=`${r}-${a}--${n}-${i}`;wl(`source`,o,c,e,n,i),wl(`target`,o,s,e,r,a)}}function El(e,t){if(e.size!==t.size)return!1;for(let n of e)if(!t.has(n))return!1;return!0}function Dl(e,t,n,r,i,a,o,s){let c=[];for(let l of e){let e=Qs(l)?l:xl(l,s,i,a);if(!e)continue;let u=n(e.source),d=n(e.target);if(!u||!d){i(new Zc(Yc.EDGE_SOURCE_TARGET_MISSING,e.id,e.source,e.target));continue}if(!u){i(new Zc(Yc.EDGE_SOURCE_MISSING,e.id,e.source));continue}if(!d){i(new Zc(Yc.EDGE_TARGET_MISSING,e.id,e.target));continue}if(t&&!t(e,{edges:s,nodes:o,sourceNode:u,targetNode:d})){i(new Zc(Yc.EDGE_INVALID,e.id));continue}let f=r(e.id);c.push({...ic(e,f,a),sourceNode:u,targetNode:d})}return c}var Ol=Symbol(`vueFlow`),kl=Symbol(`nodeId`),Al=Symbol(`nodeRef`),jl=Symbol(`edgeId`),Ml=Symbol(`edgeRef`),Nl=Symbol(`slots`);function Pl(e){let{vueFlowRef:t,snapToGrid:n,snapGrid:r,noDragClassName:i,nodeLookup:a,nodeExtent:o,nodeDragThreshold:s,viewport:c,autoPanOnNodeDrag:l,autoPanSpeed:u,nodesDraggable:d,panBy:f,findNode:p,multiSelectionActive:m,nodesSelectionActive:h,selectNodesOnDrag:g,removeSelectedElements:_,addSelectedNodes:v,updateNodePositions:y,emits:b}=Hu(),{onStart:x,onDrag:S,onStop:C,onClick:w,el:T,disabled:E,id:D,selectable:O,dragHandle:k}=e,A=Qe(!1),j=[],M,ee=null,N={x:void 0,y:void 0},P={x:0,y:0},te=null,ne=!1,re=!1,F=0,ie=!1,ae=Ll(),I=({x:e,y:t})=>{N={x:e,y:t};let i=!1;if(j=j.map(a=>{let s={x:e-a.distance.x,y:t-a.distance.y},{computedPosition:c}=Wc(a,n.value?rl(s,r.value):s,b.error,o.value,a.parentNode?p(a.parentNode):void 0);return i=i||a.position.x!==c.x||a.position.y!==c.y,a.position=c,a}),re||=i,i&&(y(j,!0,!0),A.value=!0,te)){let[e,t]=zc({id:D,dragItems:j,findNode:p});S({event:te,node:e,nodes:t})}},oe=()=>{if(!ee)return;let[e,t]=Oc(P,ee,u.value);if(e!==0||t!==0){let n={x:(N.x??0)-e/c.value.zoom,y:(N.y??0)-t/c.value.zoom};f({x:e,y:t})&&I(n)}F=requestAnimationFrame(oe)},L=(e,t)=>{ne=!0;let n=p(D);!g.value&&!m.value&&n&&(n.selected||_()),n&&Xe(O)&&g.value&&yl(n,m.value,v,_,h,!1,t);let r=ae(e.sourceEvent);if(N=r,j=Rc(a.value,d.value,r,D),j.length){let[t,n]=zc({id:D,dragItems:j,findNode:p});x({event:e.sourceEvent,node:t,nodes:n})}},se=(e,n)=>{e.sourceEvent.type===`touchmove`&&e.sourceEvent.touches.length>1||(re=!1,s.value===0&&L(e,n),N=ae(e.sourceEvent),ee=t.value?.getBoundingClientRect()||null,P=el(e.sourceEvent,ee))},R=(e,t)=>{let n=ae(e.sourceEvent);if(!ie&&ne&&l.value&&(ie=!0,oe()),!ne){let r=n.xSnapped-(N.x??0),i=n.ySnapped-(N.y??0);Math.sqrt(r*r+i*i)>s.value&&L(e,t)}(N.x!==n.xSnapped||N.y!==n.ySnapped)&&j.length&&ne&&(te=e.sourceEvent,P=el(e.sourceEvent,ee),I(n))},z=e=>{let t=!1;if(!ne&&!A.value&&!m.value){let n=e.sourceEvent,r=ae(n),i=r.xSnapped-(N.x??0),a=r.ySnapped-(N.y??0),o=Math.sqrt(i*i+a*a);o!==0&&o<=s.value&&(w?.(n),t=!0)}if(j.length&&!t){re&&=(y(j,!1,!1),!1);let[t,n]=zc({id:D,dragItems:j,findNode:p});C({event:e.sourceEvent,node:t,nodes:n})}j=[],A.value=!1,ie=!1,ne=!1,N={x:void 0,y:void 0},cancelAnimationFrame(F)};return W([()=>Xe(E),T],([e,t],n,r)=>{if(t){let n=Br(t);e||(M=ti().on(`start`,e=>se(e,t)).on(`drag`,e=>R(e,t)).on(`end`,e=>z(e)).filter(e=>{let n=e.target,r=Xe(k);return!e.button&&(!i.value||!Lc(n,`.${i.value}`,t)&&(!r||Lc(n,r,t)))}),n.call(M)),r(()=>{n.on(`.drag`,null),M&&(M.on(`start`,null),M.on(`drag`,null),M.on(`end`,null))})}}),A}function Fl(){return{doubleClick:$(),click:$(),mouseEnter:$(),mouseMove:$(),mouseLeave:$(),contextMenu:$(),updateStart:$(),update:$(),updateEnd:$()}}function Il(e,t){let n=Fl();return n.doubleClick.on(n=>{var r,i;t.edgeDoubleClick(n),(i=(r=e.events)?.doubleClick)==null||i.call(r,n)}),n.click.on(n=>{var r,i;t.edgeClick(n),(i=(r=e.events)?.click)==null||i.call(r,n)}),n.mouseEnter.on(n=>{var r,i;t.edgeMouseEnter(n),(i=(r=e.events)?.mouseEnter)==null||i.call(r,n)}),n.mouseMove.on(n=>{var r,i;t.edgeMouseMove(n),(i=(r=e.events)?.mouseMove)==null||i.call(r,n)}),n.mouseLeave.on(n=>{var r,i;t.edgeMouseLeave(n),(i=(r=e.events)?.mouseLeave)==null||i.call(r,n)}),n.contextMenu.on(n=>{var r,i;t.edgeContextMenu(n),(i=(r=e.events)?.contextMenu)==null||i.call(r,n)}),n.updateStart.on(n=>{var r,i;t.edgeUpdateStart(n),(i=(r=e.events)?.updateStart)==null||i.call(r,n)}),n.update.on(n=>{var r,i;t.edgeUpdate(n),(i=(r=e.events)?.update)==null||i.call(r,n)}),n.updateEnd.on(n=>{var r,i;t.edgeUpdateEnd(n),(i=(r=e.events)?.updateEnd)==null||i.call(r,n)}),Object.entries(n).reduce((e,[t,n])=>(e.emit[t]=n.trigger,e.on[t]=n.on,e),{emit:{},on:{}})}function Ll(){let{viewport:e,snapGrid:t,snapToGrid:n,vueFlowRef:r}=Hu();return i=>{let a=r.value?.getBoundingClientRect()??{left:0,top:0},o=$c(i)?i.sourceEvent:i,{x:s,y:c}=el(o,a),l=dc({x:s,y:c},e.value),{x:u,y:d}=n.value?rl(l,t.value):l;return{xSnapped:u,ySnapped:d,...l}}}function Rl(){return!0}function zl({handleId:e,nodeId:t,type:n,isValidConnection:r,edgeUpdaterType:i,onEdgeUpdate:a,onEdgeUpdateEnd:o}){let{id:s,vueFlowRef:c,connectionMode:l,connectionRadius:u,connectOnClick:d,connectionClickStartHandle:f,nodesConnectable:p,autoPanOnConnect:m,autoPanSpeed:h,findNode:g,panBy:_,startConnection:v,updateConnection:y,endConnection:b,emits:x,viewport:S,edges:C,nodes:w,isValidConnection:T,nodeLookup:E}=Hu(),D=null,O=!1,k=null;function A(d){let f=Xe(n)===`target`,p=Qc(d),A=Zs(d.target),j=d.currentTarget;if(j&&(p&&d.button===0||!p)){let n=function(n){I=el(n,F),N=cl(dc(I,S.value,!1,[1,1]),u.value,E.value,se),oe||=(L(),!0);let r=ll(n,{handle:N,connectionMode:l.value,fromNodeId:Xe(t),fromHandleId:Xe(e),fromType:f?`target`:`source`,isValidConnection:ee,doc:A,lib:`vue`,flowId:s,nodeLookup:E.value},C.value,w.value,g,E.value);k=r.handleDomNode,D=r.connection,O=fl(!!N,r.isValid);let i={...ce,isValid:O,to:r.toHandle&&O?uc({x:r.toHandle.x,y:r.toHandle.y},S.value):I,toHandle:r.toHandle,toPosition:O&&r.toHandle?r.toHandle.position:ml[se.position],toNode:r.toHandle?E.value.get(r.toHandle.nodeId):null};if(O&&N&&ce?.toHandle&&i.toHandle&&ce.toHandle.type===i.toHandle.type&&ce.toHandle.nodeId===i.toHandle.nodeId&&ce.toHandle.id===i.toHandle.id&&ce.to.x===i.to.x&&ce.to.y===i.to.y)return;let a=N??r.toHandle;if(y(a&&O?uc({x:a.x,y:a.y},S.value):I,r.toHandle,dl(!!a,O)),ce=i,!N&&!O&&!k)return al(ae);D&&D.source!==D.target&&k&&(al(ae),ae=k,k.classList.add(`connecting`,`vue-flow__handle-connecting`),k.classList.toggle(`valid`,!!O),k.classList.toggle(`vue-flow__handle-valid`,!!O))},p=function(e){`touches`in e&&e.touches.length>0||((N||k)&&D&&O&&(a?a(e,D):x.connect(D)),x.connectEnd(e),i&&o?.(e),al(ae),cancelAnimationFrame(P),b(e),oe=!1,O=!1,D=null,k=null,A.removeEventListener(`mousemove`,n),A.removeEventListener(`mouseup`,p),A.removeEventListener(`touchmove`,n),A.removeEventListener(`touchend`,p))},M=g(Xe(t)),ee=Xe(r)||T.value||Rl;!ee&&M&&(ee=(f?M.isValidSourcePos:M.isValidTargetPos)||Rl);let N,P=0,{x:te,y:ne}=el(d),re=ul(Xe(i),j),F=c.value?.getBoundingClientRect();if(!F||!re)return;let ie=pl(Xe(t),re,Xe(e),E.value,l.value);if(!ie)return;let ae,I=el(d,F),oe=!1,L=()=>{if(!m.value)return;let[e,t]=Oc(I,F,h.value);_({x:e,y:t}),P=requestAnimationFrame(L)},se={...ie,nodeId:Xe(t),type:re,position:ie.position},R=E.value.get(Xe(t)),z={inProgress:!0,isValid:null,from:Gc(R,se,Q.Left,!0),fromHandle:se,fromPosition:se.position,fromNode:R,to:I,toHandle:null,toPosition:ml[se.position],toNode:null};v({nodeId:Xe(t),id:Xe(e),type:re,position:j?.getAttribute(`data-handlepos`)||Q.Top,...I},{x:te-F.left,y:ne-F.top}),x.connectStart({event:d,nodeId:Xe(t),handleId:Xe(e),handleType:re});let ce=z;A.addEventListener(`mousemove`,n),A.addEventListener(`mouseup`,p),A.addEventListener(`touchmove`,n),A.addEventListener(`touchend`,p)}}function j(i){if(!d.value)return;let a=Xe(n)===`target`;if(!f.value){x.clickConnectStart({event:i,nodeId:Xe(t),handleId:Xe(e)}),v({nodeId:Xe(t),type:Xe(n),id:Xe(e),position:Q.Top,...el(i)},void 0,!0);return}let o=Xe(r)||T.value||Rl,c=g(Xe(t));if(!o&&c&&(o=(a?c.isValidSourcePos:c.isValidTargetPos)||Rl),c&&(c.connectable===void 0?p.value:c.connectable)===!1)return;let u=Zs(i.target),m=ll(i,{handle:{nodeId:Xe(t),id:Xe(e),type:Xe(n),position:Q.Top,...el(i)},connectionMode:l.value,fromNodeId:f.value.nodeId,fromHandleId:f.value.id??null,fromType:f.value.type,isValidConnection:o,doc:u,lib:`vue`,flowId:s,nodeLookup:E.value},C.value,w.value,g,E.value),h=m.connection?.source===m.connection?.target;m.isValid&&m.connection&&!h&&x.connect(m.connection),x.clickConnectEnd(i),b(i,!0)}return{handlePointerDown:A,handleClick:j}}function Bl(){return te(kl,``)}function Vl(e){let t=e??Bl()??``,n=te(Al,U(null)),{findNode:r,edges:i,emits:a}=Hu(),o=r(t);return o||a.error(new Zc(Yc.NODE_NOT_FOUND,t)),{id:t,nodeEl:n,node:o,parentNode:q(()=>r(o.parentNode)),connectedEdges:q(()=>vc([o],i.value))}}function Hl(){return{doubleClick:$(),click:$(),mouseEnter:$(),mouseMove:$(),mouseLeave:$(),contextMenu:$(),dragStart:$(),drag:$(),dragStop:$()}}function Ul(e,t){let n=Hl();return n.doubleClick.on(n=>{var r,i;t.nodeDoubleClick(n),(i=(r=e.events)?.doubleClick)==null||i.call(r,n)}),n.click.on(n=>{var r,i;t.nodeClick(n),(i=(r=e.events)?.click)==null||i.call(r,n)}),n.mouseEnter.on(n=>{var r,i;t.nodeMouseEnter(n),(i=(r=e.events)?.mouseEnter)==null||i.call(r,n)}),n.mouseMove.on(n=>{var r,i;t.nodeMouseMove(n),(i=(r=e.events)?.mouseMove)==null||i.call(r,n)}),n.mouseLeave.on(n=>{var r,i;t.nodeMouseLeave(n),(i=(r=e.events)?.mouseLeave)==null||i.call(r,n)}),n.contextMenu.on(n=>{var r,i;t.nodeContextMenu(n),(i=(r=e.events)?.contextMenu)==null||i.call(r,n)}),n.dragStart.on(n=>{var r,i;t.nodeDragStart(n),(i=(r=e.events)?.dragStart)==null||i.call(r,n)}),n.drag.on(n=>{var r,i;t.nodeDrag(n),(i=(r=e.events)?.drag)==null||i.call(r,n)}),n.dragStop.on(n=>{var r,i;t.nodeDragStop(n),(i=(r=e.events)?.dragStop)==null||i.call(r,n)}),Object.entries(n).reduce((e,[t,n])=>(e.emit[t]=n.trigger,e.on[t]=n.on,e),{emit:{},on:{}})}function Wl(){let{getSelectedNodes:e,nodeExtent:t,updateNodePositions:n,findNode:r,snapGrid:i,snapToGrid:a,nodesDraggable:o,emits:s}=Hu();return(c,l=!1)=>{let u=a.value?i.value[0]:5,d=a.value?i.value[1]:5,f=l?4:1,p=c.x*u*f,m=c.y*d*f,h=[];for(let n of e.value)if(n.draggable||o&&n.draggable===void 0){let e={x:n.computedPosition.x+p,y:n.computedPosition.y+m},{computedPosition:i}=Wc(n,e,s.error,t.value,n.parentNode?r(n.parentNode):void 0);h.push({id:n.id,position:i,from:n.position,distance:{x:c.x,y:c.y},dimensions:n.dimensions})}n(h,!0,!1)}}var Gl=.1,Kl=e=>((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2;function ql(){return gl(`Viewport not initialized yet.`),Promise.resolve(!1)}var Jl={zoomIn:ql,zoomOut:ql,zoomTo:ql,fitView:ql,setCenter:ql,fitBounds:ql,project:e=>e,screenToFlowCoordinate:e=>e,flowToScreenCoordinate:e=>e,setViewport:ql,setTransform:ql,getViewport:()=>({x:0,y:0,zoom:1}),getTransform:()=>({x:0,y:0,zoom:1}),viewportInitialized:!1};function Yl(e){function t(t,n){return new Promise(r=>{e.d3Selection&&e.d3Zoom?e.d3Zoom.interpolate(n?.interpolate===`linear`?ia:va).scaleBy(Xl(e.d3Selection,n?.duration,n?.ease,()=>{r(!0)}),t):r(!1)})}function n(t,n,r,i){return new Promise(a=>{var o;let{x:s,y:c}=Xs({x:-t,y:-n},e.translateExtent),l=_s.translate(-s,-c).scale(r);e.d3Selection&&e.d3Zoom?(o=e.d3Zoom)==null||o.interpolate(i?.interpolate===`linear`?ia:va).transform(Xl(e.d3Selection,i?.duration,i?.ease,()=>{a(!0)}),l):a(!1)})}return q(()=>e.d3Zoom&&e.d3Selection&&e.dimensions.width&&e.dimensions.height?{viewportInitialized:!0,zoomIn:e=>t(1.2,e),zoomOut:e=>t(1/1.2,e),zoomTo:(t,n)=>new Promise(r=>{e.d3Selection&&e.d3Zoom?e.d3Zoom.interpolate(n?.interpolate===`linear`?ia:va).scaleTo(Xl(e.d3Selection,n?.duration,n?.ease,()=>{r(!0)}),t):r(!1)}),setViewport:(e,t)=>n(e.x,e.y,e.zoom,t),setTransform:(e,t)=>n(e.x,e.y,e.zoom,t),getViewport:()=>({x:e.viewport.x,y:e.viewport.y,zoom:e.viewport.zoom}),getTransform:()=>({x:e.viewport.x,y:e.viewport.y,zoom:e.viewport.zoom}),fitView:(t={padding:Gl,includeHiddenNodes:!1,duration:0})=>{let r=[];for(let n of e.nodes)n.dimensions.width&&n.dimensions.height&&(t?.includeHiddenNodes||!n.hidden)&&(!t.nodes?.length||t.nodes?.length&&t.nodes.includes(n.id))&&r.push(n);if(!r.length)return Promise.resolve(!1);let i=gc(r),{x:a,y:o,zoom:s}=Sc(i,e.dimensions.width,e.dimensions.height,t.minZoom??e.minZoom,t.maxZoom??e.maxZoom,t.padding??Gl);return n(a,o,s,t)},setCenter:(t,r,i)=>{let a=i?.zoom===void 0?e.maxZoom:i.zoom,o=e.dimensions.width/2-t*a,s=e.dimensions.height/2-r*a;return n(o,s,a,i)},fitBounds:(t,r={padding:Gl})=>{let{x:i,y:a,zoom:o}=Sc(t,e.dimensions.width,e.dimensions.height,e.minZoom,e.maxZoom,r.padding??Gl);return n(i,a,o,r)},project:t=>dc(t,e.viewport,e.snapToGrid,e.snapGrid),screenToFlowCoordinate:t=>{if(e.vueFlowRef){let{x:n,y:r}=e.vueFlowRef.getBoundingClientRect(),i={x:t.x-n,y:t.y-r};return dc(i,e.viewport,e.snapToGrid,e.snapGrid)}return{x:0,y:0}},flowToScreenCoordinate:t=>{if(e.vueFlowRef){let{x:n,y:r}=e.vueFlowRef.getBoundingClientRect(),i={x:t.x+n,y:t.y+r};return uc(i,e.viewport)}return{x:0,y:0}}}:Jl)}function Xl(e,t=0,n=Kl,r=()=>{}){let i=typeof t==`number`&&t>0;return i||r(),i?e.transition().duration(t).ease(n).on(`end`,r):e}function Zl(e,t,n){let r=Ve(!0);return r.run(()=>{r.run(()=>{let t,r,i=!!(n.nodes.value.length||n.edges.value.length);t=Ct([e.modelValue,()=>e.modelValue?.value?.length],([e])=>{e&&Array.isArray(e)&&(r?.pause(),n.setElements(e),!r&&!i&&e.length?i=!0:r?.resume())}),r=Ct([n.nodes,n.edges,()=>n.edges.value.length,()=>n.nodes.value.length],([n,r])=>{e.modelValue?.value&&Array.isArray(e.modelValue.value)&&(t?.pause(),e.modelValue.value=[...n,...r],F(()=>{t?.resume()}))},{immediate:i}),ve(()=>{t?.stop(),r?.stop()})}),r.run(()=>{let t,r,i=!!n.nodes.value.length;t=Ct([e.nodes,()=>e.nodes?.value?.length],([e])=>{e&&Array.isArray(e)&&(r?.pause(),n.setNodes(e),!r&&!i&&e.length?i=!0:r?.resume())}),r=Ct([n.nodes,()=>n.nodes.value.length],([n])=>{e.nodes?.value&&Array.isArray(e.nodes.value)&&(t?.pause(),e.nodes.value=[...n],F(()=>{t?.resume()}))},{immediate:i}),ve(()=>{t?.stop(),r?.stop()})}),r.run(()=>{let t,r,i=!!n.edges.value.length;t=Ct([e.edges,()=>e.edges?.value?.length],([e])=>{e&&Array.isArray(e)&&(r?.pause(),n.setEdges(e),!r&&!i&&e.length?i=!0:r?.resume())}),r=Ct([n.edges,()=>n.edges.value.length],([n])=>{e.edges?.value&&Array.isArray(e.edges.value)&&(t?.pause(),e.edges.value=[...n],F(()=>{t?.resume()}))},{immediate:i}),ve(()=>{t?.stop(),r?.stop()})}),r.run(()=>{W(()=>t.minZoom,()=>{t.minZoom&&bl(t.minZoom)&&n.setMinZoom(t.minZoom)},{immediate:!0})}),r.run(()=>{W(()=>t.maxZoom,()=>{t.maxZoom&&bl(t.maxZoom)&&n.setMaxZoom(t.maxZoom)},{immediate:!0})}),r.run(()=>{W(()=>t.translateExtent,()=>{t.translateExtent&&bl(t.translateExtent)&&n.setTranslateExtent(t.translateExtent)},{immediate:!0})}),r.run(()=>{W(()=>t.nodeExtent,()=>{t.nodeExtent&&bl(t.nodeExtent)&&n.setNodeExtent(t.nodeExtent)},{immediate:!0})}),r.run(()=>{W(()=>t.applyDefault,()=>{bl(t.applyDefault)&&(n.applyDefault.value=t.applyDefault)},{immediate:!0})}),r.run(()=>{let e=async e=>{let r=e;typeof t.autoConnect==`function`&&(r=await t.autoConnect(e)),r!==!1&&n.addEdges([r])};W(()=>t.autoConnect,()=>{bl(t.autoConnect)&&(n.autoConnect.value=t.autoConnect)},{immediate:!0}),W(n.autoConnect,(t,r,i)=>{t?n.onConnect(e):n.hooks.value.connect.off(e),i(()=>{n.hooks.value.connect.off(e)})},{immediate:!0})}),(()=>{let e=[`id`,`modelValue`,`translateExtent`,`nodeExtent`,`edges`,`nodes`,`maxZoom`,`minZoom`,`applyDefault`,`autoConnect`];for(let i of Object.keys(t)){let a=i;if(!e.includes(a)){let e=de(()=>t[a]),i=n[a];ke(i)&&r.run(()=>{W(e,e=>{bl(e)&&(i.value=e)},{immediate:!0})})}}})()}),()=>r.stop()}function Ql(){return{edgesChange:$(),nodesChange:$(),nodeDoubleClick:$(),nodeClick:$(),nodeMouseEnter:$(),nodeMouseMove:$(),nodeMouseLeave:$(),nodeContextMenu:$(),nodeDragStart:$(),nodeDrag:$(),nodeDragStop:$(),nodesInitialized:$(),miniMapNodeClick:$(),miniMapNodeDoubleClick:$(),miniMapNodeMouseEnter:$(),miniMapNodeMouseMove:$(),miniMapNodeMouseLeave:$(),connect:$(),connectStart:$(),connectEnd:$(),clickConnectStart:$(),clickConnectEnd:$(),paneReady:$(),init:$(),move:$(),moveStart:$(),moveEnd:$(),selectionDragStart:$(),selectionDrag:$(),selectionDragStop:$(),selectionContextMenu:$(),selectionStart:$(),selectionEnd:$(),viewportChangeStart:$(),viewportChange:$(),viewportChangeEnd:$(),paneScroll:$(),paneClick:$(),paneContextMenu:$(),paneMouseEnter:$(),paneMouseMove:$(),paneMouseLeave:$(),edgeContextMenu:$(),edgeMouseEnter:$(),edgeMouseMove:$(),edgeMouseLeave:$(),edgeDoubleClick:$(),edgeClick:$(),edgeUpdateStart:$(),edgeUpdate:$(),edgeUpdateEnd:$(),updateNodeInternals:$(),error:$(e=>gl(e.message))}}function $l(e,t){let n=ne();he(()=>{for(let[n,i]of Object.entries(t.value))i.setEmitter(t=>{e(n,t)}),dt(i.removeEmitter),i.setHasEmitListeners(()=>r(n)),dt(i.removeHasEmitListeners)});function r(e){let t=eu(e);return!!n?.vnode.props?.[t]}}function eu(e){let[t,...n]=e.split(`:`);return`on${t.replace(/(?:^|-)(\w)/g,(e,t)=>t.toUpperCase())}${n.length?`:${n.join(`:`)}`:``}`}function tu(){return{vueFlowRef:null,viewportRef:null,nodes:[],edges:[],connectionLookup:new Map,nodeTypes:{},edgeTypes:{},initialized:!1,dimensions:{width:0,height:0},viewport:{x:0,y:0,zoom:1},d3Zoom:null,d3Selection:null,d3ZoomHandler:null,minZoom:.5,maxZoom:2,translateExtent:[[-1/0,-1/0],[1/0,1/0]],nodeExtent:[[-1/0,-1/0],[1/0,1/0]],selectionMode:Ds.Full,paneDragging:!1,preventScrolling:!0,zoomOnScroll:!0,zoomOnPinch:!0,zoomOnDoubleClick:!0,panOnScroll:!1,panOnScrollSpeed:.5,panOnScrollMode:js.Free,paneClickDistance:0,panOnDrag:!0,edgeUpdaterRadius:10,onlyRenderVisibleElements:!1,defaultViewport:{x:0,y:0,zoom:1},nodesSelectionActive:!1,userSelectionActive:!1,userSelectionRect:null,defaultMarkerColor:`#b1b1b7`,connectionLineStyle:{},connectionLineType:null,connectionLineOptions:{type:Os.Bezier,style:{}},connectionMode:ks.Loose,connectionStartHandle:null,connectionEndHandle:null,connectionClickStartHandle:null,connectionPosition:{x:NaN,y:NaN},connectionRadius:20,connectOnClick:!0,connectionStatus:null,isValidConnection:null,snapGrid:[15,15],snapToGrid:!1,edgesUpdatable:!1,edgesFocusable:!0,nodesFocusable:!0,nodesConnectable:!0,nodesDraggable:!0,nodeDragThreshold:1,elementsSelectable:!0,selectNodesOnDrag:!0,multiSelectionActive:!1,selectionKeyCode:`Shift`,multiSelectionKeyCode:tl()?`Meta`:`Control`,zoomActivationKeyCode:tl()?`Meta`:`Control`,deleteKeyCode:`Backspace`,panActivationKeyCode:`Space`,hooks:Ql(),applyDefault:!0,autoConnect:!1,fitViewOnInit:!1,fitViewOnInitDone:!1,noDragClassName:`nodrag`,noWheelClassName:`nowheel`,noPanClassName:`nopan`,defaultEdgeOptions:void 0,elevateEdgesOnSelect:!1,elevateNodesOnSelect:!0,autoPanOnNodeDrag:!0,autoPanOnConnect:!0,autoPanSpeed:15,disableKeyboardA11y:!1,ariaLiveMessage:``}}var nu=[`id`,`vueFlowRef`,`viewportRef`,`initialized`,`modelValue`,`nodes`,`edges`,`maxZoom`,`minZoom`,`translateExtent`,`hooks`,`defaultEdgeOptions`];function ru(e,t,n){let r=Yl(e),i=t=>{let n=t??[];e.hooks.updateNodeInternals.trigger(n)},a=t=>sc(t,e.nodes,e.edges),o=t=>oc(t,e.nodes,e.edges),s=t=>vc(t,e.edges),c=({id:t,type:n,nodeId:r})=>{let i=t?`-${n}-${t}`:`-${n}`;return Array.from(e.connectionLookup.get(`${r}${i}`)?.values()??[])},l=e=>{if(e)return t.value.get(e)},u=e=>{if(e)return n.value.get(e)},d=(t,n,r)=>{let i=[];for(let e of t){let t={id:e.id,type:`position`,dragging:r,from:e.from};if(n&&(t.position=e.position,e.parentNode)){let n=l(e.parentNode);t.position={x:t.position.x-(n?.computedPosition?.x??0),y:t.position.y-(n?.computedPosition?.y??0)}}i.push(t)}i?.length&&e.hooks.nodesChange.trigger(i)},f=t=>{if(!e.vueFlowRef)return;let n=e.vueFlowRef.querySelector(`.vue-flow__transformationpane`);if(!n)return;let i=window.getComputedStyle(n),{m22:a}=new window.DOMMatrixReadOnly(i.transform),o=[];for(let e of t){let t=e,n=l(t.id);if(n){let e=Js(t.nodeElement);if(e.width&&e.height&&(n.dimensions.width!==e.width||n.dimensions.height!==e.height||t.forceUpdate)){let r=t.nodeElement.getBoundingClientRect();n.dimensions=e,n.handleBounds.source=vl(`source`,t.nodeElement,r,a,n.id),n.handleBounds.target=vl(`target`,t.nodeElement,r,a,n.id),o.push({id:n.id,type:`dimensions`,dimensions:e})}}}!e.fitViewOnInitDone&&e.fitViewOnInit&&r.value.fitView().then(()=>{e.fitViewOnInitDone=!0}),o.length&&e.hooks.nodesChange.trigger(o)},p=(r,i)=>{let a=new Set,o=new Set;for(let e of r)$s(e)?a.add(e.id):Qs(e)&&o.add(e.id);let s=Fc(t.value,a,!0),c=Fc(n.value,o);if(e.multiSelectionActive){for(let e of a)s.push(jc(e,i));for(let e of o)c.push(jc(e,i))}s.length&&e.hooks.nodesChange.trigger(s),c.length&&e.hooks.edgesChange.trigger(c)},m=r=>{if(e.multiSelectionActive){let t=r.map(e=>jc(e.id,!0));e.hooks.nodesChange.trigger(t);return}e.hooks.nodesChange.trigger(Fc(t.value,new Set(r.map(e=>e.id)),!0)),e.hooks.edgesChange.trigger(Fc(n.value))},h=r=>{if(e.multiSelectionActive){let t=r.map(e=>jc(e.id,!0));e.hooks.edgesChange.trigger(t);return}e.hooks.edgesChange.trigger(Fc(n.value,new Set(r.map(e=>e.id)))),e.hooks.nodesChange.trigger(Fc(t.value,new Set,!0))},g=e=>{p(e,!0)},_=t=>{let n=(t||e.nodes).map(e=>(e.selected=!1,jc(e.id,!1)));e.hooks.nodesChange.trigger(n)},v=t=>{let n=(t||e.edges).map(e=>(e.selected=!1,jc(e.id,!1)));e.hooks.edgesChange.trigger(n)},y=t=>{if(!t||!t.length)return p([],!1);let n=t.reduce((e,t)=>{let n=jc(t.id,!1);return $s(t)?e.nodes.push(n):e.edges.push(n),e},{nodes:[],edges:[]});n.nodes.length&&e.hooks.nodesChange.trigger(n.nodes),n.edges.length&&e.hooks.edgesChange.trigger(n.edges)},b=t=>{var n;(n=e.d3Zoom)==null||n.scaleExtent([t,e.maxZoom]),e.minZoom=t},x=t=>{var n;(n=e.d3Zoom)==null||n.scaleExtent([e.minZoom,t]),e.maxZoom=t},S=t=>{var n;(n=e.d3Zoom)==null||n.translateExtent(t),e.translateExtent=t},C=t=>{e.nodeExtent=t,i()},w=t=>{var n;(n=e.d3Zoom)==null||n.clickDistance(t)},T=t=>{e.nodesDraggable=t,e.nodesConnectable=t,e.elementsSelectable=t},E=t=>{let n=t instanceof Function?t(e.nodes):t;!e.initialized&&!n.length||(e.nodes=Cl(n,l,e.hooks.error.trigger))},D=t=>{let r=t instanceof Function?t(e.edges):t;if(!e.initialized&&!r.length)return;let i=Dl(r,e.isValidConnection,l,u,e.hooks.error.trigger,e.defaultEdgeOptions,e.nodes,e.edges);Tl(e.connectionLookup,n.value,i),e.edges=i},O=t=>{let n=t instanceof Function?t([...e.nodes,...e.edges]):t;!e.initialized&&!n.length||(E(n.filter($s)),D(n.filter(Qs)))},k=t=>{let n=t instanceof Function?t(e.nodes):t;n=Array.isArray(n)?n:[n];let r=Cl(n,l,e.hooks.error.trigger),i=[];for(let e of r)i.push(Mc(e));i.length&&e.hooks.nodesChange.trigger(i)},A=t=>{let n=t instanceof Function?t(e.edges):t;n=Array.isArray(n)?n:[n];let r=Dl(n,e.isValidConnection,l,u,e.hooks.error.trigger,e.defaultEdgeOptions,e.nodes,e.edges),i=[];for(let e of r)i.push(Mc(e));i.length&&e.hooks.edgesChange.trigger(i)},j=(t,n=!0,r=!1)=>{let i=t instanceof Function?t(e.nodes):t,a=Array.isArray(i)?i:[i],o=[],c=[];function u(e){let t=s(e);for(let e of t)(!bl(e.deletable)||e.deletable)&&c.push(Pc(e.id,e.source,e.target,e.sourceHandle,e.targetHandle))}function d(t){let r=[];for(let n of e.nodes)n.parentNode===t&&r.push(n);if(r.length){for(let e of r)o.push(Nc(e.id));n&&u(r);for(let e of r)d(e.id)}}for(let e of a){let t=typeof e==`string`?l(e):e;t&&(bl(t.deletable)&&!t.deletable||(o.push(Nc(t.id)),n&&u([t]),r&&d(t.id)))}c.length&&e.hooks.edgesChange.trigger(c),o.length&&e.hooks.nodesChange.trigger(o)},M=t=>{let n=t instanceof Function?t(e.edges):t,r=Array.isArray(n)?n:[n],i=[];for(let e of r){let t=typeof e==`string`?u(e):e;t&&(bl(t.deletable)&&!t.deletable||i.push(Pc(typeof e==`string`?e:e.id,t.source,t.target,t.sourceHandle,t.targetHandle)))}e.hooks.edgesChange.trigger(i)},ee=(t,r,i=!0)=>{let a=u(t.id);if(!a)return!1;let o=e.edges.indexOf(a),s=Sl(t,r,a,i,e.hooks.error.trigger);if(s){let[t]=Dl([s],e.isValidConnection,l,u,e.hooks.error.trigger,e.defaultEdgeOptions,e.nodes,e.edges);return e.edges=e.edges.map((e,n)=>n===o?t:e),Tl(e.connectionLookup,n.value,[t]),t}return!1},N=(e,t,n={replace:!1})=>{let r=u(e);if(!r)return;let i=typeof t==`function`?t(r):t;r.data=n.replace?i:{...r.data,...i}},P=t=>Ac(t,e.nodes),te=t=>{let r=Ac(t,e.edges);return Tl(e.connectionLookup,n.value,r),r},ne=(t,n,r={replace:!1})=>{let i=l(t);if(!i)return;let a=typeof n==`function`?n(i):n;r.replace?e.nodes.splice(e.nodes.indexOf(i),1,a):Object.assign(i,a)},re=(e,t,n={replace:!1})=>{let r=l(e);if(!r)return;let i=typeof t==`function`?t(r):t;r.data=n.replace?i:{...r.data,...i}},F=(t,n,r=!1)=>{r?e.connectionClickStartHandle=t:e.connectionStartHandle=t,e.connectionEndHandle=null,e.connectionStatus=null,n&&(e.connectionPosition=n)},ie=(t,n=null,r=null)=>{e.connectionStartHandle&&(e.connectionPosition=t,e.connectionEndHandle=n,e.connectionStatus=r)},ae=(t,n)=>{e.connectionPosition={x:NaN,y:NaN},e.connectionEndHandle=null,e.connectionStatus=null,n?e.connectionClickStartHandle=null:e.connectionStartHandle=null},I=e=>{let t=nc(e),n=t?null:ec(e)?e:l(e.id);return!t&&!n?[null,null,t]:[t?e:Ks(n),n,t]},oe=(t,n=!0,r=e.nodes)=>{let[i,a,o]=I(t);if(!i)return[];let s=[];for(let t of r||e.nodes){if(!o&&(t.id===a.id||!t.computedPosition))continue;let e=Ks(t),r=qs(e,i);(n&&r>0||r>=e.width*e.height||r>=Number(i.width)*Number(i.height))&&s.push(t)}return s},L=(e,t,n=!0)=>{let[r]=I(e);if(!r)return!1;let i=qs(r,t);return n&&i>0||i>=Number(r.width)*Number(r.height)},se=t=>{let{viewport:n,dimensions:r,d3Zoom:i,d3Selection:a,translateExtent:o}=e;if(!i||!a||!t.x&&!t.y)return!1;let s=_s.translate(n.x+t.x,n.y+t.y).scale(n.zoom),c=[[0,0],[r.width,r.height]],l=i.constrain()(s,c,o),u=e.viewport.x!==l.x||e.viewport.y!==l.y||e.viewport.zoom!==l.k;return i.transform(a,l),u},R=t=>{let n=t instanceof Function?t(e):t,r=[`d3Zoom`,`d3Selection`,`d3ZoomHandler`,`viewportRef`,`vueFlowRef`,`dimensions`,`hooks`];bl(n.defaultEdgeOptions)&&(e.defaultEdgeOptions=n.defaultEdgeOptions);let i=n.modelValue||n.nodes||n.edges?[]:void 0;i&&(n.modelValue&&i.push(...n.modelValue),n.nodes&&i.push(...n.nodes),n.edges&&i.push(...n.edges),O(i));let a=()=>{bl(n.maxZoom)&&x(n.maxZoom),bl(n.minZoom)&&b(n.minZoom),bl(n.translateExtent)&&S(n.translateExtent)};for(let t of Object.keys(n)){let i=t,a=n[i];![...nu,...r].includes(i)&&bl(a)&&(e[i]=a)}Et(()=>e.d3Zoom).not.toBeNull().then(a),e.initialized||=!0};return{updateNodePositions:d,updateNodeDimensions:f,setElements:O,setNodes:E,setEdges:D,addNodes:k,addEdges:A,removeNodes:j,removeEdges:M,findNode:l,findEdge:u,updateEdge:ee,updateEdgeData:N,updateNode:ne,updateNodeData:re,applyEdgeChanges:te,applyNodeChanges:P,addSelectedElements:g,addSelectedNodes:m,addSelectedEdges:h,setMinZoom:b,setMaxZoom:x,setTranslateExtent:S,setNodeExtent:C,setPaneClickDistance:w,removeSelectedElements:y,removeSelectedNodes:_,removeSelectedEdges:v,startConnection:F,updateConnection:ie,endConnection:ae,setInteractive:T,setState:R,getIntersectingNodes:oe,getIncomers:a,getOutgoers:o,getConnectedEdges:s,getHandleConnections:c,isNodeIntersecting:L,panBy:se,fitView:e=>r.value.fitView(e),zoomIn:e=>r.value.zoomIn(e),zoomOut:e=>r.value.zoomOut(e),zoomTo:(e,t)=>r.value.zoomTo(e,t),setViewport:(e,t)=>r.value.setViewport(e,t),setTransform:(e,t)=>r.value.setTransform(e,t),getViewport:()=>r.value.getViewport(),getTransform:()=>r.value.getTransform(),setCenter:(e,t,n)=>r.value.setCenter(e,t,n),fitBounds:(e,t)=>r.value.fitBounds(e,t),project:e=>r.value.project(e),screenToFlowCoordinate:e=>r.value.screenToFlowCoordinate(e),flowToScreenCoordinate:e=>r.value.flowToScreenCoordinate(e),toObject:()=>{let t=[],n=[];for(let n of e.nodes){let{computedPosition:e,handleBounds:r,selected:i,dimensions:a,isParent:o,resizing:s,dragging:c,events:l,...u}=n;t.push(u)}for(let t of e.edges){let{selected:e,sourceNode:r,targetNode:i,events:a,...o}=t;n.push(o)}return JSON.parse(JSON.stringify({nodes:t,edges:n,position:[e.viewport.x,e.viewport.y],zoom:e.viewport.zoom,viewport:e.viewport}))},fromObject:t=>new Promise(n=>{let{nodes:i,edges:a,position:o,zoom:s,viewport:c}=t;if(i&&E(i),a&&D(a),c?.x&&c?.y||o){let t=c?.x||o[0],i=c?.y||o[1],a=c?.zoom||s||e.viewport.zoom;return Et(()=>r.value.viewportInitialized).toBe(!0).then(()=>{r.value.setViewport({x:t,y:i,zoom:a}).then(()=>{n(!0)})})}else n(!0)}),updateNodeInternals:i,viewportHelper:r,$reset:()=>{let t=tu();if(e.edges=[],e.nodes=[],e.d3Zoom&&e.d3Selection){let n=_s.translate(t.defaultViewport.x??0,t.defaultViewport.y??0).scale(Ys(t.defaultViewport.zoom??1,t.minZoom,t.maxZoom)),r=e.viewportRef.getBoundingClientRect(),i=[[0,0],[r.width,r.height]],a=e.d3Zoom.constrain()(n,i,t.translateExtent);e.d3Zoom.transform(e.d3Selection,a)}R(t)},$destroy:()=>{}}}var iu=[`data-id`,`data-handleid`,`data-nodeid`,`data-handlepos`],au=V({name:`Handle`,compatConfig:{MODE:3},props:{id:{default:null},type:{},position:{default:()=>Q.Top},isValidConnection:{type:Function},connectable:{type:[Boolean,Number,String,Function],default:void 0},connectableStart:{type:Boolean,default:!0},connectableEnd:{type:Boolean,default:!0}},setup(e,{expose:t}){let n=re(e,[`position`,`connectable`,`connectableStart`,`connectableEnd`,`id`]),r=de(()=>n.type??`source`),i=de(()=>n.isValidConnection??null),{id:a,connectionStartHandle:o,connectionClickStartHandle:s,connectionEndHandle:c,vueFlowRef:l,nodesConnectable:u,noDragClassName:d,noPanClassName:f}=Hu(),{id:p,node:m,nodeEl:h,connectedEdges:g}=Vl(),_=U(),v=de(()=>e.connectableStart===void 0?!0:e.connectableStart),y=de(()=>e.connectableEnd===void 0?!0:e.connectableEnd),b=de(()=>o.value?.nodeId===p&&o.value?.id===e.id&&o.value?.type===r.value||c.value?.nodeId===p&&c.value?.id===e.id&&c.value?.type===r.value),x=de(()=>s.value?.nodeId===p&&s.value?.id===e.id&&s.value?.type===r.value),{handlePointerDown:S,handleClick:C}=zl({nodeId:p,handleId:e.id,isValidConnection:i,type:r}),w=q(()=>typeof e.connectable==`string`&&e.connectable===`single`?!g.value.some(t=>{let n=t[`${r.value}Handle`];return t[r.value]===p?n?n===e.id:!0:!1}):typeof e.connectable==`number`?g.value.filter(t=>{let n=t[`${r.value}Handle`];return t[r.value]===p?n?n===e.id:!0:!1}).length<e.connectable:typeof e.connectable==`function`?e.connectable(m,g.value):bl(e.connectable)?e.connectable:u.value);ce(()=>{if(!m.dimensions.width||!m.dimensions.height)return;let t=m.handleBounds[r.value]?.find(t=>t.id===e.id);if(!l.value||t)return;let n=l.value.querySelector(`.vue-flow__transformationpane`);if(!h.value||!_.value||!n||!e.id)return;let i=h.value.getBoundingClientRect(),a=_.value.getBoundingClientRect(),o=window.getComputedStyle(n),{m22:s}=new window.DOMMatrixReadOnly(o.transform),c={id:e.id,position:e.position,x:(a.left-i.left)/s,y:(a.top-i.top)/s,type:r.value,nodeId:p,...Js(_.value)};m.handleBounds[r.value]=[...m.handleBounds[r.value]??[],c]});function T(e){let t=Qc(e);w.value&&v.value&&(t&&e.button===0||!t)&&S(e)}function E(e){!p||!s.value&&!v.value||w.value&&C(e)}return t({handleClick:C,handlePointerDown:S,onClick:E,onPointerDown:T}),(t,n)=>(G(),P(`div`,{ref_key:`handle`,ref:_,"data-id":`${B(a)}-${B(p)}-${e.id}-${r.value}`,"data-handleid":e.id,"data-nodeid":B(p),"data-handlepos":t.position,class:N([`vue-flow__handle`,[`vue-flow__handle-${t.position}`,`vue-flow__handle-${e.id}`,B(d),B(f),r.value,{connectable:w.value,connecting:x.value,connectablestart:v.value,connectableend:y.value,connectionindicator:w.value&&(v.value&&!b.value||y.value&&b.value)}]]),onMousedown:T,onTouchstartPassive:T,onClick:E},[We(t.$slots,`default`,{id:t.id})],42,iu))}}),ou=function({sourcePosition:e=Q.Bottom,targetPosition:t=Q.Top,label:n,connectable:r=!0,isValidTargetPos:i,isValidSourcePos:a,data:o}){let s=o.label??n;return[H(au,{type:`target`,position:t,connectable:r,isValidConnection:i}),typeof s!=`string`&&s?H(s):H(je,[s]),H(au,{type:`source`,position:e,connectable:r,isValidConnection:a})]};ou.props=[`sourcePosition`,`targetPosition`,`label`,`isValidTargetPos`,`isValidSourcePos`,`connectable`,`data`],ou.inheritAttrs=!1,ou.compatConfig={MODE:3};var su=ou,cu=function({targetPosition:e=Q.Top,label:t,connectable:n=!0,isValidTargetPos:r,data:i}){let a=i.label??t;return[H(au,{type:`target`,position:e,connectable:n,isValidConnection:r}),typeof a!=`string`&&a?H(a):H(je,[a])]};cu.props=[`targetPosition`,`label`,`isValidTargetPos`,`connectable`,`data`],cu.inheritAttrs=!1,cu.compatConfig={MODE:3};var lu=cu,uu=function({sourcePosition:e=Q.Bottom,label:t,connectable:n=!0,isValidSourcePos:r,data:i}){let a=i.label??t;return[typeof a!=`string`&&a?H(a):H(je,[a]),H(au,{type:`source`,position:e,connectable:n,isValidConnection:r})]};uu.props=[`sourcePosition`,`label`,`isValidSourcePos`,`connectable`,`data`],uu.inheritAttrs=!1,uu.compatConfig={MODE:3};var du=uu,fu=[`transform`],pu=[`width`,`height`,`x`,`y`,`rx`,`ry`],mu=[`y`],hu=V({name:`EdgeText`,compatConfig:{MODE:3},props:{x:{},y:{},label:{},labelStyle:{default:()=>({})},labelShowBg:{type:Boolean,default:!0},labelBgStyle:{default:()=>({})},labelBgPadding:{default:()=>[2,4]},labelBgBorderRadius:{default:2}},setup(e){let t=U({x:0,y:0,width:0,height:0}),n=U(null),r=q(()=>`translate(${e.x-t.value.width/2} ${e.y-t.value.height/2})`);ce(i),W([()=>e.x,()=>e.y,n,()=>e.label],i);function i(){if(!n.value)return;let e=n.value.getBBox();(e.width!==t.value.width||e.height!==t.value.height)&&(t.value=e)}return(e,i)=>(G(),P(`g`,{transform:r.value,class:`vue-flow__edge-textwrapper`},[e.labelShowBg?(G(),P(`rect`,{key:0,class:`vue-flow__edge-textbg`,width:`${t.value.width+2*e.labelBgPadding[0]}px`,height:`${t.value.height+2*e.labelBgPadding[1]}px`,x:-e.labelBgPadding[0],y:-e.labelBgPadding[1],style:R(e.labelBgStyle),rx:e.labelBgBorderRadius,ry:e.labelBgBorderRadius},null,12,pu)):z(``,!0),I(`text`,He(e.$attrs,{ref_key:`el`,ref:n,class:`vue-flow__edge-text`,y:t.value.height/2,dy:`0.3em`,style:e.labelStyle}),[We(e.$slots,`default`,{},()=>[typeof e.label==`string`?(G(),P(je,{key:1},[X(J(e.label),1)],64)):(G(),L(be(e.label),{key:0}))])],16,mu)],8,fu))}}),gu=[`id`,`d`,`marker-end`,`marker-start`],_u=[`d`,`stroke-width`],vu=V({name:`BaseEdge`,inheritAttrs:!1,compatConfig:{MODE:3},props:{id:{},labelX:{},labelY:{},path:{},label:{},markerStart:{},markerEnd:{},interactionWidth:{default:20},labelStyle:{},labelShowBg:{type:Boolean},labelBgStyle:{},labelBgPadding:{},labelBgBorderRadius:{}},setup(e,{expose:t}){let n=U(null),r=U(null),i=U(null),a=ze();return t({pathEl:n,interactionEl:r,labelEl:i}),(e,t)=>(G(),P(je,null,[I(`path`,He(B(a),{id:e.id,ref_key:`pathEl`,ref:n,d:e.path,class:`vue-flow__edge-path`,"marker-end":e.markerEnd,"marker-start":e.markerStart}),null,16,gu),e.interactionWidth?(G(),P(`path`,{key:0,ref_key:`interactionEl`,ref:r,fill:`none`,d:e.path,"stroke-width":e.interactionWidth,"stroke-opacity":0,class:`vue-flow__edge-interaction`},null,8,_u)):z(``,!0),e.label&&e.labelX&&e.labelY?(G(),L(hu,{key:1,ref_key:`labelEl`,ref:i,x:e.labelX,y:e.labelY,label:e.label,"label-show-bg":e.labelShowBg,"label-bg-style":e.labelBgStyle,"label-bg-padding":e.labelBgPadding,"label-bg-border-radius":e.labelBgBorderRadius,"label-style":e.labelStyle},null,8,[`x`,`y`,`label`,`label-show-bg`,`label-bg-style`,`label-bg-padding`,`label-bg-border-radius`,`label-style`])):z(``,!0)],64))}});function yu({sourceX:e,sourceY:t,targetX:n,targetY:r}){let i=Math.abs(n-e)/2,a=n<e?n+i:n-i,o=Math.abs(r-t)/2,s=r<t?r+o:r-o;return[a,s,i,o]}function bu({sourceX:e,sourceY:t,targetX:n,targetY:r,sourceControlX:i,sourceControlY:a,targetControlX:o,targetControlY:s}){let c=e*.125+i*.375+o*.375+n*.125,l=t*.125+a*.375+s*.375+r*.125,u=Math.abs(c-e),d=Math.abs(l-t);return[c,l,u,d]}function xu(e,t){return e>=0?.5*e:t*25*Math.sqrt(-e)}function Su({pos:e,x1:t,y1:n,x2:r,y2:i,c:a}){let o,s;switch(e){case Q.Left:o=t-xu(t-r,a),s=n;break;case Q.Right:o=t+xu(r-t,a),s=n;break;case Q.Top:o=t,s=n-xu(n-i,a);break;case Q.Bottom:o=t,s=n+xu(i-n,a);break}return[o,s]}function Cu(e){let{sourceX:t,sourceY:n,sourcePosition:r=Q.Bottom,targetX:i,targetY:a,targetPosition:o=Q.Top,curvature:s=.25}=e,[c,l]=Su({pos:r,x1:t,y1:n,x2:i,y2:a,c:s}),[u,d]=Su({pos:o,x1:i,y1:a,x2:t,y2:n,c:s}),[f,p,m,h]=bu({sourceX:t,sourceY:n,targetX:i,targetY:a,sourceControlX:c,sourceControlY:l,targetControlX:u,targetControlY:d});return[`M${t},${n} C${c},${l} ${u},${d} ${i},${a}`,f,p,m,h]}function wu({pos:e,x1:t,y1:n,x2:r,y2:i}){let a,o;switch(e){case Q.Left:case Q.Right:a=.5*(t+r),o=n;break;case Q.Top:case Q.Bottom:a=t,o=.5*(n+i);break}return[a,o]}function Tu(e){let{sourceX:t,sourceY:n,sourcePosition:r=Q.Bottom,targetX:i,targetY:a,targetPosition:o=Q.Top}=e,[s,c]=wu({pos:r,x1:t,y1:n,x2:i,y2:a}),[l,u]=wu({pos:o,x1:i,y1:a,x2:t,y2:n}),[d,f,p,m]=bu({sourceX:t,sourceY:n,targetX:i,targetY:a,sourceControlX:s,sourceControlY:c,targetControlX:l,targetControlY:u});return[`M${t},${n} C${s},${c} ${l},${u} ${i},${a}`,d,f,p,m]}var Eu={[Q.Left]:{x:-1,y:0},[Q.Right]:{x:1,y:0},[Q.Top]:{x:0,y:-1},[Q.Bottom]:{x:0,y:1}};function Du({source:e,sourcePosition:t=Q.Bottom,target:n}){return t===Q.Left||t===Q.Right?e.x<n.x?{x:1,y:0}:{x:-1,y:0}:e.y<n.y?{x:0,y:1}:{x:0,y:-1}}function Ou(e,t){return Math.sqrt((t.x-e.x)**2+(t.y-e.y)**2)}function ku({source:e,sourcePosition:t=Q.Bottom,target:n,targetPosition:r=Q.Top,center:i,offset:a}){let o=Eu[t],s=Eu[r],c={x:e.x+o.x*a,y:e.y+o.y*a},l={x:n.x+s.x*a,y:n.y+s.y*a},u=Du({source:c,sourcePosition:t,target:l}),d=u.x===0?`y`:`x`,f=u[d],p,m,h,g={x:0,y:0},_={x:0,y:0},[v,y,b,x]=yu({sourceX:e.x,sourceY:e.y,targetX:n.x,targetY:n.y});if(o[d]*s[d]===-1){m=i.x??v,h=i.y??y;let e=[{x:m,y:c.y},{x:m,y:l.y}],t=[{x:c.x,y:h},{x:l.x,y:h}];p=o[d]===f?d===`x`?e:t:d===`x`?t:e}else{let i=[{x:c.x,y:l.y}],u=[{x:l.x,y:c.y}];if(p=d===`x`?o.x===f?u:i:o.y===f?i:u,t===r){let t=Math.abs(e[d]-n[d]);if(t<=a){let r=Math.min(a-1,a-t);o[d]===f?g[d]=(c[d]>e[d]?-1:1)*r:_[d]=(l[d]>n[d]?-1:1)*r}}if(t!==r){let e=d===`x`?`y`:`x`,t=o[d]===s[e],n=c[e]>l[e],r=c[e]<l[e];(o[d]===1&&(!t&&n||t&&r)||o[d]!==1&&(!t&&r||t&&n))&&(p=d===`x`?i:u)}let v={x:c.x+g.x,y:c.y+g.y},y={x:l.x+_.x,y:l.y+_.y},b=Math.max(Math.abs(v.x-p[0].x),Math.abs(y.x-p[0].x)),x=Math.max(Math.abs(v.y-p[0].y),Math.abs(y.y-p[0].y));b>=x?(m=(v.x+y.x)/2,h=p[0].y):(m=p[0].x,h=(v.y+y.y)/2)}return[[e,{x:c.x+g.x,y:c.y+g.y},...p,{x:l.x+_.x,y:l.y+_.y},n],m,h,b,x]}function Au(e,t,n,r){let i=Math.min(Ou(e,t)/2,Ou(t,n)/2,r),{x:a,y:o}=t;if(e.x===a&&a===n.x||e.y===o&&o===n.y)return`L${a} ${o}`;if(e.y===o){let t=e.x<n.x?-1:1,r=e.y<n.y?1:-1;return`L ${a+i*t},${o}Q ${a},${o} ${a},${o+i*r}`}let s=e.x<n.x?1:-1,c=e.y<n.y?-1:1;return`L ${a},${o+i*c}Q ${a},${o} ${a+i*s},${o}`}function ju(e){let{sourceX:t,sourceY:n,sourcePosition:r=Q.Bottom,targetX:i,targetY:a,targetPosition:o=Q.Top,borderRadius:s=5,centerX:c,centerY:l,offset:u=20}=e,[d,f,p,m,h]=ku({source:{x:t,y:n},sourcePosition:r,target:{x:i,y:a},targetPosition:o,center:{x:c,y:l},offset:u});return[d.reduce((e,t,n)=>{let r;return r=n>0&&n<d.length-1?Au(d[n-1],t,d[n+1],s):`${n===0?`M`:`L`}${t.x} ${t.y}`,e+=r,e},``),f,p,m,h]}function Mu(e){let{sourceX:t,sourceY:n,targetX:r,targetY:i}=e,[a,o,s,c]=yu({sourceX:t,sourceY:n,targetX:r,targetY:i});return[`M ${t},${n}L ${r},${i}`,a,o,s,c]}var Nu=V({name:`StraightEdge`,props:[`label`,`labelStyle`,`labelShowBg`,`labelBgStyle`,`labelBgPadding`,`labelBgBorderRadius`,`sourceY`,`sourceX`,`targetX`,`targetY`,`markerEnd`,`markerStart`,`interactionWidth`],compatConfig:{MODE:3},setup(e,{attrs:t}){return()=>{let[n,r,i]=Mu(e);return H(vu,{path:n,labelX:r,labelY:i,...t,...e})}}}),Pu=V({name:`SmoothStepEdge`,props:[`sourcePosition`,`targetPosition`,`label`,`labelStyle`,`labelShowBg`,`labelBgStyle`,`labelBgPadding`,`labelBgBorderRadius`,`sourceY`,`sourceX`,`targetX`,`targetY`,`borderRadius`,`markerEnd`,`markerStart`,`interactionWidth`,`offset`],compatConfig:{MODE:3},setup(e,{attrs:t}){return()=>{let[n,r,i]=ju({...e,sourcePosition:e.sourcePosition??Q.Bottom,targetPosition:e.targetPosition??Q.Top});return H(vu,{path:n,labelX:r,labelY:i,...t,...e})}}}),Fu=V({name:`StepEdge`,props:[`sourcePosition`,`targetPosition`,`label`,`labelStyle`,`labelShowBg`,`labelBgStyle`,`labelBgPadding`,`labelBgBorderRadius`,`sourceY`,`sourceX`,`targetX`,`targetY`,`markerEnd`,`markerStart`,`interactionWidth`],setup(e,{attrs:t}){return()=>H(Pu,{...e,...t,borderRadius:0})}}),Iu=V({name:`BezierEdge`,props:[`sourcePosition`,`targetPosition`,`label`,`labelStyle`,`labelShowBg`,`labelBgStyle`,`labelBgPadding`,`labelBgBorderRadius`,`sourceY`,`sourceX`,`targetX`,`targetY`,`curvature`,`markerEnd`,`markerStart`,`interactionWidth`],compatConfig:{MODE:3},setup(e,{attrs:t}){return()=>{let[n,r,i]=Cu({...e,sourcePosition:e.sourcePosition??Q.Bottom,targetPosition:e.targetPosition??Q.Top});return H(vu,{path:n,labelX:r,labelY:i,...t,...e})}}}),Lu=V({name:`SimpleBezierEdge`,props:[`sourcePosition`,`targetPosition`,`label`,`labelStyle`,`labelShowBg`,`labelBgStyle`,`labelBgPadding`,`labelBgBorderRadius`,`sourceY`,`sourceX`,`targetX`,`targetY`,`markerEnd`,`markerStart`,`interactionWidth`],compatConfig:{MODE:3},setup(e,{attrs:t}){return()=>{let[n,r,i]=Tu({...e,sourcePosition:e.sourcePosition??Q.Bottom,targetPosition:e.targetPosition??Q.Top});return H(vu,{path:n,labelX:r,labelY:i,...t,...e})}}}),Ru={input:du,default:su,output:lu},zu={default:Iu,straight:Nu,step:Fu,smoothstep:Pu,simplebezier:Lu};function Bu(e,t,n){let r=q(()=>e=>t.value.get(e)),i=q(()=>e=>n.value.get(e)),a=q(()=>{let t={...zu,...e.edgeTypes},n=Object.keys(t);for(let r of e.edges)r.type&&!n.includes(r.type)&&(t[r.type]=r.type);return t}),o=q(()=>{let t={...Ru,...e.nodeTypes},n=Object.keys(t);for(let r of e.nodes)r.type&&!n.includes(r.type)&&(t[r.type]=r.type);return t}),s=q(()=>e.onlyRenderVisibleElements?_c(e.nodes,{x:0,y:0,width:e.dimensions.width,height:e.dimensions.height},e.viewport,!0):e.nodes),c=q(()=>{if(e.onlyRenderVisibleElements){let n=[];for(let r of e.edges){let i=t.value.get(r.source),a=t.value.get(r.target);qc({sourcePos:i.computedPosition||{x:0,y:0},targetPos:a.computedPosition||{x:0,y:0},sourceWidth:i.dimensions.width,sourceHeight:i.dimensions.height,targetWidth:a.dimensions.width,targetHeight:a.dimensions.height,width:e.dimensions.width,height:e.dimensions.height,viewport:e.viewport})&&n.push(r)}return n}return e.edges}),l=q(()=>[...s.value,...c.value]),u=q(()=>{let t=[];for(let n of e.nodes)n.selected&&t.push(n);return t}),d=q(()=>{let t=[];for(let n of e.edges)n.selected&&t.push(n);return t}),f=q(()=>[...u.value,...d.value]),p=q(()=>{let t=[];for(let n of e.nodes)n.dimensions.width&&n.dimensions.height&&n.handleBounds!==void 0&&t.push(n);return t}),m=q(()=>s.value.length>0&&p.value.length===s.value.length);return{getNode:r,getEdge:i,getElements:l,getEdgeTypes:a,getNodeTypes:o,getEdges:c,getNodes:s,getSelectedElements:f,getSelectedNodes:u,getSelectedEdges:d,getNodesInitialized:p,areNodesInitialized:m}}var Vu=class e{constructor(){this.currentId=0,this.flows=new Map}static getInstance(){let t=ne()?.appContext.app;return e.instance=t?.config.globalProperties.$vueFlowStorage??e.instance??new e,t&&(t.config.globalProperties.$vueFlowStorage=e.instance),e.instance}set(e,t){return this.flows.set(e,t)}get(e){return this.flows.get(e)}remove(e){return this.flows.delete(e)}create(e,t){let n=tu(),r=Ye(n),i={};for(let[e,t]of Object.entries(r.hooks)){let n=`on${e.charAt(0).toUpperCase()+e.slice(1)}`;i[n]=t.on}let a={};for(let[e,t]of Object.entries(r.hooks))a[e]=t.trigger;let o=q(()=>{let e=new Map;for(let t of r.nodes)e.set(t.id,t);return e}),s=q(()=>{let e=new Map;for(let t of r.edges)e.set(t.id,t);return e}),c=Bu(r,o,s),l=ru(r,o,s);l.setState({...r,...t});let u={...i,...c,...l,...wt(r),nodeLookup:o,edgeLookup:s,emits:a,id:e,vueFlowVersion:`1.47.0`,$destroy:()=>{this.remove(e)}};return this.set(e,u),u}getId(){return`vue-flow-${this.currentId++}`}};function Hu(e){let t=Vu.getInstance(),n=Fe(),r=typeof e==`object`,i=r?e:{id:e},a=i.id,o=a??n?.vueFlowId,s;if(n){let e=te(Ol,null);e!=null&&(!o||e.id===o)&&(s=e)}if(s||o&&(s=t.get(o)),!s||o&&s.id!==o){let e=a??t.getId(),r=t.create(e,i);s=r,(n??Ve(!0)).run(()=>{W(r.applyDefault,(e,t,n)=>{let i=e=>{r.applyNodeChanges(e)},a=e=>{r.applyEdgeChanges(e)};e?(r.onNodesChange(i),r.onEdgesChange(a)):(r.hooks.value.nodesChange.off(i),r.hooks.value.edgesChange.off(a)),n(()=>{r.hooks.value.nodesChange.off(i),r.hooks.value.edgesChange.off(a)})},{immediate:!0}),dt(()=>{if(s){let e=t.get(s.id);e?e.$destroy():gl(`No store instance found for id ${s.id} in storage.`)}})})}else r&&s.setState(i);return n&&(qe(Ol,s),n.vueFlowId=s.id),r&&ne()?.type.name!==`VueFlow`&&s.emits.error(new Zc(Yc.USEVUEFLOW_OPTIONS)),s}function Uu(e){let{emits:t,dimensions:n}=Hu(),r;ce(()=>{let i=()=>{var r;if(!e.value||!((r=e.value).checkVisibility?.call(r)??!0))return;let i=Js(e.value);(i.width===0||i.height===0)&&t.error(new Zc(Yc.MISSING_VIEWPORT_DIMENSIONS)),n.value={width:i.width||500,height:i.height||500}};i(),window.addEventListener(`resize`,i),e.value&&(r=new ResizeObserver(()=>i()),r.observe(e.value)),me(()=>{window.removeEventListener(`resize`,i),r&&e.value&&r.unobserve(e.value)})})}var Wu=V({name:`UserSelection`,compatConfig:{MODE:3},props:{userSelectionRect:{}},setup(e){return(e,t)=>(G(),P(`div`,{class:`vue-flow__selection vue-flow__container`,style:R({width:`${e.userSelectionRect.width}px`,height:`${e.userSelectionRect.height}px`,transform:`translate(${e.userSelectionRect.x}px, ${e.userSelectionRect.y}px)`})},null,4))}}),Gu=[`tabIndex`],Ku=V({name:`NodesSelection`,compatConfig:{MODE:3},setup(e){let{emits:t,viewport:n,getSelectedNodes:r,noPanClassName:i,disableKeyboardA11y:a,userSelectionActive:o}=Hu(),s=Wl(),c=U(null),l=Pl({el:c,onStart(e){t.selectionDragStart(e),t.nodeDragStart(e)},onDrag(e){t.selectionDrag(e),t.nodeDrag(e)},onStop(e){t.selectionDragStop(e),t.nodeDragStop(e)}});ce(()=>{var e;a.value||(e=c.value)==null||e.focus({preventScroll:!0})});let u=q(()=>gc(r.value)),d=q(()=>({width:`${u.value.width}px`,height:`${u.value.height}px`,top:`${u.value.y}px`,left:`${u.value.x}px`}));function f(e){t.selectionContextMenu({event:e,nodes:r.value})}function p(e){a||Gs[e.key]&&(e.preventDefault(),s({x:Gs[e.key].x,y:Gs[e.key].y},e.shiftKey))}return(e,t)=>!B(o)&&u.value.width&&u.value.height?(G(),P(`div`,{key:0,class:N([`vue-flow__nodesselection vue-flow__container`,B(i)]),style:R({transform:`translate(${B(n).x}px,${B(n).y}px) scale(${B(n).zoom})`})},[I(`div`,{ref_key:`el`,ref:c,class:N([{dragging:B(l)},`vue-flow__nodesselection-rect`]),style:R(d.value),tabIndex:B(a)?void 0:-1,onContextmenu:f,onKeydown:p},null,46,Gu)],6)):z(``,!0)}});function qu(e,t){return{x:e.clientX-t.left,y:e.clientY-t.top}}var Ju=V({name:`Pane`,compatConfig:{MODE:3},props:{isSelecting:{type:Boolean},selectionKeyPressed:{type:Boolean}},setup(e){let{vueFlowRef:t,nodes:n,viewport:r,emits:i,userSelectionActive:a,removeSelectedElements:o,userSelectionRect:s,elementsSelectable:c,nodesSelectionActive:l,getSelectedEdges:u,getSelectedNodes:d,removeNodes:f,removeEdges:p,selectionMode:m,deleteKeyCode:h,multiSelectionKeyCode:g,multiSelectionActive:_,edgeLookup:v,nodeLookup:y,connectionLookup:b,defaultEdgeOptions:x,connectionStartHandle:S}=Hu(),C=U(null),w=U(new Set),T=U(new Set),E=U(),D=de(()=>c.value&&(e.isSelecting||a.value)),O=de(()=>S.value!==null),k=!1,A=!1,j=Bs(h,{actInsideInputWithModifier:!1}),M=Bs(g);W(j,e=>{e&&(f(d.value),p(u.value),l.value=!1)}),W(M,e=>{_.value=e});function ee(e,t){return n=>{n.target===t&&e?.(n)}}function te(e){if(k||O.value){k=!1;return}i.paneClick(e),o(),l.value=!1}function ne(e){e.preventDefault(),e.stopPropagation(),i.paneContextMenu(e)}function re(e){i.paneScroll(e)}function F(n){var r,a;if(E.value=t.value?.getBoundingClientRect(),!c.value||!e.isSelecting||n.button!==0||n.target!==C.value||!E.value)return;(a=(r=n.target)?.setPointerCapture)==null||a.call(r,n.pointerId);let{x:l,y:u}=qu(n,E.value);A=!0,k=!1,o(),s.value={width:0,height:0,startX:l,startY:u,x:l,y:u},i.selectionStart(n)}function ie(e){if(!E.value||!s.value)return;k=!0;let{x:t,y:o}=el(e,E.value),{startX:c=0,startY:u=0}=s.value,d={startX:c,startY:u,x:t<c?t:c,y:o<u?o:u,width:Math.abs(t-c),height:Math.abs(o-u)},f=w.value,p=T.value;w.value=new Set(_c(n.value,d,r.value,m.value===Ds.Partial,!0).map(e=>e.id)),T.value=new Set;let h=x.value?.selectable??!0;for(let e of w.value){let t=b.value.get(e);if(t)for(let{edgeId:e}of t.values()){let t=v.value.get(e);t&&(t.selectable??h)&&T.value.add(e)}}if(!El(f,w.value)){let e=Fc(y.value,w.value,!0);i.nodesChange(e)}if(!El(p,T.value)){let e=Fc(v.value,T.value);i.edgesChange(e)}s.value=d,a.value=!0,l.value=!1}function ae(t){var n;t.button!==0||!A||((n=t.target)==null||n.releasePointerCapture(t.pointerId),!a.value&&s.value&&t.target===C.value&&te(t),a.value=!1,s.value=null,l.value=w.value.size>0,i.selectionEnd(t),e.selectionKeyPressed&&(k=!1),A=!1)}return(e,t)=>(G(),P(`div`,{ref_key:`container`,ref:C,class:N([`vue-flow__pane vue-flow__container`,{selection:e.isSelecting}]),onClick:t[0]||=e=>D.value?void 0:ee(te,C.value)(e),onContextmenu:t[1]||=e=>ee(ne,C.value)(e),onWheelPassive:t[2]||=e=>ee(re,C.value)(e),onPointerenter:t[3]||=e=>D.value?void 0:B(i).paneMouseEnter(e),onPointerdown:t[4]||=e=>D.value?F(e):B(i).paneMouseMove(e),onPointermove:t[5]||=e=>D.value?ie(e):B(i).paneMouseMove(e),onPointerup:t[6]||=e=>D.value?ae(e):void 0,onPointerleave:t[7]||=e=>B(i).paneMouseLeave(e)},[We(e.$slots,`default`),B(a)&&B(s)?(G(),L(Wu,{key:0,"user-selection-rect":B(s)},null,8,[`user-selection-rect`])):z(``,!0),B(l)&&B(d).length?(G(),L(Ku,{key:1})):z(``,!0)],34))}}),Yu=V({name:`Transform`,compatConfig:{MODE:3},setup(e){let{viewport:t,fitViewOnInit:n,fitViewOnInitDone:r}=Hu(),i=q(()=>n.value?!r.value:!1),a=q(()=>`translate(${t.value.x}px,${t.value.y}px) scale(${t.value.zoom})`);return(e,t)=>(G(),P(`div`,{class:`vue-flow__transformationpane vue-flow__container`,style:R({transform:a.value,opacity:i.value?0:void 0})},[We(e.$slots,`default`)],4))}}),Xu=V({name:`Viewport`,compatConfig:{MODE:3},setup(e){let{minZoom:t,maxZoom:n,defaultViewport:r,translateExtent:i,zoomActivationKeyCode:a,selectionKeyCode:o,panActivationKeyCode:s,panOnScroll:c,panOnScrollMode:l,panOnScrollSpeed:u,panOnDrag:d,zoomOnDoubleClick:f,zoomOnPinch:p,zoomOnScroll:m,preventScrolling:h,noWheelClassName:g,noPanClassName:_,emits:v,connectionStartHandle:y,userSelectionActive:b,paneDragging:x,d3Zoom:S,d3Selection:C,d3ZoomHandler:w,viewport:T,viewportRef:E,paneClickDistance:D}=Hu();Uu(E);let k=Qe(!1),A=Qe(!1),j=null,M=!1,ee=0,te={x:0,y:0,zoom:0},ne=Bs(s),re=Bs(o),F=Bs(a),ie=de(()=>(!re.value||re.value&&o.value===!0)&&(ne.value||d.value)),ae=de(()=>ne.value||c.value),I=de(()=>re.value||o.value===!0&&ie.value!==!0),oe=de(()=>y.value!==null);ce(()=>{if(!E.value){gl(`Viewport element is missing`);return}let e=E.value,a=e.getBoundingClientRect(),s=Es().clickDistance(D.value).scaleExtent([t.value,n.value]).translateExtent(i.value),y=Br(e).call(s),O=y.on(`wheel.zoom`),N=_s.translate(r.value.x??0,r.value.y??0).scale(Ys(r.value.zoom??1,t.value,n.value)),P=[[0,0],[a.width,a.height]],re=s.constrain()(N,P,i.value);s.transform(y,re),s.wheelDelta(Ec),S.value=s,C.value=y,w.value=O,T.value={x:re.x,y:re.y,zoom:re.k},s.on(`start`,e=>{if(!e.sourceEvent)return null;ee=e.sourceEvent.button,k.value=!0;let t=R(e.transform);e.sourceEvent?.type===`mousedown`&&(x.value=!0),te=t,v.viewportChangeStart(t),v.moveStart({event:e,flowTransform:t})}),s.on(`end`,e=>{if(!e.sourceEvent)return null;if(k.value=!1,x.value=!1,L(ie.value,ee??0)&&!M&&v.paneContextMenu(e.sourceEvent),M=!1,se(te,e.transform)){let t=R(e.transform);te=t,v.viewportChangeEnd(t),v.moveEnd({event:e,flowTransform:t})}}),s.filter(e=>{let t=F.value||m.value,n=p.value&&e.ctrlKey,r=e.button,i=e.type===`wheel`;if(r===1&&e.type===`mousedown`&&(z(e,`vue-flow__node`)||z(e,`vue-flow__edge`)))return!0;if(!ie.value&&!t&&!ae.value&&!f.value&&!p.value||b.value||oe.value&&!i||!f.value&&e.type===`dblclick`||z(e,g.value)&&i||z(e,_.value)&&(!i||ae.value&&i&&!F.value)||!p.value&&e.ctrlKey&&i||!t&&!ae.value&&!n&&i)return!1;if(!p&&e.type===`touchstart`&&e.touches?.length>1)return e.preventDefault(),!1;if(!ie.value&&(e.type===`mousedown`||e.type===`touchstart`)||o.value===!0&&Array.isArray(d.value)&&d.value.includes(0)&&r===0||Array.isArray(d.value)&&!d.value.includes(r)&&(e.type===`mousedown`||e.type===`touchstart`))return!1;let a=Array.isArray(d.value)&&d.value.includes(r)||o.value===!0&&Array.isArray(d.value)&&!d.value.includes(0)||!r||r<=1;return(!e.ctrlKey||ne.value||i)&&a}),W([b,ie],()=>{b.value&&!k.value?s.on(`zoom`,null):b.value||s.on(`zoom`,e=>{T.value={x:e.transform.x,y:e.transform.y,zoom:e.transform.k};let t=R(e.transform);M=L(ie.value,ee??0),v.viewportChange(t),v.move({event:e,flowTransform:t})})},{immediate:!0}),W([b,ae,l,F,p,h,g],()=>{ae.value&&!F.value&&!b.value?y.on(`wheel.zoom`,e=>{if(z(e,g.value))return!1;let t=F.value||m.value,n=p.value&&e.ctrlKey;if(!(!h.value||ae.value||t||n))return!1;e.preventDefault(),e.stopImmediatePropagation();let r=y.property(`__zoom`).k||1,i=tl();if(!ne.value&&e.ctrlKey&&p.value&&i){let t=Hr(e),n=Ec(e),i=r*2**n;s.scaleTo(y,i,t,e);return}let a=e.deltaMode===1?20:1,o=l.value===js.Vertical?0:e.deltaX*a,c=l.value===js.Horizontal?0:e.deltaY*a;!i&&e.shiftKey&&l.value!==js.Vertical&&!o&&c&&(o=c,c=0),s.translateBy(y,-(o/r)*u.value,-(c/r)*u.value);let d=R(y.property(`__zoom`));j&&clearTimeout(j),A.value?(v.move({event:e,flowTransform:d}),v.viewportChange(d),j=setTimeout(()=>{v.moveEnd({event:e,flowTransform:d}),v.viewportChangeEnd(d),A.value=!1},150)):(A.value=!0,v.moveStart({event:e,flowTransform:d}),v.viewportChangeStart(d))},{passive:!1}):O!==void 0&&y.on(`wheel.zoom`,function(e,t){let n=!h.value&&e.type===`wheel`&&!e.ctrlKey,r=F.value||m.value,i=p.value&&e.ctrlKey;if(!r&&!c.value&&!i&&e.type===`wheel`||n||z(e,g.value))return null;e.preventDefault(),O.call(this,e,t)},{passive:!1})},{immediate:!0})});function L(e,t){return t===2&&Array.isArray(e)&&e.includes(2)}function se(e,t){return e.x!==t.x&&!Number.isNaN(t.x)||e.y!==t.y&&!Number.isNaN(t.y)||e.zoom!==t.k&&!Number.isNaN(t.k)}function R(e){return{x:e.x,y:e.y,zoom:e.k}}function z(e,t){return e.target.closest(`.${t}`)}return(e,t)=>(G(),P(`div`,{ref_key:`viewportRef`,ref:E,class:`vue-flow__viewport vue-flow__container`},[O(Ju,{"is-selecting":I.value,"selection-key-pressed":B(re),class:N({connecting:oe.value,dragging:B(x),draggable:B(d)===!0||Array.isArray(B(d))&&B(d).includes(0)})},{default:Y(()=>[O(Yu,null,{default:Y(()=>[We(e.$slots,`default`)]),_:3})]),_:3},8,[`is-selecting`,`selection-key-pressed`,`class`])],512))}}),Zu=[`id`],Qu=[`id`],$u=[`id`],ed=V({name:`A11yDescriptions`,compatConfig:{MODE:3},setup(e){let{id:t,disableKeyboardA11y:n,ariaLiveMessage:r}=Hu();return(e,i)=>(G(),P(je,null,[I(`div`,{id:`${B(Vs)}-${B(t)}`,style:{display:`none`}},` Press enter or space to select a node. `+J(B(n)?``:`You can then use the arrow keys to move the node around.`)+` You can then use the arrow keys to move the node around, press delete to remove it and press escape to cancel. `,9,Zu),I(`div`,{id:`${B(Hs)}-${B(t)}`,style:{display:`none`}},` Press enter or space to select an edge. You can then press delete to remove it or press escape to cancel. `,8,Qu),B(n)?z(``,!0):(G(),P(`div`,{key:0,id:`${B(Us)}-${B(t)}`,"aria-live":`assertive`,"aria-atomic":`true`,style:{position:`absolute`,width:`1px`,height:`1px`,margin:`-1px`,border:`0`,padding:`0`,overflow:`hidden`,clip:`rect(0px, 0px, 0px, 0px)`,"clip-path":`inset(100%)`}},J(B(r)),9,$u))],64))}});function td(){let e=Hu();W(()=>e.viewportHelper.value.viewportInitialized,t=>{t&&setTimeout(()=>{e.emits.init(e),e.emits.paneReady(e)},1)})}function nd(e,t,n){return n===Q.Left?e-t:n===Q.Right?e+t:e}function rd(e,t,n){return n===Q.Top?e-t:n===Q.Bottom?e+t:e}var id=function({radius:e=10,centerX:t=0,centerY:n=0,position:r=Q.Top,type:i}){return H(`circle`,{class:`vue-flow__edgeupdater vue-flow__edgeupdater-${i}`,cx:nd(t,e,r),cy:rd(n,e,r),r:e,stroke:`transparent`,fill:`transparent`})};id.props=[`radius`,`centerX`,`centerY`,`position`,`type`],id.compatConfig={MODE:3};var ad=id,od=V({name:`Edge`,compatConfig:{MODE:3},props:[`id`],setup(e){let{id:t,addSelectedEdges:n,connectionMode:r,edgeUpdaterRadius:i,emits:a,nodesSelectionActive:o,noPanClassName:s,getEdgeTypes:c,removeSelectedEdges:l,findEdge:u,findNode:d,isValidConnection:f,multiSelectionActive:p,disableKeyboardA11y:m,elementsSelectable:h,edgesUpdatable:g,edgesFocusable:_,hooks:v}=Hu(),y=q(()=>u(e.id)),{emit:b,on:x}=Il(y.value,a),S=te(Nl),C=ne(),w=U(!1),T=U(!1),E=U(``),D=U(null),O=U(`source`),k=U(null),A=de(()=>y.value.selectable===void 0?h.value:y.value.selectable),j=de(()=>y.value.updatable===void 0?g.value:y.value.updatable),M=de(()=>y.value.focusable===void 0?_.value:y.value.focusable);qe(jl,e.id),qe(Ml,k);let ee=q(()=>y.value.class instanceof Function?y.value.class(y.value):y.value.class),N=q(()=>y.value.style instanceof Function?y.value.style(y.value):y.value.style),P=q(()=>{let e=y.value.type||`default`,t=S?.[`edge-${e}`];if(t)return t;let n=y.value.template??c.value[e];if(typeof n==`string`&&C){let t=Object.keys(C.appContext.components);t&&t.includes(e)&&(n=K(e,!1))}return n&&typeof n!=`string`?n:(a.error(new Zc(Yc.EDGE_TYPE_MISSING,n)),!1)}),{handlePointerDown:re}=zl({nodeId:E,handleId:D,type:O,isValidConnection:f,edgeUpdaterType:O,onEdgeUpdate:ae,onEdgeUpdateEnd:I});return()=>{let n=d(y.value.source),o=d(y.value.target),l=`pathOptions`in y.value?y.value.pathOptions:{};if(!n&&!o)return a.error(new Zc(Yc.EDGE_SOURCE_TARGET_MISSING,y.value.id,y.value.source,y.value.target)),null;if(!n)return a.error(new Zc(Yc.EDGE_SOURCE_MISSING,y.value.id,y.value.source)),null;if(!o)return a.error(new Zc(Yc.EDGE_TARGET_MISSING,y.value.id,y.value.target)),null;if(!y.value||y.value.hidden||n.hidden||o.hidden)return null;let u;u=r.value===ks.Strict?n.handleBounds.source:[...n.handleBounds.source||[],...n.handleBounds.target||[]];let f=Kc(u,y.value.sourceHandle),p;p=r.value===ks.Strict?o.handleBounds.target:[...o.handleBounds.target||[],...o.handleBounds.source||[]];let m=Kc(p,y.value.targetHandle),h=f?.position||Q.Bottom,g=m?.position||Q.Top,{x:_,y:b}=Gc(n,f,h),{x:S,y:C}=Gc(o,m,g);return y.value.sourceX=_,y.value.sourceY=b,y.value.targetX=S,y.value.targetY=C,H(`g`,{ref:k,key:e.id,"data-id":e.id,class:[`vue-flow__edge`,`vue-flow__edge-${P.value===!1?`default`:y.value.type||`default`}`,s.value,ee.value,{updating:w.value,selected:y.value.selected,animated:y.value.animated,inactive:!A.value&&!v.value.edgeClick.hasListeners()}],tabIndex:M.value?0:void 0,"aria-label":y.value.ariaLabel===null?void 0:y.value.ariaLabel??`Edge from ${y.value.source} to ${y.value.target}`,"aria-describedby":M.value?`${Hs}-${t}`:void 0,"aria-roledescription":`edge`,role:M.value?`group`:`img`,...y.value.domAttributes,onClick:L,onContextmenu:se,onDblclick:R,onMouseenter:z,onMousemove:ce,onMouseleave:le,onKeyDown:M.value?B:void 0},[T.value?null:H(P.value===!1?c.value.default:P.value,{id:e.id,sourceNode:n,targetNode:o,source:y.value.source,target:y.value.target,type:y.value.type,updatable:j.value,selected:y.value.selected,animated:y.value.animated,label:y.value.label,labelStyle:y.value.labelStyle,labelShowBg:y.value.labelShowBg,labelBgStyle:y.value.labelBgStyle,labelBgPadding:y.value.labelBgPadding,labelBgBorderRadius:y.value.labelBgBorderRadius,data:y.value.data,events:{...y.value.events,...x},style:N.value,markerStart:`url('#${Tc(y.value.markerStart,t)}')`,markerEnd:`url('#${Tc(y.value.markerEnd,t)}')`,sourcePosition:h,targetPosition:g,sourceX:_,sourceY:b,targetX:S,targetY:C,sourceHandleId:y.value.sourceHandle,targetHandleId:y.value.targetHandle,interactionWidth:y.value.interactionWidth,...l}),[j.value===`source`||j.value===!0?[H(`g`,{onMousedown:ue,onMouseenter:F,onMouseout:ie},H(ad,{position:h,centerX:_,centerY:b,radius:i.value,type:`source`,"data-type":`source`}))]:null,j.value===`target`||j.value===!0?[H(`g`,{onMousedown:fe,onMouseenter:F,onMouseout:ie},H(ad,{position:g,centerX:S,centerY:C,radius:i.value,type:`target`,"data-type":`target`}))]:null]])};function F(){w.value=!0}function ie(){w.value=!1}function ae(e,t){b.update({event:e,edge:y.value,connection:t})}function I(e){b.updateEnd({event:e,edge:y.value}),T.value=!1}function oe(e,t){e.button===0&&(T.value=!0,E.value=t?y.value.target:y.value.source,D.value=(t?y.value.targetHandle:y.value.sourceHandle)??null,O.value=t?`target`:`source`,b.updateStart({event:e,edge:y.value}),re(e))}function L(e){var t;let r={event:e,edge:y.value};A.value&&(o.value=!1,y.value.selected&&p.value?(l([y.value]),(t=k.value)==null||t.blur()):n([y.value])),b.click(r)}function se(e){b.contextMenu({event:e,edge:y.value})}function R(e){b.doubleClick({event:e,edge:y.value})}function z(e){b.mouseEnter({event:e,edge:y.value})}function ce(e){b.mouseMove({event:e,edge:y.value})}function le(e){b.mouseLeave({event:e,edge:y.value})}function ue(e){oe(e,!0)}function fe(e){oe(e,!1)}function B(t){var r;!m.value&&Ws.includes(t.key)&&A.value&&(t.key===`Escape`?((r=k.value)==null||r.blur(),l([u(e.id)])):n([u(e.id)]))}}}),sd=V({name:`ConnectionLine`,compatConfig:{MODE:3},setup(){let{id:e,connectionMode:t,connectionStartHandle:n,connectionEndHandle:r,connectionPosition:i,connectionLineType:a,connectionLineStyle:o,connectionLineOptions:s,connectionStatus:c,viewport:l,findNode:u}=Hu(),d=te(Nl)?.[`connection-line`],f=q(()=>u(n.value?.nodeId)),p=q(()=>u(r.value?.nodeId)??null),m=q(()=>({x:(i.value.x-l.value.x)/l.value.zoom,y:(i.value.y-l.value.y)/l.value.zoom})),h=q(()=>s.value.markerStart?`url(#${Tc(s.value.markerStart,e)})`:``),g=q(()=>s.value.markerEnd?`url(#${Tc(s.value.markerEnd,e)})`:``);return()=>{if(!f.value||!n.value)return null;let e=n.value.id,i=n.value.type,l=f.value.handleBounds,u=l?.[i]??[];if(t.value===ks.Loose){let e=l?.[i===`source`?`target`:`source`]??[];u=[...u,...e]}if(!u)return null;let _=(e?u.find(t=>t.id===e):u[0])??null,v=_?.position??Q.Top,{x:y,y:b}=Gc(f.value,_,v),x=null;p.value&&(x=t.value===ks.Strict?p.value.handleBounds[i===`source`?`target`:`source`]?.find(e=>e.id===r.value?.id)||null:[...p.value.handleBounds.source??[],...p.value.handleBounds.target??[]]?.find(e=>e.id===r.value?.id)||null);let S=r.value?.position??(v?ml[v]:null);if(!v||!S)return null;let C=a.value??s.value.type??Os.Bezier,w=``,T={sourceX:y,sourceY:b,sourcePosition:v,targetX:m.value.x,targetY:m.value.y,targetPosition:S};return C===Os.Bezier?[w]=Cu(T):C===Os.Step?[w]=ju({...T,borderRadius:0}):C===Os.SmoothStep?[w]=ju(T):C===Os.SimpleBezier?[w]=Tu(T):w=`M${y},${b} ${m.value.x},${m.value.y}`,H(`svg`,{class:`vue-flow__edges vue-flow__connectionline vue-flow__container`},H(`g`,{class:`vue-flow__connection`},d?H(d,{sourceX:y,sourceY:b,sourcePosition:v,targetX:m.value.x,targetY:m.value.y,targetPosition:S,sourceNode:f.value,sourceHandle:_,targetNode:p.value,targetHandle:x,markerEnd:g.value,markerStart:h.value,connectionStatus:c.value}):H(`path`,{d:w,class:[s.value.class,c.value,`vue-flow__connection-path`],style:{...o.value,...s.value.style},"marker-end":g.value,"marker-start":h.value})))}}}),cd=[`id`,`markerWidth`,`markerHeight`,`markerUnits`,`orient`],ld=V({name:`MarkerType`,compatConfig:{MODE:3},props:{id:{},type:{},color:{default:`none`},width:{default:12.5},height:{default:12.5},markerUnits:{default:`strokeWidth`},orient:{default:`auto-start-reverse`},strokeWidth:{default:1}},setup(e){return(e,t)=>(G(),P(`marker`,{id:e.id,class:`vue-flow__arrowhead`,viewBox:`-10 -10 20 20`,refX:`0`,refY:`0`,markerWidth:`${e.width}`,markerHeight:`${e.height}`,markerUnits:e.markerUnits,orient:e.orient},[e.type===B(As).ArrowClosed?(G(),P(`polyline`,{key:0,style:R({stroke:e.color,fill:e.color,strokeWidth:e.strokeWidth}),"stroke-linecap":`round`,"stroke-linejoin":`round`,points:`-5,-4 0,0 -5,4 -5,-4`},null,4)):z(``,!0),e.type===B(As).Arrow?(G(),P(`polyline`,{key:1,style:R({stroke:e.color,strokeWidth:e.strokeWidth}),"stroke-linecap":`round`,"stroke-linejoin":`round`,fill:`none`,points:`-5,-4 0,0 -5,4`},null,4)):z(``,!0)],8,cd))}}),ud={class:`vue-flow__marker vue-flow__container`,"aria-hidden":`true`},dd=V({name:`MarkerDefinitions`,compatConfig:{MODE:3},setup(e){let{id:t,edges:n,connectionLineOptions:r,defaultMarkerColor:i}=Hu(),a=q(()=>{let e=new Set,a=[],o=n=>{if(n){let r=Tc(n,t);e.has(r)||(typeof n==`object`?a.push({...n,id:r,color:n.color||i.value}):a.push({id:r,color:i.value,type:n}),e.add(r))}};for(let e of[r.value.markerEnd,r.value.markerStart])o(e);for(let e of n.value)for(let t of[e.markerStart,e.markerEnd])o(t);return a.sort((e,t)=>e.id.localeCompare(t.id))});return(e,t)=>(G(),P(`svg`,ud,[I(`defs`,null,[(G(!0),P(je,null,Le(a.value,e=>(G(),L(ld,{id:e.id,key:e.id,type:e.type,color:e.color,width:e.width,height:e.height,markerUnits:e.markerUnits,"stroke-width":e.strokeWidth,orient:e.orient},null,8,[`id`,`type`,`color`,`width`,`height`,`markerUnits`,`stroke-width`,`orient`]))),128))])]))}}),fd=V({name:`Edges`,compatConfig:{MODE:3},setup(e){let{findNode:t,getEdges:n,elevateEdgesOnSelect:r}=Hu();return(e,i)=>(G(),P(je,null,[O(dd),(G(!0),P(je,null,Le(B(n),e=>(G(),P(`svg`,{key:e.id,class:`vue-flow__edges vue-flow__container`,style:R({zIndex:B(Jc)(e,B(t),B(r))})},[O(B(od),{id:e.id},null,8,[`id`])],4))),128)),O(B(sd))],64))}}),pd=V({name:`Node`,compatConfig:{MODE:3},props:[`id`,`resizeObserver`],setup(e){let{id:t,noPanClassName:n,selectNodesOnDrag:r,nodesSelectionActive:i,multiSelectionActive:a,emits:o,removeSelectedNodes:s,addSelectedNodes:c,updateNodeDimensions:l,onUpdateNodeInternals:u,getNodeTypes:d,nodeExtent:f,elevateNodesOnSelect:p,disableKeyboardA11y:m,ariaLiveMessage:h,snapToGrid:g,snapGrid:_,nodeDragThreshold:v,nodesDraggable:y,elementsSelectable:b,nodesConnectable:x,nodesFocusable:S,hooks:C}=Hu(),w=U(null);qe(Al,w),qe(kl,e.id);let T=te(Nl),E=ne(),D=Wl(),{node:O,parentNode:k}=Vl(e.id),{emit:A,on:j}=Ul(O,o),M=de(()=>O.draggable===void 0?y.value:O.draggable),ee=de(()=>O.selectable===void 0?b.value:O.selectable),N=de(()=>O.connectable===void 0?x.value:O.connectable),P=de(()=>O.focusable===void 0?S.value:O.focusable),re=q(()=>ee.value||M.value||C.value.nodeClick.hasListeners()||C.value.nodeDoubleClick.hasListeners()||C.value.nodeMouseEnter.hasListeners()||C.value.nodeMouseMove.hasListeners()||C.value.nodeMouseLeave.hasListeners()),ie=de(()=>!!O.dimensions.width&&!!O.dimensions.height),ae=q(()=>{let e=O.type||`default`,t=T?.[`node-${e}`];if(t)return t;let n=O.template||d.value[e];if(typeof n==`string`&&E){let t=Object.keys(E.appContext.components);t&&t.includes(e)&&(n=K(e,!1))}return n&&typeof n!=`string`?n:(o.error(new Zc(Yc.NODE_TYPE_MISSING,n)),!1)}),I=Pl({id:e.id,el:w,disabled:()=>!M.value,selectable:ee,dragHandle:()=>O.dragHandle,onStart(e){A.dragStart(e)},onDrag(e){A.drag(e)},onStop(e){A.dragStop(e)},onClick(e){V(e)}}),oe=q(()=>O.class instanceof Function?O.class(O):O.class),L=q(()=>{let e=(O.style instanceof Function?O.style(O):O.style)||{},t=O.width instanceof Function?O.width(O):O.width,n=O.height instanceof Function?O.height(O):O.height;return!e.width&&t&&(e.width=typeof t==`string`?t:`${t}px`),!e.height&&n&&(e.height=typeof n==`string`?n:`${n}px`),e}),se=de(()=>Number(O.zIndex??L.value.zIndex??0));return u(t=>{(t.includes(e.id)||!t.length)&&z()}),ce(()=>{W(()=>O.hidden,(t=!1,n,r)=>{!t&&w.value&&(e.resizeObserver.observe(w.value),r(()=>{w.value&&e.resizeObserver.unobserve(w.value)}))},{immediate:!0,flush:`post`})}),W([()=>O.type,()=>O.sourcePosition,()=>O.targetPosition],()=>{F(()=>{l([{id:e.id,nodeElement:w.value,forceUpdate:!0}])})}),W([()=>O.position.x,()=>O.position.y,()=>k.value?.computedPosition.x,()=>k.value?.computedPosition.y,()=>k.value?.computedPosition.z,se,()=>O.selected,()=>O.dimensions.height,()=>O.dimensions.width,()=>k.value?.dimensions.height,()=>k.value?.dimensions.width],([e,t,n,r,i,a])=>{let o={x:e,y:t,z:a+(p.value&&O.selected?1e3:0)};n!==void 0&&r!==void 0?O.computedPosition=Cc({x:n,y:r,z:i},o):O.computedPosition=o},{flush:`post`,immediate:!0}),W([()=>O.extent,f],([e,t],[n,r])=>{(e!==n||t!==r)&&R()}),O.extent===`parent`||typeof O.extent==`object`&&`range`in O.extent&&O.extent.range===`parent`?Et(()=>ie).toBe(!0).then(R):R(),()=>O.hidden?null:H(`div`,{ref:w,"data-id":O.id,class:[`vue-flow__node`,`vue-flow__node-${ae.value===!1?`default`:O.type||`default`}`,{[n.value]:M.value,dragging:I?.value,draggable:M.value,selected:O.selected,selectable:ee.value,parent:O.isParent},oe.value],style:{visibility:ie.value?`visible`:`hidden`,zIndex:O.computedPosition.z??se.value,transform:`translate(${O.computedPosition.x}px,${O.computedPosition.y}px)`,pointerEvents:re.value?`all`:`none`,...L.value},tabIndex:P.value?0:void 0,role:P.value?`group`:void 0,"aria-describedby":m.value?void 0:`${Vs}-${t}`,"aria-label":O.ariaLabel,"aria-roledescription":`node`,...O.domAttributes,onMouseenter:le,onMousemove:ue,onMouseleave:fe,onContextmenu:B,onClick:V,onDblclick:pe,onKeydown:me},[H(ae.value===!1?d.value.default:ae.value,{id:O.id,type:O.type,data:O.data,events:{...O.events,...j},selected:O.selected,resizing:O.resizing,dragging:I.value,connectable:N.value,position:O.computedPosition,dimensions:O.dimensions,isValidTargetPos:O.isValidTargetPos,isValidSourcePos:O.isValidSourcePos,parent:O.parentNode,parentNodeId:O.parentNode,zIndex:O.computedPosition.z??se.value,targetPosition:O.targetPosition,sourcePosition:O.sourcePosition,label:O.label,dragHandle:O.dragHandle,onUpdateNodeInternals:z})]);function R(){let e=O.computedPosition,{computedPosition:t,position:n}=Wc(O,g.value?rl(e,_.value):e,o.error,f.value,k.value);(O.computedPosition.x!==t.x||O.computedPosition.y!==t.y)&&(O.computedPosition={...O.computedPosition,...t}),(O.position.x!==n.x||O.position.y!==n.y)&&(O.position=n)}function z(){w.value&&l([{id:e.id,nodeElement:w.value,forceUpdate:!0}])}function le(e){I?.value||A.mouseEnter({event:e,node:O})}function ue(e){I?.value||A.mouseMove({event:e,node:O})}function fe(e){I?.value||A.mouseLeave({event:e,node:O})}function B(e){return A.contextMenu({event:e,node:O})}function pe(e){return A.doubleClick({event:e,node:O})}function V(e){ee.value&&(!r.value||!M.value||v.value>0)&&yl(O,a.value,c,s,i,!1,w.value),A.click({event:e,node:O})}function me(e){if(!(Fs(e)||m.value))if(Ws.includes(e.key)&&ee.value){let t=e.key===`Escape`;yl(O,a.value,c,s,i,t,w.value)}else M.value&&O.selected&&Gs[e.key]&&(e.preventDefault(),h.value=`Moved selected node ${e.key.replace(`Arrow`,``).toLowerCase()}. New position, x: ${~~O.position.x}, y: ${~~O.position.y}`,D({x:Gs[e.key].x,y:Gs[e.key].y},e.shiftKey))}}});function md(e={includeHiddenNodes:!1}){let{nodes:t}=Hu();return q(()=>{if(t.value.length===0)return!1;for(let n of t.value)if((e.includeHiddenNodes||!n.hidden)&&(n?.handleBounds===void 0||n.dimensions.width===0||n.dimensions.height===0))return!1;return!0})}var hd={class:`vue-flow__nodes vue-flow__container`},gd=V({name:`Nodes`,compatConfig:{MODE:3},setup(e){let{getNodes:t,updateNodeDimensions:n,emits:r}=Hu(),i=md(),a=U();return W(i,e=>{e&&F(()=>{r.nodesInitialized(t.value)})},{immediate:!0}),ce(()=>{a.value=new ResizeObserver(e=>{let t=e.map(e=>({id:e.target.getAttribute(`data-id`),nodeElement:e.target,forceUpdate:!0}));F(()=>n(t))})}),me(()=>a.value?.disconnect()),(e,n)=>(G(),P(`div`,hd,[a.value?(G(!0),P(je,{key:0},Le(B(t),(e,t,n,r)=>{let i=[e.id];if(r&&r.key===e.id&&ie(r,i))return r;let o=(G(),L(B(pd),{id:e.id,key:e.id,"resize-observer":a.value},null,8,[`id`,`resize-observer`]));return o.memo=i,o},n,0),128)):z(``,!0)]))}});function _d(){let{emits:e}=Hu();ce(()=>{if(_l()){let t=document.querySelector(`.vue-flow__pane`);t&&window.getComputedStyle(t).zIndex!==`1`&&e.error(new Zc(Yc.MISSING_STYLES))}})}var vd=I(`div`,{class:`vue-flow__edge-labels`},null,-1),yd=V({name:`VueFlow`,compatConfig:{MODE:3},props:{id:{},modelValue:{},nodes:{},edges:{},edgeTypes:{},nodeTypes:{},connectionMode:{},connectionLineType:{},connectionLineStyle:{default:void 0},connectionLineOptions:{default:void 0},connectionRadius:{},isValidConnection:{type:[Function,null],default:void 0},deleteKeyCode:{default:void 0},selectionKeyCode:{type:[Boolean,null],default:void 0},multiSelectionKeyCode:{default:void 0},zoomActivationKeyCode:{default:void 0},panActivationKeyCode:{default:void 0},snapToGrid:{type:Boolean,default:void 0},snapGrid:{},onlyRenderVisibleElements:{type:Boolean,default:void 0},edgesUpdatable:{type:[Boolean,String],default:void 0},nodesDraggable:{type:Boolean,default:void 0},nodesConnectable:{type:Boolean,default:void 0},nodeDragThreshold:{},elementsSelectable:{type:Boolean,default:void 0},selectNodesOnDrag:{type:Boolean,default:void 0},panOnDrag:{type:[Boolean,Array],default:void 0},minZoom:{},maxZoom:{},defaultViewport:{},translateExtent:{},nodeExtent:{},defaultMarkerColor:{},zoomOnScroll:{type:Boolean,default:void 0},zoomOnPinch:{type:Boolean,default:void 0},panOnScroll:{type:Boolean,default:void 0},panOnScrollSpeed:{},panOnScrollMode:{},paneClickDistance:{},zoomOnDoubleClick:{type:Boolean,default:void 0},preventScrolling:{type:Boolean,default:void 0},selectionMode:{},edgeUpdaterRadius:{},fitViewOnInit:{type:Boolean,default:void 0},connectOnClick:{type:Boolean,default:void 0},applyDefault:{type:Boolean,default:void 0},autoConnect:{type:[Boolean,Function],default:void 0},noDragClassName:{},noWheelClassName:{},noPanClassName:{},defaultEdgeOptions:{},elevateEdgesOnSelect:{type:Boolean,default:void 0},elevateNodesOnSelect:{type:Boolean,default:void 0},disableKeyboardA11y:{type:Boolean,default:void 0},edgesFocusable:{type:Boolean,default:void 0},nodesFocusable:{type:Boolean,default:void 0},autoPanOnConnect:{type:Boolean,default:void 0},autoPanOnNodeDrag:{type:Boolean,default:void 0},autoPanSpeed:{}},emits:`nodesChange.edgesChange.nodesInitialized.paneReady.init.updateNodeInternals.error.connect.connectStart.connectEnd.clickConnectStart.clickConnectEnd.moveStart.move.moveEnd.selectionDragStart.selectionDrag.selectionDragStop.selectionContextMenu.selectionStart.selectionEnd.viewportChangeStart.viewportChange.viewportChangeEnd.paneScroll.paneClick.paneContextMenu.paneMouseEnter.paneMouseMove.paneMouseLeave.edgeUpdate.edgeContextMenu.edgeMouseEnter.edgeMouseMove.edgeMouseLeave.edgeDoubleClick.edgeClick.edgeUpdateStart.edgeUpdateEnd.nodeContextMenu.nodeMouseEnter.nodeMouseMove.nodeMouseLeave.nodeDoubleClick.nodeClick.nodeDragStart.nodeDrag.nodeDragStop.miniMapNodeClick.miniMapNodeDoubleClick.miniMapNodeMouseEnter.miniMapNodeMouseMove.miniMapNodeMouseLeave.update:modelValue.update:nodes.update:edges`.split(`.`),setup(e,{expose:t,emit:n}){let r=e,i=Ke(),a=Nt(r,`modelValue`,n),o=Nt(r,`nodes`,n),s=Nt(r,`edges`,n),c=Hu(r),l=Zl({modelValue:a,nodes:o,edges:s},r,c);return $l(n,c.hooks),td(),_d(),qe(Nl,i),T(l),t(c),(e,t)=>(G(),P(`div`,{ref:B(c).vueFlowRef,class:`vue-flow`},[O(Xu,null,{default:Y(()=>[O(fd),vd,O(gd),We(e.$slots,`zoom-pane`)]),_:3}),We(e.$slots,`default`),O(ed)],512))}}),bd=V({name:`Panel`,compatConfig:{MODE:3},props:{position:{}},setup(e){let t=e,{userSelectionActive:n}=Hu(),r=q(()=>`${t.position}`.split(`-`));return(e,t)=>(G(),P(`div`,{class:N([`vue-flow__panel`,r.value]),style:R({pointerEvents:B(n)?`none`:`all`})},[We(e.$slots,`default`)],6))}});function xd(){let{connectionStartHandle:e,connectionEndHandle:t,connectionStatus:n,connectionPosition:r}=Hu();return{startHandle:e,endHandle:t,status:n,position:r}}const Sd={ellipse:`node-port--ellipse`,circle:`node-port--circle`};function Cd(e,t,n){let r=e.replace(/\s+/g,``),i=new Set(t.filter(e=>!n||e.id!==n).map(e=>e.data?.label).filter(e=>!!e)),a=r.match(/^(.+?)_(\d+)$/),o,s;if(a?(o=a[1],s=parseInt(a[2],10)):(o=r,s=0),!i.has(r))return r;let c=o.replace(/[.*+?^${}()|[\]\\]/g,`\\$&`),l=RegExp(`^${c}_?(\\d+)?$`),u=s;return i.forEach(e=>{let t=e.match(l);if(t){if(e===o)u=Math.max(u,0);else if(t[1]){let e=parseInt(t[1],10);u=Math.max(u,e)}}}),`${o}_${u+1}`}function wd(e){let n=null,r=0,i=[];function a(e){if(e.length===0)return{x:0,y:0};let t=e.reduce((e,t)=>({x:e.x+t.position.x,y:e.y+t.position.y}),{x:0,y:0});return{x:t.x/e.length,y:t.y/e.length}}function o(e){let t=e.vueflow.getSelectedNodes?.value??[];if(t.length===0){console.log(`[CopyPaste Plugin] `);return}let i=new Set(t.map(e=>e.id)),o=(e.core.edges.value||[]).filter(e=>i.has(e.source)&&i.has(e.target)),s=a(t);n={nodes:JSON.parse(JSON.stringify(t)),edges:JSON.parse(JSON.stringify(o)),timestamp:Date.now(),center:s},r=0,console.log(`[CopyPaste Plugin]  ${t.length}  ${o.length} `)}function s(e){if(!n||n.nodes.length===0){console.log(`[CopyPaste Plugin] `);return}r+=30;let t=r,i=[],a=new Map;n.nodes.forEach(n=>{let r=`node-${Date.now()}-${Math.random().toString(36).substr(2,9)}`;a.set(n.id,r);let o=n.data?.label||``,s=Cd(o,e.core.nodes.value),c={...n,id:r,position:{x:n.position.x+t,y:n.position.y+t},data:{...n.data,label:s}};e.core.addNode(c),i.push(r)});let o=[];n.edges.forEach(t=>{let n=`edge-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,r={...t,id:n,source:a.get(t.source)||t.source,target:a.get(t.target)||t.target};e.core.addEdge(r),o.push(n)});let{removeSelectedElements:s,addSelectedNodes:c,nodesSelectionActive:l}=e.vueflow;s?.(),F(()=>{let t=e.core.nodes.value.filter(e=>i.includes(e.id));t.length>0&&(c?.(t),t.length>1&&l&&(l.value=!0))}),console.log(`[CopyPaste Plugin]  ${i.length}  ${o.length}  (: ${t}px)`)}function c(e){let t=e.vueflow.getSelectedNodes?.value??[];if(t.length===0){console.log(`[CopyPaste Plugin] `);return}o(e),t.forEach(t=>{e.core.deleteNode(t.id)}),console.log(`[CopyPaste Plugin] `)}return{config:{id:`copy-paste`,name:``,description:``,enabled:!0,version:`1.0.0`},shortcuts:[{key:`ctrl+c`,description:``,handler:e=>o(e)},{key:`ctrl+v`,description:``,handler:e=>s(e)},{key:`ctrl+x`,description:``,handler:e=>c(e)}],setup(n){let{enableShortcut:r}=e;i.push(t(`c`,e=>{r.value&&(e.ctrlKey||e.metaKey)&&(e.preventDefault(),o(n))},{dedupe:!1})),i.push(t(`v`,e=>{r.value&&(e.ctrlKey||e.metaKey)&&(e.preventDefault(),s(n))},{dedupe:!1})),i.push(t(`x`,e=>{r.value&&(e.ctrlKey||e.metaKey)&&(e.preventDefault(),c(n))},{dedupe:!1})),console.log(`[CopyPaste Plugin] `),console.log(`[CopyPaste Plugin] : Ctrl+C (), Ctrl+V (), Ctrl+X ()`)},cleanup(){i.forEach(e=>e()),i.length=0,n=null,r=0,console.log(`[CopyPaste Plugin] `)}}}function Td(){let e=[];function t(e,t){e.core.updateEdges(e=>e.map(e=>({...e,type:`custom`,edgeType:t.value.edgeType,animated:t.value.edgeAnimation,style:{...e.style,stroke:t.value.edgeColor,strokeWidth:t.value.edgeWidth}}))),console.log(`[ConfigSync Plugin] `)}return{config:{id:`config-sync`,name:``,description:``,enabled:!0,version:`1.0.0`},setup(n){console.log(`[ConfigSync Plugin] `);let r=w(),{config:i}=Ze(r),a=W(()=>[i.value.edgeType,i.value.edgeWidth,i.value.edgeColor,i.value.edgeAnimation],()=>{t(n,i)},{immediate:!1});e.push(a)},cleanup(){console.log(`[ConfigSync Plugin] `),e.forEach(e=>e()),e=[]}}}var Ed=`canvas-view-state`,Dd=`v2`;function Od(){let e=[],t=null,n=null;async function i(e){try{let t={lastNodeResults:e.lastNodeResults,timestamp:Date.now()};await a().cache.save(Ed,t,{namespace:Dd}),console.log(`[CanvasPersistence Plugin] `)}catch(e){console.error(`[CanvasPersistence Plugin] :`,e)}}async function o(e){try{let t=await a().cache.read(Ed,{namespace:Dd});return t?(t.lastNodeResults&&Array.isArray(t.lastNodeResults)&&(e.lastNodeResults=t.lastNodeResults),console.log(`[CanvasPersistence Plugin]  (${t.lastNodeResults?.length||0} )`),!0):(console.log(`[CanvasPersistence Plugin] `),!1)}catch(e){return console.error(`[CanvasPersistence Plugin] :`,e),!1}}function s(e){t!==null&&clearTimeout(t),t=window.setTimeout(()=>{i(e),t=null},500)}return{config:{id:`canvas-persistence`,name:`Canvas `,description:` localStorage workflowStore `,enabled:!0,version:`2.0.0`},setup(c){console.log(`[CanvasPersistence Plugin] `);let l=r(),u=`canvas-state`;(async()=>{let e=a();await e.cache.read(u,{namespace:Dd})!==void 0&&(console.log(`[CanvasPersistence Plugin] `),await e.cache.remove(u,{namespace:Dd}))})(),o(l);let d=W(()=>l.lastNodeResults.length,()=>{s(l)});e.push(d),n=e=>{t!==null&&(clearTimeout(t),t=null),i(l),console.log(`[CanvasPersistence Plugin] `)},window.addEventListener(`beforeunload`,n)},cleanup(r){console.log(`[CanvasPersistence Plugin] `),t!==null&&(clearTimeout(t),t=null),n&&=(window.removeEventListener(`beforeunload`,n),null),e.forEach(e=>e()),e=[]},hooks:{onInstall(e){console.log(`[CanvasPersistence Plugin] `)},onUninstall(e){console.log(`[CanvasPersistence Plugin] `);let t=r();i(t)}}}}function kd(){let e=null,t=null;return{config:{id:`multi-select`,name:``,description:` Shift `,enabled:!0,version:`1.0.0`},shortcuts:[{key:`shift+click`,description:` Shift `,handler:()=>{}}],setup(n){let r=S().Shift,{multiSelectionActive:i,nodesSelectionActive:a,getSelectedNodes:o}=n.vueflow;e=W(r,e=>{i&&(i.value=!!e,console.log(`[MultiSelect Plugin] Shift ${e?``:``}${e?``:``}`))}),t=W(()=>(o?.value??[]).length,e=>{a&&(a.value=e>1)}),console.log(`[MultiSelect Plugin] `),console.log(`[MultiSelect Plugin] :  Shift /`)},cleanup(){e?.(),t?.(),e=null,t=null,console.log(`[MultiSelect Plugin] `)}}}function Ad(e){if(!(e instanceof HTMLElement))return!1;let t=e.tagName;if(t===`INPUT`||t===`TEXTAREA`||e.isContentEditable)return!0;let n=e.getAttribute(`role`);return n===`textbox`||n===`combobox`||n===`searchbox`?!0:!!e.closest(`[contenteditable="true"]`)}function jd(){let e=document.activeElement;return e?!Ad(e):!0}function Md(){let e=U([]),t=U(-1),r=!1,i=null,a=q(()=>t.value>0),o=q(()=>t.value<e.value.length-1);function s(e,t){return{nodes:JSON.parse(JSON.stringify(e)),edges:JSON.parse(JSON.stringify(t)),timestamp:Date.now()}}function c(n,i){if(r)return;e.value=e.value.slice(0,t.value+1);let a=s(n,i);e.value.push(a),e.value.length>50?e.value.shift():t.value++,console.log(`[History Plugin]  (${t.value+1}/${e.value.length})`)}function l(n){if(!a.value)return;t.value--;let i=e.value[t.value];i&&(r=!0,n.core.nodes.value=JSON.parse(JSON.stringify(i.nodes)),n.core.edges.value=JSON.parse(JSON.stringify(i.edges)),console.log(`[History Plugin]  ${t.value+1}/${e.value.length}`),setTimeout(()=>{r=!1},100))}function u(n){if(!o.value)return;t.value++;let i=e.value[t.value];i&&(r=!0,n.core.nodes.value=JSON.parse(JSON.stringify(i.nodes)),n.core.edges.value=JSON.parse(JSON.stringify(i.edges)),console.log(`[History Plugin]  ${t.value+1}/${e.value.length}`),setTimeout(()=>{r=!1},100))}function d(n,i){r=!0,e.value=[s(n,i)],t.value=0,console.log(`[History Plugin] `),setTimeout(()=>{r=!1},100)}return{config:{id:`history`,name:``,description:`/ (Ctrl+Z / Ctrl+Y)`,enabled:!0,version:`1.0.0`},shortcuts:[{key:`ctrl+z`,description:``,handler:()=>{}},{key:`ctrl+y`,description:``,handler:()=>{}},{key:`ctrl+shift+z`,description:``,handler:()=>{}}],setup(s){d(s.core.nodes.value,s.core.edges.value);let f=S(),p=f[`Ctrl+Z`],m=f[`Ctrl+Y`],h=f[`Ctrl+Shift+Z`],g=f.Shift,_=n(p,()=>{g.value||jd()&&a.value&&l(s)}),v=n(m,()=>{jd()&&o.value&&u(s)}),y=n(h,()=>{jd()&&o.value&&u(s)});s.core.events&&(s.core.events.on(`history:undo`,()=>{a.value&&l(s)}),s.core.events.on(`history:redo`,()=>{o.value&&u(s)}),s.core.events.on(`workflow:switched`,e=>{console.log(`[History Plugin] ${e.previousWorkflowId}  ${e.workflowId}`),d(s.core.nodes.value,s.core.edges.value)}));let b=()=>{r||(i&&clearTimeout(i),i=setTimeout(()=>{c(s.core.nodes.value,s.core.edges.value)},300))},x=W(()=>s.core.nodes.value.length,b),C=W(()=>s.core.edges.value.length,b),w=W(()=>s.core.nodes.value.map(e=>`${e.id}:${e.position.x}:${e.position.y}`).join(`,`),b);console.log(`[History Plugin] `),console.log(`[History Plugin] : Ctrl+Z (), Ctrl+Y (), Ctrl+Shift+Z ()`);let T;if(s.core.events){let n=()=>{s.core.events?.emit(`history:status-changed`,{canUndo:a.value,canRedo:o.value,current:t.value+1,total:e.value.length})};return n(),T=W([a,o,t,()=>e.value.length],n),()=>{T?.(),_(),v(),y(),x(),C(),w(),i&&clearTimeout(i)}}return()=>{_(),v(),y(),x(),C(),w(),i&&clearTimeout(i)}},cleanup(){e.value=[],t.value=-1,r=!1,i&&=(clearTimeout(i),null),console.log(`[History Plugin] `)}}}function Nd(e={}){let{validateEdge:t,allowReconnectToOriginal:n=!0}=e,r=U(null),i=U(!1),a=U(null);function o(e,t,n){return e.some(e=>e.id!==n&&e.source===t.source&&e.target===t.target&&e.sourceHandle===t.sourceHandle&&e.targetHandle===t.targetHandle)}function s(e,n,r){if(o(e,r,n.id))return console.log(`[Edge Edit Plugin] `),!1;if(t){let e=t(n,r);return console.log(`[Edge Edit Plugin] :`,e),e}return!0}function c(e,t){let{edge:n}=t;r.value=n.id,i.value=!1,a.value={...n},console.log(`[Edge Edit Plugin] : ${n.id}`,{source:n.source,target:n.target,sourceHandle:n.sourceHandle,targetHandle:n.targetHandle})}function l(e,{edge:t,connection:r}){let o=e.core.edges.value,c={source:r.source,target:r.target,sourceHandle:r.sourceHandle??null,targetHandle:r.targetHandle??null};if(console.log(`[Edge Edit Plugin] :`,{edgeId:t.id,newConnection:c,originalEdge:a.value,allowReconnectToOriginal:n}),n&&a.value){let e=a.value,n=e.source===c.source&&e.target===c.target&&e.sourceHandle===c.sourceHandle&&e.targetHandle===c.targetHandle;if(console.log(`[Edge Edit Plugin] :`,n),n){i.value=!0,console.log(`[Edge Edit Plugin] : ${t.id}`);return}}if(!s(o,t,c)){console.log(`[Edge Edit Plugin] : ${t.id}`),i.value=!1;return}e.core.edges.value=o.map(e=>e.id===t.id?{...e,source:r.source,target:r.target,sourceHandle:r.sourceHandle,targetHandle:r.targetHandle}:e),i.value=!0,console.log(`[Edge Edit Plugin] : ${t.id}`)}function u(e,t){let{edge:n}=t;if(console.log(`[Edge Edit Plugin] :`,{edgeId:n.id,updateSuccessful:i.value}),i.value)console.log(`[Edge Edit Plugin] : ${n.id}`);else{let t=e.core.edges.value;e.core.edges.value=t.filter(e=>e.id!==n.id),console.log(`[Edge Edit Plugin] : ${n.id}`)}r.value=null,i.value=!1,a.value=null}return{config:{id:`edge-edit`,name:``,description:``,enabled:!0,version:`1.0.0`},setup(e){if(!e.core.events){console.warn(`[Edge Edit Plugin] `);return}e.shared[`edge-edit`]={isEditing:r,editingEdgeId:r,originalEdge:a,markUpdateSuccessful:()=>{i.value=!0,console.log(`[Edge Edit Plugin] : ${r.value}`)}},e.core.events.on(`edge:update-start`,t=>{c(e,t)}),e.core.events.on(`edge:update`,t=>{l(e,t)}),e.core.events.on(`edge:update-end`,t=>{u(e,t)}),console.log(`[Edge Edit Plugin] `),console.log(`[Edge Edit Plugin] : ${n}`)},cleanup(){r.value=null,i.value=!1,a.value=null,console.log(`[Edge Edit Plugin] `)}}}function Pd(e,t){if(e.targetHandle===`loop-in`||e.source===e.target)return!1;let n=t.find(t=>t.id===e.source),r=t.find(t=>t.id===e.target),i=$e(n,`parentNode`,``),a=$e(r,`parentNode`,``);return i||a?!!(i&&a&&i===a||i&&r?.type===`forLoopContainer`&&r?.id===i||a&&n?.type===`forLoopContainer`&&n?.id===a):!0}function Fd(e){function t(t){return!e.value.some(e=>e.source===t.source&&e.sourceHandle===t.sourceHandle&&e.target===t.target&&e.targetHandle===t.targetHandle)&&t.source!==t.target}return{validateConnection:t}}function Id(t={}){let{debug:n=!1,validateConnection:r,allowReconnectToOriginal:i=!0,autoEnable:a=!1}=t,o,s,c,l,u,d,f,p,m,h,g=[],_=[];function v(e,t){if(e?.computedPosition)return{x:e.computedPosition.x,y:e.computedPosition.y};let n=t?.position;return{x:n?.x??0,y:n?.y??0}}function y(e){return e?e.includes(`loop`):!1}function b(e,t,n,r,i,a,o){if(!e||!t)return[];let s=e.handleBounds?.[n]??[];if(!s||s.length===0)return[];let c=v(e,t);return s.filter(e=>{if(y(e.id))return!1;let n=a===`source`?{source:r,sourceHandle:i,target:t.id,targetHandle:e.id??null}:{source:t.id,sourceHandle:e.id??null,target:r,targetHandle:i};return Pd(n,o)}).map(e=>{let t=c.x+e.x+(e.width??0)/2,n=c.y+e.y+(e.height??0)/2;return{handle:e,position:{x:t,y:n}}})}function x(){c.value&&(c.value=null,n&&console.log(`[CtrlConnect Plugin] `))}function C(e){if(!l.value||!s.value.nodeId||!s.value.handleType){x();return}let t=u.value,a=d.value;if(!t||!a){x();return}let o=document.elementFromPoint(a.x,a.y);if(!o){x();return}let f=o.closest(`.vue-flow__node`);if(!f){x();return}let g=f.dataset.id??f.getAttribute(`data-id`)??null;if(!g||g===s.value.nodeId){x();return}let _=s.value.handleType===`source`?`target`:`source`,v=o.closest(`.vue-flow__handle`),y=v&&(_===`source`?v.classList.contains(`source`):v.classList.contains(`target`))?v?.dataset.handleid??v?.getAttribute(`data-handleid`)??null:null,S=e.vueflow.nodes.value,C=S.find(e=>e.id===g)??null,w=e.vueflow.findNode?.(g)??null,T=b(w,C,_,s.value.nodeId,s.value.handleId,s.value.handleType,S);if(!T.length){x();return}let E=null,D=1/0;for(let e of T){let n=e.handle.id??null,r=Math.hypot(e.position.x-t.x,e.position.y-t.y);y&&n===y&&(r-=1e3),(!E||r<D)&&(E={handleId:n,position:e.position},D=r)}if(!E||!E.handleId){x();return}let O=_===`target`?{source:s.value.nodeId,sourceHandle:s.value.handleId,target:g,targetHandle:E.handleId}:{source:g,sourceHandle:E.handleId,target:s.value.nodeId,targetHandle:s.value.handleId},k=e.vueflow.edges.value,A=(p.value&&m.value?k.filter(e=>e.id!==m.value):k).some(e=>e.source===O.source&&e.sourceHandle===O.sourceHandle&&e.target===O.target&&e.targetHandle===O.targetHandle),j=!1;p.value&&h.value&&(j=O.source===h.value.source&&O.target===h.value.target&&O.sourceHandle===h.value.sourceHandle&&O.targetHandle===h.value.targetHandle);let M=!1;j?(M=i,n&&console.log(`[CtrlConnect Plugin] :`,M)):A?(M=!0,n&&console.log(`[CtrlConnect Plugin] `)):M=r?r(O):O.source!==O.target,c.value={nodeId:g,handleId:E.handleId,handleType:_,position:E.position,isValid:M},n&&console.log(`[CtrlConnect Plugin] :`,c.value)}function w(e){if(!l.value)return!1;let t=c.value;if(!t||!t.isValid||!t.handleId||!s.value.nodeId||!s.value.handleId||!s.value.handleType)return!1;let a=s.value.handleType===`source`?{source:s.value.nodeId,sourceHandle:s.value.handleId,target:t.nodeId,targetHandle:t.handleId}:{source:t.nodeId,sourceHandle:t.handleId,target:s.value.nodeId,targetHandle:s.value.handleId};if(n&&p.value&&console.log(`[CtrlConnect Plugin] :`,{editingEdgeId:m.value,originalEdge:h.value,newConnection:a}),p.value&&h.value&&a.source===h.value.source&&a.target===h.value.target&&a.sourceHandle===h.value.sourceHandle&&a.targetHandle===h.value.targetHandle)return n&&console.log(`[CtrlConnect Plugin] :`,i),i?(e.shared[`edge-edit`]?.markUpdateSuccessful?.(),n&&console.log(`[CtrlConnect Plugin] `),!0):(n&&console.log(`[CtrlConnect Plugin] `),!1);if(e.vueflow.edges.value.filter(e=>!m.value||e.id!==m.value).some(e=>e.source===a.source&&e.sourceHandle===a.sourceHandle&&e.target===a.target&&e.targetHandle===a.targetHandle))return n&&console.log(`[CtrlConnect Plugin] `),!0;let o=e.vueflow.nodes.value;if(!Pd(a,o))return n&&console.warn(`[CtrlConnect Plugin] :`,a),!1;if(r&&!r(a))return n&&console.log(`[CtrlConnect Plugin] `),!1;if(p.value&&m.value){let t=e.core.edges.value;return e.core.edges.value=t.map(e=>e.id===m.value?{...e,source:a.source,target:a.target,sourceHandle:a.sourceHandle??void 0,targetHandle:a.targetHandle??void 0}:e),e.shared[`edge-edit`]?.markUpdateSuccessful?.(),n&&console.log(`[CtrlConnect Plugin] `,m,a),!0}let u={id:`edge_${Date.now()}`,source:a.source,sourceHandle:a.sourceHandle??void 0,target:a.target,targetHandle:a.targetHandle??void 0};return e.vueflow.addEdges([u]),n&&console.log(`[CtrlConnect Plugin] :`,u),!0}return{config:{id:`ctrl-connect`,name:`Ctrl `,description:a?``:` Ctrl `,enabled:!0,version:`1.0.0`},shortcuts:a?[{key:`drag`,description:``,handler:()=>{}}]:[{key:`ctrl+drag`,description:` Ctrl `,handler:()=>{}}],setup(t){o=U(!1),s=U({nodeId:null,handleId:null,handleType:null}),c=U(null),u=U(null),d=U(null),f=U(!0),p=U(!1),m=U(null),h=U(null),t.core.events&&(t.core.events.on(`edge:connect-start`,e=>{let{handleId:r,handleType:i,nodeId:a}=e;!r||!i||!a||(s.value={nodeId:a??null,handleId:r??null,handleType:i??null},f.value=i===`source`,l.value&&C(t),n&&console.log(`[CtrlConnect Plugin] :`,{handleType:i,nodeId:a,handleId:r,isSnapEnabled:f.value}))}),t.core.events.on(`edge:connect-end`,()=>{let e=w(t);s.value={nodeId:null,handleId:null,handleType:null},f.value=!0,x(),n&&e&&console.log(`[CtrlConnect Plugin] Ctrl `)}),t.core.events.on(`edge:update-start`,e=>{p.value=!0,m.value=e.edge?.id??null,h.value=e.edge??null,n&&console.log(`[CtrlConnect Plugin] :`,e.edge)}),t.core.events.on(`edge:update-end`,e=>{p.value=!1,m.value=null,h.value=null,f.value=!0,n&&console.log(`[CtrlConnect Plugin] :`,e.edge)})),l=q(()=>f.value&&(a||o.value)&&s.value.nodeId!==null&&s.value.handleId!==null&&s.value.handleType!==null),g.push(W(l,e=>{e?C(t):x()})),g.push(W(o,e=>{if(!e){x();return}l.value&&C(t)}));let r=S().Control;g.push(W(r,e=>{o.value=!!e})),_.push(e(window,`keydown`,e=>{(e.key===`Control`||e.ctrlKey)&&(o.value=!0)})),_.push(e(window,`keyup`,e=>{e.ctrlKey||(o.value=!1,x())})),_.push(e(window,`blur`,()=>{o.value=!1,x()})),_.push(e(window,`mousemove`,e=>{d.value={x:e.clientX,y:e.clientY};let n=t.vueflow.project?.({x:e.clientX,y:e.clientY});n&&(u.value=n,l.value&&C(t))})),t.shared[`ctrl-connect`]={isActive:l,candidate:c,connectionState:s},console.log(`[CtrlConnect Plugin] Ctrl `),a?console.log(`[CtrlConnect Plugin] :  Ctrl `):console.log(`[CtrlConnect Plugin] :  Ctrl `),console.log(`[CtrlConnect Plugin] : ${i}`),console.log(`[CtrlConnect Plugin] : ${a}`),console.log(`[CtrlConnect Plugin] : ${n}`)},cleanup(e){g.forEach(e=>e()),_.forEach(e=>e()),g=[],_=[],delete e.shared[`ctrl-connect`],console.log(`[CtrlConnect Plugin] Ctrl `)}}}var Ld=D(((e,t)=>{var n=`\0`,r=`\0`,i=``,a=class{_isDirected=!0;_isMultigraph=!1;_isCompound=!1;_label;_defaultNodeLabelFn=()=>void 0;_defaultEdgeLabelFn=()=>void 0;_nodes={};_in={};_preds={};_out={};_sucs={};_edgeObjs={};_edgeLabels={};_nodeCount=0;_edgeCount=0;_parent;_children;constructor(e){e&&(this._isDirected=Object.hasOwn(e,`directed`)?e.directed:!0,this._isMultigraph=Object.hasOwn(e,`multigraph`)?e.multigraph:!1,this._isCompound=Object.hasOwn(e,`compound`)?e.compound:!1),this._isCompound&&(this._parent={},this._children={},this._children[r]={})}isDirected(){return this._isDirected}isMultigraph(){return this._isMultigraph}isCompound(){return this._isCompound}setGraph(e){return this._label=e,this}graph(){return this._label}setDefaultNodeLabel(e){return this._defaultNodeLabelFn=e,typeof e!=`function`&&(this._defaultNodeLabelFn=()=>e),this}nodeCount(){return this._nodeCount}nodes(){return Object.keys(this._nodes)}sources(){var e=this;return this.nodes().filter(t=>Object.keys(e._in[t]).length===0)}sinks(){var e=this;return this.nodes().filter(t=>Object.keys(e._out[t]).length===0)}setNodes(e,t){var n=arguments,r=this;return e.forEach(function(e){n.length>1?r.setNode(e,t):r.setNode(e)}),this}setNode(e,t){return Object.hasOwn(this._nodes,e)?(arguments.length>1&&(this._nodes[e]=t),this):(this._nodes[e]=arguments.length>1?t:this._defaultNodeLabelFn(e),this._isCompound&&(this._parent[e]=r,this._children[e]={},this._children[r][e]=!0),this._in[e]={},this._preds[e]={},this._out[e]={},this._sucs[e]={},++this._nodeCount,this)}node(e){return this._nodes[e]}hasNode(e){return Object.hasOwn(this._nodes,e)}removeNode(e){var t=this;if(Object.hasOwn(this._nodes,e)){var n=e=>t.removeEdge(t._edgeObjs[e]);delete this._nodes[e],this._isCompound&&(this._removeFromParentsChildList(e),delete this._parent[e],this.children(e).forEach(function(e){t.setParent(e)}),delete this._children[e]),Object.keys(this._in[e]).forEach(n),delete this._in[e],delete this._preds[e],Object.keys(this._out[e]).forEach(n),delete this._out[e],delete this._sucs[e],--this._nodeCount}return this}setParent(e,t){if(!this._isCompound)throw Error(`Cannot set parent in a non-compound graph`);if(t===void 0)t=r;else{t+=``;for(var n=t;n!==void 0;n=this.parent(n))if(n===e)throw Error(`Setting `+t+` as parent of `+e+` would create a cycle`);this.setNode(t)}return this.setNode(e),this._removeFromParentsChildList(e),this._parent[e]=t,this._children[t][e]=!0,this}_removeFromParentsChildList(e){delete this._children[this._parent[e]][e]}parent(e){if(this._isCompound){var t=this._parent[e];if(t!==r)return t}}children(e=r){if(this._isCompound){var t=this._children[e];if(t)return Object.keys(t)}else if(e===r)return this.nodes();else if(this.hasNode(e))return[]}predecessors(e){var t=this._preds[e];if(t)return Object.keys(t)}successors(e){var t=this._sucs[e];if(t)return Object.keys(t)}neighbors(e){var t=this.predecessors(e);if(t){let r=new Set(t);for(var n of this.successors(e))r.add(n);return Array.from(r.values())}}isLeaf(e){return(this.isDirected()?this.successors(e):this.neighbors(e)).length===0}filterNodes(e){var t=new this.constructor({directed:this._isDirected,multigraph:this._isMultigraph,compound:this._isCompound});t.setGraph(this.graph());var n=this;Object.entries(this._nodes).forEach(function([n,r]){e(n)&&t.setNode(n,r)}),Object.values(this._edgeObjs).forEach(function(e){t.hasNode(e.v)&&t.hasNode(e.w)&&t.setEdge(e,n.edge(e))});var r={};function i(e){var a=n.parent(e);return a===void 0||t.hasNode(a)?(r[e]=a,a):a in r?r[a]:i(a)}return this._isCompound&&t.nodes().forEach(e=>t.setParent(e,i(e))),t}setDefaultEdgeLabel(e){return this._defaultEdgeLabelFn=e,typeof e!=`function`&&(this._defaultEdgeLabelFn=()=>e),this}edgeCount(){return this._edgeCount}edges(){return Object.values(this._edgeObjs)}setPath(e,t){var n=this,r=arguments;return e.reduce(function(e,i){return r.length>1?n.setEdge(e,i,t):n.setEdge(e,i),i}),this}setEdge(){var e,t,n,r,i=!1,a=arguments[0];typeof a==`object`&&a&&`v`in a?(e=a.v,t=a.w,n=a.name,arguments.length===2&&(r=arguments[1],i=!0)):(e=a,t=arguments[1],n=arguments[3],arguments.length>2&&(r=arguments[2],i=!0)),e=``+e,t=``+t,n!==void 0&&(n=``+n);var s=c(this._isDirected,e,t,n);if(Object.hasOwn(this._edgeLabels,s))return i&&(this._edgeLabels[s]=r),this;if(n!==void 0&&!this._isMultigraph)throw Error(`Cannot set a named edge when isMultigraph = false`);this.setNode(e),this.setNode(t),this._edgeLabels[s]=i?r:this._defaultEdgeLabelFn(e,t,n);var u=l(this._isDirected,e,t,n);return e=u.v,t=u.w,Object.freeze(u),this._edgeObjs[s]=u,o(this._preds[t],e),o(this._sucs[e],t),this._in[t][s]=u,this._out[e][s]=u,this._edgeCount++,this}edge(e,t,n){var r=arguments.length===1?u(this._isDirected,arguments[0]):c(this._isDirected,e,t,n);return this._edgeLabels[r]}edgeAsObj(){let e=this.edge(...arguments);return typeof e==`object`?e:{label:e}}hasEdge(e,t,n){var r=arguments.length===1?u(this._isDirected,arguments[0]):c(this._isDirected,e,t,n);return Object.hasOwn(this._edgeLabels,r)}removeEdge(e,t,n){var r=arguments.length===1?u(this._isDirected,arguments[0]):c(this._isDirected,e,t,n),i=this._edgeObjs[r];return i&&(e=i.v,t=i.w,delete this._edgeLabels[r],delete this._edgeObjs[r],s(this._preds[t],e),s(this._sucs[e],t),delete this._in[t][r],delete this._out[e][r],this._edgeCount--),this}inEdges(e,t){var n=this._in[e];if(n){var r=Object.values(n);return t?r.filter(e=>e.v===t):r}}outEdges(e,t){var n=this._out[e];if(n){var r=Object.values(n);return t?r.filter(e=>e.w===t):r}}nodeEdges(e,t){var n=this.inEdges(e,t);if(n)return n.concat(this.outEdges(e,t))}};function o(e,t){e[t]?e[t]++:e[t]=1}function s(e,t){--e[t]||delete e[t]}function c(e,t,r,a){var o=``+t,s=``+r;if(!e&&o>s){var c=o;o=s,s=c}return o+i+s+i+(a===void 0?n:a)}function l(e,t,n,r){var i=``+t,a=``+n;if(!e&&i>a){var o=i;i=a,a=o}var s={v:i,w:a};return r&&(s.name=r),s}function u(e,t){return c(e,t.v,t.w,t.name)}t.exports=a})),Rd=D(((e,t)=>{t.exports=`2.2.4`})),zd=D(((e,t)=>{t.exports={Graph:Ld(),version:Rd()}})),Bd=D(((e,t)=>{var n=Ld();t.exports={write:r,read:o};function r(e){var t={options:{directed:e.isDirected(),multigraph:e.isMultigraph(),compound:e.isCompound()},nodes:i(e),edges:a(e)};return e.graph()!==void 0&&(t.value=structuredClone(e.graph())),t}function i(e){return e.nodes().map(function(t){var n=e.node(t),r=e.parent(t),i={v:t};return n!==void 0&&(i.value=n),r!==void 0&&(i.parent=r),i})}function a(e){return e.edges().map(function(t){var n=e.edge(t),r={v:t.v,w:t.w};return t.name!==void 0&&(r.name=t.name),n!==void 0&&(r.value=n),r})}function o(e){var t=new n(e.options).setGraph(e.value);return e.nodes.forEach(function(e){t.setNode(e.v,e.value),e.parent&&t.setParent(e.v,e.parent)}),e.edges.forEach(function(e){t.setEdge({v:e.v,w:e.w,name:e.name},e.value)}),t}})),Vd=D(((e,t)=>{t.exports=n;function n(e){var t={},n=[],r;function i(n){Object.hasOwn(t,n)||(t[n]=!0,r.push(n),e.successors(n).forEach(i),e.predecessors(n).forEach(i))}return e.nodes().forEach(function(e){r=[],i(e),r.length&&n.push(r)}),n}})),Hd=D(((e,t)=>{t.exports=class{_arr=[];_keyIndices={};size(){return this._arr.length}keys(){return this._arr.map(function(e){return e.key})}has(e){return Object.hasOwn(this._keyIndices,e)}priority(e){var t=this._keyIndices[e];if(t!==void 0)return this._arr[t].priority}min(){if(this.size()===0)throw Error(`Queue underflow`);return this._arr[0].key}add(e,t){var n=this._keyIndices;if(e=String(e),!Object.hasOwn(n,e)){var r=this._arr,i=r.length;return n[e]=i,r.push({key:e,priority:t}),this._decrease(i),!0}return!1}removeMin(){this._swap(0,this._arr.length-1);var e=this._arr.pop();return delete this._keyIndices[e.key],this._heapify(0),e.key}decrease(e,t){var n=this._keyIndices[e];if(t>this._arr[n].priority)throw Error(`New priority is greater than current priority. Key: `+e+` Old: `+this._arr[n].priority+` New: `+t);this._arr[n].priority=t,this._decrease(n)}_heapify(e){var t=this._arr,n=2*e,r=n+1,i=e;n<t.length&&(i=t[n].priority<t[i].priority?n:i,r<t.length&&(i=t[r].priority<t[i].priority?r:i),i!==e&&(this._swap(e,i),this._heapify(i)))}_decrease(e){for(var t=this._arr,n=t[e].priority,r;e!==0&&(r=e>>1,!(t[r].priority<n));)this._swap(e,r),e=r}_swap(e,t){var n=this._arr,r=this._keyIndices,i=n[e],a=n[t];n[e]=a,n[t]=i,r[a.key]=e,r[i.key]=t}}})),Ud=D(((e,t)=>{var n=Hd();t.exports=i;var r=()=>1;function i(e,t,n,i){return a(e,String(t),n||r,i||function(t){return e.outEdges(t)})}function a(e,t,r,i){var a={},o=new n,s,c,l=function(e){var t=e.v===s?e.w:e.v,n=a[t],i=r(e),l=c.distance+i;if(i<0)throw Error(`dijkstra does not allow negative edge weights. Bad edge: `+e+` Weight: `+i);l<n.distance&&(n.distance=l,n.predecessor=s,o.decrease(t,l))};for(e.nodes().forEach(function(e){var n=e===t?0:1/0;a[e]={distance:n},o.add(e,n)});o.size()>0&&(s=o.removeMin(),c=a[s],c.distance!==1/0);)i(s).forEach(l);return a}})),Wd=D(((e,t)=>{var n=Ud();t.exports=r;function r(e,t,r){return e.nodes().reduce(function(i,a){return i[a]=n(e,a,t,r),i},{})}})),Gd=D(((e,t)=>{t.exports=n;function n(e){var t=0,n=[],r={},i=[];function a(o){var s=r[o]={onStack:!0,lowlink:t,index:t++};if(n.push(o),e.successors(o).forEach(function(e){Object.hasOwn(r,e)?r[e].onStack&&(s.lowlink=Math.min(s.lowlink,r[e].index)):(a(e),s.lowlink=Math.min(s.lowlink,r[e].lowlink))}),s.lowlink===s.index){var c=[],l;do l=n.pop(),r[l].onStack=!1,c.push(l);while(o!==l);i.push(c)}}return e.nodes().forEach(function(e){Object.hasOwn(r,e)||a(e)}),i}})),Kd=D(((e,t)=>{var n=Gd();t.exports=r;function r(e){return n(e).filter(function(t){return t.length>1||t.length===1&&e.hasEdge(t[0],t[0])})}})),qd=D(((e,t)=>{t.exports=r;var n=()=>1;function r(e,t,r){return i(e,t||n,r||function(t){return e.outEdges(t)})}function i(e,t,n){var r={},i=e.nodes();return i.forEach(function(e){r[e]={},r[e][e]={distance:0},i.forEach(function(t){e!==t&&(r[e][t]={distance:1/0})}),n(e).forEach(function(n){var i=n.v===e?n.w:n.v,a=t(n);r[e][i]={distance:a,predecessor:e}})}),i.forEach(function(e){var t=r[e];i.forEach(function(n){var a=r[n];i.forEach(function(n){var r=a[e],i=t[n],o=a[n],s=r.distance+i.distance;s<o.distance&&(o.distance=s,o.predecessor=i.predecessor)})})}),r}})),Jd=D(((e,t)=>{function n(e){var t={},n={},i=[];function a(o){if(Object.hasOwn(n,o))throw new r;Object.hasOwn(t,o)||(n[o]=!0,t[o]=!0,e.predecessors(o).forEach(a),delete n[o],i.push(o))}if(e.sinks().forEach(a),Object.keys(t).length!==e.nodeCount())throw new r;return i}var r=class extends Error{constructor(){super(...arguments)}};t.exports=n,n.CycleException=r})),Yd=D(((e,t)=>{var n=Jd();t.exports=r;function r(e){try{n(e)}catch(e){if(e instanceof n.CycleException)return!1;throw e}return!0}})),Xd=D(((e,t)=>{t.exports=n;function n(e,t,n){Array.isArray(t)||(t=[t]);var a=e.isDirected()?t=>e.successors(t):t=>e.neighbors(t),o=n===`post`?r:i,s=[],c={};return t.forEach(t=>{if(!e.hasNode(t))throw Error(`Graph does not have node: `+t);o(t,a,c,s)}),s}function r(e,t,n,r){for(var i=[[e,!1]];i.length>0;){var o=i.pop();o[1]?r.push(o[0]):Object.hasOwn(n,o[0])||(n[o[0]]=!0,i.push([o[0],!0]),a(t(o[0]),e=>i.push([e,!1])))}}function i(e,t,n,r){for(var i=[e];i.length>0;){var o=i.pop();Object.hasOwn(n,o)||(n[o]=!0,r.push(o),a(t(o),e=>i.push(e)))}}function a(e,t){for(var n=e.length;n--;)t(e[n],n,e);return e}})),Zd=D(((e,t)=>{var n=Xd();t.exports=r;function r(e,t){return n(e,t,`post`)}})),Qd=D(((e,t)=>{var n=Xd();t.exports=r;function r(e,t){return n(e,t,`pre`)}})),$d=D(((e,t)=>{var n=Ld(),r=Hd();t.exports=i;function i(e,t){var i=new n,a={},o=new r,s;function c(e){var n=e.v===s?e.w:e.v,r=o.priority(n);if(r!==void 0){var i=t(e);i<r&&(a[n]=s,o.decrease(n,i))}}if(e.nodeCount()===0)return i;e.nodes().forEach(function(e){o.add(e,1/0),i.setNode(e)}),o.decrease(e.nodes()[0],0);for(var l=!1;o.size()>0;){if(s=o.removeMin(),Object.hasOwn(a,s))i.setEdge(s,a[s]);else if(l)throw Error(`Input graph is not connected: `+e);else l=!0;e.nodeEdges(s).forEach(c)}return i}})),ef=D(((e,t)=>{t.exports={components:Vd(),dijkstra:Ud(),dijkstraAll:Wd(),findCycles:Kd(),floydWarshall:qd(),isAcyclic:Yd(),postorder:Zd(),preorder:Qd(),prim:$d(),tarjan:Gd(),topsort:Jd()}})),tf=D(((e,t)=>{var n=zd();t.exports={Graph:n.Graph,json:Bd(),alg:ef(),version:n.version}})),nf=D(((e,t)=>{var n=class{constructor(){let e={};e._next=e._prev=e,this._sentinel=e}dequeue(){let e=this._sentinel,t=e._prev;if(t!==e)return r(t),t}enqueue(e){let t=this._sentinel;e._prev&&e._next&&r(e),e._next=t._next,t._next._prev=e,t._next=e,e._prev=t}toString(){let e=[],t=this._sentinel,n=t._prev;for(;n!==t;)e.push(JSON.stringify(n,i)),n=n._prev;return`[`+e.join(`, `)+`]`}};function r(e){e._prev._next=e._next,e._next._prev=e._prev,delete e._next,delete e._prev}function i(e,t){if(e!==`_next`&&e!==`_prev`)return t}t.exports=n})),rf=D(((e,t)=>{var n=tf().Graph,r=nf();t.exports=a;var i=()=>1;function a(e,t){if(e.nodeCount()<=1)return[];let n=c(e,t||i);return o(n.graph,n.buckets,n.zeroIdx).flatMap(t=>e.outEdges(t.v,t.w))}function o(e,t,n){let r=[],i=t[t.length-1],a=t[0],o;for(;e.nodeCount();){for(;o=a.dequeue();)s(e,t,n,o);for(;o=i.dequeue();)s(e,t,n,o);if(e.nodeCount()){for(let i=t.length-2;i>0;--i)if(o=t[i].dequeue(),o){r=r.concat(s(e,t,n,o,!0));break}}}return r}function s(e,t,n,r,i){let a=i?[]:void 0;return e.inEdges(r.v).forEach(r=>{let o=e.edge(r),s=e.node(r.v);i&&a.push({v:r.v,w:r.w}),s.out-=o,l(t,n,s)}),e.outEdges(r.v).forEach(r=>{let i=e.edge(r),a=r.w,o=e.node(a);o.in-=i,l(t,n,o)}),e.removeNode(r.v),a}function c(e,t){let i=new n,a=0,o=0;e.nodes().forEach(e=>{i.setNode(e,{v:e,in:0,out:0})}),e.edges().forEach(e=>{let n=i.edge(e.v,e.w)||0,r=t(e),s=n+r;i.setEdge(e.v,e.w,s),o=Math.max(o,i.node(e.v).out+=r),a=Math.max(a,i.node(e.w).in+=r)});let s=u(o+a+3).map(()=>new r),c=a+1;return i.nodes().forEach(e=>{l(s,c,i.node(e))}),{graph:i,buckets:s,zeroIdx:c}}function l(e,t,n){n.out?n.in?e[n.out-n.in+t].enqueue(n):e[e.length-1].enqueue(n):e[0].enqueue(n)}function u(e){let t=[];for(let n=0;n<e;n++)t.push(n);return t}})),af=D(((e,t)=>{var n=tf().Graph;t.exports={addBorderNode:f,addDummyNode:r,applyWithChunking:h,asNonCompoundGraph:a,buildLayerMatrix:l,intersectRect:c,mapValues:w,maxRank:g,normalizeRanks:u,notime:y,partition:_,pick:C,predecessorWeights:s,range:S,removeEmptyRanks:d,simplify:i,successorWeights:o,time:v,uniqueId:x,zipObject:T};function r(e,t,n,r){for(var i=r;e.hasNode(i);)i=x(r);return n.dummy=t,e.setNode(i,n),i}function i(e){let t=new n().setGraph(e.graph());return e.nodes().forEach(n=>t.setNode(n,e.node(n))),e.edges().forEach(n=>{let r=t.edge(n.v,n.w)||{weight:0,minlen:1},i=e.edge(n);t.setEdge(n.v,n.w,{weight:r.weight+i.weight,minlen:Math.max(r.minlen,i.minlen)})}),t}function a(e){let t=new n({multigraph:e.isMultigraph()}).setGraph(e.graph());return e.nodes().forEach(n=>{e.children(n).length||t.setNode(n,e.node(n))}),e.edges().forEach(n=>{t.setEdge(n,e.edge(n))}),t}function o(e){let t=e.nodes().map(t=>{let n={};return e.outEdges(t).forEach(t=>{n[t.w]=(n[t.w]||0)+e.edge(t).weight}),n});return T(e.nodes(),t)}function s(e){let t=e.nodes().map(t=>{let n={};return e.inEdges(t).forEach(t=>{n[t.v]=(n[t.v]||0)+e.edge(t).weight}),n});return T(e.nodes(),t)}function c(e,t){let n=e.x,r=e.y,i=t.x-n,a=t.y-r,o=e.width/2,s=e.height/2;if(!i&&!a)throw Error(`Not possible to find intersection inside of the rectangle`);let c,l;return Math.abs(a)*o>Math.abs(i)*s?(a<0&&(s=-s),c=s*i/a,l=s):(i<0&&(o=-o),c=o,l=o*a/i),{x:n+c,y:r+l}}function l(e){let t=S(g(e)+1).map(()=>[]);return e.nodes().forEach(n=>{let r=e.node(n),i=r.rank;i!==void 0&&(t[i][r.order]=n)}),t}function u(e){let t=e.nodes().map(t=>{let n=e.node(t).rank;return n===void 0?Number.MAX_VALUE:n}),n=h(Math.min,t);e.nodes().forEach(t=>{let r=e.node(t);Object.hasOwn(r,`rank`)&&(r.rank-=n)})}function d(e){let t=e.nodes().map(t=>e.node(t).rank),n=h(Math.min,t),r=[];e.nodes().forEach(t=>{let i=e.node(t).rank-n;r[i]||(r[i]=[]),r[i].push(t)});let i=0,a=e.graph().nodeRankFactor;Array.from(r).forEach((t,n)=>{t===void 0&&n%a!==0?--i:t!==void 0&&i&&t.forEach(t=>e.node(t).rank+=i)})}function f(e,t,n,i){let a={width:0,height:0};return arguments.length>=4&&(a.rank=n,a.order=i),r(e,`border`,a,t)}function p(e,t=m){let n=[];for(let r=0;r<e.length;r+=t){let i=e.slice(r,r+t);n.push(i)}return n}var m=65535;function h(e,t){if(t.length>m){let n=p(t);return e.apply(null,n.map(t=>e.apply(null,t)))}else return e.apply(null,t)}function g(e){let t=e.nodes().map(t=>{let n=e.node(t).rank;return n===void 0?Number.MIN_VALUE:n});return h(Math.max,t)}function _(e,t){let n={lhs:[],rhs:[]};return e.forEach(e=>{t(e)?n.lhs.push(e):n.rhs.push(e)}),n}function v(e,t){let n=Date.now();try{return t()}finally{console.log(e+` time: `+(Date.now()-n)+`ms`)}}function y(e,t){return t()}var b=0;function x(e){var t=++b;return e+(``+t)}function S(e,t,n=1){t??(t=e,e=0);let r=e=>e<t;n<0&&(r=e=>t<e);let i=[];for(let t=e;r(t);t+=n)i.push(t);return i}function C(e,t){let n={};for(let r of t)e[r]!==void 0&&(n[r]=e[r]);return n}function w(e,t){let n=t;return typeof t==`string`&&(n=e=>e[t]),Object.entries(e).reduce((e,[t,r])=>(e[t]=n(r,t),e),{})}function T(e,t){return e.reduce((e,n,r)=>(e[n]=t[r],e),{})}})),sf=D(((e,t)=>{var n=rf(),r=af().uniqueId;t.exports={run:i,undo:o};function i(e){(e.graph().acyclicer===`greedy`?n(e,t(e)):a(e)).forEach(t=>{let n=e.edge(t);e.removeEdge(t),n.forwardName=t.name,n.reversed=!0,e.setEdge(t.w,t.v,n,r(`rev`))});function t(e){return t=>e.edge(t).weight}}function a(e){let t=[],n={},r={};function i(a){Object.hasOwn(r,a)||(r[a]=!0,n[a]=!0,e.outEdges(a).forEach(e=>{Object.hasOwn(n,e.w)?t.push(e):i(e.w)}),delete n[a])}return e.nodes().forEach(i),t}function o(e){e.edges().forEach(t=>{let n=e.edge(t);if(n.reversed){e.removeEdge(t);let r=n.forwardName;delete n.reversed,delete n.forwardName,e.setEdge(t.w,t.v,n,r)}})}})),cf=D(((e,t)=>{var n=af();t.exports={run:r,undo:a};function r(e){e.graph().dummyChains=[],e.edges().forEach(t=>i(e,t))}function i(e,t){let r=t.v,i=e.node(r).rank,a=t.w,o=e.node(a).rank,s=t.name,c=e.edge(t),l=c.labelRank;if(o===i+1)return;e.removeEdge(t);let u,d,f;for(f=0,++i;i<o;++f,++i)c.points=[],d={width:0,height:0,edgeLabel:c,edgeObj:t,rank:i},u=n.addDummyNode(e,`edge`,d,`_d`),i===l&&(d.width=c.width,d.height=c.height,d.dummy=`edge-label`,d.labelpos=c.labelpos),e.setEdge(r,u,{weight:c.weight},s),f===0&&e.graph().dummyChains.push(u),r=u;e.setEdge(r,a,{weight:c.weight},s)}function a(e){e.graph().dummyChains.forEach(t=>{let n=e.node(t),r=n.edgeLabel,i;for(e.setEdge(n.edgeObj,r);n.dummy;)i=e.successors(t)[0],e.removeNode(t),r.points.push({x:n.x,y:n.y}),n.dummy===`edge-label`&&(r.x=n.x,r.y=n.y,r.width=n.width,r.height=n.height),t=i,n=e.node(t)})}})),lf=D(((e,t)=>{var{applyWithChunking:n}=af();t.exports={longestPath:r,slack:i};function r(e){var t={};function r(i){var a=e.node(i);if(Object.hasOwn(t,i))return a.rank;t[i]=!0;let o=e.outEdges(i).map(t=>t==null?1/0:r(t.w)-e.edge(t).minlen);var s=n(Math.min,o);return s===1/0&&(s=0),a.rank=s}e.sources().forEach(r)}function i(e,t){return e.node(t.w).rank-e.node(t.v).rank-e.edge(t).minlen}})),uf=D(((e,t)=>{var n=tf().Graph,r=lf().slack;t.exports=i;function i(e){var t=new n({directed:!1}),i=e.nodes()[0],c=e.nodeCount();t.setNode(i,{});for(var l,u;a(t,e)<c;)l=o(t,e),u=t.hasNode(l.v)?r(e,l):-r(e,l),s(t,e,u);return t}function a(e,t){function n(i){t.nodeEdges(i).forEach(a=>{var o=a.v,s=i===o?a.w:o;!e.hasNode(s)&&!r(t,a)&&(e.setNode(s,{}),e.setEdge(i,s,{}),n(s))})}return e.nodes().forEach(n),e.nodeCount()}function o(e,t){return t.edges().reduce((n,i)=>{let a=1/0;return e.hasNode(i.v)!==e.hasNode(i.w)&&(a=r(t,i)),a<n[0]?[a,i]:n},[1/0,null])[1]}function s(e,t,n){e.nodes().forEach(e=>t.node(e).rank+=n)}})),df=D(((e,t)=>{var n=uf(),r=lf().slack,i=lf().longestPath,a=tf().alg.preorder,o=tf().alg.postorder,s=af().simplify;t.exports=c,c.initLowLimValues=f,c.initCutValues=l,c.calcCutValue=d,c.leaveEdge=m,c.enterEdge=h,c.exchangeEdges=g;function c(e){e=s(e),i(e);var t=n(e);f(t),l(t,e);for(var r,a;r=m(t);)a=h(t,e,r),g(t,e,r,a)}function l(e,t){var n=o(e,e.nodes());n=n.slice(0,n.length-1),n.forEach(n=>u(e,t,n))}function u(e,t,n){var r=e.node(n).parent;e.edge(n,r).cutvalue=d(e,t,n)}function d(e,t,n){var r=e.node(n).parent,i=!0,a=t.edge(n,r),o=0;return a||=(i=!1,t.edge(r,n)),o=a.weight,t.nodeEdges(n).forEach(a=>{var s=a.v===n,c=s?a.w:a.v;if(c!==r){var l=s===i,u=t.edge(a).weight;if(o+=l?u:-u,v(e,n,c)){var d=e.edge(n,c).cutvalue;o+=l?-d:d}}}),o}function f(e,t){arguments.length<2&&(t=e.nodes()[0]),p(e,{},1,t)}function p(e,t,n,r,i){var a=n,o=e.node(r);return t[r]=!0,e.neighbors(r).forEach(i=>{Object.hasOwn(t,i)||(n=p(e,t,n,i,r))}),o.low=a,o.lim=n++,i?o.parent=i:delete o.parent,n}function m(e){return e.edges().find(t=>e.edge(t).cutvalue<0)}function h(e,t,n){var i=n.v,a=n.w;t.hasEdge(i,a)||(i=n.w,a=n.v);var o=e.node(i),s=e.node(a),c=o,l=!1;return o.lim>s.lim&&(c=s,l=!0),t.edges().filter(t=>l===y(e,e.node(t.v),c)&&l!==y(e,e.node(t.w),c)).reduce((e,n)=>r(t,n)<r(t,e)?n:e)}function g(e,t,n,r){var i=n.v,a=n.w;e.removeEdge(i,a),e.setEdge(r.v,r.w,{}),f(e),l(e,t),_(e,t)}function _(e,t){var n=e.nodes().find(e=>!t.node(e).parent),r=a(e,n);r=r.slice(1),r.forEach(n=>{var r=e.node(n).parent,i=t.edge(n,r),a=!1;i||(i=t.edge(r,n),a=!0),t.node(n).rank=t.node(r).rank+(a?i.minlen:-i.minlen)})}function v(e,t,n){return e.hasEdge(t,n)}function y(e,t,n){return n.low<=t.lim&&t.lim<=n.lim}})),ff=D(((e,t)=>{var n=lf().longestPath,r=uf(),i=df();t.exports=a;function a(e){var t=e.graph().ranker;if(t instanceof Function)return t(e);switch(e.graph().ranker){case`network-simplex`:c(e);break;case`tight-tree`:s(e);break;case`longest-path`:o(e);break;case`none`:break;default:c(e)}}var o=n;function s(e){n(e),r(e)}function c(e){i(e)}})),pf=D(((e,t)=>{t.exports=n;function n(e){let t=i(e);e.graph().dummyChains.forEach(n=>{let i=e.node(n),a=i.edgeObj,o=r(e,t,a.v,a.w),s=o.path,c=o.lca,l=0,u=s[l],d=!0;for(;n!==a.w;){if(i=e.node(n),d){for(;(u=s[l])!==c&&e.node(u).maxRank<i.rank;)l++;u===c&&(d=!1)}if(!d){for(;l<s.length-1&&e.node(u=s[l+1]).minRank<=i.rank;)l++;u=s[l]}e.setParent(n,u),n=e.successors(n)[0]}})}function r(e,t,n,r){let i=[],a=[],o=Math.min(t[n].low,t[r].low),s=Math.max(t[n].lim,t[r].lim),c,l;c=n;do c=e.parent(c),i.push(c);while(c&&(t[c].low>o||s>t[c].lim));for(l=c,c=r;(c=e.parent(c))!==l;)a.push(c);return{path:i.concat(a.reverse()),lca:l}}function i(e){let t={},n=0;function r(i){let a=n;e.children(i).forEach(r),t[i]={low:a,lim:n++}}return e.children().forEach(r),t}})),mf=D(((e,t)=>{var n=af();t.exports={run:r,cleanup:s};function r(e){let t=n.addDummyNode(e,`root`,{},`_root`),r=a(e),s=Object.values(r),c=n.applyWithChunking(Math.max,s)-1,l=2*c+1;e.graph().nestingRoot=t,e.edges().forEach(t=>e.edge(t).minlen*=l);let u=o(e)+1;e.children().forEach(n=>i(e,t,l,u,c,r,n)),e.graph().nodeRankFactor=l}function i(e,t,r,a,o,s,c){let l=e.children(c);if(!l.length){c!==t&&e.setEdge(t,c,{weight:0,minlen:r});return}let u=n.addBorderNode(e,`_bt`),d=n.addBorderNode(e,`_bb`),f=e.node(c);e.setParent(u,c),f.borderTop=u,e.setParent(d,c),f.borderBottom=d,l.forEach(n=>{i(e,t,r,a,o,s,n);let l=e.node(n),f=l.borderTop?l.borderTop:n,p=l.borderBottom?l.borderBottom:n,m=l.borderTop?a:2*a,h=f===p?o-s[c]+1:1;e.setEdge(u,f,{weight:m,minlen:h,nestingEdge:!0}),e.setEdge(p,d,{weight:m,minlen:h,nestingEdge:!0})}),e.parent(c)||e.setEdge(t,u,{weight:0,minlen:o+s[c]})}function a(e){var t={};function n(r,i){var a=e.children(r);a&&a.length&&a.forEach(e=>n(e,i+1)),t[r]=i}return e.children().forEach(e=>n(e,1)),t}function o(e){return e.edges().reduce((t,n)=>t+e.edge(n).weight,0)}function s(e){var t=e.graph();e.removeNode(t.nestingRoot),delete t.nestingRoot,e.edges().forEach(t=>{e.edge(t).nestingEdge&&e.removeEdge(t)})}})),hf=D(((e,t)=>{var n=af();t.exports=r;function r(e){function t(n){let r=e.children(n),a=e.node(n);if(r.length&&r.forEach(t),Object.hasOwn(a,`minRank`)){a.borderLeft=[],a.borderRight=[];for(let t=a.minRank,r=a.maxRank+1;t<r;++t)i(e,`borderLeft`,`_bl`,n,a,t),i(e,`borderRight`,`_br`,n,a,t)}}e.children().forEach(t)}function i(e,t,r,i,a,o){let s={width:0,height:0,rank:o,borderType:t},c=a[t][o-1],l=n.addDummyNode(e,`border`,s,r);a[t][o]=l,e.setParent(l,i),c&&e.setEdge(c,l,{weight:1})}})),gf=D(((e,t)=>{t.exports={adjust:n,undo:r};function n(e){let t=e.graph().rankdir.toLowerCase();(t===`lr`||t===`rl`)&&i(e)}function r(e){let t=e.graph().rankdir.toLowerCase();(t===`bt`||t===`rl`)&&o(e),(t===`lr`||t===`rl`)&&(c(e),i(e))}function i(e){e.nodes().forEach(t=>a(e.node(t))),e.edges().forEach(t=>a(e.edge(t)))}function a(e){let t=e.width;e.width=e.height,e.height=t}function o(e){e.nodes().forEach(t=>s(e.node(t))),e.edges().forEach(t=>{let n=e.edge(t);n.points.forEach(s),Object.hasOwn(n,`y`)&&s(n)})}function s(e){e.y=-e.y}function c(e){e.nodes().forEach(t=>l(e.node(t))),e.edges().forEach(t=>{let n=e.edge(t);n.points.forEach(l),Object.hasOwn(n,`x`)&&l(n)})}function l(e){let t=e.x;e.x=e.y,e.y=t}})),_f=D(((e,t)=>{var n=af();t.exports=r;function r(e){let t={},r=e.nodes().filter(t=>!e.children(t).length),i=r.map(t=>e.node(t).rank),a=n.applyWithChunking(Math.max,i),o=n.range(a+1).map(()=>[]);function s(n){if(t[n])return;t[n]=!0;let r=e.node(n);o[r.rank].push(n),e.successors(n).forEach(s)}return r.sort((t,n)=>e.node(t).rank-e.node(n).rank).forEach(s),o}})),vf=D(((e,t)=>{var n=af().zipObject;t.exports=r;function r(e,t){let n=0;for(let r=1;r<t.length;++r)n+=i(e,t[r-1],t[r]);return n}function i(e,t,r){let i=n(r,r.map((e,t)=>t)),a=t.flatMap(t=>e.outEdges(t).map(t=>({pos:i[t.w],weight:e.edge(t).weight})).sort((e,t)=>e.pos-t.pos)),o=1;for(;o<r.length;)o<<=1;let s=2*o-1;--o;let c=Array(s).fill(0),l=0;return a.forEach(e=>{let t=e.pos+o;c[t]+=e.weight;let n=0;for(;t>0;)t%2&&(n+=c[t+1]),t=t-1>>1,c[t]+=e.weight;l+=e.weight*n}),l}})),yf=D(((e,t)=>{t.exports=n;function n(e,t=[]){return t.map(t=>{let n=e.inEdges(t);if(n.length){let r=n.reduce((t,n)=>{let r=e.edge(n),i=e.node(n.v);return{sum:t.sum+r.weight*i.order,weight:t.weight+r.weight}},{sum:0,weight:0});return{v:t,barycenter:r.sum/r.weight,weight:r.weight}}else return{v:t}})}})),bf=D(((e,t)=>{var n=af();t.exports=r;function r(e,t){let n={};e.forEach((e,t)=>{let r=n[e.v]={indegree:0,in:[],out:[],vs:[e.v],i:t};e.barycenter!==void 0&&(r.barycenter=e.barycenter,r.weight=e.weight)}),t.edges().forEach(e=>{let t=n[e.v],r=n[e.w];t!==void 0&&r!==void 0&&(r.indegree++,t.out.push(n[e.w]))});let r=Object.values(n).filter(e=>!e.indegree);return i(r)}function i(e){let t=[];function r(e){return t=>{t.merged||(t.barycenter===void 0||e.barycenter===void 0||t.barycenter>=e.barycenter)&&a(e,t)}}function i(t){return n=>{n.in.push(t),--n.indegree===0&&e.push(n)}}for(;e.length;){let n=e.pop();t.push(n),n.in.reverse().forEach(r(n)),n.out.forEach(i(n))}return t.filter(e=>!e.merged).map(e=>n.pick(e,[`vs`,`i`,`barycenter`,`weight`]))}function a(e,t){let n=0,r=0;e.weight&&(n+=e.barycenter*e.weight,r+=e.weight),t.weight&&(n+=t.barycenter*t.weight,r+=t.weight),e.vs=t.vs.concat(e.vs),e.barycenter=n/r,e.weight=r,e.i=Math.min(t.i,e.i),t.merged=!0}})),xf=D(((e,t)=>{var n=af();t.exports=r;function r(e,t){let r=n.partition(e,e=>Object.hasOwn(e,`barycenter`)),o=r.lhs,s=r.rhs.sort((e,t)=>t.i-e.i),c=[],l=0,u=0,d=0;o.sort(a(!!t)),d=i(c,s,d),o.forEach(e=>{d+=e.vs.length,c.push(e.vs),l+=e.barycenter*e.weight,u+=e.weight,d=i(c,s,d)});let f={vs:c.flat(!0)};return u&&(f.barycenter=l/u,f.weight=u),f}function i(e,t,n){let r;for(;t.length&&(r=t[t.length-1]).i<=n;)t.pop(),e.push(r.vs),n++;return n}function a(e){return(t,n)=>t.barycenter<n.barycenter?-1:t.barycenter>n.barycenter?1:e?n.i-t.i:t.i-n.i}})),Sf=D(((e,t)=>{var n=yf(),r=bf(),i=xf();t.exports=a;function a(e,t,c,l){let u=e.children(t),d=e.node(t),f=d?d.borderLeft:void 0,p=d?d.borderRight:void 0,m={};f&&(u=u.filter(e=>e!==f&&e!==p));let h=n(e,u);h.forEach(t=>{if(e.children(t.v).length){let n=a(e,t.v,c,l);m[t.v]=n,Object.hasOwn(n,`barycenter`)&&s(t,n)}});let g=r(h,c);o(g,m);let _=i(g,l);if(f&&(_.vs=[f,_.vs,p].flat(!0),e.predecessors(f).length)){let t=e.node(e.predecessors(f)[0]),n=e.node(e.predecessors(p)[0]);Object.hasOwn(_,`barycenter`)||(_.barycenter=0,_.weight=0),_.barycenter=(_.barycenter*_.weight+t.order+n.order)/(_.weight+2),_.weight+=2}return _}function o(e,t){e.forEach(e=>{e.vs=e.vs.flatMap(e=>t[e]?t[e].vs:e)})}function s(e,t){e.barycenter===void 0?(e.barycenter=t.barycenter,e.weight=t.weight):(e.barycenter=(e.barycenter*e.weight+t.barycenter*t.weight)/(e.weight+t.weight),e.weight+=t.weight)}})),Cf=D(((e,t)=>{var n=tf().Graph,r=af();t.exports=i;function i(e,t,r){let i=a(e),o=new n({compound:!0}).setGraph({root:i}).setDefaultNodeLabel(t=>e.node(t));return e.nodes().forEach(n=>{let a=e.node(n),s=e.parent(n);(a.rank===t||a.minRank<=t&&t<=a.maxRank)&&(o.setNode(n),o.setParent(n,s||i),e[r](n).forEach(t=>{let r=t.v===n?t.w:t.v,i=o.edge(r,n),a=i===void 0?0:i.weight;o.setEdge(r,n,{weight:e.edge(t).weight+a})}),Object.hasOwn(a,`minRank`)&&o.setNode(n,{borderLeft:a.borderLeft[t],borderRight:a.borderRight[t]}))}),o}function a(e){for(var t;e.hasNode(t=r.uniqueId(`_root`)););return t}})),wf=D(((e,t)=>{t.exports=n;function n(e,t,n){let r={},i;n.forEach(n=>{let a=e.parent(n),o,s;for(;a;){if(o=e.parent(a),o?(s=r[o],r[o]=a):(s=i,i=a),s&&s!==a){t.setEdge(s,a);return}a=o}})}})),Tf=D(((e,t)=>{var n=_f(),r=vf(),i=Sf(),a=Cf(),o=wf(),s=tf().Graph,c=af();t.exports=l;function l(e,t){if(t&&typeof t.customOrder==`function`){t.customOrder(e,l);return}let i=c.maxRank(e),a=u(e,c.range(1,i+1),`inEdges`),o=u(e,c.range(i-1,-1,-1),`outEdges`),s=n(e);if(f(e,s),t&&t.disableOptimalOrderHeuristic)return;let p=1/0,m;for(let t=0,n=0;n<4;++t,++n){d(t%2?a:o,t%4>=2),s=c.buildLayerMatrix(e);let i=r(e,s);i<p&&(n=0,m=Object.assign({},s),p=i)}f(e,m)}function u(e,t,n){return t.map(function(t){return a(e,t,n)})}function d(e,t){let n=new s;e.forEach(function(e){let r=e.graph().root,a=i(e,r,n,t);a.vs.forEach((t,n)=>e.node(t).order=n),o(e,n,a.vs)})}function f(e,t){Object.values(t).forEach(t=>t.forEach((t,n)=>e.node(t).order=n))}})),Ef=D(((e,t)=>{var n=tf().Graph,r=af();t.exports={positionX:h,findType1Conflicts:i,findType2Conflicts:a,addConflict:s,hasConflict:c,verticalAlignment:l,horizontalCompaction:u,alignCoordinates:p,findSmallestWidthAlignment:f,balance:m};function i(e,t){let n={};function r(t,r){let i=0,a=0,c=t.length,l=r[r.length-1];return r.forEach((t,u)=>{let d=o(e,t),f=d?e.node(d).order:c;(d||t===l)&&(r.slice(a,u+1).forEach(t=>{e.predecessors(t).forEach(r=>{let a=e.node(r),o=a.order;(o<i||f<o)&&!(a.dummy&&e.node(t).dummy)&&s(n,r,t)})}),a=u+1,i=f)}),r}return t.length&&t.reduce(r),n}function a(e,t){let n={};function i(t,i,a,o,c){let l;r.range(i,a).forEach(r=>{l=t[r],e.node(l).dummy&&e.predecessors(l).forEach(t=>{let r=e.node(t);r.dummy&&(r.order<o||r.order>c)&&s(n,t,l)})})}function a(t,n){let r=-1,a,o=0;return n.forEach((s,c)=>{if(e.node(s).dummy===`border`){let t=e.predecessors(s);t.length&&(a=e.node(t[0]).order,i(n,o,c,r,a),o=c,r=a)}i(n,o,n.length,a,t.length)}),n}return t.length&&t.reduce(a),n}function o(e,t){if(e.node(t).dummy)return e.predecessors(t).find(t=>e.node(t).dummy)}function s(e,t,n){if(t>n){let e=t;t=n,n=e}let r=e[t];r||(e[t]=r={}),r[n]=!0}function c(e,t,n){if(t>n){let e=t;t=n,n=e}return!!e[t]&&Object.hasOwn(e[t],n)}function l(e,t,n,r){let i={},a={},o={};return t.forEach(e=>{e.forEach((e,t)=>{i[e]=e,a[e]=e,o[e]=t})}),t.forEach(e=>{let t=-1;e.forEach(e=>{let s=r(e);if(s.length){s=s.sort((e,t)=>o[e]-o[t]);let r=(s.length-1)/2;for(let l=Math.floor(r),u=Math.ceil(r);l<=u;++l){let r=s[l];a[e]===e&&t<o[r]&&!c(n,e,r)&&(a[r]=e,a[e]=i[e]=i[r],t=o[r])}}})}),{root:i,align:a}}function u(e,t,n,r,i){let a={},o=d(e,t,n,i),s=i?`borderLeft`:`borderRight`;function c(e,t){let n=o.nodes(),r=n.pop(),i={};for(;r;)i[r]?e(r):(i[r]=!0,n.push(r),n=n.concat(t(r))),r=n.pop()}function l(e){a[e]=o.inEdges(e).reduce((e,t)=>Math.max(e,a[t.v]+o.edge(t)),0)}function u(t){let n=o.outEdges(t).reduce((e,t)=>Math.min(e,a[t.w]-o.edge(t)),1/0),r=e.node(t);n!==1/0&&r.borderType!==s&&(a[t]=Math.max(a[t],n))}return c(l,o.predecessors.bind(o)),c(u,o.successors.bind(o)),Object.keys(r).forEach(e=>a[e]=a[n[e]]),a}function d(e,t,r,i){let a=new n,o=e.graph(),s=g(o.nodesep,o.edgesep,i);return t.forEach(t=>{let n;t.forEach(t=>{let i=r[t];if(a.setNode(i),n){var o=r[n],c=a.edge(o,i);a.setEdge(o,i,Math.max(s(e,t,n),c||0))}n=t})}),a}function f(e,t){return Object.values(t).reduce((t,n)=>{let r=-1/0,i=1/0;Object.entries(n).forEach(([t,n])=>{let a=_(e,t)/2;r=Math.max(n+a,r),i=Math.min(n-a,i)});let a=r-i;return a<t[0]&&(t=[a,n]),t},[1/0,null])[1]}function p(e,t){let n=Object.values(t),i=r.applyWithChunking(Math.min,n),a=r.applyWithChunking(Math.max,n);[`u`,`d`].forEach(n=>{[`l`,`r`].forEach(o=>{let s=n+o,c=e[s];if(c===t)return;let l=Object.values(c),u=i-r.applyWithChunking(Math.min,l);o!==`l`&&(u=a-r.applyWithChunking(Math.max,l)),u&&(e[s]=r.mapValues(c,e=>e+u))})})}function m(e,t){return r.mapValues(e.ul,(n,r)=>{if(t)return e[t.toLowerCase()][r];{let t=Object.values(e).map(e=>e[r]).sort((e,t)=>e-t);return(t[1]+t[2])/2}})}function h(e){let t=r.buildLayerMatrix(e),n=Object.assign(i(e,t),a(e,t)),o={},s;[`u`,`d`].forEach(i=>{s=i===`u`?t:Object.values(t).reverse(),[`l`,`r`].forEach(t=>{t===`r`&&(s=s.map(e=>Object.values(e).reverse()));let a=(i===`u`?e.predecessors:e.successors).bind(e),c=l(e,s,n,a),d=u(e,s,c.root,c.align,t===`r`);t===`r`&&(d=r.mapValues(d,e=>-e)),o[i+t]=d})});let c=f(e,o);return p(o,c),m(o,e.graph().align)}function g(e,t,n){return(r,i,a)=>{let o=r.node(i),s=r.node(a),c=0,l;if(c+=o.width/2,Object.hasOwn(o,`labelpos`))switch(o.labelpos.toLowerCase()){case`l`:l=-o.width/2;break;case`r`:l=o.width/2;break}if(l&&(c+=n?l:-l),l=0,c+=(o.dummy?t:e)/2,c+=(s.dummy?t:e)/2,c+=s.width/2,Object.hasOwn(s,`labelpos`))switch(s.labelpos.toLowerCase()){case`l`:l=s.width/2;break;case`r`:l=-s.width/2;break}return l&&(c+=n?l:-l),l=0,c}}function _(e,t){return e.node(t).width}})),Df=D(((e,t)=>{var n=af(),r=Ef().positionX;t.exports=i;function i(e){e=n.asNonCompoundGraph(e),a(e),Object.entries(r(e)).forEach(([t,n])=>e.node(t).x=n)}function a(e){let t=n.buildLayerMatrix(e),r=e.graph().ranksep,i=0;t.forEach(t=>{let n=t.reduce((t,n)=>{let r=e.node(n).height;return t>r?t:r},0);t.forEach(t=>e.node(t).y=i+n/2),i+=n+r})}})),Of=D(((e,t)=>{var n=sf(),r=cf(),i=ff(),a=af().normalizeRanks,o=pf(),s=af().removeEmptyRanks,c=mf(),l=hf(),u=gf(),d=Tf(),f=Df(),p=af(),m=tf().Graph;t.exports=h;function h(e,t){let n=t&&t.debugTiming?p.time:p.notime;n(`layout`,()=>{let r=n(`  buildLayoutGraph`,()=>E(e));n(`  runLayout`,()=>g(r,n,t)),n(`  updateInputGraph`,()=>_(e,r))})}function g(e,t,m){t(`    makeSpaceForEdgeLabels`,()=>D(e)),t(`    removeSelfEdges`,()=>te(e)),t(`    acyclic`,()=>n.run(e)),t(`    nestingGraph.run`,()=>c.run(e)),t(`    rank`,()=>i(p.asNonCompoundGraph(e))),t(`    injectEdgeLabelProxies`,()=>O(e)),t(`    removeEmptyRanks`,()=>s(e)),t(`    nestingGraph.cleanup`,()=>c.cleanup(e)),t(`    normalizeRanks`,()=>a(e)),t(`    assignRankMinMax`,()=>k(e)),t(`    removeEdgeLabelProxies`,()=>A(e)),t(`    normalize.run`,()=>r.run(e)),t(`    parentDummyChains`,()=>o(e)),t(`    addBorderSegments`,()=>l(e)),t(`    order`,()=>d(e,m)),t(`    insertSelfEdges`,()=>ne(e)),t(`    adjustCoordinateSystem`,()=>u.adjust(e)),t(`    position`,()=>f(e)),t(`    positionSelfEdges`,()=>re(e)),t(`    removeBorderNodes`,()=>P(e)),t(`    normalize.undo`,()=>r.undo(e)),t(`    fixupEdgeLabelCoords`,()=>ee(e)),t(`    undoCoordinateSystem`,()=>u.undo(e)),t(`    translateGraph`,()=>j(e)),t(`    assignNodeIntersects`,()=>M(e)),t(`    reversePoints`,()=>N(e)),t(`    acyclic.undo`,()=>n.undo(e))}function _(e,t){e.nodes().forEach(n=>{let r=e.node(n),i=t.node(n);r&&(r.x=i.x,r.y=i.y,r.rank=i.rank,t.children(n).length&&(r.width=i.width,r.height=i.height))}),e.edges().forEach(n=>{let r=e.edge(n),i=t.edge(n);r.points=i.points,Object.hasOwn(i,`x`)&&(r.x=i.x,r.y=i.y)}),e.graph().width=t.graph().width,e.graph().height=t.graph().height}var v=[`nodesep`,`edgesep`,`ranksep`,`marginx`,`marginy`],y={ranksep:50,edgesep:20,nodesep:50,rankdir:`tb`},b=[`acyclicer`,`ranker`,`rankdir`,`align`],x=[`width`,`height`,`rank`],S={width:0,height:0},C=[`minlen`,`weight`,`width`,`height`,`labeloffset`],w={minlen:1,weight:1,width:0,height:0,labeloffset:10,labelpos:`r`},T=[`labelpos`];function E(e){let t=new m({multigraph:!0,compound:!0}),n=ie(e.graph());return t.setGraph(Object.assign({},y,F(n,v),p.pick(n,b))),e.nodes().forEach(n=>{let r=ie(e.node(n)),i=F(r,x);Object.keys(S).forEach(e=>{i[e]===void 0&&(i[e]=S[e])}),t.setNode(n,i),t.setParent(n,e.parent(n))}),e.edges().forEach(n=>{let r=ie(e.edge(n));t.setEdge(n,Object.assign({},w,F(r,C),p.pick(r,T)))}),t}function D(e){let t=e.graph();t.ranksep/=2,e.edges().forEach(n=>{let r=e.edge(n);r.minlen*=2,r.labelpos.toLowerCase()!==`c`&&(t.rankdir===`TB`||t.rankdir===`BT`?r.width+=r.labeloffset:r.height+=r.labeloffset)})}function O(e){e.edges().forEach(t=>{let n=e.edge(t);if(n.width&&n.height){let n=e.node(t.v),r={rank:(e.node(t.w).rank-n.rank)/2+n.rank,e:t};p.addDummyNode(e,`edge-proxy`,r,`_ep`)}})}function k(e){let t=0;e.nodes().forEach(n=>{let r=e.node(n);r.borderTop&&(r.minRank=e.node(r.borderTop).rank,r.maxRank=e.node(r.borderBottom).rank,t=Math.max(t,r.maxRank))}),e.graph().maxRank=t}function A(e){e.nodes().forEach(t=>{let n=e.node(t);n.dummy===`edge-proxy`&&(e.edge(n.e).labelRank=n.rank,e.removeNode(t))})}function j(e){let t=1/0,n=0,r=1/0,i=0,a=e.graph(),o=a.marginx||0,s=a.marginy||0;function c(e){let a=e.x,o=e.y,s=e.width,c=e.height;t=Math.min(t,a-s/2),n=Math.max(n,a+s/2),r=Math.min(r,o-c/2),i=Math.max(i,o+c/2)}e.nodes().forEach(t=>c(e.node(t))),e.edges().forEach(t=>{let n=e.edge(t);Object.hasOwn(n,`x`)&&c(n)}),t-=o,r-=s,e.nodes().forEach(n=>{let i=e.node(n);i.x-=t,i.y-=r}),e.edges().forEach(n=>{let i=e.edge(n);i.points.forEach(e=>{e.x-=t,e.y-=r}),Object.hasOwn(i,`x`)&&(i.x-=t),Object.hasOwn(i,`y`)&&(i.y-=r)}),a.width=n-t+o,a.height=i-r+s}function M(e){e.edges().forEach(t=>{let n=e.edge(t),r=e.node(t.v),i=e.node(t.w),a,o;n.points?(a=n.points[0],o=n.points[n.points.length-1]):(n.points=[],a=i,o=r),n.points.unshift(p.intersectRect(r,a)),n.points.push(p.intersectRect(i,o))})}function ee(e){e.edges().forEach(t=>{let n=e.edge(t);if(Object.hasOwn(n,`x`))switch((n.labelpos===`l`||n.labelpos===`r`)&&(n.width-=n.labeloffset),n.labelpos){case`l`:n.x-=n.width/2+n.labeloffset;break;case`r`:n.x+=n.width/2+n.labeloffset;break}})}function N(e){e.edges().forEach(t=>{let n=e.edge(t);n.reversed&&n.points.reverse()})}function P(e){e.nodes().forEach(t=>{if(e.children(t).length){let n=e.node(t),r=e.node(n.borderTop),i=e.node(n.borderBottom),a=e.node(n.borderLeft[n.borderLeft.length-1]),o=e.node(n.borderRight[n.borderRight.length-1]);n.width=Math.abs(o.x-a.x),n.height=Math.abs(i.y-r.y),n.x=a.x+n.width/2,n.y=r.y+n.height/2}}),e.nodes().forEach(t=>{e.node(t).dummy===`border`&&e.removeNode(t)})}function te(e){e.edges().forEach(t=>{if(t.v===t.w){var n=e.node(t.v);n.selfEdges||=[],n.selfEdges.push({e:t,label:e.edge(t)}),e.removeEdge(t)}})}function ne(e){p.buildLayerMatrix(e).forEach(t=>{var n=0;t.forEach((t,r)=>{var i=e.node(t);i.order=r+n,(i.selfEdges||[]).forEach(t=>{p.addDummyNode(e,`selfedge`,{width:t.label.width,height:t.label.height,rank:i.rank,order:r+ ++n,e:t.e,label:t.label},`_se`)}),delete i.selfEdges})})}function re(e){e.nodes().forEach(t=>{var n=e.node(t);if(n.dummy===`selfedge`){var r=e.node(n.e.v),i=r.x+r.width/2,a=r.y,o=n.x-i,s=r.height/2;e.setEdge(n.e,n.label),e.removeNode(t),n.label.points=[{x:i+2*o/3,y:a-s},{x:i+5*o/6,y:a-s},{x:i+o,y:a},{x:i+5*o/6,y:a+s},{x:i+2*o/3,y:a+s}],n.label.x=n.x,n.label.y=n.y}})}function F(e,t){return p.mapValues(p.pick(e,t),Number)}function ie(e){var t={};return e&&Object.entries(e).forEach(([e,n])=>{typeof e==`string`&&(e=e.toLowerCase()),t[e]=n}),t}})),kf=D(((e,t)=>{var n=af(),r=tf().Graph;t.exports={debugOrdering:i};function i(e){let t=n.buildLayerMatrix(e),i=new r({compound:!0,multigraph:!0}).setGraph({});return e.nodes().forEach(t=>{i.setNode(t,{label:t}),i.setParent(t,`layer`+e.node(t).rank)}),e.edges().forEach(e=>i.setEdge(e.v,e.w,{},e.name)),t.forEach((e,t)=>{let n=`layer`+t;i.setNode(n,{rank:`same`}),e.reduce((e,t)=>(i.setEdge(e,t,{style:`invis`}),t))}),i}})),Af=D(((e,t)=>{t.exports=`1.1.5`})),jf=oe(D(((e,t)=>{t.exports={graphlib:tf(),layout:Of(),debug:kf(),util:{time:af().time,notime:af().notime},version:Af()}}))());const Mf={minWidth:200,defaultWidth:200,maxWidth:400,headerHeight:30,contentMinHeight:50,iconSize:10,borderWidth:2,borderRadius:8},Nf={headerPadding:{vertical:2,horizontal:12},contentPadding:12,iconGap:8},Pf={default:`#3b82f6`,border:`#e5e7eb`,borderSelected:`#3b82f6`,background:`#ffffff`},Ff={headerHeight:32,padding:{top:30,right:80,bottom:30,left:80},minWidth:400,minHeight:200};Mf.defaultWidth/2,Mf.headerHeight/2;function If(){let e=null;function t(e){return e.dimensions?.width?e.dimensions.width:e.width?e.width:e.data?.width?e.data.width:e.type===`loopContainer`?400:260}function n(e){return e.dimensions?.height?e.dimensions.height:e.height?e.height:e.data?.height?e.data.height:e.type===`loopContainer`||e.type===`forLoopContainer`?300:160}function r(e,r,i,a){let o=new Map,s=r.filter(t=>t.parentNode===e);if(s.length===0)return o;let c=new jf.default.graphlib.Graph;c.setDefaultEdgeLabel(()=>({})),c.setGraph({rankdir:a.direction,nodesep:a.nodesep,ranksep:a.ranksep,marginx:0,marginy:0}),s.forEach(e=>{let r=t(e),i=n(e);c.setNode(e.id,{width:r,height:i})});let l=new Set(s.map(e=>e.id));i.forEach(t=>{l.has(t.source)&&l.has(t.target)&&t.source!==e&&t.target!==e&&c.setEdge(t.source,t.target)}),jf.default.layout(c);let u=1/0,d=1/0;s.forEach(e=>{let t=c.node(e.id);if(!t)return;let n=t.width,r=t.height,i=t.x-n/2,a=t.y-r/2;u=Math.min(u,i),d=Math.min(d,a)});let f=Number.isFinite(u)?u:0,p=Number.isFinite(d)?d:0;return s.forEach(e=>{let t=c.node(e.id);if(!t)return;let n=t.x-t.width/2-f+Ff.padding.left,r=t.y-t.height/2-p+Ff.headerHeight+Ff.padding.top;o.set(e.id,{x:n,y:r})}),o}async function i(i={}){if(!e){console.warn(`[AutoLayout Plugin] `);return}let{core:a,vueflow:o}=e,{nodes:s,edges:c}=a;if(s.value.length===0){console.warn(`[AutoLayout Plugin] `);return}let l=i.direction??`LR`,u=i.nodesep??160,d=i.ranksep??240,f=i.padding??120,p=i.forNodeSpacing??40,m=i.fitView??!0,h=i.fitViewPadding??.2,g=i.fitViewDuration??400,_=new Map,v=new Map;s.value.forEach(e=>{if(e.type===`for`&&e.data?.config?.containerId){let t=e.data.config.containerId;_.set(e.id,t),v.set(t,e.id)}}),console.log(`[AutoLayout Plugin]  ${v.size}  for `);let y=new Map;v.forEach((e,t)=>{let n=r(t,s.value,c.value,{direction:l,nodesep:u*.8,ranksep:d*.7});y.set(t,n)}),y.size>0&&(a.updateNodes(e=>e.map(e=>{if(e.parentNode&&y.has(e.parentNode)){let t=y.get(e.parentNode).get(e.id);if(t)return{...e,position:{x:t.x,y:t.y}}}return e})),await F(),console.log(`[AutoLayout Plugin]  ${Array.from(y.values()).reduce((e,t)=>e+t.size,0)} `));let b=e?.shared?.[`for-loop`];b&&typeof b.updateContainerBounds==`function`&&(v.forEach((e,t)=>{b.updateContainerBounds(t)}),await F(),await new Promise(e=>setTimeout(e,50)),console.log(`[AutoLayout Plugin]  bounds  ${v.size} `));let x=s.value.filter(e=>!(e.parentNode||v.has(e.id)));if(x.length===0){console.warn(`[AutoLayout Plugin] `);return}let S=new jf.default.graphlib.Graph;S.setDefaultEdgeLabel(()=>({})),S.setGraph({rankdir:l,nodesep:u,ranksep:d,marginx:0,marginy:0}),x.forEach(e=>{let r=t(e),i=n(e);S.setNode(e.id,{width:r,height:i})});let C=new Set(x.map(e=>e.id));c.value.forEach(e=>{C.has(e.source)&&C.has(e.target)&&S.setEdge(e.source,e.target)}),jf.default.layout(S);let w=[];x.forEach(e=>{let t=S.node(e.id);t&&w.push({node:e,x:t.x,y:t.y,width:t.width,height:t.height})});let T=1/0,E=1/0;w.forEach(({x:e,y:t,width:n,height:r})=>{let i=e-n/2,a=t-r/2;T=Math.min(T,i),E=Math.min(E,a)});let D=Number.isFinite(T)?T:0,O=Number.isFinite(E)?E:0,k=new Map;v.forEach((e,r)=>{let i=s.value.find(e=>e.id===r);i&&k.set(r,{width:t(i),height:n(i)})}),a.updateNodes(e=>e.map(e=>{let n=w.find(t=>t.node.id===e.id);if(n){let t=n.x-n.width/2-D+f,r=n.y-n.height/2-O+f;return{...e,position:{x:t,y:r}}}if(v.has(e.id)){let n=v.get(e.id),r=w.find(e=>e.node.id===n);if(r){let n=r.x-r.width/2-D+f,i=r.y-r.height/2-O+f,a=k.get(e.id),o=a?a.width:t(e),s=n+r.width/2-o/2;return{...e,position:{x:s,y:i+r.height+p}}}}return e})),console.log(`[AutoLayout Plugin]  `),console.log(`  - : ${w.length} `),console.log(`  - For : ${v.size} `),console.log(`  - : ${Array.from(y.values()).reduce((e,t)=>e+t.size,0)} `),await F(),m&&typeof o.fitView==`function`&&(await o.fitView({padding:h,duration:g}),console.log(`[AutoLayout Plugin] `)),a.events&&a.events.emit(`canvas:auto-layout`,{nodeCount:w.length,direction:l})}return{config:{id:`auto-layout`,name:``,description:` Dagre `,enabled:!0,version:`1.0.0`,author:`AI Assistant`},shortcuts:[{key:`ctrl+shift+l`,description:``,handler:()=>{i()}}],setup(t){e=t,t.autoLayout=i,t.core.events&&t.core.events.on(`canvas:request-auto-layout`,e=>{i(e)}),console.log(`[AutoLayout Plugin] `),console.log(`[AutoLayout Plugin] :  canvas:request-auto-layout  Ctrl+Shift+L`)},cleanup(){e=null,console.log(`[AutoLayout Plugin] `)}}}function Lf(e){let n=[];function r(e){let t=e.vueflow.getSelectedNodes?.value??[],n=e.vueflow.getSelectedEdges?.value??[],r=0;t.length>0&&(t.forEach(t=>{e.core.deleteNode(t.id)}),r+=t.length,console.log(`[Delete Plugin]  ${t.length} `)),n.length>0&&(n.forEach(t=>{e.core.deleteEdge(t.id)}),r+=n.length,console.log(`[Delete Plugin]  ${n.length} `)),r===0&&console.log(`[Delete Plugin] `)}return{config:{id:`delete`,name:``,description:``,enabled:!0,version:`1.0.0`},shortcuts:[{key:`delete`,description:``,handler:e=>r(e)},{key:`backspace`,description:``,handler:e=>r(e)}],setup(i){let{enableShortcut:a}=e;n.push(t([`Delete`,`Backspace`],e=>{if(a.value){let t=i.vueflow.getSelectedNodes?.value??[],n=i.vueflow.getSelectedEdges?.value??[];(t.length>0||n.length>0)&&(e.preventDefault(),r(i))}},{dedupe:!0})),console.log(`[Delete Plugin] `),console.log(`[Delete Plugin] : Delete / Backspace ()`)},cleanup(){n.forEach(e=>e()),n.length=0,console.log(`[Delete Plugin] `)}}}function Rf(e={}){let{debug:t=!1,validateConnection:n}=e;function r(e,t){return t.filter(t=>t.target===e)}function i(e,t){return t.filter(t=>t.source===e)}function a(e,t,n,r,i){return i.some(i=>i.source===e&&i.sourceHandle===t&&i.target===n&&i.targetHandle===r)}function o(e,n){if(e.length<=1)return e.length===1?e:null;let a=new Set(e),o=new Map;for(let t of e)o.set(t,{incoming:r(t,n).filter(e=>a.has(e.source)),outgoing:i(t,n).filter(e=>a.has(e.target))});let s=null;for(let t of e){let e=o.get(t);if(e.incoming.length===0){if(r(t,n).filter(e=>!a.has(e.source)).length>0){s=t;break}}else e.incoming.length===1&&(s||=t)}if(!s){for(let t of e)if(o.get(t).incoming.length<=1){s=t;break}}if(!s)return t&&console.log(`[AutoReconnect Plugin] : ${e.join(`, `)}`),null;let c=[s],l=new Set([s]),u=s;for(;c.length<e.length;){let e=o.get(u).outgoing.filter(e=>a.has(e.target));if(e.length===0)break;if(e.length>1)return t&&console.log(`[AutoReconnect Plugin] : ${u}  ${e.length} `),null;let n=e[0];if(!n)break;let r=n.target;if(l.has(r))return t&&console.log(`[AutoReconnect Plugin] : ${u} -> ${r}`),null;c.push(r),l.add(r),u=r}if(c.length!==e.length)return t&&console.log(`[AutoReconnect Plugin] :  ${e.length}  ${c.length} `),null;for(let e=0;e<c.length-1;e++){let n=c[e],r=c[e+1];if(!n||!r)return null;let i=o.get(n);if(!i)return null;if(i.outgoing.filter(e=>e.target===r).length!==1)return t&&console.log(`[AutoReconnect Plugin] : ${n} -> ${r} `),null}return c}function s(e,o,s){let c=r(o,s),l=i(o,s);if(t&&console.log(`[AutoReconnect Plugin]  ${o} :`,`: ${c.length} , : ${l.length} `),c.length>0&&l.length>0){let r=[];for(let e of c)for(let i of l){let o=e.source,c=e.sourceHandle??null,l=i.target,u=i.targetHandle??null;if(o===l){t&&console.log(`[AutoReconnect Plugin] : ${o} -> ${l}`);continue}if(a(o,c,l,u,s)){t&&console.log(`[AutoReconnect Plugin] : ${o}(${c}) -> ${l}(${u})`);continue}if(n&&!n({source:o,sourceHandle:c,target:l,targetHandle:u})){t&&console.log(`[AutoReconnect Plugin] : ${o}(${c}) -> ${l}(${u})`);continue}let d={id:`edge-${o}-${l}-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,source:o,target:l,sourceHandle:c??null,targetHandle:u??null,type:i.type,animated:i.animated,style:i.style,label:i.label,labelStyle:i.labelStyle,labelShowBg:i.labelShowBg,labelBgStyle:i.labelBgStyle};r.push(d),t&&console.log(`[AutoReconnect Plugin] : ${o}(${c}) -> ${l}(${u})`)}r.length>0?(r.forEach(t=>{e.core.addEdge(t)}),console.log(`[AutoReconnect Plugin]  ${o} :  ${r.length} `)):t&&console.log(`[AutoReconnect Plugin]  ${o} `)}else t&&console.log(`[AutoReconnect Plugin]  ${o} `)}function c(e,o,s){if(o.length<2)return;let c=o[0],l=o[o.length-1];if(!c||!l){t&&console.warn(`[AutoReconnect Plugin] : `);return}let u=new Set(o),d=r(c,s).filter(e=>!u.has(e.source)),f=i(l,s).filter(e=>!u.has(e.target));if(t&&console.log(`[AutoReconnect Plugin] :`,` ${c} : ${d.length} `,` ${l} : ${f.length} `),d.length>0&&f.length>0){let r=[];for(let e of d)for(let i of f){let o=e.source,c=e.sourceHandle??null,l=i.target,u=i.targetHandle??null;if(o===l){t&&console.log(`[AutoReconnect Plugin] : ${o} -> ${l}`);continue}if(a(o,c,l,u,s)){t&&console.log(`[AutoReconnect Plugin] : ${o}(${c}) -> ${l}(${u})`);continue}if(n&&!n({source:o,sourceHandle:c,target:l,targetHandle:u})){t&&console.log(`[AutoReconnect Plugin] : ${o}(${c}) -> ${l}(${u})`);continue}let d={id:`edge-${o}-${l}-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,source:o,target:l,sourceHandle:c??null,targetHandle:u??null,type:i.type,animated:i.animated,style:i.style,label:i.label,labelStyle:i.labelStyle,labelShowBg:i.labelShowBg,labelBgStyle:i.labelBgStyle};r.push(d),t&&console.log(`[AutoReconnect Plugin] : ${o}(${c}) -> ${l}(${u})`)}r.length>0?(r.forEach(t=>{e.core.addEdge(t)}),console.log(`[AutoReconnect Plugin]  [${o.join(` -> `)}] :  ${r.length} `)):t&&console.log(`[AutoReconnect Plugin] `)}else t&&console.log(`[AutoReconnect Plugin] `)}function l(e,n){let r=e.core.edges.value;if(!e.core.nodes.value.find(e=>e.id===n)){t&&console.warn(`[AutoReconnect Plugin] : ${n}`);return}let i=(e.vueflow.getSelectedNodes?.value??[]).map(e=>e.id);if(i.includes(n)&&i.length>1){let a=o(i,r);if(a){t&&console.log(`[AutoReconnect Plugin] : ${a.join(` -> `)}`),a[0]===n?c(e,a,r):t&&console.log(`[AutoReconnect Plugin]  ${n}  ${a[0]} `);return}else t&&console.log(`[AutoReconnect Plugin] : ${n}`)}s(e,n,r)}return{config:{id:`auto-reconnect`,name:``,description:``,enabled:!0,version:`1.0.0`},hooks:{beforeNodeDelete(e,t){l(e,t)}},setup(){t&&console.log(`[AutoReconnect Plugin] `)},cleanup(){t&&console.log(`[AutoReconnect Plugin] `)}}}var{headerHeight:zf,padding:Bf,minWidth:Vf,minHeight:Hf}=Ff,Uf=`edge-layer-container`;function Wf(){let e=[],t=null,n={dragTargetContainerId:null,isCtrlPressed:!1,ctrlDetachContext:null},r=U({});function i(e){return e?typeof e==`string`?e.split(/\s+/).filter(Boolean):Array.isArray(e)?e.flatMap(e=>typeof e==`string`?e.split(/\s+/).filter(Boolean):[]).filter(Boolean):typeof e==`object`?Object.entries(e).filter(([,e])=>!!e).map(([e])=>e).filter(Boolean):[]:[]}function a(e,t){r.value={[e]:t},console.log(`[ForLoopPlugin] : ${e}, : ${t}`)}function o(){r.value={}}function s(e,t){let n=e.position.x,r=e.position.y,i=e.width||200,a=e.height||100,o=t.position.x,s=t.position.y,c=t.width||Vf,l=t.height||Hf;return!(n+i<o||n>o+c||r+a<s||r>s+l)}function c(e,t){return t.core.edges.value.some(t=>t.source===e||t.target===e)}function l(e,t){if(!e)return;let n=t.core.nodes.value,r=i(e.class).filter(e=>e!==Uf),a=n.find(t=>t.id===e.source),o=n.find(t=>t.id===e.target);if(!a||!o)return;let s=a?.parentNode??null,c=o?.parentNode??null,l=!!(s&&s===c||a?.type===`forLoopContainer`&&c===a.id||o?.type===`forLoopContainer`&&s===o.id);l&&(r.push(Uf),typeof window<`u`&&requestAnimationFrame(()=>{let t=document.querySelector(`[data-id="${e.id}"]`)?.parentElement;t&&(l?t.classList.add(Uf):t.classList.remove(Uf))}))}function u(e){let t=e.core.edges.value;t.forEach(t=>l(t,e)),console.log(`[ForLoopPlugin]  ${t.length} `)}function d(e,t,n){let r=n.core.nodes.value,i=r.find(t=>t.id===e),a=r.find(e=>e.id===t);if(!i||!a){console.warn(`[ForLoopPlugin] `);return}let o=a.position.x+i.position.x,s=a.position.y+i.position.y,c=[];n.core.edges.value.forEach(t=>{(t.source===e||t.target===e)&&c.push(t.id)}),c.forEach(e=>{n.core.deleteEdge(e)}),n.core.updateNodes(t=>t.map(t=>t.id===e?{...t,parentNode:void 0,position:{x:o,y:s}}:t)),console.log(`[ForLoopPlugin]   ${e}  ${t} ${c.length} `),p(t,n),u(n)}function f(e,t,n){let r=n.core.nodes.value,i=r.find(t=>t.id===e),a=r.find(e=>e.id===t);if(!i||!a){console.warn(`[ForLoopPlugin] `);return}let o=i.position.x-a.position.x,s=i.position.y-a.position.y;n.core.updateNodes(n=>n.map(n=>n.id===e?{...n,parentNode:t,position:{x:o,y:s}}:n)),console.log(`[ForLoopPlugin]   ${e}  ${t}`),p(t,n),u(n)}function p(e,t){let n=t.core.nodes.value,r=n.find(t=>t.id===e);if(!r)return;let i=n.filter(t=>t.parentNode===e);if(i.length===0){t.core.updateNodes(t=>t.map(t=>t.id===e?{...t,width:Vf,height:Hf,style:{...t.style,width:`${Vf}px`,height:`${Hf}px`}}:t));return}let a=1/0,o=1/0,s=-1/0,c=-1/0;i.forEach(e=>{let t=e.width||200,n=e.height||100,i=r.position.x+e.position.x,l=r.position.y+e.position.y;a=Math.min(a,i),o=Math.min(o,l),s=Math.max(s,i+t),c=Math.max(c,l+n)});let l=a-Bf.left,u=o-zf-Bf.top,d=s-a,f=c-o,p=Math.max(d+Bf.left+Bf.right,Vf),m=Math.max(f+zf+Bf.top+Bf.bottom,Hf);t.core.updateNodes(t=>t.map(t=>{if(t.id===e)return{...t,position:{x:l,y:u},width:p,height:m,style:{...t.style,width:`${p}px`,height:`${m}px`}};if(t.parentNode===e){let e=r.position.x+t.position.x,n=r.position.y+t.position.y;return{...t,position:{x:e-l,y:n-u}}}return t})),console.log(`[ForLoopPlugin]  - : (${l}, ${u}), : ${p}x${m}`)}function m(e){if(!t)return;let{node:r}=e;if(r.parentNode&&n.isCtrlPressed&&!n.ctrlDetachContext){let e=t.core.nodes.value.find(e=>e.id===r.parentNode);e&&e.type===`forLoopContainer`&&(n.ctrlDetachContext={nodeId:r.id,containerId:r.parentNode},console.log(`[ForLoopPlugin]  Ctrl :  ${r.id}  ${r.parentNode}`))}if(n.ctrlDetachContext&&n.ctrlDetachContext.nodeId===r.id){let e=n.ctrlDetachContext.containerId,i=t.core.nodes.value.find(t=>t.id===e);if(i){let t=i.position.x+r.position.x,n=i.position.y+r.position.y,o={...r,position:{x:t,y:n}},c=s(o,i);a(e,c?`normal`:`warning`)}return}if(r.parentNode||r.type===`forLoopContainer`)return;let i=(t.vueflow.getIntersectingNodes(r)||[]).find(e=>e.type===`forLoopContainer`);if(i&&s(r,i)){let e=c(r.id,t);n.dragTargetContainerId=i.id,a(i.id,e?`warning`:`normal`);return}n.dragTargetContainerId&&=(o(),null)}function h(e){if(!t)return;let{node:r}=e;if(n.ctrlDetachContext&&n.ctrlDetachContext.nodeId===r.id){let e=n.ctrlDetachContext.containerId,i=t.core.nodes.value.find(t=>t.id===e);if(i){let n=i.position.x+r.position.x,a=i.position.y+r.position.y,o={...r,position:{x:n,y:a}};s(o,i)?(console.log(`[ForLoopPlugin]  ${r.id}  ${e} `),p(e,t)):(console.log(`[ForLoopPlugin]  ${r.id}  ${e}`),d(r.id,e,t))}n.ctrlDetachContext=null,o();return}if(n.dragTargetContainerId&&!r.parentNode&&(c(r.id,t)?console.log(`[ForLoopPlugin]  ${r.id} `):(console.log(`[ForLoopPlugin]  ${r.id}  ${n.dragTargetContainerId}`),f(r.id,n.dragTargetContainerId,t))),r.parentNode){let e=t.core.nodes.value.find(e=>e.id===r.parentNode);e&&e.type===`forLoopContainer`&&p(r.parentNode,t)}o(),n.dragTargetContainerId=null}function g(e){if(!t)return!0;let n=t.core.nodes.value,r=n.find(t=>t.id===e.source),i=n.find(t=>t.id===e.target);if(!r||!i)return!0;let a=e.sourceHandle,o=e.targetHandle;return r.type===`forLoopContainer`&&a===`loop-left`?i.parentNode===r.id?!0:(console.warn(`[ForLoopPlugin]  loop-left `),!1):i.type===`forLoopContainer`&&o===`loop-right`?r.parentNode===i.id?!0:(console.warn(`[ForLoopPlugin]  loop-right `),!1):r.parentNode?i.id===r.parentNode&&i.type===`forLoopContainer`&&o===`loop-right`?!0:i.parentNode?i.parentNode===r.parentNode?!0:(console.warn(`[ForLoopPlugin] `),!1):(console.warn(`[ForLoopPlugin] `),!1):i.parentNode?r.id===i.parentNode&&r.type===`forLoopContainer`&&a===`loop-left`?!0:(console.warn(`[ForLoopPlugin] `),!1):!0}let _=new Set;function v(e,t){if(_.has(t))return;let r=e.core.nodes.value,i=r.find(e=>e.id===t);if(!i)return;let a=new Set,o=new Set;if(i.type===`for`){a.add(t);let s=i.data?.config?.containerId;s&&r.find(e=>e.id===s)&&(a.add(s),r.filter(e=>e.parentNode===s).forEach(e=>{a.add(e.id)}),e.core.edges.value.forEach(e=>{(e.source===s||e.target===s)&&o.add(e.id)}),n.dragTargetContainerId===s&&(n.dragTargetContainerId=null))}else if(i.type===`forLoopContainer`){a.add(t),r.filter(e=>e.parentNode===t).forEach(e=>{a.add(e.id)});let s=i.data?.config?.forNodeId;s&&r.find(e=>e.id===s)&&!_.has(s)&&a.add(s),e.core.edges.value.forEach(e=>{(e.source===t||e.target===t)&&o.add(e.id)}),n.dragTargetContainerId===t&&(n.dragTargetContainerId=null)}a.forEach(e=>{_.add(e)}),a.forEach(t=>{e.core.deleteNode(t,!1)}),o.forEach(t=>{e.core.deleteEdge(t,!1)}),console.log(`[ForLoopPlugin]  ${a.size}  ${o.size} `),setTimeout(()=>{a.forEach(e=>{_.delete(e)})},100)}return{config:{id:`for-loop`,name:`For `,description:` For `,enabled:!0,version:`1.0.0`},hooks:{beforeNodeDelete(e,t){return v(e,t),!0}},setup(i){t=i,i.shared[`for-loop`]={containerHighlight:r,updateContainerBounds:e=>{p(e,i)}};let a=e=>{(e.key===`Control`||e.ctrlKey)&&(n.isCtrlPressed=!0)},s=e=>{(e.key===`Control`||!e.ctrlKey)&&(n.isCtrlPressed=!1,n.ctrlDetachContext&&=(o(),null))};if(window.addEventListener(`keydown`,a),window.addEventListener(`keyup`,s),e.push(()=>{window.removeEventListener(`keydown`,a),window.removeEventListener(`keyup`,s)}),i.vueflow.onNodeDrag){let t=i.vueflow.onNodeDrag(m);t&&typeof t==`object`&&`off`in t&&e.push(()=>t.off())}if(i.vueflow.onNodeDragStop){let t=i.vueflow.onNodeDragStop(h);t&&typeof t==`object`&&`off`in t&&e.push(()=>t.off())}if(i.vueflow.onConnect){let t=i.vueflow.onConnect(e=>{if(!g(e))return!1;setTimeout(()=>u(i),100)});t&&typeof t==`object`&&`off`in t&&e.push(()=>t.off())}setTimeout(()=>u(i),200),console.log(`[ForLoopPlugin] For `)},cleanup(){e.forEach(e=>e()),e.length=0,o(),_.clear(),t=null,console.log(`[ForLoopPlugin] For `)}}}const Gf=Symbol(`PLUGIN_MANAGER`);var Kf=class{constructor(){this.plugins=new Map,this.enabledPlugins=U(new Set),this.context=null,this.sharedState={}}setContext(e){this.context={...e,shared:this.sharedState}}getSharedState(){return this.sharedState}register(e){this.plugins.set(e.config.id,e),e.config.enabled&&this.enable(e.config.id),console.log(`[Plugin Manager] : ${e.config.name}`)}enable(e){let t=this.plugins.get(e);if(!t){console.warn(`[Plugin Manager] : ${e}`);return}this.enabledPlugins.value.has(e)||(t.setup&&this.context&&t.setup(this.context),t.hooks?.onInstall&&this.context&&t.hooks.onInstall(this.context),this.enabledPlugins.value.add(e),console.log(`[Plugin Manager] : ${t.config.name}`))}disable(e){let t=this.plugins.get(e);if(!t){console.warn(`[Plugin Manager] : ${e}`);return}this.enabledPlugins.value.has(e)&&(t.cleanup&&this.context&&t.cleanup(this.context),t.hooks?.onUninstall&&this.context&&t.hooks.onUninstall(this.context),this.enabledPlugins.value.delete(e),console.log(`[Plugin Manager] : ${t.config.name}`))}toggle(e){this.isEnabled(e)?this.disable(e):this.enable(e)}isEnabled(e){return this.enabledPlugins.value.has(e)}getPlugin(e){return this.plugins.get(e)}getAllPlugins(){return Array.from(this.plugins.values())}getEnabledPlugins(){return this.getAllPlugins().filter(e=>this.isEnabled(e.config.id))}getAllShortcuts(){return this.getEnabledPlugins().flatMap(e=>e.shortcuts||[])}callHook(e,...t){if(!this.context)return;let n=this.getEnabledPlugins();for(let r of n){let n=r.hooks?.[e];if(n&&typeof n==`function`&&n(this.context,...t)===!1)return!1}}},qf=V({__name:`PortHandle`,props:{id:{},type:{},position:{},variant:{default:`ellipse`},isConnectable:{type:Boolean,default:!0},nodeId:{},style:{default:()=>({})},class:{default:``}},setup(e){let t=e,n=r(),i=te(Gf),{endHandle:a,status:o}=xd(),s=q(()=>{if(!i)return null;let e=i.getSharedState()[`ctrl-connect`];if(!e||!e.candidate)return null;let t=e.candidate.value;return!t||!t.position?null:t}),c=q(()=>{let e=s.value;if(e)return e.nodeId===t.nodeId&&e.handleId===t.id&&e.handleType===t.type;let n=a.value;return!n||n.nodeId!==t.nodeId||n.type!==t.type?!1:n.id===t.id}),l=q(()=>{if(!c.value)return!0;let e=s.value;if(e)return e.isValid;let t=o.value;return t?t===`valid`:!0}),u=e=>{let t=n.nodes;return Pd(e,t)?l.value:!1},d=q(()=>c.value?l.value?`port-valid-target`:`port-invalid-target`:``),f=q(()=>{let e=[];return t.variant===`ellipse`?e.push(Sd.ellipse):e.push(Sd.circle),t.type===`source`?e.push(`port-output`):e.push(`port-input`),d.value&&e.push(d.value),t.class&&(Array.isArray(t.class)?e.push(...t.class):e.push(t.class)),e});return(t,n)=>(G(),L(B(au),{id:e.id,type:e.type,position:e.position,"is-connectable":e.isConnectable,"is-valid-connection":u,class:N(f.value),style:R(e.style)},null,8,[`id`,`type`,`position`,`is-connectable`,`class`,`style`]))}}),Jf={},Yf={class:`w-6 h-6`,viewBox:`0 0 24 24`,fill:`none`,xmlns:`http://www.w3.org/2000/svg`};function Xf(e,t){return G(),P(`svg`,Yf,[...t[0]||=[I(`rect`,{x:`4`,y:`4`,width:`6`,height:`6`,rx:`1.5`,stroke:`currentColor`,"stroke-width":`2`},null,-1),I(`rect`,{x:`14`,y:`4`,width:`6`,height:`6`,rx:`1.5`,stroke:`currentColor`,"stroke-width":`2`},null,-1),I(`rect`,{x:`4`,y:`14`,width:`6`,height:`6`,rx:`1.5`,stroke:`currentColor`,"stroke-width":`2`},null,-1),I(`rect`,{x:`14`,y:`14`,width:`6`,height:`6`,rx:`1.5`,stroke:`currentColor`,"stroke-width":`2`},null,-1)]])}var Zf=Z(Jf,[[`render`,Xf]]),Qf={},$f={class:`w-4 h-4`,viewBox:`0 0 16 16`,fill:`none`,xmlns:`http://www.w3.org/2000/svg`};function ep(e,t){return G(),P(`svg`,$f,[...t[0]||=[I(`rect`,{x:`2`,y:`2`,width:`5`,height:`5`,rx:`1`,stroke:`currentColor`,"stroke-width":`1.5`},null,-1),I(`rect`,{x:`9`,y:`9`,width:`5`,height:`5`,rx:`1`,stroke:`currentColor`,"stroke-width":`1.5`},null,-1),I(`path`,{d:`M4.5 7V9M7 4.5H9M7 11.5H9M11.5 7V9`,stroke:`currentColor`,"stroke-width":`1.5`},null,-1)]])}var tp=Z(Qf,[[`render`,ep]]),np={},rp={xmlns:`http://www.w3.org/2000/svg`,viewBox:`0 0 24 24`,fill:`none`,stroke:`currentColor`,"stroke-width":`2`,"stroke-linecap":`round`,"stroke-linejoin":`round`,width:`14`,height:`14`};function ip(e,t){return G(),P(`svg`,rp,[...t[0]||=[I(`rect`,{x:`2`,y:`2`,width:`20`,height:`8`,rx:`2`,ry:`2`},null,-1),I(`rect`,{x:`2`,y:`14`,width:`20`,height:`8`,rx:`2`,ry:`2`},null,-1),I(`line`,{x1:`6`,y1:`6`,x2:`6.01`,y2:`6`},null,-1),I(`line`,{x1:`6`,y1:`18`,x2:`6.01`,y2:`18`},null,-1)]])}var ap=Z(np,[[`render`,ip]]),op={},sp={class:`w-4 h-4`,viewBox:`0 0 18 18`,fill:`none`,xmlns:`http://www.w3.org/2000/svg`};function cp(e,t){return G(),P(`svg`,sp,[...t[0]||=[I(`circle`,{cx:`9`,cy:`9`,r:`3`,stroke:`currentColor`,"stroke-width":`1.5`},null,-1),I(`path`,{d:`M9 1V3M9 15V17M17 9H15M3 9H1M14.5 14.5L13 13M5 5L3.5 3.5M14.5 3.5L13 5M5 13L3.5 14.5`,stroke:`currentColor`,"stroke-width":`1.5`,"stroke-linecap":`round`},null,-1)]])}var lp=Z(op,[[`render`,cp]]),up={},dp={class:`w-5 h-5`,viewBox:`0 0 20 20`,fill:`none`,xmlns:`http://www.w3.org/2000/svg`};function fp(e,t){return G(),P(`svg`,dp,[...t[0]||=[I(`path`,{d:`M10 12.5C11.3807 12.5 12.5 11.3807 12.5 10C12.5 8.61929 11.3807 7.5 10 7.5C8.61929 7.5 7.5 8.61929 7.5 10C7.5 11.3807 8.61929 12.5 10 12.5Z`,stroke:`currentColor`,"stroke-width":`1.5`},null,-1),I(`path`,{d:`M10 1.25L11.5 4.5H14.75L12.25 6.75L13.5 10L10 7.75L6.5 10L7.75 6.75L5.25 4.5H8.5L10 1.25Z`,stroke:`currentColor`,"stroke-width":`1.5`,"stroke-linecap":`round`,"stroke-linejoin":`round`},null,-1)]])}var pp=Z(up,[[`render`,fp]]),mp={},hp={viewBox:`0 0 24 24`,fill:`none`,stroke:`currentColor`,"stroke-width":`2`,"stroke-linecap":`round`,"stroke-linejoin":`round`};function gp(e,t){return G(),P(`svg`,hp,[...t[0]||=[I(`rect`,{x:`3`,y:`3`,width:`18`,height:`18`,rx:`2`,ry:`2`},null,-1),I(`line`,{x1:`9`,y1:`9`,x2:`15`,y2:`9`},null,-1),I(`line`,{x1:`9`,y1:`15`,x2:`15`,y2:`15`},null,-1)]])}var _p=Z(mp,[[`render`,gp]]);const vp=[{id:`workflows`,label:``,icon:Zf,description:``},{id:`node-library`,label:``,icon:tp,description:``},{id:`node-config`,label:``,icon:pp,description:``},{id:`node-result-preview`,label:``,icon:_p,description:``},{id:`variables`,label:``,icon:rt,description:``},{id:`execution-history`,label:``,icon:ap,description:``}],yp=[{id:`settings`,label:``,icon:lp,description:``}];[...vp,...yp];var bp={},xp={viewBox:`0 0 24 24`,fill:`none`,stroke:`currentColor`,"stroke-width":`2`,"stroke-linecap":`round`,"stroke-linejoin":`round`};function Sp(e,t){return G(),P(`svg`,xp,[...t[0]||=[I(`path`,{d:`M21 12a9 9 0 1 1-6.219-8.56`},null,-1)]])}var Cp=Z(bp,[[`render`,Sp]]),wp={},Tp={viewBox:`0 0 24 24`,fill:`none`,stroke:`currentColor`,"stroke-width":`2`,"stroke-linecap":`round`,"stroke-linejoin":`round`};function Ep(e,t){return G(),P(`svg`,Tp,[...t[0]||=[I(`circle`,{cx:`12`,cy:`12`,r:`10`},null,-1),I(`polyline`,{points:`9 12 11 14 15 10`},null,-1)]])}var Dp=Z(wp,[[`render`,Ep]]),Op={},kp={viewBox:`0 0 24 24`,fill:`none`,stroke:`currentColor`,"stroke-width":`2`,"stroke-linecap":`round`,"stroke-linejoin":`round`};function Ap(e,t){return G(),P(`svg`,kp,[...t[0]||=[I(`circle`,{cx:`12`,cy:`12`,r:`10`},null,-1),I(`line`,{x1:`15`,y1:`9`,x2:`9`,y2:`15`},null,-1),I(`line`,{x1:`9`,y1:`9`,x2:`15`,y2:`15`},null,-1)]])}var jp=Z(Op,[[`render`,Ap]]),Mp={},Np={viewBox:`0 0 24 24`,fill:`none`,stroke:`currentColor`,"stroke-width":`2`,"stroke-linecap":`round`,"stroke-linejoin":`round`};function Pp(e,t){return G(),P(`svg`,Np,[...t[0]||=[I(`path`,{d:`M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z`},null,-1)]])}var Fp=Z(Mp,[[`render`,Pp]]),Ip={},Lp={viewBox:`0 0 24 24`,fill:`none`,stroke:`currentColor`,"stroke-width":`2`,"stroke-linecap":`round`,"stroke-linejoin":`round`};function Rp(e,t){return G(),P(`svg`,Lp,[...t[0]||=[I(`polygon`,{points:`5 4 15 12 5 20 5 4`},null,-1),I(`line`,{x1:`19`,y1:`5`,x2:`19`,y2:`19`},null,-1)]])}var zp=Z(Ip,[[`render`,Rp]]),Bp=[`title`],Vp={class:`flex items-center gap-1 hover:border-b group-hover:border-white`},Hp={class:`text-xs`},Up={key:0,class:`text-[11px] opacity-90 ml-0.5`},Wp=V({__name:`NodeExecutionBadge`,props:{nodeId:{}},setup(e){let t=e,n=r(),i=q(()=>n.getNodeExecutionStatus(t.nodeId)),a=q(()=>{let e=i.value?.status;return e&&e!==`pending`}),o=q(()=>{switch(i.value?.status){case`running`:return Cp;case`success`:return Dp;case`error`:return jp;case`cached`:return Fp;case`skipped`:return zp;default:return Cp}}),s=q(()=>{switch(i.value?.status){case`running`:return``;case`success`:return``;case`error`:return``;case`cached`:return``;case`skipped`:return``;default:return``}}),c=q(()=>i.value?.duration??null),l=q(()=>{switch(i.value?.status){case`running`:return`bg-blue-500/90 text-white`;case`success`:return`bg-green-500/90 text-white`;case`error`:return`bg-red-500/90 text-white`;case`cached`:return`bg-purple-500/90 text-white`;case`skipped`:return`bg-gray-400/90 text-white`;default:return`bg-gray-400/90 text-white`}}),u=q(()=>``);function d(){let e=i.value?.status;t.nodeId&&e&&(console.log(`[NodeExecutionBadge] :`,{nodeId:t.nodeId,status:e,result:i.value}),tt.emit(`execution:result:preview`,{nodeId:t.nodeId,status:e,result:i.value}))}return(e,t)=>a.value?(G(),P(`div`,{key:0,class:N([`absolute group h-6 -top-7 right-0 z-10 px-2 py-1 rounded-md text-xs font-medium leading-none whitespace-nowrap shadow backdrop-blur-sm cursor-pointer pointer-events-auto pb-1`,l.value]),title:u.value,onClick:se(d,[`stop`])},[I(`div`,Vp,[(G(),L(be(o.value),{class:N([`w-3.5 h-3.5`,i.value?.status===`running`?`animate-spin`:``])},null,8,[`class`])),I(`span`,Hp,J(s.value),1),c.value!==null&&i.value?.status!==`running`?(G(),P(`span`,Up,J(c.value)+`ms`,1)):z(``,!0)])],10,Bp)):z(``,!0)}}),Gp={},Kp={xmlns:`http://www.w3.org/2000/svg`,viewBox:`0 0 24 24`,fill:`currentColor`,width:`14`,height:`14`};function qp(e,t){return G(),P(`svg`,Kp,[...t[0]||=[I(`path`,{d:`M8 5v14l11-7z`},null,-1)]])}var Jp=Z(Gp,[[`render`,qp]]),Yp={},Xp={xmlns:`http://www.w3.org/2000/svg`,width:`1em`,height:`1em`,viewBox:`0 0 24 24`,fill:`none`,stroke:`currentColor`,"stroke-width":`2`,"stroke-linecap":`round`,"stroke-linejoin":`round`};function Zp(e,t){return G(),P(`svg`,Xp,[...t[0]||=[le(`<path d="M3 6h18"></path><path d="M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6"></path><path d="M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2"></path><line x1="10" x2="10" y1="11" y2="17"></line><line x1="14" x2="14" y1="11" y2="17"></line>`,5)]])}var Qp=Z(Yp,[[`render`,Zp]]),$p={},em={xmlns:`http://www.w3.org/2000/svg`,width:`1em`,height:`1em`,viewBox:`0 0 24 24`,fill:`none`,stroke:`currentColor`,"stroke-width":`2`,"stroke-linecap":`round`,"stroke-linejoin":`round`};function tm(e,t){return G(),P(`svg`,em,[...t[0]||=[I(`path`,{d:`M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7`},null,-1),I(`path`,{d:`M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z`},null,-1)]])}var nm=Z($p,[[`render`,tm]]),rm={},im={t:`1762760305870`,class:`icon`,viewBox:`0 0 1024 1024`,version:`1.1`,xmlns:`http://www.w3.org/2000/svg`,"p-id":`4562`};function am(e,t){return G(),P(`svg`,im,[...t[0]||=[I(`path`,{d:`M0 0h1024v1024H0z`,fill:`#FFFFFF`,"p-id":`4563`},null,-1),I(`path`,{d:`M160 279.264l-22.784-22.464A32 32 0 0 0 128 279.264h32zM340.704 96V64a32 32 0 0 0-22.784 9.536l22.784 22.464zM672 224h32-32z m0 416h32-32z m0-416a32 32 0 1 0 0 64V224z m160 160h-32 32z m0 416h32-32z m-480-32a32 32 0 1 0-64 0h64z m64-672a32 32 0 1 0-64 0h64z m-32 224v32a32 32 0 0 0 32-32h-32zM160 288a32 32 0 0 0 0 64V288z m22.784 13.76l180.704-183.296-45.568-44.928-180.704 183.264L182.784 301.76zM288 800h256v-64H288v64z m52.704-672H544V64h-203.296v64zM640 224v416h64V224h-64zM128 279.264V640h64V279.264H128zM288 736a96 96 0 0 1-96-96H128a160 160 0 0 0 160 160v-64z m256 64a160 160 0 0 0 160-160h-64a96 96 0 0 1-96 96v64z m0-672a96 96 0 0 1 96 96h64a160 160 0 0 0-160-160v64z m-96 832h256v-64h-256v64z m224-672h32V224h-32v64z m128 96v416h64V384h-64zM288 768v32h64v-32H288z m160 128a96 96 0 0 1-96-96H288a160 160 0 0 0 160 160v-64z m256 64a160 160 0 0 0 160-160h-64a96 96 0 0 1-96 96v64z m0-672a96 96 0 0 1 96 96h64a160 160 0 0 0-160-160v64zM352 96v224h64V96h-64z m32 192H160v64h224V288z`,fill:`currentColor`,"p-id":`4564`},null,-1)]])}var om=Z(rm,[[`render`,am]]),sm={class:`flex flex-col gap-1`},cm={class:`flex items-center gap-2`},lm={class:`flex items-center gap-2`},um=V({__name:`StandardNodeContent`,props:{data:{}},setup(e){return(t,n)=>(G(),P(`div`,sm,[I(`div`,cm,[n[1]||=I(`div`,{class:`rounded-md text-gray-600 text-[10px] w-8 text-right`},`  `,-1),I(`div`,lm,[(G(!0),P(je,null,Le(e.data.inputs,e=>(G(),P(`div`,{key:e.name,class:`rounded-xs px-0.5 text-[8px] py-0.5 font-mono bg-orange-200 text-orange-500`,style:{"line-height":`8px`}},[n[0]||=I(`span`,{class:`text-[6px] text-orange-300 italic font-bold`,style:{"margin-right":`1px`}},`str.`,-1),I(`span`,null,J(e.name),1)]))),128))])])]))}}),dm={class:`rounded-md overflow-hidden`},fm=[`innerHTML`],pm={class:`flex-1 text-[13px] font-medium overflow-hidden text-ellipsis whitespace-nowrap`},mm={key:0},hm={key:1,class:`w-full min-w-0 max-w-[100px] nodrag`},gm={key:3,class:`shrink-0`},_m={key:0,class:`text-xs text-gray-600 leading-relaxed line-clamp-3`},vm={key:1,class:`text-xs text-gray-400 italic`},ym=V({__name:`StandardNode`,props:{id:{},data:{},selected:{type:Boolean},parent:{}},setup(e){let t=e,n=U(!1),r=U(``),i=U(null),a=q(()=>{if(t.data.style)return t.data.style;if(t.data.type)try{return g(t.data.type).getStyle()}catch{}return{}}),o=q(()=>{let e={gap:`${Nf.iconGap}px`,paddingTop:`${Nf.headerPadding.vertical}px`,paddingBottom:`${Nf.headerPadding.vertical}px`,paddingLeft:`${Nf.headerPadding.horizontal}px`,paddingRight:`${Nf.headerPadding.horizontal}px`,height:`${Mf.headerHeight}px`,...a.value.headerStyle},t=a.value.headerColor;if(t)if(Array.isArray(t)){let[n,r=n]=t;e.background=`linear-gradient(135deg, ${n} 0%, ${r} 100%)`}else typeof t==`string`&&(e.backgroundColor=t);else e.backgroundColor=Pf.default;return e}),l=q(()=>({padding:`${Nf.contentPadding}px`,minHeight:`${Mf.contentMinHeight}px`,...a.value.bodyStyle})),u=q(()=>({minWidth:`${Mf.minWidth}px`,borderWidth:`${Mf.borderWidth}px`,borderColor:t.selected?Pf.borderSelected:Pf.border,borderRadius:`${Mf.borderRadius}px`,boxShadow:t.selected?`0 4px 12px rgba(59, 130, 246, 0.25)`:`0 2px 8px rgba(0, 0, 0, 0.08)`})),d=q(()=>({width:`${Mf.iconSize}px`,height:`${Mf.iconSize}px`})),f=q(()=>({width:`${Mf.iconSize+8}px`,height:`${Mf.iconSize+8}px`})),p=q(()=>t.data.showExecuteButton!==!1),m=q(()=>t.data.showDeleteButton!==!1);function h(){tt.emit(`node:execute`,{nodeId:t.id})}function _(){tt.emit(`node:delete-request`,{nodeId:t.id})}function v(){n.value=!0,r.value=t.data.label||``,F(()=>{i.value&&(i.value.focus(),i.value.select())})}function y(){if(!n.value)return;let e=r.value.trim();e&&e!==t.data.label&&tt.emit(`node:label-updated`,{nodeId:t.id,label:e}),n.value=!1}function b(){n.value=!1,r.value=t.data.label||``}function x(e){e.key===`F2`&&t.selected&&!n.value&&(e.preventDefault(),e.stopPropagation(),v())}ce(()=>{window.addEventListener(`keydown`,x)}),T(()=>{window.removeEventListener(`keydown`,x)});function S(){tt.emit(`node:duplicate-request`,{nodeId:t.id})}function C(){t.parent&&tt.emit(`node:detach-from-container`,{nodeId:t.id,containerId:t.parent})}let w=q(()=>{let e=[{label:``,key:`rename`,icon:()=>H(Je,null,{default:()=>H(nm)})},{label:``,key:`duplicate`,icon:()=>H(Je,null,{default:()=>H(om)})}];return t.parent&&e.unshift({label:``,key:`detach`,icon:()=>H(Je,null,{default:()=>H(s)})}),e.push({type:`divider`,key:`divider`}),e.push({label:``,key:`delete`,icon:()=>H(Je,null,{default:()=>H(Qp)})}),e});function E(e){switch(e){case`rename`:v();break;case`duplicate`:S();break;case`detach`:C();break;case`delete`:_();break}}let D=q(()=>a.value.showIcon===void 0?!!a.value.icon:a.value.showIcon),k=q(()=>{let e=a.value.icon;return!e||typeof e!=`string`?null:e.trim().startsWith(`<svg`)?e:null}),A=q(()=>{let e=a.value.icon;return!e||typeof e==`string`&&e.trim().startsWith(`<svg`)?null:typeof e==`object`?e:null}),M=q(()=>{let e=a.value.icon;return!e||typeof e!=`string`||e.trim().startsWith(`<svg`)?null:e}),ee=q(()=>!t.data.noInputs),te=q(()=>!t.data.noOutputs),ne=q(()=>({top:`${Mf.headerHeight+20}px!important`})),re=q(()=>({id:`input`,type:`target`,position:Q.Left,nodeId:t.id,variant:`ellipse`,style:ne.value})),ie=q(()=>({id:`output`,type:`source`,position:Q.Right,nodeId:t.id,variant:`ellipse`,style:ne.value}));return(t,a)=>(G(),P(`div`,{class:N([`relative bg-white shadow-sm min-h-24 h-full`,{"animate-pulse":e.data.status===`running`}]),style:R(u.value)},[O(Wp,{"node-id":e.id},null,8,[`node-id`]),ee.value?We(t.$slots,`inputPorts`,{key:0,nodeId:e.id,position:B(Q).Left,defaultPort:re.value},()=>[O(B(qf),{id:re.value.id,type:re.value.type,position:re.value.position,"node-id":re.value.nodeId,variant:re.value.variant,style:R(re.value.style)},null,8,[`id`,`type`,`position`,`node-id`,`variant`,`style`])]):z(``,!0),I(`div`,dm,[I(`div`,{class:`flex items-center text-white`,style:R(o.value)},[D.value&&A.value?(G(),L(be(A.value),{key:0,class:`shrink-0 text-white`,style:R(d.value)},null,8,[`style`])):D.value&&k.value?(G(),P(`div`,{key:1,class:`shrink-0 flex items-center justify-center text-white [&_svg]:w-full [&_svg]:h-full [&_svg]:text-inherit`,style:R(d.value),innerHTML:k.value},null,12,fm)):D.value&&M.value?(G(),P(`span`,{key:2,class:`text-lg leading-none shrink-0 flex items-center justify-center`,style:R({fontSize:`${B(Mf).iconSize}px`})},J(M.value),5)):z(``,!0),I(`div`,pm,[n.value?(G(),P(`div`,hm,[O(B(Oe),{ref_key:`renameInputRef`,ref:i,value:r.value,"onUpdate:value":a[0]||=e=>r.value=e,size:`tiny`,class:`w-full`,placeholder:``,"input-props":{class:`text-white`},style:{"--n-color":`rgba(255, 255, 255, 0.2)`,"--n-color-focus":`rgba(255, 255, 255, 0.2)`,"--n-border":`1px solid rgba(255, 255, 255, 0.3)`,"--n-border-focus":`1px solid rgba(255, 255, 255, 0.6)`,"--n-border-hover":`1px solid rgba(255, 255, 255, 0.4)`,"--n-text-color":`white`,"--n-caret-color":`white`,"--n-font-size":`13px`},onKeydown:[j(y,[`enter`]),j(b,[`esc`])],onBlur:y,onClick:a[1]||=se(()=>{},[`stop`])},null,8,[`value`])])):(G(),P(`span`,mm,J(e.data.label||``),1))]),e.data.status?(G(),P(`div`,gm,[I(`div`,{class:N([`w-2 h-2 rounded-full`,{"bg-white shadow-[0_0_0_2px_rgba(255,255,255,0.3)]":e.data.status===`success`,"bg-red-200 shadow-[0_0_0_2px_rgba(254,202,202,0.3)]":e.data.status===`error`,"bg-yellow-100 shadow-[0_0_0_2px_rgba(254,243,199,0.3)] animate-ping":e.data.status===`running`,"bg-slate-200":e.data.status===`pending`}])},null,2)])):z(``,!0),I(`div`,{class:`shrink-0 flex items-center gap-1 ml-auto`,onClick:a[3]||=se(()=>{},[`stop`])},[p.value?(G(),P(`button`,{key:0,class:`rounded hover:bg-white/20 transition-colors flex items-center justify-center`,style:R(f.value),title:``,onClick:h},[O(Jp,{style:R(d.value),class:`text-white`},null,8,[`style`])],4)):z(``,!0),m.value?(G(),L(B(Me),{key:1,options:w.value,onSelect:E,trigger:`click`,placement:`bottom-end`},{default:Y(()=>[I(`button`,{class:`p-1 rounded hover:bg-white/20 transition-colors flex items-center justify-center`,style:R(f.value),title:``,onClick:a[2]||=se(()=>{},[`stop`])},[O(c,{style:R(d.value),class:`text-white`},null,8,[`style`])],4)]),_:1},8,[`options`])):z(``,!0),We(t.$slots,`headerActions`)])],4),I(`div`,{class:`bg-white nopan`,style:R(l.value)},[We(t.$slots,`default`,{},()=>[e.data.description?(G(),P(`div`,_m,J(e.data.description),1)):(G(),P(`div`,vm,``)),O(um,{data:e.data},null,8,[`data`])])],4)]),te.value?We(t.$slots,`outputPorts`,{key:1,nodeId:e.id,position:B(Q).Right,defaultPort:ie.value},()=>[O(B(qf),{id:ie.value.id,type:ie.value.type,position:ie.value.position,"node-id":ie.value.nodeId,variant:ie.value.variant,style:R(ie.value.style)},null,8,[`id`,`type`,`position`,`node-id`,`variant`,`style`])]):z(``,!0)],6))}}),bm=V({__name:`CustomNode`,props:{id:{},data:{},selected:{type:Boolean},parent:{}},setup(e){let t=e,n=q(()=>{let e={...t.data.color&&{headerColor:t.data.color},...t.data.icon&&{icon:t.data.icon}};return{...t.data,style:Object.keys(e).length>0?e:void 0}});return(t,r)=>(G(),L(ym,{id:e.id,data:n.value,selected:e.selected,parent:e.parent},null,8,[`id`,`data`,`selected`,`parent`]))}});function xm(e={}){let{enableStoreSync:t=!0,enableEvents:n=!0,pluginManager:i}=e,a=r(),o=n?nt():null,s=Hu(),{fitView:c,project:l,addNodes:u,addEdges:d}=s,f=U([]),p=U([]);function m(){t&&(h(),_())}function h(){f.value=a.nodes,p.value=a.edges}function g(){a.updateNodes(f.value),a.updateEdges(p.value)}function _(){let e=null,t=t=>{e!==null&&clearTimeout(e),e=window.setTimeout(t,150)};W(()=>a.currentWorkflowId,(e,t)=>{e!==t&&(h(),o&&o.emit(`workflow:switched`,{workflowId:e,previousWorkflowId:t}))}),W(()=>a.nodes,e=>{f.value=e}),W(()=>a.edges,e=>{p.value=e}),W(()=>f.value.length,()=>{t(()=>{a.updateNodes(f.value),o&&o.emit(`canvas:viewport-changed`,{x:0,y:0,zoom:1})})}),W(()=>f.value.map(e=>`${e.id}:${e.position.x}:${e.position.y}`).join(`,`),()=>{t(()=>{a.updateNodes(f.value)})}),W(()=>p.value.length,()=>{t(()=>{a.updateEdges(p.value)})})}function v(e){u([e]),o&&o.emit(`node:added`,{node:e})}function y(e,t=!0){if(i&&t&&i.callHook(`beforeNodeDelete`,e)===!1){console.log(`[VueFlowCore] : ${e}`);return}f.value=f.value.filter(t=>t.id!==e),p.value=p.value.filter(t=>t.source!==e&&t.target!==e),i&&t&&i.callHook(`afterNodeDelete`,e),o&&o.emit(`node:deleted`,{nodeId:e})}function b(e){d([e]),o&&o.emit(`edge:added`,{edge:e})}function x(e,t=!0){if(i&&t&&i.callHook(`beforeEdgeDelete`,e)===!1){console.log(`[VueFlowCore] : ${e}`);return}p.value=p.value.filter(t=>t.id!==e),i&&i.callHook(`afterEdgeDelete`,e),o&&o.emit(`edge:deleted`,{edgeId:e})}function S(e){p.value=e(p.value)}function C(e){f.value=e(f.value)}function w(){f.value=[],p.value=[],o&&o.emit(`canvas:cleared`,void 0)}async function T(e){await c({padding:e?.padding??.2,duration:e?.duration??300}),o&&o.emit(`canvas:fit-view`,{padding:e?.padding})}function E(){return l({x:window.innerWidth/2,y:window.innerHeight/2})}return m(),{nodes:f,edges:p,fitView:c,project:l,vueflow:s,addNode:v,deleteNode:y,addEdge:b,deleteEdge:x,updateEdges:S,updateNodes:C,clearCanvas:w,fitViewToCanvas:T,getCanvasCenter:E,syncFromStore:h,syncToStoreImmediate:g,events:o}}const Sm={defaultZoom:1,minZoom:.1,maxZoom:4,snapToGrid:!1,snapGrid:[20,20],fitViewOnInit:!0,connectOnClick:!0,connectionMode:`strict`,defaultEdgeOptions:{type:`default`,animated:!1}},Cm={pannable:!0,zoomable:!0,position:`top-right`},wm={position:`bottom-right`,showZoom:!0,showFitView:!0,showInteractive:!0};var Tm=(e=>(e.Lines=`lines`,e.Dots=`dots`,e))(Tm||{}),Em=function({dimensions:e,size:t,color:n}){return H(`path`,{stroke:n,"stroke-width":t,d:`M${e[0]/2} 0 V${e[1]} M0 ${e[1]/2} H${e[0]}`})},Dm=function({radius:e,color:t}){return H(`circle`,{cx:e,cy:e,r:e,fill:t})};Tm.Lines,Tm.Dots;var Om={[Tm.Dots]:`#81818a`,[Tm.Lines]:`#eee`},km=[`id`,`x`,`y`,`width`,`height`,`patternTransform`],Am={key:2,height:`100`,width:`100`},jm=[`fill`],Mm=[`x`,`y`,`fill`],Nm=V({name:`Background`,compatConfig:{MODE:3},props:{id:{},variant:{default:()=>Tm.Dots},gap:{default:20},size:{default:1},lineWidth:{default:1},patternColor:{},color:{},bgColor:{},height:{default:100},width:{default:100},x:{default:0},y:{default:0},offset:{default:0}},setup(e){let{id:t,viewport:n}=Hu(),r=q(()=>{let t=n.value.zoom,[r,i]=Array.isArray(e.gap)?e.gap:[e.gap,e.gap],a=[r*t||1,i*t||1],o=e.size*t,[s,c]=Array.isArray(e.offset)?e.offset:[e.offset,e.offset],l=[s*t||1+a[0]/2,c*t||1+a[1]/2];return{scaledGap:a,offset:l,size:o}}),i=de(()=>`pattern-${t}${e.id?`-${e.id}`:``}`),a=de(()=>e.color||e.patternColor||Om[e.variant||Tm.Dots]);return(e,t)=>(G(),P(`svg`,{class:`vue-flow__background vue-flow__container`,style:R({height:`${e.height>100?100:e.height}%`,width:`${e.width>100?100:e.width}%`})},[We(e.$slots,`pattern-container`,{id:i.value},()=>[I(`pattern`,{id:i.value,x:B(n).x%r.value.scaledGap[0],y:B(n).y%r.value.scaledGap[1],width:r.value.scaledGap[0],height:r.value.scaledGap[1],patternTransform:`translate(-${r.value.offset[0]},-${r.value.offset[1]})`,patternUnits:`userSpaceOnUse`},[We(e.$slots,`pattern`,{},()=>[e.variant===B(Tm).Lines?(G(),L(B(Em),{key:0,size:e.lineWidth,color:a.value,dimensions:r.value.scaledGap},null,8,[`size`,`color`,`dimensions`])):e.variant===B(Tm).Dots?(G(),L(B(Dm),{key:1,color:a.value,radius:r.value.size/2},null,8,[`color`,`radius`])):z(``,!0),e.bgColor?(G(),P(`svg`,Am,[I(`rect`,{width:`100%`,height:`100%`,fill:e.bgColor},null,8,jm)])):z(``,!0)])],8,km)]),I(`rect`,{x:e.x,y:e.y,width:`100%`,height:`100%`,fill:`url(#${i.value})`},null,8,Mm),We(e.$slots,`default`,{id:i.value})],4))}}),Pm={name:`ControlButton`,compatConfig:{MODE:3}},Fm=(e,t)=>{let n=e.__vccOpts||e;for(let[e,r]of t)n[e]=r;return n},Im={type:`button`,class:`vue-flow__controls-button`};function Lm(e,t,n,r,i,a){return G(),P(`button`,Im,[We(e.$slots,`default`)])}var Rm=Fm(Pm,[[`render`,Lm]]),zm={xmlns:`http://www.w3.org/2000/svg`,viewBox:`0 0 32 32`},Bm=[I(`path`,{d:`M32 18.133H18.133V32h-4.266V18.133H0v-4.266h13.867V0h4.266v13.867H32z`},null,-1)];function Vm(e,t){return G(),P(`svg`,zm,Bm)}var Hm={render:Vm},Um={xmlns:`http://www.w3.org/2000/svg`,viewBox:`0 0 32 5`},Wm=[I(`path`,{d:`M0 0h32v4.2H0z`},null,-1)];function Gm(e,t){return G(),P(`svg`,Um,Wm)}var Km={render:Gm},qm={xmlns:`http://www.w3.org/2000/svg`,viewBox:`0 0 32 30`},Jm=[I(`path`,{d:`M3.692 4.63c0-.53.4-.938.939-.938h5.215V0H4.708C2.13 0 0 2.054 0 4.63v5.216h3.692V4.631zM27.354 0h-5.2v3.692h5.17c.53 0 .984.4.984.939v5.215H32V4.631A4.624 4.624 0 0 0 27.354 0zm.954 24.83c0 .532-.4.94-.939.94h-5.215v3.768h5.215c2.577 0 4.631-2.13 4.631-4.707v-5.139h-3.692v5.139zm-23.677.94a.919.919 0 0 1-.939-.94v-5.138H0v5.139c0 2.577 2.13 4.707 4.708 4.707h5.138V25.77H4.631z`},null,-1)];function Ym(e,t){return G(),P(`svg`,qm,Jm)}var Xm={render:Ym},Zm={xmlns:`http://www.w3.org/2000/svg`,viewBox:`0 0 25 32`},Qm=[I(`path`,{d:`M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0 8 0 4.571 3.429 4.571 7.619v3.048H3.048A3.056 3.056 0 0 0 0 13.714v15.238A3.056 3.056 0 0 0 3.048 32h18.285a3.056 3.056 0 0 0 3.048-3.048V13.714a3.056 3.056 0 0 0-3.048-3.047zM12.19 24.533a3.056 3.056 0 0 1-3.047-3.047 3.056 3.056 0 0 1 3.047-3.048 3.056 3.056 0 0 1 3.048 3.048 3.056 3.056 0 0 1-3.048 3.047zm4.724-13.866H7.467V7.619c0-2.59 2.133-4.724 4.723-4.724 2.591 0 4.724 2.133 4.724 4.724v3.048z`},null,-1)];function $m(e,t){return G(),P(`svg`,Zm,Qm)}var eh={render:$m},th={xmlns:`http://www.w3.org/2000/svg`,viewBox:`0 0 25 32`},nh=[I(`path`,{d:`M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0c-4.114 1.828-1.37 2.133.305 2.438 1.676.305 4.42 2.59 4.42 5.181v3.048H3.047A3.056 3.056 0 0 0 0 13.714v15.238A3.056 3.056 0 0 0 3.048 32h18.285a3.056 3.056 0 0 0 3.048-3.048V13.714a3.056 3.056 0 0 0-3.048-3.047zM12.19 24.533a3.056 3.056 0 0 1-3.047-3.047 3.056 3.056 0 0 1 3.047-3.048 3.056 3.056 0 0 1 3.048 3.048 3.056 3.056 0 0 1-3.048 3.047z`},null,-1)];function rh(e,t){return G(),P(`svg`,th,nh)}var ih={render:rh},ah=V({name:`Controls`,compatConfig:{MODE:3},props:{showZoom:{type:Boolean,default:!0},showFitView:{type:Boolean,default:!0},showInteractive:{type:Boolean,default:!0},fitViewParams:{},position:{default:()=>Ms.BottomLeft}},emits:[`zoomIn`,`zoomOut`,`fitView`,`interactionChange`],setup(e,{emit:t}){let{nodesDraggable:n,nodesConnectable:r,elementsSelectable:i,setInteractive:a,zoomIn:o,zoomOut:s,fitView:c,viewport:l,minZoom:u,maxZoom:d}=Hu(),f=de(()=>n.value||r.value||i.value),p=de(()=>l.value.zoom<=u.value),m=de(()=>l.value.zoom>=d.value);function h(){o(),t(`zoomIn`)}function g(){s(),t(`zoomOut`)}function _(){c(e.fitViewParams),t(`fitView`)}function v(){a(!f.value),t(`interactionChange`,!f.value)}return(e,t)=>(G(),L(B(bd),{class:`vue-flow__controls`,position:e.position},{default:Y(()=>[We(e.$slots,`top`),e.showZoom?(G(),P(je,{key:0},[We(e.$slots,`control-zoom-in`,{},()=>[O(Rm,{class:`vue-flow__controls-zoomin`,disabled:m.value,onClick:h},{default:Y(()=>[We(e.$slots,`icon-zoom-in`,{},()=>[(G(),L(be(B(Hm))))])]),_:3},8,[`disabled`])]),We(e.$slots,`control-zoom-out`,{},()=>[O(Rm,{class:`vue-flow__controls-zoomout`,disabled:p.value,onClick:g},{default:Y(()=>[We(e.$slots,`icon-zoom-out`,{},()=>[(G(),L(be(B(Km))))])]),_:3},8,[`disabled`])])],64)):z(``,!0),e.showFitView?We(e.$slots,`control-fit-view`,{key:1},()=>[O(Rm,{class:`vue-flow__controls-fitview`,onClick:_},{default:Y(()=>[We(e.$slots,`icon-fit-view`,{},()=>[(G(),L(be(B(Xm))))])]),_:3})]):z(``,!0),e.showInteractive?We(e.$slots,`control-interactive`,{key:2},()=>[e.showInteractive?(G(),L(Rm,{key:0,class:`vue-flow__controls-interactive`,onClick:v},{default:Y(()=>[f.value?We(e.$slots,`icon-unlock`,{key:0},()=>[(G(),L(be(B(ih))))]):z(``,!0),f.value?z(``,!0):We(e.$slots,`icon-lock`,{key:1},()=>[(G(),L(be(B(eh))))])]),_:3})):z(``,!0)]):z(``,!0),We(e.$slots,`default`)]),_:3},8,[`position`]))}}),oh={value:()=>{}};function sh(){for(var e=0,t=arguments.length,n={},r;e<t;++e){if(!(r=arguments[e]+``)||r in n||/[\s.]/.test(r))throw Error(`illegal type: `+r);n[r]=[]}return new ch(n)}function ch(e){this._=e}function lh(e,t){return e.trim().split(/^|\s+/).map(function(e){var n=``,r=e.indexOf(`.`);if(r>=0&&(n=e.slice(r+1),e=e.slice(0,r)),e&&!t.hasOwnProperty(e))throw Error(`unknown type: `+e);return{type:e,name:n}})}ch.prototype=sh.prototype={constructor:ch,on:function(e,t){var n=this._,r=lh(e+``,n),i,a=-1,o=r.length;if(arguments.length<2){for(;++a<o;)if((i=(e=r[a]).type)&&(i=uh(n[i],e.name)))return i;return}if(t!=null&&typeof t!=`function`)throw Error(`invalid callback: `+t);for(;++a<o;)if(i=(e=r[a]).type)n[i]=dh(n[i],e.name,t);else if(t==null)for(i in n)n[i]=dh(n[i],e.name,null);return this},copy:function(){var e={},t=this._;for(var n in t)e[n]=t[n].slice();return new ch(e)},call:function(e,t){if((i=arguments.length-2)>0)for(var n=Array(i),r=0,i,a;r<i;++r)n[r]=arguments[r+2];if(!this._.hasOwnProperty(e))throw Error(`unknown type: `+e);for(a=this._[e],r=0,i=a.length;r<i;++r)a[r].value.apply(t,n)},apply:function(e,t,n){if(!this._.hasOwnProperty(e))throw Error(`unknown type: `+e);for(var r=this._[e],i=0,a=r.length;i<a;++i)r[i].value.apply(t,n)}};function uh(e,t){for(var n=0,r=e.length,i;n<r;++n)if((i=e[n]).name===t)return i.value}function dh(e,t,n){for(var r=0,i=e.length;r<i;++r)if(e[r].name===t){e[r]=oh,e=e.slice(0,r).concat(e.slice(r+1));break}return n!=null&&e.push({name:t,value:n}),e}var fh=`http://www.w3.org/1999/xhtml`,ph={svg:`http://www.w3.org/2000/svg`,xhtml:fh,xlink:`http://www.w3.org/1999/xlink`,xml:`http://www.w3.org/XML/1998/namespace`,xmlns:`http://www.w3.org/2000/xmlns/`};function mh(e){var t=e+=``,n=t.indexOf(`:`);return n>=0&&(t=e.slice(0,n))!==`xmlns`&&(e=e.slice(n+1)),ph.hasOwnProperty(t)?{space:ph[t],local:e}:e}function hh(e){return function(){var t=this.ownerDocument,n=this.namespaceURI;return n===fh&&t.documentElement.namespaceURI===fh?t.createElement(e):t.createElementNS(n,e)}}function gh(e){return function(){return this.ownerDocument.createElementNS(e.space,e.local)}}function _h(e){var t=mh(e);return(t.local?gh:hh)(t)}function vh(){}function yh(e){return e==null?vh:function(){return this.querySelector(e)}}function bh(e){typeof e!=`function`&&(e=yh(e));for(var t=this._groups,n=t.length,r=Array(n),i=0;i<n;++i)for(var a=t[i],o=a.length,s=r[i]=Array(o),c,l,u=0;u<o;++u)(c=a[u])&&(l=e.call(c,c.__data__,u,a))&&(`__data__`in c&&(l.__data__=c.__data__),s[u]=l);return new c_(r,this._parents)}function xh(e){return e==null?[]:Array.isArray(e)?e:Array.from(e)}function Sh(){return[]}function Ch(e){return e==null?Sh:function(){return this.querySelectorAll(e)}}function wh(e){return function(){return xh(e.apply(this,arguments))}}function Th(e){e=typeof e==`function`?wh(e):Ch(e);for(var t=this._groups,n=t.length,r=[],i=[],a=0;a<n;++a)for(var o=t[a],s=o.length,c,l=0;l<s;++l)(c=o[l])&&(r.push(e.call(c,c.__data__,l,o)),i.push(c));return new c_(r,i)}function Eh(e){return function(){return this.matches(e)}}function Dh(e){return function(t){return t.matches(e)}}var Oh=Array.prototype.find;function kh(e){return function(){return Oh.call(this.children,e)}}function Ah(){return this.firstElementChild}function jh(e){return this.select(e==null?Ah:kh(typeof e==`function`?e:Dh(e)))}var Mh=Array.prototype.filter;function Nh(){return Array.from(this.children)}function Ph(e){return function(){return Mh.call(this.children,e)}}function Fh(e){return this.selectAll(e==null?Nh:Ph(typeof e==`function`?e:Dh(e)))}function Ih(e){typeof e!=`function`&&(e=Eh(e));for(var t=this._groups,n=t.length,r=Array(n),i=0;i<n;++i)for(var a=t[i],o=a.length,s=r[i]=[],c,l=0;l<o;++l)(c=a[l])&&e.call(c,c.__data__,l,a)&&s.push(c);return new c_(r,this._parents)}function Lh(e){return Array(e.length)}function Rh(){return new c_(this._enter||this._groups.map(Lh),this._parents)}function zh(e,t){this.ownerDocument=e.ownerDocument,this.namespaceURI=e.namespaceURI,this._next=null,this._parent=e,this.__data__=t}zh.prototype={constructor:zh,appendChild:function(e){return this._parent.insertBefore(e,this._next)},insertBefore:function(e,t){return this._parent.insertBefore(e,t)},querySelector:function(e){return this._parent.querySelector(e)},querySelectorAll:function(e){return this._parent.querySelectorAll(e)}};function Bh(e){return function(){return e}}function Vh(e,t,n,r,i,a){for(var o=0,s,c=t.length,l=a.length;o<l;++o)(s=t[o])?(s.__data__=a[o],r[o]=s):n[o]=new zh(e,a[o]);for(;o<c;++o)(s=t[o])&&(i[o]=s)}function Hh(e,t,n,r,i,a,o){var s,c,l=new Map,u=t.length,d=a.length,f=Array(u),p;for(s=0;s<u;++s)(c=t[s])&&(f[s]=p=o.call(c,c.__data__,s,t)+``,l.has(p)?i[s]=c:l.set(p,c));for(s=0;s<d;++s)p=o.call(e,a[s],s,a)+``,(c=l.get(p))?(r[s]=c,c.__data__=a[s],l.delete(p)):n[s]=new zh(e,a[s]);for(s=0;s<u;++s)(c=t[s])&&l.get(f[s])===c&&(i[s]=c)}function Uh(e){return e.__data__}function Wh(e,t){if(!arguments.length)return Array.from(this,Uh);var n=t?Hh:Vh,r=this._parents,i=this._groups;typeof e!=`function`&&(e=Bh(e));for(var a=i.length,o=Array(a),s=Array(a),c=Array(a),l=0;l<a;++l){var u=r[l],d=i[l],f=d.length,p=Gh(e.call(u,u&&u.__data__,l,r)),m=p.length,h=s[l]=Array(m),g=o[l]=Array(m),_=c[l]=Array(f);n(u,d,h,g,_,p,t);for(var v=0,y=0,b,x;v<m;++v)if(b=h[v]){for(v>=y&&(y=v+1);!(x=g[y])&&++y<m;);b._next=x||null}}return o=new c_(o,r),o._enter=s,o._exit=c,o}function Gh(e){return typeof e==`object`&&`length`in e?e:Array.from(e)}function Kh(){return new c_(this._exit||this._groups.map(Lh),this._parents)}function qh(e,t,n){var r=this.enter(),i=this,a=this.exit();return typeof e==`function`?(r=e(r),r&&=r.selection()):r=r.append(e+``),t!=null&&(i=t(i),i&&=i.selection()),n==null?a.remove():n(a),r&&i?r.merge(i).order():i}function Jh(e){for(var t=e.selection?e.selection():e,n=this._groups,r=t._groups,i=n.length,a=r.length,o=Math.min(i,a),s=Array(i),c=0;c<o;++c)for(var l=n[c],u=r[c],d=l.length,f=s[c]=Array(d),p,m=0;m<d;++m)(p=l[m]||u[m])&&(f[m]=p);for(;c<i;++c)s[c]=n[c];return new c_(s,this._parents)}function Yh(){for(var e=this._groups,t=-1,n=e.length;++t<n;)for(var r=e[t],i=r.length-1,a=r[i],o;--i>=0;)(o=r[i])&&(a&&o.compareDocumentPosition(a)^4&&a.parentNode.insertBefore(o,a),a=o);return this}function Xh(e){e||=Zh;function t(t,n){return t&&n?e(t.__data__,n.__data__):!t-!n}for(var n=this._groups,r=n.length,i=Array(r),a=0;a<r;++a){for(var o=n[a],s=o.length,c=i[a]=Array(s),l,u=0;u<s;++u)(l=o[u])&&(c[u]=l);c.sort(t)}return new c_(i,this._parents).order()}function Zh(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function Qh(){var e=arguments[0];return arguments[0]=this,e.apply(null,arguments),this}function $h(){return Array.from(this)}function eg(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var r=e[t],i=0,a=r.length;i<a;++i){var o=r[i];if(o)return o}return null}function tg(){let e=0;for(let t of this)++e;return e}function ng(){return!this.node()}function rg(e){for(var t=this._groups,n=0,r=t.length;n<r;++n)for(var i=t[n],a=0,o=i.length,s;a<o;++a)(s=i[a])&&e.call(s,s.__data__,a,i);return this}function ig(e){return function(){this.removeAttribute(e)}}function ag(e){return function(){this.removeAttributeNS(e.space,e.local)}}function og(e,t){return function(){this.setAttribute(e,t)}}function sg(e,t){return function(){this.setAttributeNS(e.space,e.local,t)}}function cg(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttribute(e):this.setAttribute(e,n)}}function lg(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,n)}}function ug(e,t){var n=mh(e);if(arguments.length<2){var r=this.node();return n.local?r.getAttributeNS(n.space,n.local):r.getAttribute(n)}return this.each((t==null?n.local?ag:ig:typeof t==`function`?n.local?lg:cg:n.local?sg:og)(n,t))}function dg(e){return e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView}function fg(e){return function(){this.style.removeProperty(e)}}function pg(e,t,n){return function(){this.style.setProperty(e,t,n)}}function mg(e,t,n){return function(){var r=t.apply(this,arguments);r==null?this.style.removeProperty(e):this.style.setProperty(e,r,n)}}function hg(e,t,n){return arguments.length>1?this.each((t==null?fg:typeof t==`function`?mg:pg)(e,t,n??``)):gg(this.node(),e)}function gg(e,t){return e.style.getPropertyValue(t)||dg(e).getComputedStyle(e,null).getPropertyValue(t)}function _g(e){return function(){delete this[e]}}function vg(e,t){return function(){this[e]=t}}function yg(e,t){return function(){var n=t.apply(this,arguments);n==null?delete this[e]:this[e]=n}}function bg(e,t){return arguments.length>1?this.each((t==null?_g:typeof t==`function`?yg:vg)(e,t)):this.node()[e]}function xg(e){return e.trim().split(/^|\s+/)}function Sg(e){return e.classList||new Cg(e)}function Cg(e){this._node=e,this._names=xg(e.getAttribute(`class`)||``)}Cg.prototype={add:function(e){this._names.indexOf(e)<0&&(this._names.push(e),this._node.setAttribute(`class`,this._names.join(` `)))},remove:function(e){var t=this._names.indexOf(e);t>=0&&(this._names.splice(t,1),this._node.setAttribute(`class`,this._names.join(` `)))},contains:function(e){return this._names.indexOf(e)>=0}};function wg(e,t){for(var n=Sg(e),r=-1,i=t.length;++r<i;)n.add(t[r])}function Tg(e,t){for(var n=Sg(e),r=-1,i=t.length;++r<i;)n.remove(t[r])}function Eg(e){return function(){wg(this,e)}}function Dg(e){return function(){Tg(this,e)}}function Og(e,t){return function(){(t.apply(this,arguments)?wg:Tg)(this,e)}}function kg(e,t){var n=xg(e+``);if(arguments.length<2){for(var r=Sg(this.node()),i=-1,a=n.length;++i<a;)if(!r.contains(n[i]))return!1;return!0}return this.each((typeof t==`function`?Og:t?Eg:Dg)(n,t))}function Ag(){this.textContent=``}function jg(e){return function(){this.textContent=e}}function Mg(e){return function(){this.textContent=e.apply(this,arguments)??``}}function Ng(e){return arguments.length?this.each(e==null?Ag:(typeof e==`function`?Mg:jg)(e)):this.node().textContent}function Pg(){this.innerHTML=``}function Fg(e){return function(){this.innerHTML=e}}function Ig(e){return function(){this.innerHTML=e.apply(this,arguments)??``}}function Lg(e){return arguments.length?this.each(e==null?Pg:(typeof e==`function`?Ig:Fg)(e)):this.node().innerHTML}function Rg(){this.nextSibling&&this.parentNode.appendChild(this)}function zg(){return this.each(Rg)}function Bg(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function Vg(){return this.each(Bg)}function Hg(e){var t=typeof e==`function`?e:_h(e);return this.select(function(){return this.appendChild(t.apply(this,arguments))})}function Ug(){return null}function Wg(e,t){var n=typeof e==`function`?e:_h(e),r=t==null?Ug:typeof t==`function`?t:yh(t);return this.select(function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)})}function Gg(){var e=this.parentNode;e&&e.removeChild(this)}function Kg(){return this.each(Gg)}function qg(){var e=this.cloneNode(!1),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function Jg(){var e=this.cloneNode(!0),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function Yg(e){return this.select(e?Jg:qg)}function Xg(e){return arguments.length?this.property(`__data__`,e):this.node().__data__}function Zg(e){return function(t){e.call(this,t,this.__data__)}}function Qg(e){return e.trim().split(/^|\s+/).map(function(e){var t=``,n=e.indexOf(`.`);return n>=0&&(t=e.slice(n+1),e=e.slice(0,n)),{type:e,name:t}})}function $g(e){return function(){var t=this.__on;if(t){for(var n=0,r=-1,i=t.length,a;n<i;++n)a=t[n],(!e.type||a.type===e.type)&&a.name===e.name?this.removeEventListener(a.type,a.listener,a.options):t[++r]=a;++r?t.length=r:delete this.__on}}}function e_(e,t,n){return function(){var r=this.__on,i,a=Zg(t);if(r){for(var o=0,s=r.length;o<s;++o)if((i=r[o]).type===e.type&&i.name===e.name){this.removeEventListener(i.type,i.listener,i.options),this.addEventListener(i.type,i.listener=a,i.options=n),i.value=t;return}}this.addEventListener(e.type,a,n),i={type:e.type,name:e.name,value:t,listener:a,options:n},r?r.push(i):this.__on=[i]}}function t_(e,t,n){var r=Qg(e+``),i,a=r.length,o;if(arguments.length<2){var s=this.node().__on;if(s){for(var c=0,l=s.length,u;c<l;++c)for(i=0,u=s[c];i<a;++i)if((o=r[i]).type===u.type&&o.name===u.name)return u.value}return}for(s=t?e_:$g,i=0;i<a;++i)this.each(s(r[i],t,n));return this}function n_(e,t,n){var r=dg(e),i=r.CustomEvent;typeof i==`function`?i=new i(t,n):(i=r.document.createEvent(`Event`),n?(i.initEvent(t,n.bubbles,n.cancelable),i.detail=n.detail):i.initEvent(t,!1,!1)),e.dispatchEvent(i)}function r_(e,t){return function(){return n_(this,e,t)}}function i_(e,t){return function(){return n_(this,e,t.apply(this,arguments))}}function a_(e,t){return this.each((typeof t==`function`?i_:r_)(e,t))}function*o_(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var r=e[t],i=0,a=r.length,o;i<a;++i)(o=r[i])&&(yield o)}var s_=[null];function c_(e,t){this._groups=e,this._parents=t}function l_(){return new c_([[document.documentElement]],s_)}function u_(){return this}c_.prototype=l_.prototype={constructor:c_,select:bh,selectAll:Th,selectChild:jh,selectChildren:Fh,filter:Ih,data:Wh,enter:Rh,exit:Kh,join:qh,merge:Jh,selection:u_,order:Yh,sort:Xh,call:Qh,nodes:$h,node:eg,size:tg,empty:ng,each:rg,attr:ug,style:hg,property:bg,classed:kg,text:Ng,html:Lg,raise:zg,lower:Vg,append:Hg,insert:Wg,remove:Kg,clone:Yg,datum:Xg,on:t_,dispatch:a_,[Symbol.iterator]:o_};function d_(e){return typeof e==`string`?new c_([[document.querySelector(e)]],[document.documentElement]):new c_([[e]],s_)}function f_(e){let t;for(;t=e.sourceEvent;)e=t;return e}function p_(e,t){if(e=f_(e),t===void 0&&(t=e.currentTarget),t){var n=t.ownerSVGElement||t;if(n.createSVGPoint){var r=n.createSVGPoint();return r.x=e.clientX,r.y=e.clientY,r=r.matrixTransform(t.getScreenCTM().inverse()),[r.x,r.y]}if(t.getBoundingClientRect){var i=t.getBoundingClientRect();return[e.clientX-i.left-t.clientLeft,e.clientY-i.top-t.clientTop]}}return[e.pageX,e.pageY]}var m_={capture:!0,passive:!1};function h_(e){e.preventDefault(),e.stopImmediatePropagation()}function g_(e){var t=e.document.documentElement,n=d_(e).on(`dragstart.drag`,h_,m_);`onselectstart`in t?n.on(`selectstart.drag`,h_,m_):(t.__noselect=t.style.MozUserSelect,t.style.MozUserSelect=`none`)}function __(e,t){var n=e.document.documentElement,r=d_(e).on(`dragstart.drag`,null);t&&(r.on(`click.drag`,h_,m_),setTimeout(function(){r.on(`click.drag`,null)},0)),`onselectstart`in n?r.on(`selectstart.drag`,null):(n.style.MozUserSelect=n.__noselect,delete n.__noselect)}function v_(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function y_(e,t){var n=Object.create(e.prototype);for(var r in t)n[r]=t[r];return n}function b_(){}var x_=.7,S_=1/x_,C_=`\\s*([+-]?\\d+)\\s*`,w_=`\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*`,T_=`\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*`,E_=/^#([0-9a-f]{3,8})$/,D_=RegExp(`^rgb\\(${C_},${C_},${C_}\\)$`),O_=RegExp(`^rgb\\(${T_},${T_},${T_}\\)$`),k_=RegExp(`^rgba\\(${C_},${C_},${C_},${w_}\\)$`),A_=RegExp(`^rgba\\(${T_},${T_},${T_},${w_}\\)$`),j_=RegExp(`^hsl\\(${w_},${T_},${T_}\\)$`),M_=RegExp(`^hsla\\(${w_},${T_},${T_},${w_}\\)$`),N_={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};v_(b_,R_,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:P_,formatHex:P_,formatHex8:F_,formatHsl:I_,formatRgb:L_,toString:L_});function P_(){return this.rgb().formatHex()}function F_(){return this.rgb().formatHex8()}function I_(){return Z_(this).formatHsl()}function L_(){return this.rgb().formatRgb()}function R_(e){var t,n;return e=(e+``).trim().toLowerCase(),(t=E_.exec(e))?(n=t[1].length,t=parseInt(t[1],16),n===6?z_(t):n===3?new U_(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):n===8?B_(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):n===4?B_(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=D_.exec(e))?new U_(t[1],t[2],t[3],1):(t=O_.exec(e))?new U_(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=k_.exec(e))?B_(t[1],t[2],t[3],t[4]):(t=A_.exec(e))?B_(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=j_.exec(e))?X_(t[1],t[2]/100,t[3]/100,1):(t=M_.exec(e))?X_(t[1],t[2]/100,t[3]/100,t[4]):N_.hasOwnProperty(e)?z_(N_[e]):e===`transparent`?new U_(NaN,NaN,NaN,0):null}function z_(e){return new U_(e>>16&255,e>>8&255,e&255,1)}function B_(e,t,n,r){return r<=0&&(e=t=n=NaN),new U_(e,t,n,r)}function V_(e){return e instanceof b_||(e=R_(e)),e?(e=e.rgb(),new U_(e.r,e.g,e.b,e.opacity)):new U_}function H_(e,t,n,r){return arguments.length===1?V_(e):new U_(e,t,n,r??1)}function U_(e,t,n,r){this.r=+e,this.g=+t,this.b=+n,this.opacity=+r}v_(U_,H_,y_(b_,{brighter(e){return e=e==null?S_:S_**+e,new U_(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?x_:x_**+e,new U_(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new U_(J_(this.r),J_(this.g),J_(this.b),q_(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:W_,formatHex:W_,formatHex8:G_,formatRgb:K_,toString:K_}));function W_(){return`#${Y_(this.r)}${Y_(this.g)}${Y_(this.b)}`}function G_(){return`#${Y_(this.r)}${Y_(this.g)}${Y_(this.b)}${Y_((isNaN(this.opacity)?1:this.opacity)*255)}`}function K_(){let e=q_(this.opacity);return`${e===1?`rgb(`:`rgba(`}${J_(this.r)}, ${J_(this.g)}, ${J_(this.b)}${e===1?`)`:`, ${e})`}`}function q_(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function J_(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function Y_(e){return e=J_(e),(e<16?`0`:``)+e.toString(16)}function X_(e,t,n,r){return r<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new $_(e,t,n,r)}function Z_(e){if(e instanceof $_)return new $_(e.h,e.s,e.l,e.opacity);if(e instanceof b_||(e=R_(e)),!e)return new $_;if(e instanceof $_)return e;e=e.rgb();var t=e.r/255,n=e.g/255,r=e.b/255,i=Math.min(t,n,r),a=Math.max(t,n,r),o=NaN,s=a-i,c=(a+i)/2;return s?(o=t===a?(n-r)/s+(n<r)*6:n===a?(r-t)/s+2:(t-n)/s+4,s/=c<.5?a+i:2-a-i,o*=60):s=c>0&&c<1?0:o,new $_(o,s,c,e.opacity)}function Q_(e,t,n,r){return arguments.length===1?Z_(e):new $_(e,t,n,r??1)}function $_(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}v_($_,Q_,y_(b_,{brighter(e){return e=e==null?S_:S_**+e,new $_(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?x_:x_**+e,new $_(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*t,i=2*n-r;return new U_(nv(e>=240?e-240:e+120,i,r),nv(e,i,r),nv(e<120?e+240:e-120,i,r),this.opacity)},clamp(){return new $_(ev(this.h),tv(this.s),tv(this.l),q_(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){let e=q_(this.opacity);return`${e===1?`hsl(`:`hsla(`}${ev(this.h)}, ${tv(this.s)*100}%, ${tv(this.l)*100}%${e===1?`)`:`, ${e})`}`}}));function ev(e){return e=(e||0)%360,e<0?e+360:e}function tv(e){return Math.max(0,Math.min(1,e||0))}function nv(e,t,n){return(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)*255}var rv=e=>()=>e;function iv(e,t){return function(n){return e+n*t}}function av(e,t,n){return e**=+n,t=t**+n-e,n=1/n,function(r){return(e+r*t)**+n}}function ov(e){return(e=+e)==1?sv:function(t,n){return n-t?av(t,n,e):rv(isNaN(t)?n:t)}}function sv(e,t){var n=t-e;return n?iv(e,n):rv(isNaN(e)?t:e)}var cv=function e(t){var n=ov(t);function r(e,t){var r=n((e=H_(e)).r,(t=H_(t)).r),i=n(e.g,t.g),a=n(e.b,t.b),o=sv(e.opacity,t.opacity);return function(t){return e.r=r(t),e.g=i(t),e.b=a(t),e.opacity=o(t),e+``}}return r.gamma=e,r}(1);function lv(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}}var uv=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,dv=new RegExp(uv.source,`g`);function fv(e){return function(){return e}}function pv(e){return function(t){return e(t)+``}}function mv(e,t){var n=uv.lastIndex=dv.lastIndex=0,r,i,a,o=-1,s=[],c=[];for(e+=``,t+=``;(r=uv.exec(e))&&(i=dv.exec(t));)(a=i.index)>n&&(a=t.slice(n,a),s[o]?s[o]+=a:s[++o]=a),(r=r[0])===(i=i[0])?s[o]?s[o]+=i:s[++o]=i:(s[++o]=null,c.push({i:o,x:lv(r,i)})),n=dv.lastIndex;return n<t.length&&(a=t.slice(n),s[o]?s[o]+=a:s[++o]=a),s.length<2?c[0]?pv(c[0].x):fv(t):(t=c.length,function(e){for(var n=0,r;n<t;++n)s[(r=c[n]).i]=r.x(e);return s.join(``)})}var hv=180/Math.PI,gv={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function _v(e,t,n,r,i,a){var o,s,c;return(o=Math.sqrt(e*e+t*t))&&(e/=o,t/=o),(c=e*n+t*r)&&(n-=e*c,r-=t*c),(s=Math.sqrt(n*n+r*r))&&(n/=s,r/=s,c/=s),e*r<t*n&&(e=-e,t=-t,c=-c,o=-o),{translateX:i,translateY:a,rotate:Math.atan2(t,e)*hv,skewX:Math.atan(c)*hv,scaleX:o,scaleY:s}}var vv;function yv(e){let t=new(typeof DOMMatrix==`function`?DOMMatrix:WebKitCSSMatrix)(e+``);return t.isIdentity?gv:_v(t.a,t.b,t.c,t.d,t.e,t.f)}function bv(e){return e==null||(vv||=document.createElementNS(`http://www.w3.org/2000/svg`,`g`),vv.setAttribute(`transform`,e),!(e=vv.transform.baseVal.consolidate()))?gv:(e=e.matrix,_v(e.a,e.b,e.c,e.d,e.e,e.f))}function xv(e,t,n,r){function i(e){return e.length?e.pop()+` `:``}function a(e,r,i,a,o,s){if(e!==i||r!==a){var c=o.push(`translate(`,null,t,null,n);s.push({i:c-4,x:lv(e,i)},{i:c-2,x:lv(r,a)})}else (i||a)&&o.push(`translate(`+i+t+a+n)}function o(e,t,n,a){e===t?t&&n.push(i(n)+`rotate(`+t+r):(e-t>180?t+=360:t-e>180&&(e+=360),a.push({i:n.push(i(n)+`rotate(`,null,r)-2,x:lv(e,t)}))}function s(e,t,n,a){e===t?t&&n.push(i(n)+`skewX(`+t+r):a.push({i:n.push(i(n)+`skewX(`,null,r)-2,x:lv(e,t)})}function c(e,t,n,r,a,o){if(e!==n||t!==r){var s=a.push(i(a)+`scale(`,null,`,`,null,`)`);o.push({i:s-4,x:lv(e,n)},{i:s-2,x:lv(t,r)})}else (n!==1||r!==1)&&a.push(i(a)+`scale(`+n+`,`+r+`)`)}return function(t,n){var r=[],i=[];return t=e(t),n=e(n),a(t.translateX,t.translateY,n.translateX,n.translateY,r,i),o(t.rotate,n.rotate,r,i),s(t.skewX,n.skewX,r,i),c(t.scaleX,t.scaleY,n.scaleX,n.scaleY,r,i),t=n=null,function(e){for(var t=-1,n=i.length,a;++t<n;)r[(a=i[t]).i]=a.x(e);return r.join(``)}}}var Sv=xv(yv,`px, `,`px)`,`deg)`),Cv=xv(bv,`, `,`)`,`)`),wv=1e-12;function Tv(e){return((e=Math.exp(e))+1/e)/2}function Ev(e){return((e=Math.exp(e))-1/e)/2}function Dv(e){return((e=Math.exp(2*e))-1)/(e+1)}var Ov=function e(t,n,r){function i(e,i){var a=e[0],o=e[1],s=e[2],c=i[0],l=i[1],u=i[2],d=c-a,f=l-o,p=d*d+f*f,m,h;if(p<wv)h=Math.log(u/s)/t,m=function(e){return[a+e*d,o+e*f,s*Math.exp(t*e*h)]};else{var g=Math.sqrt(p),_=(u*u-s*s+r*p)/(2*s*n*g),v=(u*u-s*s-r*p)/(2*u*n*g),y=Math.log(Math.sqrt(_*_+1)-_);h=(Math.log(Math.sqrt(v*v+1)-v)-y)/t,m=function(e){var r=e*h,i=Tv(y),c=s/(n*g)*(i*Dv(t*r+y)-Ev(y));return[a+c*d,o+c*f,s*i/Tv(t*r+y)]}}return m.duration=h*1e3*t/Math.SQRT2,m}return i.rho=function(t){var n=Math.max(.001,+t),r=n*n,i=r*r;return e(n,r,i)},i}(Math.SQRT2,2,4),kv=0,Av=0,jv=0,Mv=1e3,Nv,Pv,Fv=0,Iv=0,Lv=0,Rv=typeof performance==`object`&&performance.now?performance:Date,zv=typeof window==`object`&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function Bv(){return Iv||=(zv(Vv),Rv.now()+Lv)}function Vv(){Iv=0}function Hv(){this._call=this._time=this._next=null}Hv.prototype=Uv.prototype={constructor:Hv,restart:function(e,t,n){if(typeof e!=`function`)throw TypeError(`callback is not a function`);n=(n==null?Bv():+n)+(t==null?0:+t),!this._next&&Pv!==this&&(Pv?Pv._next=this:Nv=this,Pv=this),this._call=e,this._time=n,Jv()},stop:function(){this._call&&(this._call=null,this._time=1/0,Jv())}};function Uv(e,t,n){var r=new Hv;return r.restart(e,t,n),r}function Wv(){Bv(),++kv;for(var e=Nv,t;e;)(t=Iv-e._time)>=0&&e._call.call(void 0,t),e=e._next;--kv}function Gv(){Iv=(Fv=Rv.now())+Lv,kv=Av=0;try{Wv()}finally{kv=0,qv(),Iv=0}}function Kv(){var e=Rv.now(),t=e-Fv;t>Mv&&(Lv-=t,Fv=e)}function qv(){for(var e,t=Nv,n,r=1/0;t;)t._call?(r>t._time&&(r=t._time),e=t,t=t._next):(n=t._next,t._next=null,t=e?e._next=n:Nv=n);Pv=e,Jv(r)}function Jv(e){kv||(Av&&=clearTimeout(Av),e-Iv>24?(e<1/0&&(Av=setTimeout(Gv,e-Rv.now()-Lv)),jv&&=clearInterval(jv)):(jv||=(Fv=Rv.now(),setInterval(Kv,Mv)),kv=1,zv(Gv)))}function Yv(e,t,n){var r=new Hv;return t=t==null?0:+t,r.restart(n=>{r.stop(),e(n+t)},t,n),r}var Xv=sh(`start`,`end`,`cancel`,`interrupt`),Zv=[],Qv=0,$v=1,ey=2,ty=3,ny=4,ry=5,iy=6;function ay(e,t,n,r,i,a){var o=e.__transition;if(!o)e.__transition={};else if(n in o)return;ly(e,n,{name:t,index:r,group:i,on:Xv,tween:Zv,time:a.time,delay:a.delay,duration:a.duration,ease:a.ease,timer:null,state:Qv})}function oy(e,t){var n=cy(e,t);if(n.state>Qv)throw Error(`too late; already scheduled`);return n}function sy(e,t){var n=cy(e,t);if(n.state>ty)throw Error(`too late; already running`);return n}function cy(e,t){var n=e.__transition;if(!n||!(n=n[t]))throw Error(`transition not found`);return n}function ly(e,t,n){var r=e.__transition,i;r[t]=n,n.timer=Uv(a,0,n.time);function a(e){n.state=$v,n.timer.restart(o,n.delay,n.time),n.delay<=e&&o(e-n.delay)}function o(a){var l,u,d,f;if(n.state!==$v)return c();for(l in r)if(f=r[l],f.name===n.name){if(f.state===ty)return Yv(o);f.state===ny?(f.state=iy,f.timer.stop(),f.on.call(`interrupt`,e,e.__data__,f.index,f.group),delete r[l]):+l<t&&(f.state=iy,f.timer.stop(),f.on.call(`cancel`,e,e.__data__,f.index,f.group),delete r[l])}if(Yv(function(){n.state===ty&&(n.state=ny,n.timer.restart(s,n.delay,n.time),s(a))}),n.state=ey,n.on.call(`start`,e,e.__data__,n.index,n.group),n.state===ey){for(n.state=ty,i=Array(d=n.tween.length),l=0,u=-1;l<d;++l)(f=n.tween[l].value.call(e,e.__data__,n.index,n.group))&&(i[++u]=f);i.length=u+1}}function s(t){for(var r=t<n.duration?n.ease.call(null,t/n.duration):(n.timer.restart(c),n.state=ry,1),a=-1,o=i.length;++a<o;)i[a].call(e,r);n.state===ry&&(n.on.call(`end`,e,e.__data__,n.index,n.group),c())}function c(){for(var i in n.state=iy,n.timer.stop(),delete r[t],r)return;delete e.__transition}}function uy(e,t){var n=e.__transition,r,i,a=!0,o;if(n){for(o in t=t==null?null:t+``,n){if((r=n[o]).name!==t){a=!1;continue}i=r.state>ey&&r.state<ry,r.state=iy,r.timer.stop(),r.on.call(i?`interrupt`:`cancel`,e,e.__data__,r.index,r.group),delete n[o]}a&&delete e.__transition}}function dy(e){return this.each(function(){uy(this,e)})}function fy(e,t){var n,r;return function(){var i=sy(this,e),a=i.tween;if(a!==n){r=n=a;for(var o=0,s=r.length;o<s;++o)if(r[o].name===t){r=r.slice(),r.splice(o,1);break}}i.tween=r}}function py(e,t,n){var r,i;if(typeof n!=`function`)throw Error();return function(){var a=sy(this,e),o=a.tween;if(o!==r){i=(r=o).slice();for(var s={name:t,value:n},c=0,l=i.length;c<l;++c)if(i[c].name===t){i[c]=s;break}c===l&&i.push(s)}a.tween=i}}function my(e,t){var n=this._id;if(e+=``,arguments.length<2){for(var r=cy(this.node(),n).tween,i=0,a=r.length,o;i<a;++i)if((o=r[i]).name===e)return o.value;return null}return this.each((t==null?fy:py)(n,e,t))}function hy(e,t,n){var r=e._id;return e.each(function(){var e=sy(this,r);(e.value||={})[t]=n.apply(this,arguments)}),function(e){return cy(e,r).value[t]}}function gy(e,t){var n;return(typeof t==`number`?lv:t instanceof R_?cv:(n=R_(t))?(t=n,cv):mv)(e,t)}function _y(e){return function(){this.removeAttribute(e)}}function vy(e){return function(){this.removeAttributeNS(e.space,e.local)}}function yy(e,t,n){var r,i=n+``,a;return function(){var o=this.getAttribute(e);return o===i?null:o===r?a:a=t(r=o,n)}}function by(e,t,n){var r,i=n+``,a;return function(){var o=this.getAttributeNS(e.space,e.local);return o===i?null:o===r?a:a=t(r=o,n)}}function xy(e,t,n){var r,i,a;return function(){var o,s=n(this),c;return s==null?void this.removeAttribute(e):(o=this.getAttribute(e),c=s+``,o===c?null:o===r&&c===i?a:(i=c,a=t(r=o,s)))}}function Sy(e,t,n){var r,i,a;return function(){var o,s=n(this),c;return s==null?void this.removeAttributeNS(e.space,e.local):(o=this.getAttributeNS(e.space,e.local),c=s+``,o===c?null:o===r&&c===i?a:(i=c,a=t(r=o,s)))}}function Cy(e,t){var n=mh(e),r=n===`transform`?Cv:gy;return this.attrTween(e,typeof t==`function`?(n.local?Sy:xy)(n,r,hy(this,`attr.`+e,t)):t==null?(n.local?vy:_y)(n):(n.local?by:yy)(n,r,t))}function wy(e,t){return function(n){this.setAttribute(e,t.call(this,n))}}function Ty(e,t){return function(n){this.setAttributeNS(e.space,e.local,t.call(this,n))}}function Ey(e,t){var n,r;function i(){var i=t.apply(this,arguments);return i!==r&&(n=(r=i)&&Ty(e,i)),n}return i._value=t,i}function Dy(e,t){var n,r;function i(){var i=t.apply(this,arguments);return i!==r&&(n=(r=i)&&wy(e,i)),n}return i._value=t,i}function Oy(e,t){var n=`attr.`+e;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(t==null)return this.tween(n,null);if(typeof t!=`function`)throw Error();var r=mh(e);return this.tween(n,(r.local?Ey:Dy)(r,t))}function ky(e,t){return function(){oy(this,e).delay=+t.apply(this,arguments)}}function Ay(e,t){return t=+t,function(){oy(this,e).delay=t}}function jy(e){var t=this._id;return arguments.length?this.each((typeof e==`function`?ky:Ay)(t,e)):cy(this.node(),t).delay}function My(e,t){return function(){sy(this,e).duration=+t.apply(this,arguments)}}function Ny(e,t){return t=+t,function(){sy(this,e).duration=t}}function Py(e){var t=this._id;return arguments.length?this.each((typeof e==`function`?My:Ny)(t,e)):cy(this.node(),t).duration}function Fy(e,t){if(typeof t!=`function`)throw Error();return function(){sy(this,e).ease=t}}function Iy(e){var t=this._id;return arguments.length?this.each(Fy(t,e)):cy(this.node(),t).ease}function Ly(e,t){return function(){var n=t.apply(this,arguments);if(typeof n!=`function`)throw Error();sy(this,e).ease=n}}function Ry(e){if(typeof e!=`function`)throw Error();return this.each(Ly(this._id,e))}function zy(e){typeof e!=`function`&&(e=Eh(e));for(var t=this._groups,n=t.length,r=Array(n),i=0;i<n;++i)for(var a=t[i],o=a.length,s=r[i]=[],c,l=0;l<o;++l)(c=a[l])&&e.call(c,c.__data__,l,a)&&s.push(c);return new mb(r,this._parents,this._name,this._id)}function By(e){if(e._id!==this._id)throw Error();for(var t=this._groups,n=e._groups,r=t.length,i=n.length,a=Math.min(r,i),o=Array(r),s=0;s<a;++s)for(var c=t[s],l=n[s],u=c.length,d=o[s]=Array(u),f,p=0;p<u;++p)(f=c[p]||l[p])&&(d[p]=f);for(;s<r;++s)o[s]=t[s];return new mb(o,this._parents,this._name,this._id)}function Vy(e){return(e+``).trim().split(/^|\s+/).every(function(e){var t=e.indexOf(`.`);return t>=0&&(e=e.slice(0,t)),!e||e===`start`})}function Hy(e,t,n){var r,i,a=Vy(t)?oy:sy;return function(){var o=a(this,e),s=o.on;s!==r&&(i=(r=s).copy()).on(t,n),o.on=i}}function Uy(e,t){var n=this._id;return arguments.length<2?cy(this.node(),n).on.on(e):this.each(Hy(n,e,t))}function Wy(e){return function(){var t=this.parentNode;for(var n in this.__transition)if(+n!==e)return;t&&t.removeChild(this)}}function Gy(){return this.on(`end.remove`,Wy(this._id))}function Ky(e){var t=this._name,n=this._id;typeof e!=`function`&&(e=yh(e));for(var r=this._groups,i=r.length,a=Array(i),o=0;o<i;++o)for(var s=r[o],c=s.length,l=a[o]=Array(c),u,d,f=0;f<c;++f)(u=s[f])&&(d=e.call(u,u.__data__,f,s))&&(`__data__`in u&&(d.__data__=u.__data__),l[f]=d,ay(l[f],t,n,f,l,cy(u,n)));return new mb(a,this._parents,t,n)}function qy(e){var t=this._name,n=this._id;typeof e!=`function`&&(e=Ch(e));for(var r=this._groups,i=r.length,a=[],o=[],s=0;s<i;++s)for(var c=r[s],l=c.length,u,d=0;d<l;++d)if(u=c[d]){for(var f=e.call(u,u.__data__,d,c),p,m=cy(u,n),h=0,g=f.length;h<g;++h)(p=f[h])&&ay(p,t,n,h,f,m);a.push(f),o.push(u)}return new mb(a,o,t,n)}var Jy=l_.prototype.constructor;function Yy(){return new Jy(this._groups,this._parents)}function Xy(e,t){var n,r,i;return function(){var a=gg(this,e),o=(this.style.removeProperty(e),gg(this,e));return a===o?null:a===n&&o===r?i:i=t(n=a,r=o)}}function Zy(e){return function(){this.style.removeProperty(e)}}function Qy(e,t,n){var r,i=n+``,a;return function(){var o=gg(this,e);return o===i?null:o===r?a:a=t(r=o,n)}}function $y(e,t,n){var r,i,a;return function(){var o=gg(this,e),s=n(this),c=s+``;return s??(c=s=(this.style.removeProperty(e),gg(this,e))),o===c?null:o===r&&c===i?a:(i=c,a=t(r=o,s))}}function eb(e,t){var n,r,i,a=`style.`+t,o=`end.`+a,s;return function(){var c=sy(this,e),l=c.on,u=c.value[a]==null?s||=Zy(t):void 0;(l!==n||i!==u)&&(r=(n=l).copy()).on(o,i=u),c.on=r}}function tb(e,t,n){var r=(e+=``)==`transform`?Sv:gy;return t==null?this.styleTween(e,Xy(e,r)).on(`end.style.`+e,Zy(e)):typeof t==`function`?this.styleTween(e,$y(e,r,hy(this,`style.`+e,t))).each(eb(this._id,e)):this.styleTween(e,Qy(e,r,t),n).on(`end.style.`+e,null)}function nb(e,t,n){return function(r){this.style.setProperty(e,t.call(this,r),n)}}function rb(e,t,n){var r,i;function a(){var a=t.apply(this,arguments);return a!==i&&(r=(i=a)&&nb(e,a,n)),r}return a._value=t,a}function ib(e,t,n){var r=`style.`+(e+=``);if(arguments.length<2)return(r=this.tween(r))&&r._value;if(t==null)return this.tween(r,null);if(typeof t!=`function`)throw Error();return this.tween(r,rb(e,t,n??``))}function ab(e){return function(){this.textContent=e}}function ob(e){return function(){this.textContent=e(this)??``}}function sb(e){return this.tween(`text`,typeof e==`function`?ob(hy(this,`text`,e)):ab(e==null?``:e+``))}function cb(e){return function(t){this.textContent=e.call(this,t)}}function lb(e){var t,n;function r(){var r=e.apply(this,arguments);return r!==n&&(t=(n=r)&&cb(r)),t}return r._value=e,r}function ub(e){var t=`text`;if(arguments.length<1)return(t=this.tween(t))&&t._value;if(e==null)return this.tween(t,null);if(typeof e!=`function`)throw Error();return this.tween(t,lb(e))}function db(){for(var e=this._name,t=this._id,n=hb(),r=this._groups,i=r.length,a=0;a<i;++a)for(var o=r[a],s=o.length,c,l=0;l<s;++l)if(c=o[l]){var u=cy(c,t);ay(c,e,n,l,o,{time:u.time+u.delay+u.duration,delay:0,duration:u.duration,ease:u.ease})}return new mb(r,this._parents,e,n)}function fb(){var e,t,n=this,r=n._id,i=n.size();return new Promise(function(a,o){var s={value:o},c={value:function(){--i===0&&a()}};n.each(function(){var n=sy(this,r),i=n.on;i!==e&&(t=(e=i).copy(),t._.cancel.push(s),t._.interrupt.push(s),t._.end.push(c)),n.on=t}),i===0&&a()})}var pb=0;function mb(e,t,n,r){this._groups=e,this._parents=t,this._name=n,this._id=r}function hb(){return++pb}var gb=l_.prototype;mb.prototype={constructor:mb,select:Ky,selectAll:qy,selectChild:gb.selectChild,selectChildren:gb.selectChildren,filter:zy,merge:By,selection:Yy,transition:db,call:gb.call,nodes:gb.nodes,node:gb.node,size:gb.size,empty:gb.empty,each:gb.each,on:Uy,attr:Cy,attrTween:Oy,style:tb,styleTween:ib,text:sb,textTween:ub,remove:Gy,tween:my,delay:jy,duration:Py,ease:Iy,easeVarying:Ry,end:fb,[Symbol.iterator]:gb[Symbol.iterator]};function _b(e){return((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2}var vb={time:null,delay:0,duration:250,ease:_b};function yb(e,t){for(var n;!(n=e.__transition)||!(n=n[t]);)if(!(e=e.parentNode))throw Error(`transition ${t} not found`);return n}function bb(e){var t,n;e instanceof mb?(t=e._id,e=e._name):(t=hb(),(n=vb).time=Bv(),e=e==null?null:e+``);for(var r=this._groups,i=r.length,a=0;a<i;++a)for(var o=r[a],s=o.length,c,l=0;l<s;++l)(c=o[l])&&ay(c,e,t,l,o,n||yb(c,t));return new mb(r,this._parents,e,t)}l_.prototype.interrupt=dy,l_.prototype.transition=bb;var xb=e=>()=>e;function Sb(e,{sourceEvent:t,target:n,transform:r,dispatch:i}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},target:{value:n,enumerable:!0,configurable:!0},transform:{value:r,enumerable:!0,configurable:!0},_:{value:i}})}function Cb(e,t,n){this.k=e,this.x=t,this.y=n}Cb.prototype={constructor:Cb,scale:function(e){return e===1?this:new Cb(this.k*e,this.x,this.y)},translate:function(e,t){return e===0&t===0?this:new Cb(this.k,this.x+this.k*e,this.y+this.k*t)},apply:function(e){return[e[0]*this.k+this.x,e[1]*this.k+this.y]},applyX:function(e){return e*this.k+this.x},applyY:function(e){return e*this.k+this.y},invert:function(e){return[(e[0]-this.x)/this.k,(e[1]-this.y)/this.k]},invertX:function(e){return(e-this.x)/this.k},invertY:function(e){return(e-this.y)/this.k},rescaleX:function(e){return e.copy().domain(e.range().map(this.invertX,this).map(e.invert,e))},rescaleY:function(e){return e.copy().domain(e.range().map(this.invertY,this).map(e.invert,e))},toString:function(){return`translate(`+this.x+`,`+this.y+`) scale(`+this.k+`)`}};var wb=new Cb(1,0,0);Cb.prototype;function Tb(e){e.stopImmediatePropagation()}function Eb(e){e.preventDefault(),e.stopImmediatePropagation()}function Db(e){return(!e.ctrlKey||e.type===`wheel`)&&!e.button}function Ob(){var e=this;return e instanceof SVGElement?(e=e.ownerSVGElement||e,e.hasAttribute(`viewBox`)?(e=e.viewBox.baseVal,[[e.x,e.y],[e.x+e.width,e.y+e.height]]):[[0,0],[e.width.baseVal.value,e.height.baseVal.value]]):[[0,0],[e.clientWidth,e.clientHeight]]}function kb(){return this.__zoom||wb}function Ab(e){return-e.deltaY*(e.deltaMode===1?.05:e.deltaMode?1:.002)*(e.ctrlKey?10:1)}function jb(){return navigator.maxTouchPoints||`ontouchstart`in this}function Mb(e,t,n){var r=e.invertX(t[0][0])-n[0][0],i=e.invertX(t[1][0])-n[1][0],a=e.invertY(t[0][1])-n[0][1],o=e.invertY(t[1][1])-n[1][1];return e.translate(i>r?(r+i)/2:Math.min(0,r)||Math.max(0,i),o>a?(a+o)/2:Math.min(0,a)||Math.max(0,o))}function Nb(){var e=Db,t=Ob,n=Mb,r=Ab,i=jb,a=[0,1/0],o=[[-1/0,-1/0],[1/0,1/0]],s=250,c=Ov,l=sh(`start`,`zoom`,`end`),u,d,f,p=500,m=150,h=0,g=10;function _(e){e.property(`__zoom`,kb).on(`wheel.zoom`,w,{passive:!1}).on(`mousedown.zoom`,T).on(`dblclick.zoom`,E).filter(i).on(`touchstart.zoom`,D).on(`touchmove.zoom`,O).on(`touchend.zoom touchcancel.zoom`,k).style(`-webkit-tap-highlight-color`,`rgba(0,0,0,0)`)}_.transform=function(e,t,n,r){var i=e.selection?e.selection():e;i.property(`__zoom`,kb),e===i?i.interrupt().each(function(){S(this,arguments).event(r).start().zoom(null,typeof t==`function`?t.apply(this,arguments):t).end()}):x(e,t,n,r)},_.scaleBy=function(e,t,n,r){_.scaleTo(e,function(){var e=this.__zoom.k,n=typeof t==`function`?t.apply(this,arguments):t;return e*n},n,r)},_.scaleTo=function(e,r,i,a){_.transform(e,function(){var e=t.apply(this,arguments),a=this.__zoom,s=i==null?b(e):typeof i==`function`?i.apply(this,arguments):i,c=a.invert(s),l=typeof r==`function`?r.apply(this,arguments):r;return n(y(v(a,l),s,c),e,o)},i,a)},_.translateBy=function(e,r,i,a){_.transform(e,function(){return n(this.__zoom.translate(typeof r==`function`?r.apply(this,arguments):r,typeof i==`function`?i.apply(this,arguments):i),t.apply(this,arguments),o)},null,a)},_.translateTo=function(e,r,i,a,s){_.transform(e,function(){var e=t.apply(this,arguments),s=this.__zoom,c=a==null?b(e):typeof a==`function`?a.apply(this,arguments):a;return n(wb.translate(c[0],c[1]).scale(s.k).translate(typeof r==`function`?-r.apply(this,arguments):-r,typeof i==`function`?-i.apply(this,arguments):-i),e,o)},a,s)};function v(e,t){return t=Math.max(a[0],Math.min(a[1],t)),t===e.k?e:new Cb(t,e.x,e.y)}function y(e,t,n){var r=t[0]-n[0]*e.k,i=t[1]-n[1]*e.k;return r===e.x&&i===e.y?e:new Cb(e.k,r,i)}function b(e){return[(+e[0][0]+ +e[1][0])/2,(+e[0][1]+ +e[1][1])/2]}function x(e,n,r,i){e.on(`start.zoom`,function(){S(this,arguments).event(i).start()}).on(`interrupt.zoom end.zoom`,function(){S(this,arguments).event(i).end()}).tween(`zoom`,function(){var e=this,a=arguments,o=S(e,a).event(i),s=t.apply(e,a),l=r==null?b(s):typeof r==`function`?r.apply(e,a):r,u=Math.max(s[1][0]-s[0][0],s[1][1]-s[0][1]),d=e.__zoom,f=typeof n==`function`?n.apply(e,a):n,p=c(d.invert(l).concat(u/d.k),f.invert(l).concat(u/f.k));return function(e){if(e===1)e=f;else{var t=p(e),n=u/t[2];e=new Cb(n,l[0]-t[0]*n,l[1]-t[1]*n)}o.zoom(null,e)}})}function S(e,t,n){return!n&&e.__zooming||new C(e,t)}function C(e,n){this.that=e,this.args=n,this.active=0,this.sourceEvent=null,this.extent=t.apply(e,n),this.taps=0}C.prototype={event:function(e){return e&&(this.sourceEvent=e),this},start:function(){return++this.active===1&&(this.that.__zooming=this,this.emit(`start`)),this},zoom:function(e,t){return this.mouse&&e!==`mouse`&&(this.mouse[1]=t.invert(this.mouse[0])),this.touch0&&e!==`touch`&&(this.touch0[1]=t.invert(this.touch0[0])),this.touch1&&e!==`touch`&&(this.touch1[1]=t.invert(this.touch1[0])),this.that.__zoom=t,this.emit(`zoom`),this},end:function(){return--this.active===0&&(delete this.that.__zooming,this.emit(`end`)),this},emit:function(e){var t=d_(this.that).datum();l.call(e,this.that,new Sb(e,{sourceEvent:this.sourceEvent,target:_,type:e,transform:this.that.__zoom,dispatch:l}),t)}};function w(t,...i){if(!e.apply(this,arguments))return;var s=S(this,i).event(t),c=this.__zoom,l=Math.max(a[0],Math.min(a[1],c.k*2**r.apply(this,arguments))),u=p_(t);if(s.wheel)(s.mouse[0][0]!==u[0]||s.mouse[0][1]!==u[1])&&(s.mouse[1]=c.invert(s.mouse[0]=u)),clearTimeout(s.wheel);else if(c.k===l)return;else s.mouse=[u,c.invert(u)],uy(this),s.start();Eb(t),s.wheel=setTimeout(d,m),s.zoom(`mouse`,n(y(v(c,l),s.mouse[0],s.mouse[1]),s.extent,o));function d(){s.wheel=null,s.end()}}function T(t,...r){if(f||!e.apply(this,arguments))return;var i=t.currentTarget,a=S(this,r,!0).event(t),s=d_(t.view).on(`mousemove.zoom`,d,!0).on(`mouseup.zoom`,p,!0),c=p_(t,i),l=t.clientX,u=t.clientY;g_(t.view),Tb(t),a.mouse=[c,this.__zoom.invert(c)],uy(this),a.start();function d(e){if(Eb(e),!a.moved){var t=e.clientX-l,r=e.clientY-u;a.moved=t*t+r*r>h}a.event(e).zoom(`mouse`,n(y(a.that.__zoom,a.mouse[0]=p_(e,i),a.mouse[1]),a.extent,o))}function p(e){s.on(`mousemove.zoom mouseup.zoom`,null),__(e.view,a.moved),Eb(e),a.event(e).end()}}function E(r,...i){if(e.apply(this,arguments)){var a=this.__zoom,c=p_(r.changedTouches?r.changedTouches[0]:r,this),l=a.invert(c),u=a.k*(r.shiftKey?.5:2),d=n(y(v(a,u),c,l),t.apply(this,i),o);Eb(r),s>0?d_(this).transition().duration(s).call(x,d,c,r):d_(this).call(_.transform,d,c,r)}}function D(t,...n){if(e.apply(this,arguments)){var r=t.touches,i=r.length,a=S(this,n,t.changedTouches.length===i).event(t),o,s,c,l;for(Tb(t),s=0;s<i;++s)c=r[s],l=p_(c,this),l=[l,this.__zoom.invert(l),c.identifier],a.touch0?!a.touch1&&a.touch0[2]!==l[2]&&(a.touch1=l,a.taps=0):(a.touch0=l,o=!0,a.taps=1+!!u);u&&=clearTimeout(u),o&&(a.taps<2&&(d=l[0],u=setTimeout(function(){u=null},p)),uy(this),a.start())}}function O(e,...t){if(this.__zooming){var r=S(this,t).event(e),i=e.changedTouches,a=i.length,s,c,l,u;for(Eb(e),s=0;s<a;++s)c=i[s],l=p_(c,this),r.touch0&&r.touch0[2]===c.identifier?r.touch0[0]=l:r.touch1&&r.touch1[2]===c.identifier&&(r.touch1[0]=l);if(c=r.that.__zoom,r.touch1){var d=r.touch0[0],f=r.touch0[1],p=r.touch1[0],m=r.touch1[1],h=(h=p[0]-d[0])*h+(h=p[1]-d[1])*h,g=(g=m[0]-f[0])*g+(g=m[1]-f[1])*g;c=v(c,Math.sqrt(h/g)),l=[(d[0]+p[0])/2,(d[1]+p[1])/2],u=[(f[0]+m[0])/2,(f[1]+m[1])/2]}else if(r.touch0)l=r.touch0[0],u=r.touch0[1];else return;r.zoom(`touch`,n(y(c,l,u),r.extent,o))}}function k(e,...t){if(this.__zooming){var n=S(this,t).event(e),r=e.changedTouches,i=r.length,a,o;for(Tb(e),f&&clearTimeout(f),f=setTimeout(function(){f=null},p),a=0;a<i;++a)o=r[a],n.touch0&&n.touch0[2]===o.identifier?delete n.touch0:n.touch1&&n.touch1[2]===o.identifier&&delete n.touch1;if(n.touch1&&!n.touch0&&(n.touch0=n.touch1,delete n.touch1),n.touch0)n.touch0[1]=this.__zoom.invert(n.touch0[0]);else if(n.end(),n.taps===2&&(o=p_(o,this),Math.hypot(d[0]-o[0],d[1]-o[1])<g)){var s=d_(this).on(`dblclick.zoom`);s&&s.apply(this,arguments)}}}return _.wheelDelta=function(e){return arguments.length?(r=typeof e==`function`?e:xb(+e),_):r},_.filter=function(t){return arguments.length?(e=typeof t==`function`?t:xb(!!t),_):e},_.touchable=function(e){return arguments.length?(i=typeof e==`function`?e:xb(!!e),_):i},_.extent=function(e){return arguments.length?(t=typeof e==`function`?e:xb([[+e[0][0],+e[0][1]],[+e[1][0],+e[1][1]]]),_):t},_.scaleExtent=function(e){return arguments.length?(a[0]=+e[0],a[1]=+e[1],_):[a[0],a[1]]},_.translateExtent=function(e){return arguments.length?(o[0][0]=+e[0][0],o[1][0]=+e[1][0],o[0][1]=+e[0][1],o[1][1]=+e[1][1],_):[[o[0][0],o[0][1]],[o[1][0],o[1][1]]]},_.constrain=function(e){return arguments.length?(n=e,_):n},_.duration=function(e){return arguments.length?(s=+e,_):s},_.interpolate=function(e){return arguments.length?(c=e,_):c},_.on=function(){var e=l.on.apply(l,arguments);return e===l?_:e},_.clickDistance=function(e){return arguments.length?(h=(e=+e)*e,_):Math.sqrt(h)},_.tapDistance=function(e){return arguments.length?(g=+e,_):g},_}var Pb=Symbol(`MiniMapSlots`),Fb=[`id`,`x`,`y`,`rx`,`ry`,`width`,`height`,`fill`,`stroke`,`stroke-width`,`shape-rendering`],Ib=V({name:`MiniMapNode`,compatConfig:{MODE:3},inheritAttrs:!1,props:{id:{},type:{},selected:{type:Boolean},dragging:{type:Boolean},position:{},dimensions:{},borderRadius:{},color:{},shapeRendering:{},strokeColor:{},strokeWidth:{},hidden:{type:Boolean}},emits:[`click`,`dblclick`,`mouseenter`,`mousemove`,`mouseleave`],setup(e,{emit:t}){let n=e,r=te(Pb),i=ze(),a=de(()=>i.style??{});function o(e){t(`click`,e)}function s(e){t(`dblclick`,e)}function c(e){t(`mouseenter`,e)}function l(e){t(`mousemove`,e)}function u(e){t(`mouseleave`,e)}return(e,t)=>!e.hidden&&e.dimensions.width!==0&&e.dimensions.height!==0?(G(),P(je,{key:0},[B(r)[`node-${n.type}`]?(G(),L(be(B(r)[`node-${n.type}`]),M(He({key:0},{...n,...e.$attrs})),null,16)):(G(),P(`rect`,He({key:1,id:e.id},e.$attrs,{class:[`vue-flow__minimap-node`,{selected:e.selected,dragging:e.dragging}],x:e.position.x,y:e.position.y,rx:e.borderRadius,ry:e.borderRadius,width:e.dimensions.width,height:e.dimensions.height,fill:e.color||a.value.background||a.value.backgroundColor,stroke:e.strokeColor,"stroke-width":e.strokeWidth,"shape-rendering":e.shapeRendering,onClick:o,onDblclick:s,onMouseenter:c,onMousemove:l,onMouseleave:u}),null,16,Fb))],64)):z(``,!0)}}),Lb=[`width`,`height`,`viewBox`,`aria-labelledby`],Rb=[`id`],zb=[`d`,`fill`,`stroke`,`stroke-width`],Bb=V({name:`MiniMap`,compatConfig:{MODE:3},props:{nodeColor:{type:[String,Function],default:`#e2e2e2`},nodeStrokeColor:{type:[String,Function],default:`transparent`},nodeClassName:{type:[String,Function]},nodeBorderRadius:{default:5},nodeStrokeWidth:{default:2},maskColor:{default:`rgb(240, 240, 240, 0.6)`},maskStrokeColor:{default:`none`},maskStrokeWidth:{default:1},position:{default:`bottom-right`},pannable:{type:Boolean,default:!1},zoomable:{type:Boolean,default:!1},width:{},height:{},ariaLabel:{default:`Vue Flow mini map`},inversePan:{type:Boolean,default:!1},zoomStep:{default:1},offsetScale:{default:5},maskBorderRadius:{default:0}},emits:[`click`,`nodeClick`,`nodeDblclick`,`nodeMouseenter`,`nodeMousemove`,`nodeMouseleave`],setup(e,{emit:t}){let n=Ke(),r=ze(),{id:i,edges:a,viewport:o,translateExtent:s,dimensions:c,emits:l,d3Selection:u,d3Zoom:d,getNodesInitialized:f}=Hu(),p=U();qe(Pb,n);let m=de(()=>e.width??r.style?.width??200),h=de(()=>e.height??r.style?.height??150),g=typeof window>`u`||window.chrome?`crispEdges`:`geometricPrecision`,_=q(()=>typeof e.nodeColor==`string`?()=>e.nodeColor:e.nodeColor),v=q(()=>typeof e.nodeStrokeColor==`string`?()=>e.nodeStrokeColor:e.nodeStrokeColor),y=q(()=>typeof e.nodeClassName==`string`?()=>e.nodeClassName:typeof e.nodeClassName==`function`?e.nodeClassName:()=>``),b=q(()=>gc(f.value.filter(e=>!e.hidden))),x=q(()=>({x:-o.value.x/o.value.zoom,y:-o.value.y/o.value.zoom,width:c.value.width/o.value.zoom,height:c.value.height/o.value.zoom})),S=q(()=>f.value&&f.value.length?hc(b.value,x.value):x.value),C=q(()=>{let e=S.value.width/m.value,t=S.value.height/h.value;return Math.max(e,t)}),w=q(()=>{let t=C.value*m.value,n=C.value*h.value,r=e.offsetScale*C.value;return{offset:r,x:S.value.x-(t-S.value.width)/2-r,y:S.value.y-(n-S.value.height)/2-r,width:t+r*2,height:n+r*2}}),T=q(()=>!w.value.x||!w.value.y?``:`
    M${w.value.x-w.value.offset},${w.value.y-w.value.offset}
    h${w.value.width+w.value.offset*2}
    v${w.value.height+w.value.offset*2}
    h${-w.value.width-w.value.offset*2}z
    M${x.value.x+e.maskBorderRadius},${x.value.y}
    h${x.value.width-2*e.maskBorderRadius}
    a${e.maskBorderRadius},${e.maskBorderRadius} 0 0 1 ${e.maskBorderRadius},${e.maskBorderRadius}
    v${x.value.height-2*e.maskBorderRadius}
    a${e.maskBorderRadius},${e.maskBorderRadius} 0 0 1 -${e.maskBorderRadius},${e.maskBorderRadius}
    h${-(x.value.width-2*e.maskBorderRadius)}
    a${e.maskBorderRadius},${e.maskBorderRadius} 0 0 1 -${e.maskBorderRadius},-${e.maskBorderRadius}
    v${-(x.value.height-2*e.maskBorderRadius)}
    a${e.maskBorderRadius},${e.maskBorderRadius} 0 0 1 ${e.maskBorderRadius},-${e.maskBorderRadius}z`);Ne(t=>{if(p.value){let n=d_(p.value),r=Nb().wheelDelta(t=>Ec(t)*(e.zoomStep/10)).on(`zoom`,e.pannable?t=>{if(t.sourceEvent.type!==`mousemove`||!u.value||!d.value)return;let n=C.value*Math.max(1,o.value.zoom)*(e.inversePan?-1:1),r={x:o.value.x-t.sourceEvent.movementX*n,y:o.value.y-t.sourceEvent.movementY*n},i=[[0,0],[c.value.width,c.value.height]],a=wb.translate(r.x,r.y).scale(o.value.zoom),l=d.value.constrain()(a,i,s.value);d.value.transform(u.value,l)}:()=>{}).on(`zoom.wheel`,e.zoomable?t=>{if(t.sourceEvent.type!==`wheel`||!u.value||!d.value)return;let n=t.sourceEvent.ctrlKey&&tl()?10:1,r=-t.sourceEvent.deltaY*(t.sourceEvent.deltaMode===1?.05:t.sourceEvent.deltaMode?1:.002)*e.zoomStep,i=o.value.zoom*2**(r*n);d.value.scaleTo(u.value,i)}:()=>{});n.call(r),t(()=>{n.on(`zoom`,null)})}},{flush:`post`});function E(e){let[n,r]=p_(e);t(`click`,{event:e,position:{x:n,y:r}})}function D(e,n){let r={event:e,node:n,connectedEdges:vc([n],a.value)};l.miniMapNodeClick(r),t(`nodeClick`,r)}function O(e,n){let r={event:e,node:n,connectedEdges:vc([n],a.value)};l.miniMapNodeDoubleClick(r),t(`nodeDblclick`,r)}function k(e,n){let r={event:e,node:n,connectedEdges:vc([n],a.value)};l.miniMapNodeMouseEnter(r),t(`nodeMouseenter`,r)}function A(e,n){let r={event:e,node:n,connectedEdges:vc([n],a.value)};l.miniMapNodeMouseMove(r),t(`nodeMousemove`,r)}function j(e,n){let r={event:e,node:n,connectedEdges:vc([n],a.value)};l.miniMapNodeMouseLeave(r),t(`nodeMouseleave`,r)}return(e,t)=>(G(),L(B(bd),{position:e.position,class:N([`vue-flow__minimap`,{pannable:e.pannable,zoomable:e.zoomable}])},{default:Y(()=>[(G(),P(`svg`,{ref_key:`el`,ref:p,width:m.value,height:h.value,viewBox:[w.value.x,w.value.y,w.value.width,w.value.height].join(` `),role:`img`,"aria-labelledby":`vue-flow__minimap-${B(i)}`,onClick:E},[e.ariaLabel?(G(),P(`title`,{key:0,id:`vue-flow__minimap-${B(i)}`},J(e.ariaLabel),9,Rb)):z(``,!0),(G(!0),P(je,null,Le(B(f),t=>(G(),L(Ib,{id:t.id,key:t.id,f:``,position:t.computedPosition,dimensions:t.dimensions,selected:t.selected,dragging:t.dragging,style:R(t.style),class:N(y.value(t)),color:_.value(t),"border-radius":e.nodeBorderRadius,"stroke-color":v.value(t),"stroke-width":e.nodeStrokeWidth,"shape-rendering":B(g),type:t.type,hidden:t.hidden,onClick:e=>D(e,t),onDblclick:e=>O(e,t),onMouseenter:e=>k(e,t),onMousemove:e=>A(e,t),onMouseleave:e=>j(e,t)},null,8,[`id`,`position`,`dimensions`,`selected`,`dragging`,`style`,`class`,`color`,`border-radius`,`stroke-color`,`stroke-width`,`shape-rendering`,`type`,`hidden`,`onClick`,`onDblclick`,`onMouseenter`,`onMousemove`,`onMouseleave`]))),128)),I(`path`,{class:`vue-flow__minimap-mask`,d:T.value,fill:e.maskColor,stroke:e.maskStrokeColor,"stroke-width":e.maskStrokeWidth,"fill-rule":`evenodd`},null,8,zb)],8,Lb))]),_:1},8,[`position`,`class`]))}});function Vb(){let e=r();function t(t){return e.getNodeExecutionStatus(t)}function n(t,n){e.setNodeExecutionStatus(t,n)}function i(){e.clearNodeExecutionStatuses()}function a(t){console.log(`[NodeExecutionStatus] :`,t.executionId),e.currentExecutionId=t.executionId,i()}function o(e){console.log(`[NodeExecutionStatus] :`,e.executionId)}function s(e){console.log(`[NodeExecutionStatus] :`,e.nodeId),n(e.nodeId,{status:`running`,startTime:Date.now()})}function c(e){console.log(`[NodeExecutionStatus] :`,e.nodeId,e.result);let t=Date.now();n(e.nodeId,{status:`success`,endTime:t,timestamp:t,result:e.result})}function l(e){console.log(`[NodeExecutionStatus] :`,e.nodeId,e.error);let t=Date.now();n(e.nodeId,{status:`error`,endTime:t,timestamp:t,error:e.error})}function u(e){console.log(`[NodeExecutionStatus] :`,e.nodeId);let t=Date.now();n(e.nodeId,{status:`cached`,startTime:t,endTime:t,timestamp:t,duration:e.cachedResult.duration,result:e.cachedResult.outputs})}return tt.on(`execution:start`,a),tt.on(`execution:complete`,o),tt.on(`execution:node:start`,s),tt.on(`execution:node:complete`,c),tt.on(`execution:node:error`,l),tt.on(`execution:cache-hit`,u),T(()=>{tt.off(`execution:start`,a),tt.off(`execution:complete`,o),tt.off(`execution:node:start`,s),tt.off(`execution:node:complete`,c),tt.off(`execution:node:error`,l),tt.off(`execution:cache-hit`,u)}),{nodeStatuses:e.nodeExecutionStatuses,currentExecutionId:e.currentExecutionId,getNodeStatus:t,setNodeStatus:n,clearAllStatuses:i}}var Hb={key:1,class:`note-node__content`},Ub={key:0,class:`note-node__text`},Wb={key:1,class:`note-node__placeholder`},Gb=V({__name:`NoteNode`,props:{id:{},type:{},selected:{type:Boolean},connectable:{type:[Boolean,Number,String,Function]},position:{},dimensions:{},label:{},isValidTargetPos:{type:Function},isValidSourcePos:{type:Function},parent:{},parentNodeId:{},dragging:{type:Boolean},resizing:{type:Boolean},zIndex:{},targetPosition:{},sourcePosition:{},dragHandle:{},data:{},events:{}},setup(e){let t=e,{viewport:n}=Hu(),r=U(!1),i=U(!1),a=U(t.data.content||``),o=U(t.data.width||200),s=U(t.data.height||120),c=U(null),l=U(null),u=q(()=>({width:`${o.value}px`,height:`${s.value}px`,cursor:r.value?`text`:`default`}));W(()=>t.data.content,e=>{e!==void 0&&e!==a.value&&(a.value=e)}),W(()=>[t.data.width,t.data.height],([e,t])=>{e!==void 0&&e!==o.value&&(o.value=e),t!==void 0&&t!==s.value&&(s.value=t)});async function d(){!r.value&&!i.value&&(r.value=!0,await F(),c.value&&(c.value.focus(),c.value.select()))}function f(){r.value=!1,t.data&&(t.data.content=a.value)}function p(){a.value=t.data.content||``,r.value=!1}let m=0,h=0,g=0,_=0;function v(e){e.preventDefault(),e.stopPropagation(),i.value=!0,m=e.clientX,h=e.clientY,g=o.value,_=s.value,document.addEventListener(`mousemove`,y),document.addEventListener(`mouseup`,b)}function y(e){if(!i.value)return;let t=e.clientX-m,r=e.clientY-h,a=n.value.zoom||1,c=t/a,l=r/a,u=Math.max(150,g+c),d=Math.max(80,_+l);o.value=u,s.value=d}function b(){i.value&&(i.value=!1,t.data&&(t.data.width=o.value,t.data.height=s.value),document.removeEventListener(`mousemove`,y),document.removeEventListener(`mouseup`,b))}return T(()=>{document.removeEventListener(`mousemove`,y),document.removeEventListener(`mouseup`,b)}),(t,n)=>(G(),P(`div`,{ref_key:`nodeRef`,ref:l,class:N([`note-node`,{"note-node--selected":e.selected,"note-node--editing":r.value,"note-node--resizing":i.value}]),style:R(u.value),onDblclick:d},[O(Wp,{"node-id":e.id},null,8,[`node-id`]),r.value?Ce((G(),P(`textarea`,{key:0,ref_key:`textareaRef`,ref:c,"onUpdate:modelValue":n[0]||=e=>a.value=e,class:`note-node__textarea nodrag nopan`,placeholder:`...`,onBlur:f,onKeydown:j(p,[`esc`]),onClick:n[1]||=se(()=>{},[`stop`])},null,544)),[[fe,a.value]]):(G(),P(`div`,Hb,[a.value?(G(),P(`div`,Ub,J(a.value),1)):(G(),P(`div`,Wb,``))])),I(`div`,{class:`note-node__resize-handle nodrag nopan`,onMousedown:se(v,[`stop`])},[...n[2]||=[I(`svg`,{width:`12`,height:`12`,viewBox:`0 0 12 12`,fill:`none`,xmlns:`http://www.w3.org/2000/svg`},[I(`path`,{d:`M11 1L1 11M11 5L5 11M11 9L9 11`,stroke:`currentColor`,"stroke-width":`1.5`,"stroke-linecap":`round`})],-1)]],32)],38))}}),Kb=Z(Gb,[[`__scopeId`,`data-v-ee80e910`]]),qb={key:0,class:`start-node__description`},Jb={key:1,class:`start-node__placeholder`},Yb=V({__name:`StartNode`,props:{id:{},data:{},selected:{type:Boolean}},setup(e){let t=e,n=q(()=>{let e={headerColor:[`#10b981`,`#059669`],icon:``,showIcon:!0};return{...t.data,label:t.data.label||``,noInputs:!0,style:e}});return(t,r)=>(G(),L(ym,{id:e.id,data:n.value,selected:e.selected},{default:Y(()=>[e.data.description?(G(),P(`div`,qb,J(e.data.description),1)):(G(),P(`div`,Jb,``))]),_:1},8,[`id`,`data`,`selected`]))}}),Xb=Z(Yb,[[`__scopeId`,`data-v-c62fa71a`]]),Zb={key:0,class:`end-node__description`},Qb={key:1,class:`end-node__placeholder`},$b=V({__name:`EndNode`,props:{id:{},data:{},selected:{type:Boolean}},setup(e){let t=e,n=q(()=>{let e={headerColor:[`#ef4444`,`#dc2626`],icon:``,showIcon:!0};return{...t.data,label:t.data.label||``,noOutputs:!0,style:e}});return(t,r)=>(G(),L(ym,{id:e.id,data:n.value,selected:e.selected},{default:Y(()=>[e.data.description?(G(),P(`div`,Zb,J(e.data.description),1)):(G(),P(`div`,Qb,``))]),_:1},8,[`id`,`data`,`selected`]))}}),ex=Z($b,[[`__scopeId`,`data-v-f5de10a3`]]),tx=V({__name:`ConnectorNode`,props:{id:{},data:{},selected:{type:Boolean}},setup(e){return(t,n)=>(G(),P(`div`,{class:N([`connector-node`,{"connector-node--selected":e.selected}])},[O(B(qf),{id:`input`,type:`target`,position:B(Q).Left,"node-id":e.id,variant:`circle`},null,8,[`position`,`node-id`]),O(B(qf),{id:`output`,type:`source`,position:B(Q).Right,"node-id":e.id,variant:`circle`},null,8,[`position`,`node-id`])],2))}}),nx=Z(tx,[[`__scopeId`,`data-v-db38c7bf`]]),rx={},ix={xmlns:`http://www.w3.org/2000/svg`,viewBox:`0 0 24 24`,fill:`currentColor`};function ax(e,t){return G(),P(`svg`,ix,[...t[0]||=[I(`path`,{"fill-rule":`evenodd`,d:`M19.902 4.098a3.75 3.75 0 00-5.304 0l-4.5 4.5a3.75 3.75 0 001.035 6.037.75.75 0 01-.646 1.353 5.25 5.25 0 01-1.449-8.45l4.5-4.5a5.25 5.25 0 117.424 7.424l-1.757 1.757a.75.75 0 11-1.06-1.06l1.757-1.757a3.75 3.75 0 000-5.304zm-7.389 4.267a.75.75 0 011-.353 5.25 5.25 0 011.449 8.45l-4.5 4.5a5.25 5.25 0 11-7.424-7.424l1.757-1.757a.75.75 0 111.06 1.06l-1.757 1.757a3.75 3.75 0 105.304 5.304l4.5-4.5a3.75 3.75 0 00-1.035-6.037.75.75 0 01-.354-1z`,"clip-rule":`evenodd`},null,-1)]])}var ox=Z(rx,[[`render`,ax]]);function sx(e){if(!e||typeof e!=`string`)return``;let t=[...e.matchAll(/\{\{\s*([^{}]+?)\s*\}\}/g)];if(t.length===0)return e;let n=t.map(e=>{let t=e[1]?.trim();if(!t)return e[0];let n=t.split(`.`);if(n.length===0)return e[0];let r=n[0],i=n[n.length-1];return n.length===1||/^\d+$/.test(i||``)?r||e[0]:`${r} - ${i}`}),r=t[0];if(t.length===1&&r&&e.trim()===r[0])return n[0]||e;let i=e;return t.forEach((e,t)=>{i=i.replace(e[0],n[t]||e[0])}),i}var cx={class:`font-mono truncate leading-2`},lx=V({__name:`VariableBadge`,props:{value:{},fallback:{default:``},size:{default:`default`}},setup(e){let t=e,n=q(()=>{if(!t.value||typeof t.value!=`string`)return t.fallback;let e=[...t.value.matchAll(/\{\{\s*([^{}]+?)\s*\}\}/g)];if(e.length===0)return t.value;if(e.length>1){let n=e[0];if(!n||!n[1])return t.fallback;let r=n[1].trim().split(`.`);if(r.length===0)return t.fallback;let i=r[0],a=r[r.length-1];return r.length===1||/^\d+$/.test(a||``)?`${i}...`:`${i} - ${a}...`}return sx(t.value)||t.fallback});return(t,r)=>(G(),P(`div`,{class:N([`inline-flex items-center gap-0.5 rounded border bg-slate-100 border-slate-200 text-slate-700 whitespace-nowrap max-w-full`,[e.size===`xs`?`px-1 py-px text-[6px]`:`px-2 py-0.5 text-[7px]`]])},[O(ox,{class:N([`text-purple-500 shrink-0`,[e.size===`xs`?`w-1.5 h-1.5`:`w-2 h-2`]])},null,8,[`class`]),I(`span`,cx,J(n.value),1)],2))}}),ux={},dx={class:`icon`,viewBox:`0 0 24 24`,fill:`none`,xmlns:`http://www.w3.org/2000/svg`,stroke:`currentColor`,"stroke-width":`2`,"stroke-linecap":`round`,"stroke-linejoin":`round`};function fx(e,t){return G(),P(`svg`,dx,[...t[0]||=[I(`path`,{d:`M12 3v7`},null,-1),I(`circle`,{cx:`12`,cy:`10`,r:`2`,fill:`currentColor`},null,-1),I(`path`,{d:`M12 12l-6 9`},null,-1),I(`path`,{d:`M12 12l6 9`},null,-1)]])}var px=Z(ux,[[`render`,fx]]),mx={class:`flex flex-col gap-1.5 py-1`},hx={class:`flex items-center justify-between gap-1.5 mb-0.5`},gx={class:`text-[9px] font-semibold text-slate-600 uppercase tracking-wide`},_x={key:0,class:`py-0.5 px-1 text-[9px] font-medium bg-violet-200 text-violet-600 rounded`},vx={class:`flex flex-wrap items-center gap-0.5 text-[10px] text-slate-500 leading-tight`},yx={key:1},bx=V({__name:`IfNode`,props:{id:{},data:{},selected:{type:Boolean}},setup(e){let t=e,{updateNodeInternals:n}=Hu(),r=q(()=>{let e=t.data.config?.conditions||[];return e.length<1?[{logic:`and`,subConditions:[{field:``,dataType:`string`,operator:`is equal to`,value:``}]}]:e}),i=U([]),a=U(null);function o(e,t){e&&(i.value[t]=e)}let s=q(()=>{let e=[],t=r.value.length;for(let n=0;n<t;n++)e.push({id:`condition-${n}`,type:`source`,position:Q.Right,variant:`ellipse`});return e.push({id:`else`,type:`source`,position:Q.Right,variant:`ellipse`}),e});W(()=>r.value.length,async()=>{await F(),n([t.id])},{immediate:!0}),W(s,async()=>{await F(),requestAnimationFrame(()=>{n([t.id])})},{deep:!0});function c(e){let t=r.value.length;if(e===t){let e=a.value;if(e&&e.offsetParent&&e.offsetTop>0)return{top:`${e.offsetTop+e.offsetHeight/2}px !important`}}else{let t=i.value[e];if(t&&t.offsetParent&&t.offsetTop>0)return{top:`${t.offsetTop+t.offsetHeight/2}px !important`}}return e===t?{top:`${48+t*46+40/2}px !important`}:{top:`${48+e*46+40/2}px !important`}}let l=q(()=>{let e={headerColor:[`#8b5cf6`,`#7c3aed`],icon:px,showIcon:!0};return{...t.data,label:t.data.label||``,noInputs:!1,noOutputs:!1,style:e}});function d(e){return/^\{\{.+\}\}$/.test(e.trim())}function f(e){let t=[],n=/(\{\{[^{}]+\}\})/g,r=0,i;for(;(i=n.exec(e))!==null;){if(i.index>r){let n=e.slice(r,i.index);n&&t.push({text:n,isVariable:!1})}t.push({text:i[0],isVariable:!0}),r=n.lastIndex}if(r<e.length){let n=e.slice(r);n&&t.push({text:n,isVariable:!1})}return t}function p(e){let t=e.subConditions||[];if(t.length===0)return[{text:``,isVariable:!1}];if(t.length===1){let e=t[0];if(!e)return[{text:``,isVariable:!1}];let n=e.field&&String(e.field).trim()!==``,r=e.value!==null&&e.value!==void 0&&String(e.value).trim()!==``;if(!n&&!r)return[{text:``,isVariable:!1}];let i=String(e.field||``),a=u[e.operator]||e.operator,o=String(e.value??``);if([`exists`,`does not exist`,`is empty`,`is not empty`,`is true`,`is false`].includes(e.operator)){let e=[];return d(i)?e.push({text:i,isVariable:!0}):e.push(...f(i)),e.push({text:` `+a,isVariable:!1}),e}let s=[];return d(i)?s.push({text:i,isVariable:!0}):s.push(...f(i)),s.push({text:` `+a+` `,isVariable:!1}),d(o)?s.push({text:o,isVariable:!0}):s.push(...f(m(o,20))),s}let n=e.logic===`and`?`  `:`  `,r=[];return t.forEach((e,t)=>{if(!e)return;let i=e.field&&String(e.field).trim()!==``,a=e.value!==null&&e.value!==void 0&&String(e.value).trim()!==``;if(!i&&!a){t>0&&r.push({text:n,isVariable:!1}),r.push({text:``,isVariable:!1});return}t>0&&r.push({text:n,isVariable:!1});let o=String(e.field||``),s=u[e.operator]||e.operator,c=String(e.value??``);[`exists`,`does not exist`,`is empty`,`is not empty`,`is true`,`is false`].includes(e.operator)?(d(o)?r.push({text:o,isVariable:!0}):r.push(...f(o)),r.push({text:` `+s,isVariable:!1})):(d(o)?r.push({text:o,isVariable:!0}):r.push(...f(o)),r.push({text:` `+s+` `,isVariable:!1}),d(c)?r.push({text:c,isVariable:!0}):r.push(...f(m(c,15))))}),r}function m(e,t){return e?e.length<=t?e:e.slice(0,t-1)+``:``}return W(r,e=>{F(()=>{i.value=Array(e.length).fill(null)})},{immediate:!0}),(t,n)=>(G(),L(ym,{id:e.id,data:l.value,selected:e.selected},{default:Y(()=>[I(`div`,mx,[(G(!0),P(je,null,Le(r.value,(e,t)=>(G(),P(`div`,{key:t,class:`px-1.5 py-1 bg-slate-50 border border-slate-200 rounded transition-all duration-200 hover:bg-slate-100`,ref_for:!0,ref:e=>o(e,t)},[I(`div`,hx,[I(`span`,gx,` `+J(t+1),1),(e.subConditions?.length??0)>1?(G(),P(`span`,_x,J(e.logic===`and`?``:``),1)):z(``,!0)]),I(`div`,vx,[(G(!0),P(je,null,Le(p(e),(e,t)=>(G(),P(je,{key:t},[e.isVariable?(G(),L(lx,{key:0,value:e.text,size:`default`},null,8,[`value`])):(G(),P(`span`,yx,J(e.text),1))],64))),128))])]))),128)),I(`div`,{class:`px-1.5 py-1 bg-orange-50 border border-orange-200 rounded transition-all duration-200 hover:bg-orange-100`,ref_key:`elsePreviewRef`,ref:a},[...n[0]||=[I(`div`,{class:`flex items-center justify-between gap-1.5 mb-0.5`},[I(`span`,{class:`text-[9px] font-semibold text-slate-600 uppercase tracking-wide`},`  `)],-1),I(`div`,{class:`text-[10px] text-slate-500 leading-tight wrap-break-word`},`  `,-1)]],512),n[1]||=I(`div`,{class:`hidden mt-1 py-1.5 px-2 text-[10px] text-slate-400 text-center bg-slate-50 border border-dashed border-slate-300 rounded-md`},`  `,-1)])]),outputPorts:Y(e=>[(G(!0),P(je,null,Le(s.value,(t,n)=>(G(),L(B(qf),{key:t.id,id:t.id,type:t.type,position:e.position,"node-id":e.nodeId,variant:t.variant,style:R(c(n))},null,8,[`id`,`type`,`position`,`node-id`,`variant`,`style`]))),128))]),_:1},8,[`id`,`data`,`selected`]))}}),xx={},Sx={xmlns:`http://www.w3.org/2000/svg`,width:`1em`,height:`1em`,viewBox:`0 0 24 24`,fill:`none`,stroke:`currentColor`,"stroke-width":`2`,"stroke-linecap":`round`,"stroke-linejoin":`round`};function Cx(e,t){return G(),P(`svg`,Sx,[...t[0]||=[I(`path`,{d:`M21 12a9 9 0 1 1-9-9c2.52 0 4.93 1 6.74 2.74L21 8`},null,-1),I(`path`,{d:`M21 3v5h-5`},null,-1),I(`path`,{d:`M3 12a9 9 0 1 0 9-9`},null,-1)]])}var wx=Z(xx,[[`render`,Cx]]),Tx={class:`hidden flex flex-col gap-2 py-1.5`},Ex={class:`p-2 bg-slate-50 border border-slate-200 rounded-md`},Dx={class:`flex items-center justify-between gap-2 mb-1.5`},Ox={class:`text-[10px] font-semibold text-slate-600 uppercase tracking-wide`},kx={class:`text-[9px] text-slate-400 font-mono`},Ax={class:`flex flex-wrap items-center gap-1 text-[11px] text-slate-500`},jx={key:0,class:`text-slate-400 italic`},Mx={key:1,class:`font-mono font-semibold text-slate-700`},Nx={key:3,class:`font-mono font-semibold text-slate-700`},Px={key:4,class:`text-slate-400`},Fx=V({__name:`ForNode`,props:{id:{},data:{},selected:{type:Boolean}},setup(e){let t=e,n=q(()=>t.data.config||{mode:`variable`,variable:``,range:{start:0,end:10,step:1},itemName:`item`,indexName:`index`}),r=q(()=>n.value.mode===`variable`?``:``);function i(e){return typeof e==`string`?/^\{\{.+\}\}$/.test(e.trim()):!1}let a=q(()=>{let e={headerColor:[`#f97316`,`#ea580c`],icon:wx,showIcon:!0};return{...t.data,label:t.data.label||``,noInputs:!1,noOutputs:!1,style:e}});return(t,o)=>(G(),L(ym,{id:e.id,data:a.value,selected:e.selected},{default:Y(()=>[O(um,{data:e.data},null,8,[`data`]),I(`div`,Tx,[I(`div`,Ex,[I(`div`,Dx,[I(`span`,Ox,J(r.value),1),I(`span`,kx,J(n.value.itemName)+`, `+J(n.value.indexName),1)]),I(`div`,Ax,[n.value.mode===`variable`?(G(),P(je,{key:0},[n.value.variable?(G(),P(je,{key:1},[o[0]||=I(`span`,null,``,-1),O(lx,{value:n.value.variable,size:`default`},null,8,[`value`])],64)):(G(),P(`span`,jx,`  `))],64)):n.value.mode===`range`?(G(),P(je,{key:1},[o[1]||=I(`span`,null,`:`,-1),i(n.value.range?.start)?(G(),L(lx,{key:0,value:String(n.value.range?.start??0),size:`default`},null,8,[`value`])):(G(),P(`span`,Mx,J(n.value.range?.start??0),1)),o[2]||=I(`span`,null,`~`,-1),i(n.value.range?.end)?(G(),L(lx,{key:2,value:String(n.value.range?.end??10),size:`default`},null,8,[`value`])):(G(),P(`span`,Nx,J(n.value.range?.end??10),1)),(n.value.range?.step??1)===1?z(``,!0):(G(),P(`span`,Px,` (: `+J(n.value.range?.step)+`) `,1))],64)):z(``,!0)])])])]),outputPorts:Y(e=>[O(B(qf),{id:`next`,type:`source`,position:B(Q).Right,"node-id":e.nodeId,variant:`ellipse`,style:R(e.defaultPort.style)},null,8,[`position`,`node-id`,`style`]),O(B(qf),{id:`loop`,type:`source`,position:B(Q).Bottom,"node-id":e.nodeId,variant:`circle`,"is-connectable":!1,class:N(`for-node-loop`),style:{left:`50%`,bottom:`-8px`,top:`auto`,transform:`translateX(-50%)`}},null,8,[`position`,`node-id`])]),_:1},8,[`id`,`data`,`selected`]))}}),Ix=Z(Fx,[[`__scopeId`,`data-v-72c478f4`]]),Lx={class:`flex items-center gap-2`},Rx={class:`text-[10px] text-slate-400 font-mono`},zx={key:0,class:`flex items-center justify-center h-full text-xs text-slate-400 italic`},Bx=V({__name:`ForLoopContainerNode`,props:{id:{},data:{},selected:{type:Boolean}},setup(e){let{headerHeight:t,padding:n,minWidth:r,minHeight:i,padding:{top:a}}=Ff,o=e,s=te(Gf),c=q(()=>{let e=o.id;return e.length>12?`${e.slice(0,6)}...${e.slice(-4)}`:e}),l=q(()=>!1),u=q(()=>{if(!s)return null;let e=s.getSharedState()[`for-loop`];if(!e||!e.containerHighlight)return null;let t=e.containerHighlight.value;return!t||!t[o.id]?null:t[o.id]}),d=q(()=>{let e=u.value;return e?e===`normal`?`border-2 border-solid border-indigo-500 shadow-lg shadow-indigo-200 ring-2 ring-indigo-200`:e===`warning`?`border-2 border-solid border-red-500 shadow-lg shadow-red-200 ring-2 ring-red-200`:`border-2 border-dashed border-slate-300`:`border-2 border-dashed border-slate-300`}),f=q(()=>({minWidth:`${r}px`,minHeight:`${i}px`}));return(r,o)=>(G(),P(`div`,{class:N([`for-loop-container relative bg-white rounded-lg transition-all duration-200 h-full`,d.value]),style:R(f.value)},[I(`div`,{class:`container-header absolute left-0 right-0 top-0 flex items-center justify-between px-3 text-xs font-medium text-slate-600 border-b border-slate-200 bg-gradient-to-r from-slate-50 to-slate-100 rounded-t-lg`,style:R({height:`${B(t)}px`})},[I(`span`,Lx,[O(wx,{class:`w-4 h-4 text-orange-500`}),I(`span`,null,J(e.data.label||``),1)]),I(`span`,Rx,J(c.value),1)],4),O(B(qf),{id:`loop-in`,type:`target`,position:B(Q).Top,"node-id":e.id,variant:`circle`,"is-connectable":!1,style:{left:`50%`,transform:`translateX(-50%)`,top:`-8px`}},null,8,[`position`,`node-id`]),O(B(qf),{id:`loop-left`,type:`source`,position:B(Q).Right,"node-id":e.id,variant:`ellipse`,"is-connectable":!0,style:R({left:`-5px`,right:`auto!important`,zIndex:100,top:`${B(t)+50+B(a)}px!important`})},null,8,[`position`,`node-id`,`style`]),O(B(qf),{id:`loop-right`,type:`target`,position:B(Q).Left,"node-id":e.id,variant:`ellipse`,"is-connectable":!0,style:R({left:`auto!important`,right:`-5px`,zIndex:100,top:`${B(t)+50+B(a)}px!important`})},null,8,[`position`,`node-id`,`style`]),I(`div`,{class:`container-content`,style:R({paddingTop:`${B(t)+B(n).top}px`,paddingLeft:`${B(n).left}px`,paddingRight:`${B(n).right}px`,paddingBottom:`${B(n).bottom}px`,minHeight:`${B(i)}px`})},[l.value?z(``,!0):(G(),P(`div`,zx))],4)],6))}}),Vx=Z(Bx,[[`__scopeId`,`data-v-c40f6cdc`]]),Hx=V({__name:`CodeNode`,props:{id:{},data:{},selected:{type:Boolean}},setup(e){let t=e,n=q(()=>t.data.config||{code:``,dataItems:[],typeDeclarations:``});q(()=>{let e=n.value.dataItems;return Array.isArray(e)?e.map((e,n)=>{let r=typeof e?.key==`string`?e.key.trim():``;if(!r)return null;let i=e?.value,a=`()`;if(typeof i==`string`&&i.trim())a=i.trim();else if(i!=null)try{a=JSON.stringify(i)}catch{a=String(i)}return{id:`${t.id}-${n}`,key:r,preview:a}}).filter(e=>!!e):[]}),q(()=>{let e=n.value.code||``,t=e.split(`
`);return t.length>6?t.slice(0,6).join(`
`)+`
...`:e||`// `});let r=q(()=>{let e={headerColor:[`#8b5cf6`,`#7c3aed`],icon:rt,showIcon:!0};return{...t.data,label:t.data.label||``,noInputs:!1,noOutputs:!1,style:e}});return(t,n)=>(G(),L(ym,{id:e.id,data:r.value,selected:e.selected},null,8,[`id`,`data`,`selected`]))}}),Ux=Z(Hx,[[`__scopeId`,`data-v-2570a41f`]]),Wx=[`d`,`stroke`,`stroke-width`],Gx=[`cx`,`cy`,`stroke`],Kx=Z(V({__name:`CustomConnectionEdge`,props:{sourceX:{},sourceY:{},sourcePosition:{},targetX:{},targetY:{},targetPosition:{},sourceNode:{},sourceHandle:{},targetNode:{},targetHandle:{},markerStart:{},markerEnd:{},connectionStatus:{}},setup(e){let t=e,n=w(),{config:r}=Ze(n),i=te(Gf),{onConnectEnd:a}=Hu(),o=nt(),s=q(()=>i?i.getSharedState()[`edge-edit`]?.isEditing.value:!1),c=q(()=>{if(!i)return null;let e=i.getSharedState()[`ctrl-connect`];if(!e||!e.isActive?.value)return null;let t=e.candidate?.value;return!t||!t.position?null:t}),l=q(()=>{let e=c.value;return e&&e.handleType===`source`?e.position:{x:t.sourceX,y:t.sourceY}}),u=q(()=>{let e=c.value;return e&&e.handleType===`target`?e.position:{x:t.targetX,y:t.targetY}}),d=q(()=>{let e=c.value;return e?e.isValid:t.connectionStatus?t.connectionStatus===`valid`:!(!t.targetNode||!t.targetHandle)}),f=U(d.value),p=null;W(d,(e,t)=>{p&&=(clearTimeout(p),null),t===!0&&e===!1?p=setTimeout(()=>{f.value=!1,p=null},100):f.value=e},{immediate:!0}),me(()=>{p&&=(clearTimeout(p),null)});let m=q(()=>d.value?`#22c55e`:`#ef4444`);a(e=>{!f.value&&!s.value&&o.emit(`edge:connection-failed`,{event:e,position:{x:e.clientX,y:e.clientY}})});let h=q(()=>3),g=q(()=>{let e=r.value.edgeType,n=l.value,i=u.value;if(!n||!i)return``;let a={sourceX:n.x,sourceY:n.y,sourcePosition:t.sourcePosition,targetX:i.x,targetY:i.y,targetPosition:t.sourcePosition===`left`?Q.Right:Q.Left};if(e===`straight`){let[e]=Mu(a);return e}else if(e===`step`||e===`smoothstep`){let[e]=ju(a);return e}else{let[e]=Cu(a);return e}});return(e,t)=>(G(),P(`g`,null,[I(`path`,{d:g.value,fill:`none`,stroke:m.value,"stroke-width":h.value,class:`connection-line-animated`},null,8,Wx),I(`circle`,{cx:u.value?.x??0,cy:u.value?.y??0,fill:`#fff`,r:`3`,stroke:m.value,"stroke-width":2},null,8,Gx)]))}}),[[`__scopeId`,`data-v-90144f14`]]),qx=[`id`,`d`,`stroke`,`stroke-width`],Jx=[`d`,`stroke`,`stroke-width`],Yx=12,Xx=V({__name:`CustomEdge`,props:{id:{},sourceNode:{},targetNode:{},source:{},target:{},type:{},label:{type:[String,Object,Function]},style:{},selected:{type:Boolean},sourcePosition:{},targetPosition:{},sourceHandleId:{},targetHandleId:{},animated:{type:Boolean},updatable:{type:Boolean},markerStart:{},markerEnd:{},curvature:{},interactionWidth:{},data:{},events:{},labelStyle:{},labelShowBg:{type:Boolean},labelBgStyle:{},labelBgPadding:{},labelBgBorderRadius:{},sourceX:{},sourceY:{},targetX:{},targetY:{}},setup(e){k(e=>({v3b710650:B(r).edgeActiveColor}));let t=e,n=w(),{config:r}=Ze(n),i=q(()=>t.selected?r.value.edgeActiveColor:t.style?.stroke||r.value.edgeColor),a=q(()=>t.style?.strokeWidth||r.value.edgeWidth),o=q(()=>t.animated??r.value.edgeAnimation),s=q(()=>r.value.edgeShowArrow),c=q(()=>{let e=r.value.edgeType,n={sourceX:t.sourceX,sourceY:t.sourceY,sourcePosition:t.sourcePosition,targetX:t.targetX,targetY:t.targetY,targetPosition:t.targetPosition};return e===`straight`?Mu(n):e===`step`||e===`smoothstep`?ju(n):Cu(n)}),l=q(()=>c.value[0]),u=q(()=>{if(!s.value||typeof document>`u`)return``;let e=l.value;if(!e)return``;let t=document.createElementNS(`http://www.w3.org/2000/svg`,`path`);t.setAttribute(`d`,e);let n=t.getTotalLength();if(!Number.isFinite(n)||n===0)return``;let r=t.getPointAtLength(n),i=t.getPointAtLength(Math.max(n-Yx,0)),a=Math.atan2(r.y-i.y,r.x-i.x),o=Math.PI/6,c=r.x,u=r.y,d=c-Yx*Math.cos(a-o),f=u-Yx*Math.sin(a-o),p=c-Yx*Math.cos(a+o),m=u-Yx*Math.sin(a+o);return`M ${d} ${f} L ${c} ${u} L ${p} ${m}`});return(e,n)=>(G(),P(`g`,{class:N([`custom-edge`,{selected:t.selected}])},[I(`path`,{id:t.id,d:l.value,fill:`none`,stroke:i.value,"stroke-width":a.value,class:N([{animated:o.value},`edge-path`])},null,10,qx),s.value?(G(),P(`path`,{key:0,d:u.value,fill:`none`,stroke:i.value,"stroke-width":a.value,"stroke-linejoin":`miter`,class:`edge-arrow`},null,8,Jx)):z(``,!0)],2))}}),Zx=Z(Xx,[[`__scopeId`,`data-v-36f4e4c1`]]),Qx=V({__name:`VueFlowCanvas`,props:{customNodeComponent:{default:()=>bm},config:{default:()=>({})},showBackground:{type:Boolean,default:!0},backgroundConfig:{default:()=>({})},showControls:{type:Boolean,default:!0},controlsConfig:{default:()=>({})},showMiniMap:{type:Boolean,default:!1},miniMapConfig:{default:()=>({})}},setup(e,{expose:t}){k(e=>({v7c842e4c:B(a).edgeActiveColor}));let n=w(),i=r(),{config:a}=Ze(n),o=e,s=q(()=>({...Sm,...o.config})),c=q(()=>{let e=a.value.gridType;return e===`dots`||e===`lines`?e:`dots`}),l=q(()=>({...wm,...o.controlsConfig})),u=q(()=>({...Cm,...o.miniMapConfig})),d=q(()=>({type:`custom`,animated:a.value.edgeAnimation,style:{stroke:a.value.edgeColor,strokeWidth:a.value.edgeWidth}})),f={custom:o.customNodeComponent,note:()=>Kb,start:()=>Xb,end:()=>ex,connector:()=>nx,if:()=>bx,for:()=>Ix,forLoopContainer:()=>Vx,code:()=>Ux},p={custom:Zx},m={note:{content:``,width:200,height:120},if:{config:{conditions:[{logic:`and`,subConditions:[{field:``,dataType:`string`,operator:`is equal to`,value:``}]}]}}},h=Hu(),g=new Kf,_=xm({enableStoreSync:!0,enableEvents:!0,pluginManager:g}),v=b(),{enableShortcut:y}=Ze(v),{nodes:x,edges:S,events:C}=_,{validateConnection:E}=Fd(S);qe(Gf,g),Vb();function D(e){return e.data?.color||`#ffffff`}function A(e){return e.data?.color||`#94a3b8`}function j(e,t){let n=`type`in e?e.type:e.id,r=`label`in e?e.label:e.name,i=e.description||``,o={x:t.x-Mf.defaultWidth/2,y:t.y-Mf.headerHeight/2},s=[`note`,`start`,`end`,`connector`,`if`,`for`,`forLoopContainer`,`code`].includes(n)?n:`custom`,c=m[n]||{},l=Cd(r,x.value),u={id:`node-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,type:s,position:o,data:{nodeType:n,label:l,description:i,...s===`custom`&&{type:n},...c,inputs:e.inputs||[],outputs:e.outputs||[]}};if(x.value.push(u),s===`for`){let e=`for-container-${Date.now()}-${Math.random().toString(36).substring(2,9)}`,t=Cd(``,[...x.value,u]),n={id:e,type:`forLoopContainer`,position:{x:o.x-Mf.defaultWidth/2,y:o.y+100+a.value.autoLayoutRankSpacing},data:{label:t,type:`forLoopContainer`,config:{forNodeId:u.id}},width:400,height:200};x.value.push(n);let r={id:`edge-${Date.now()}-${Math.random().toString(36).substring(2,9)}`,source:u.id,sourceHandle:`loop`,target:e,targetHandle:`loop-in`,type:`custom`,updatable:!1};S.value.push(r),u.data={...u.data,config:{...u.data.config||{},containerId:e,mode:`variable`,variable:``,itemName:`item`,indexName:`index`}},console.log(`[VueFlowCanvas]  For :`,n,`:`,r)}return console.log(`[VueFlowCanvas] :`,u,`:`,o),C&&C.emit(`node:added`,{node:u}),u}function ee(e){e.preventDefault();let t=e.dataTransfer?.getData(`application/vueflow`);if(!t){console.warn(`[VueFlowCanvas] `);return}try{let n=JSON.parse(t),r=h.project({x:e.clientX,y:e.clientY});j(n,r)}catch(e){console.error(`[VueFlowCanvas] :`,e)}}async function N({nodeId:e,screenPosition:t,startHandle:n}){console.log(`[VueFlowCanvas] :`,e,t,`startHandle:`,n);let r=i.availableNodes.find(t=>t.type===e);if(!r){console.warn(`[VueFlowCanvas] :`,e);return}let a=h.project(t),o=j(r,a);if(n&&n.nodeId){await F(),h.updateNodeInternals?.([o.id]);let e=`edge-${Date.now()}-${Math.random().toString(36).substring(2,9)}`,t;n.handleType===`target`?(console.log(`[VueFlowCanvas] `),console.log(`[VueFlowCanvas] `,r),t={id:e,source:o.id,sourceHandle:r.type===`if`?`condition-0`:`output`,target:n.nodeId,targetHandle:n.handleId??void 0,...d.value}):(console.log(`[VueFlowCanvas] `),t={id:e,source:n.nodeId,sourceHandle:n.handleId??void 0,target:o.id,targetHandle:`input`,...d.value}),console.log(`[VueFlowCanvas] :`,{source:t.source,sourceHandle:t.sourceHandle,target:t.target,targetHandle:t.targetHandle,startHandleType:n.handleType}),S.value.push(t),C&&(C.emit(`edge:connected`,{connection:{source:t.source,target:t.target,sourceHandle:t.sourceHandle,targetHandle:t.targetHandle}}),C.emit(`edge:added`,{edge:t}))}}function te(e){e.preventDefault(),e.dataTransfer&&(e.dataTransfer.dropEffect=`copy`)}function ne(e){C&&C.emit(`edge:connect-start`,e)}function re(e){let t=``,n=``;return`sourceY`in e&&typeof e.sourceY==`number`&&(t=e.sourceY),`targetY`in e&&typeof e.targetY==`number`&&(n=e.targetY),`${e.source}_${e.target}_${e.sourceHandle||``}_${e.targetHandle||``}_${t}_${n}`}function ie(){let e=new Set,t=[],n=[];for(let r of S.value){let i=re(r);e.has(i)?(n.push(r.id),console.log(`[VueFlowCanvas] :`,r.id,i)):(e.add(i),t.push(r))}n.length>0&&(S.value=t,console.log(`[VueFlowCanvas]  ${n.length} `),C&&n.forEach(e=>{C.emit(`edge:deleted`,{edgeId:e})}))}function ae(e){console.log(`[VueFlowCanvas] :`,e),setTimeout(()=>{ie()},100),C&&C.emit(`edge:connect-end`,e)}function I(e){console.log(`[VueFlowCanvas] :`,e);let t={id:`edge-${e.source}-${e.target}-${Date.now()}`,source:e.source,target:e.target,sourceHandle:e.sourceHandle,targetHandle:e.targetHandle,...d.value};S.value.push(t),C&&(C.emit(`edge:connected`,{connection:e}),C.emit(`edge:added`,{edge:t}))}function oe({node:e,event:t}){C&&C.emit(`node:clicked`,{node:e,event:t})}function se({node:e,event:t}){C&&C.emit(`node:double-clicked`,{node:e,event:t})}function le({node:e,event:t}){t?.preventDefault&&t.preventDefault(),C&&C.emit(`node:context-menu`,{node:e,event:t})}function ue({edge:e}){C&&C.emit(`edge:selected`,{edge:e})}function de(e){C&&C.emit(`canvas:clicked`,{event:e})}function fe(e){C&&C.emit(`edge:update-start`,{edge:e.edge})}function V(e){C&&C.emit(`edge:update`,e)}function H(e){C&&C.emit(`edge:update-end`,{edge:e.edge})}function me({nodeId:e}){console.log(`[VueFlowCanvas] :`,e),_.deleteNode(e)}function he({nodeId:e,label:t}){console.log(`[VueFlowCanvas] : ${e} -> ${t}`);let n=Cd(t,x.value,e);n!==t&&console.log(`[VueFlowCanvas] : ${n}`),_.updateNodes(t=>t.map(t=>t.id===e?{...t,data:{...t.data,label:n}}:t))}function ge({nodeId:e}){console.log(`[VueFlowCanvas] :`,e);let t=x.value.find(t=>t.id===e);if(!t){console.warn(`[VueFlowCanvas] :`,e);return}let n=`node-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,r=t.data?.label||``,i=Cd(r,x.value),a={...JSON.parse(JSON.stringify(t)),id:n,position:{x:t.position.x+30,y:t.position.y+30},data:{...t.data,label:i}};_.addNode(a),console.log(`[VueFlowCanvas] :`,n,a);let{removeSelectedElements:o,addSelectedNodes:s}=h;o?.(),F(()=>{let e=x.value.find(e=>e.id===n);e&&s?.([e])})}function _e({nodeId:e,containerId:t}){console.log(`[VueFlowCanvas] : ${e} <- ${t}`);let n=x.value.find(t=>t.id===e),r=x.value.find(e=>e.id===t);if(!n||!r){console.warn(`[VueFlowCanvas] `);return}let i=r.position.x+n.position.x,a=r.position.y+n.position.y,o=[];S.value.forEach(t=>{(t.source===e||t.target===e)&&o.push(t.id)}),o.forEach(e=>{_.deleteEdge(e)}),_.updateNodes(t=>t.map(t=>t.id===e?{...t,parentNode:void 0,position:{x:i,y:a}}:t)),console.log(`[VueFlowCanvas]   ${e}  ${t} ${o.length} `)}return ce(()=>{g.setContext({core:_,vueflow:h}),tt.on(`node:delete-request`,me),tt.on(`node:label-updated`,he),tt.on(`node:duplicate-request`,ge),tt.on(`node:detach-from-container`,_e),C&&C.on(`quick-menu:select-node`,N);let e=Td();g.register(e);let t=wd({enableShortcut:y});g.register(t);let n=kd();g.register(n);let r=Md();g.register(r);let i=Nd({allowReconnectToOriginal:!0});g.register(i);let s=Od();g.register(s);let c=Id({debug:!0,autoEnable:!0,allowReconnectToOriginal:!0,validateConnection:E});g.register(c);let l=If();g.register(l);let u=Lf({enableShortcut:y});g.register(u);let d=Rf({debug:!0,validateConnection:E});g.register(d);let f=Wf();g.register(f),console.log(`[VueFlowCanvas] `),console.log(`[VueFlowCanvas] :`,a.value.showGrid?``:``),console.log(`[VueFlowCanvas] :`,o.showControls?``:``),console.log(`[VueFlowCanvas] :`,o.showMiniMap?``:``),console.log(`[VueFlowCanvas] :`,a.value.edgeType),console.log(`[VueFlowCanvas] :`,a.value.edgeWidth),console.log(`[VueFlowCanvas] :`,a.value.edgeColor),console.log(`[VueFlowCanvas] :`,a.value.edgeAnimation?``:``);let p=g.getEnabledPlugins().map(e=>e.config.name);console.log(`[VueFlowCanvas] :`,p)}),t({syncToStore:_.syncToStoreImmediate}),T(()=>{tt.off(`node:delete-request`,me),tt.off(`node:label-updated`,he),tt.off(`node:duplicate-request`,ge),tt.off(`node:detach-from-container`,_e),C&&C.off(`quick-menu:select-node`,N),g.getEnabledPlugins().forEach(e=>{g.disable(e.config.id)}),console.log(`[VueFlowCanvas] `)}),(t,n)=>(G(),P(`div`,{class:`vueflow-canvas-wrapper`,style:R({backgroundColor:B(a).bgColor})},[O(B(yd),{nodes:B(x),"onUpdate:nodes":n[0]||=e=>ke(x)?x.value=e:null,edges:B(S),"onUpdate:edges":n[1]||=e=>ke(S)?S.value=e:null,"node-types":f,"edge-types":p,"default-zoom":B(a).defaultZoom,"min-zoom":B(a).minZoom,"max-zoom":B(a).maxZoom,"snap-to-grid":B(a).snapToGrid,"snap-grid":[B(a).gridSize,B(a).gridSize],"fit-view-on-init":s.value.fitViewOnInit,"connect-on-click":s.value.connectOnClick,"default-edge-options":d.value,"edges-updatable":!0,"edge-updater-radius":20,connectable:``,"connection-mode":s.value.connectionMode||`loose`,onDrop:ee,onDragover:te,onConnect:I,onConnectStart:ne,onConnectEnd:ae,onNodeClick:oe,onNodeDoubleClick:se,onNodeContextMenu:le,onEdgeClick:ue,onEdgeUpdateStart:fe,onEdgeUpdate:V,onEdgeUpdateEnd:H,onPaneClick:de},{"node-custom":Y(n=>[We(t.$slots,`node-custom`,M(pe(n)),()=>[(G(),L(be(e.customNodeComponent),M(pe(n)),null,16))])]),"node-note":Y(e=>[O(Kb,M(pe(e)),null,16)]),"node-start":Y(e=>[O(Xb,M(pe(e)),null,16)]),"node-end":Y(e=>[O(ex,M(pe(e)),null,16)]),"node-connector":Y(e=>[O(nx,M(pe(e)),null,16)]),"node-if":Y(e=>[O(bx,M(pe(e)),null,16)]),"node-for":Y(e=>[O(Ix,M(pe(e)),null,16)]),"node-forLoopContainer":Y(e=>[O(Vx,M(pe(e)),null,16)]),"node-code":Y(e=>[O(Ux,M(pe(e)),null,16)]),"connection-line":Y(e=>[O(Kx,M(pe(e)),null,16)]),"edge-custom":Y(e=>[O(Zx,M(pe(e)),null,16)]),default:Y(()=>[e.showBackground&&B(a).showGrid?(G(),L(B(Nm),{key:0,"pattern-color":B(a).gridColor,gap:B(a).gridGap,variant:c.value},null,8,[`pattern-color`,`gap`,`variant`])):z(``,!0),e.showControls?(G(),L(B(ah),{key:1,position:l.value.position,"show-zoom":l.value.showZoom,"show-fit-view":l.value.showFitView,"show-interactive":l.value.showInteractive,class:`-scale-x-100`},null,8,[`position`,`show-zoom`,`show-fit-view`,`show-interactive`])):z(``,!0),e.showMiniMap?(G(),L(B(Bb),{key:2,position:u.value.position,pannable:u.value.pannable,zoomable:u.value.zoomable,"node-color":D,"node-stroke-color":A},null,8,[`position`,`pannable`,`zoomable`])):z(``,!0)]),_:3},8,[`nodes`,`edges`,`default-zoom`,`min-zoom`,`max-zoom`,`snap-to-grid`,`snap-grid`,`fit-view-on-init`,`connect-on-click`,`default-edge-options`,`connection-mode`])],4))}}),$x={},eS={xmlns:`http://www.w3.org/2000/svg`,viewBox:`0 0 24 24`,fill:`none`,stroke:`currentColor`,"stroke-width":`2`,"stroke-linecap":`round`,"stroke-linejoin":`round`};function tS(e,t){return G(),P(`svg`,eS,[...t[0]||=[I(`path`,{d:`M3 7v6h6`},null,-1),I(`path`,{d:`M21 17a9 9 0 0 0-9-9 9 9 0 0 0-6 2.3L3 13`},null,-1)]])}var nS=Z($x,[[`render`,tS]]),rS={},iS={xmlns:`http://www.w3.org/2000/svg`,viewBox:`0 0 24 24`,fill:`none`,stroke:`currentColor`,"stroke-width":`2`,"stroke-linecap":`round`,"stroke-linejoin":`round`};function aS(e,t){return G(),P(`svg`,iS,[...t[0]||=[I(`path`,{d:`M21 7v6h-6`},null,-1),I(`path`,{d:`M3 17a9 9 0 0 1 9-9 9 9 0 0 1 6 2.3l3 2.7`},null,-1)]])}var oS=Z(rS,[[`render`,aS]]),sS={},cS={class:`w-4 h-4`,viewBox:`0 0 20 20`,fill:`none`,xmlns:`http://www.w3.org/2000/svg`};function lS(e,t){return G(),P(`svg`,cS,[...t[0]||=[I(`rect`,{x:`4`,y:`4`,width:`12`,height:`12`,rx:`2`,stroke:`currentColor`,"stroke-width":`1.5`},null,-1),I(`path`,{d:`M7 7L9 9M13 7L11 9M7 13L9 11M13 13L11 11`,stroke:`currentColor`,"stroke-width":`1.5`,"stroke-linecap":`round`},null,-1)]])}var uS=Z(sS,[[`render`,lS]]),dS={},fS={class:`w-5 h-5`,viewBox:`0 0 20 20`,fill:`none`,xmlns:`http://www.w3.org/2000/svg`};function pS(e,t){return G(),P(`svg`,fS,[...t[0]||=[I(`rect`,{x:`7`,y:`2.5`,width:`6`,height:`4`,rx:`1`,stroke:`currentColor`,"stroke-width":`1.5`},null,-1),I(`rect`,{x:`3`,y:`13.5`,width:`6`,height:`4`,rx:`1`,stroke:`currentColor`,"stroke-width":`1.5`},null,-1),I(`rect`,{x:`11`,y:`13.5`,width:`6`,height:`4`,rx:`1`,stroke:`currentColor`,"stroke-width":`1.5`},null,-1),I(`path`,{d:`M10 6.5V10M10 10L6 12M10 10L14 12`,stroke:`currentColor`,"stroke-width":`1.5`,"stroke-linecap":`round`,"stroke-linejoin":`round`},null,-1)]])}var mS=Z(dS,[[`render`,pS]]),hS={},gS={class:`w-4 h-4`,viewBox:`0 0 20 20`,fill:`none`,xmlns:`http://www.w3.org/2000/svg`};function _S(e,t){return G(),P(`svg`,gS,[...t[0]||=[I(`rect`,{x:`3`,y:`3`,width:`14`,height:`14`,rx:`2`,stroke:`currentColor`,"stroke-width":`1.5`},null,-1),I(`rect`,{x:`6`,y:`6`,width:`3`,height:`3`,rx:`0.5`,fill:`currentColor`},null,-1),I(`rect`,{x:`11`,y:`6`,width:`3`,height:`3`,rx:`0.5`,fill:`currentColor`,opacity:`0.5`},null,-1),I(`rect`,{x:`6`,y:`11`,width:`3`,height:`3`,rx:`0.5`,fill:`currentColor`,opacity:`0.5`},null,-1)]])}var vS=Z(hS,[[`render`,_S]]),yS={},bS={xmlns:`http://www.w3.org/2000/svg`,viewBox:`0 0 24 24`,fill:`currentColor`,width:`14`,height:`14`};function xS(e,t){return G(),P(`svg`,bS,[...t[0]||=[I(`path`,{d:`M6 4h4v16H6V4zm8 0h4v16h-4V4z`},null,-1)]])}var SS=Z(yS,[[`render`,xS]]),CS={},wS={xmlns:`http://www.w3.org/2000/svg`,viewBox:`0 0 24 24`,fill:`currentColor`,width:`14`,height:`14`};function TS(e,t){return G(),P(`svg`,wS,[...t[0]||=[I(`rect`,{x:`5`,y:`5`,width:`14`,height:`14`},null,-1)]])}var ES=Z(CS,[[`render`,TS]]),DS={class:`flex items-center gap-2 rounded-md border border-slate-200 bg-white/95 px-2 py-1 text-xs text-slate-600 shadow-lg`},OS=V({__name:`CanvasToolbar`,emits:[`undo`,`redo`,`fitView`,`autoLayout`,`toggleMiniMap`,`executeWorkflow`,`pauseExecution`,`resumeExecution`,`stopExecution`],setup(e,{emit:t}){let n=r(),i=nt(),{getSelectedNodes:a}=Hu(),o=q(()=>n.isExecuting),s=U(!1),c=q(()=>a.value?.length||0),l=q(()=>c.value>1?` (${c.value})`:``),u=U(!1),d=U(!1),f=e=>{u.value=e.canUndo,d.value=e.canRedo};i.on(`execution:state`,({state:e})=>{s.value=e===`paused`}),ce(()=>{i.on(`history:status-changed`,f)}),T(()=>{i.off(`history:status-changed`,f)});let p=t;return(e,t)=>{let n=K(`n-icon`),r=K(`n-button`);return G(),P(`div`,DS,[O(r,{quaternary:``,circle:``,"aria-label":` (Ctrl+Z)`,disabled:!u.value,onClick:t[0]||=e=>p(`undo`)},{icon:Y(()=>[O(n,null,{default:Y(()=>[O(nS)]),_:1})]),_:1},8,[`disabled`]),O(r,{quaternary:``,circle:``,"aria-label":` (Ctrl+Y)`,disabled:!d.value,onClick:t[1]||=e=>p(`redo`)},{icon:Y(()=>[O(n,null,{default:Y(()=>[O(oS)]),_:1})]),_:1},8,[`disabled`]),t[12]||=I(`div`,{class:`h-4 w-px bg-slate-300`},null,-1),O(r,{quaternary:``,circle:``,"aria-label":``,onClick:t[2]||=e=>p(`fitView`)},{icon:Y(()=>[O(n,null,{default:Y(()=>[O(uS)]),_:1})]),_:1}),O(r,{quaternary:``,circle:``,"aria-label":``,onClick:t[3]||=e=>p(`autoLayout`)},{icon:Y(()=>[O(n,null,{default:Y(()=>[O(mS)]),_:1})]),_:1}),O(r,{quaternary:``,circle:``,"aria-label":``,onClick:t[4]||=e=>p(`toggleMiniMap`)},{icon:Y(()=>[O(n,null,{default:Y(()=>[O(vS)]),_:1})]),_:1}),o.value?(G(),P(je,{key:1},[s.value?(G(),L(r,{key:1,type:`info`,size:`small`,onClick:t[7]||=e=>p(`resumeExecution`)},{icon:Y(()=>[O(n,null,{default:Y(()=>[O(Jp)]),_:1})]),default:Y(()=>[t[10]||=X(`  `,-1)]),_:1})):(G(),L(r,{key:0,type:`warning`,size:`small`,onClick:t[6]||=e=>p(`pauseExecution`)},{icon:Y(()=>[O(n,null,{default:Y(()=>[O(SS)]),_:1})]),default:Y(()=>[t[9]||=X(`  `,-1)]),_:1})),O(r,{type:`error`,size:`small`,onClick:t[8]||=e=>p(`stopExecution`)},{icon:Y(()=>[O(n,null,{default:Y(()=>[O(ES)]),_:1})]),default:Y(()=>[t[11]||=X(`  `,-1)]),_:1})],64)):(G(),L(r,{key:0,type:`success`,size:`small`,onClick:t[5]||=e=>p(`executeWorkflow`)},{icon:Y(()=>[O(n,null,{default:Y(()=>[O(Jp)]),_:1})]),default:Y(()=>[X(` `+J(l.value),1)]),_:1}))])}}}),kS={xmlns:`http://www.w3.org/2000/svg`,"xmlns:xlink":`http://www.w3.org/1999/xlink`,viewBox:`0 0 512 512`},AS=V({name:`SearchOutline`,render:function(e,t){return G(),P(`svg`,kS,t[0]||=[I(`path`,{d:`M221.09 64a157.09 157.09 0 1 0 157.09 157.09A157.1 157.1 0 0 0 221.09 64z`,fill:`none`,stroke:`currentColor`,"stroke-miterlimit":`10`,"stroke-width":`32`},null,-1),I(`path`,{fill:`none`,stroke:`currentColor`,"stroke-linecap":`round`,"stroke-miterlimit":`10`,"stroke-width":`32`,d:`M338.29 338.29L448 448`},null,-1)])}}),jS={key:0,class:`node-list`},MS=[`onClick`],NS={class:`node-content`},PS={class:`node-name`},FS={class:`node-desc`},IS=`#6b7280`,LS=V({__name:`QuickNodeMenu`,props:{visible:{type:Boolean},position:{},startHandle:{}},emits:[`close`,`selectNode`],setup(e,{expose:t,emit:n}){let i=e,a=n,o=U(null),s=U(null),c=U(null),l=U(null),u=U(``),d=U(0),f=U([]),p=r();function m(e,t){e&&e instanceof HTMLElement&&(f.value[t]=e)}ge(()=>{f.value=[]});let h={:{icon:De(tp),color:`#3b82f6`},:{icon:De(rt),color:`#10b981`},:{icon:De(ap),color:`#f59e0b`},:{icon:De(lp),color:`#8b5cf6`}},g=De(rt);function _(e){let t=e.category||``,n=h[t]||{icon:g,color:IS};return{id:e.type,name:e.label,description:e.description||``,icon:n.icon,color:n.color}}let v=q(()=>p.availableNodes.map(_)),y=q(()=>({left:`${i.position.x}px`,top:`${i.position.y}px`,zIndex:1e3})),b=q(()=>{let e=v.value;if(e=e.filter(e=>e.id!==`start`&&e.id!==`end`),!u.value.trim())return e;let t=u.value.toLowerCase();return e.filter(e=>e.name.toLowerCase().includes(t)||e.description.toLowerCase().includes(t))});W(()=>i.visible,e=>{e&&(u.value=``,d.value=0,F(()=>{s.value?.focus(),D()}))}),W(()=>b.value,()=>{d.value=0,F(()=>{D()})}),C(o,()=>{i.visible&&a(`close`)});function x(){a(`close`)}function S(e){a(`selectNode`,{nodeId:e.id,startHandle:i.startHandle}),a(`close`)}function w(){let e=b.value[d.value];e&&S(e)}function T(){b.value.length!==0&&(d.value=(d.value+1)%b.value.length,D())}function E(){b.value.length!==0&&(d.value=d.value===0?b.value.length-1:d.value-1,D())}function D(){F(()=>{let e=f.value[d.value];if(!(!e||!c.value||!l.value))try{let t=c.value.$el;if(!t)return;let n=t.querySelector(`.n-scrollbar-container`);if(!n)return;let r=n.getBoundingClientRect(),i=e.getBoundingClientRect(),a=i.top-r.top+n.scrollTop,o=i.height,s=r.height,l=n.scrollTop;a<l?n.scrollTo({top:Math.max(0,a-8),behavior:`auto`}):a+o>l+s&&n.scrollTo({top:a+o-s+8,behavior:`auto`})}catch(t){console.warn(`[QuickNodeMenu]  scrollIntoView:`,t),e.scrollIntoView({behavior:`auto`,block:`nearest`})}})}return t({focus:()=>{s.value?.focus()}}),(t,n)=>(G(),L(ue,{name:`menu-fade`},{default:Y(()=>[e.visible?(G(),L(B(Be),{key:0,ref_key:`menuRef`,ref:o,tabindex:`-1`,onKeydown:[j(x,[`esc`]),j(se(T,[`prevent`]),[`down`]),j(se(E,[`prevent`]),[`up`]),j(se(w,[`prevent`]),[`enter`])],class:`absolute outline-none shadow-2xl quick-node-menu`,style:R([y.value,{width:`260px`}]),size:`small`,bordered:!1,"content-style":{padding:0},"header-style":{padding:`8px 12px`},"footer-style":{padding:`8px 12px`}},{header:Y(()=>[O(B(Oe),{ref_key:`inputRef`,ref:s,value:u.value,"onUpdate:value":n[0]||=e=>u.value=e,placeholder:`...`,clearable:``,size:`small`,onKeydown:[j(se(w,[`stop`,`prevent`]),[`enter`]),j(se(T,[`stop`,`prevent`]),[`down`]),j(se(E,[`stop`,`prevent`]),[`up`])]},{prefix:Y(()=>[O(B(Je),{component:B(AS),size:16},null,8,[`component`])]),_:1},8,[`value`,`onKeydown`])]),footer:Y(()=>[O(B(Ie),{depth:`3`,style:{"font-size":`10px`,"line-height":`1.4`}},{default:Y(()=>[...n[2]||=[X(`   Enter Esc  `,-1)]]),_:1})]),default:Y(()=>[O(B(Ae),{ref_key:`scrollbarRef`,ref:c,style:{"max-height":`280px`}},{default:Y(()=>[I(`div`,{ref_key:`nodeListContainerRef`,ref:l,style:{padding:`8px 4px`}},[O(B(Ie),{depth:`3`,style:{"font-size":`11px`,"padding-left":`8px`,display:`block`,"margin-bottom":`4px`,"font-weight":`600`}},{default:Y(()=>[...n[1]||=[X(`  `,-1)]]),_:1}),b.value.length>0?(G(),P(`div`,jS,[(G(!0),P(je,null,Le(b.value,(e,t)=>(G(),P(`div`,{key:e.id,ref_for:!0,ref:e=>m(e,t),class:N([`node-item`,{"node-item-selected":d.value===t}]),onClick:t=>S(e)},[O(B(Je),{component:e.icon,color:e.color,size:16},null,8,[`component`,`color`]),I(`div`,NS,[I(`div`,PS,J(e.name),1),I(`div`,FS,J(e.description),1)])],10,MS))),128))])):(G(),L(B(Ee),{key:1,description:``,size:`small`,class:`py-6`}))],512)]),_:1},512)]),_:1},8,[`onKeydown`,`style`])):z(``,!0)]),_:1}))}}),RS=Z(LS,[[`__scopeId`,`data-v-3fe249b8`]]),zS={},BS={class:`w-4 h-4`,viewBox:`0 0 16 16`,fill:`none`,xmlns:`http://www.w3.org/2000/svg`};function VS(e,t){return G(),P(`svg`,BS,[...t[0]||=[I(`rect`,{x:`2`,y:`2`,width:`12`,height:`12`,rx:`2`,stroke:`currentColor`,"stroke-width":`1.5`},null,-1),I(`path`,{d:`M2 6H14M6 2V14`,stroke:`currentColor`,"stroke-width":`1.5`},null,-1)]])}var HS=Z(zS,[[`render`,VS]]),US={class:`flex flex-col h-full`},WS={class:`flex items-center justify-center h-16 border-b border-slate-200`},GS={class:`flex h-11 w-11 items-center justify-center rounded-2xl text-blue-400`},KS=!0,qS=V({__name:`VerticalTabNav`,setup(e){let t=b();function n(e){return()=>H(Je,null,{default:()=>H(e)})}let r=q(()=>vp.filter(e=>e.id===`node-config`?!1:e.id===`node-result-preview`?!!t.previewNodeId:!0).map(e=>({label:e.label,key:e.id,icon:n(e.icon),disabled:e.disabled}))),i=yp.filter(e=>!e.testOnly).map(e=>({label:e.label,key:e.id,icon:n(e.icon),disabled:e.disabled})),a=e=>{t.setActiveTab(e)};return(e,n)=>{let o=K(`n-menu`),s=K(`n-layout-sider`);return G(),L(s,{bordered:``,"collapse-mode":`width`,"collapsed-width":64,width:240,collapsed:KS,class:`h-full`},{default:Y(()=>[I(`div`,US,[I(`div`,WS,[I(`div`,GS,[O(HS,{class:`h-5 w-5`})])]),O(o,{value:B(t).activeTab,collapsed:KS,"collapsed-width":64,"collapsed-icon-size":22,options:r.value,"onUpdate:value":a,class:`flex-1`},null,8,[`value`,`options`]),O(o,{value:B(t).activeTab,collapsed:KS,"collapsed-width":64,"collapsed-icon-size":22,options:B(i),"onUpdate:value":a,class:`border-t border-slate-200`},null,8,[`value`,`options`])])]),_:1})}}}),JS={class:`h-full overflow-y-auto`},YS={class:`space-y-4 p-4`},XS={class:`rounded bg-slate-100 p-3 font-mono text-xs text-slate-600`},ZS=Z(V({__name:`TestMenuPanel`,setup(e){let t=b(),n=r(),i=Ge(),a=xe();function o(){t.showInfoModal(``,` Modal 

`,`info`)}function s(){t.showEditorModal(``,`// 
function helloWorld() {
  console.log("Hello, World!");
  return {
    message: "",
    timestamp: Date.now()
  };
}

helloWorld();`,`javascript`)}function c(){a?.warning({title:``,content:``,positiveText:``,negativeText:``,onPositiveClick:()=>{i?.success(``)},onNegativeClick:()=>{i?.info(``)}})}function l(){i?.info(``)}function u(e){t.setPanelSize(e),i?.success(` ${e}`)}function d(){t.resetPanel(),i?.success(``)}function f(){[{id:`test-node-${Date.now()}-1`,type:`custom`,position:{x:100,y:100},data:{label:` 1`,type:`browser.open`}},{id:`test-node-${Date.now()}-2`,type:`custom`,position:{x:300,y:100},data:{label:` 2`,type:`browser.click`}},{id:`test-node-${Date.now()}-3`,type:`custom`,position:{x:500,y:100},data:{label:` 3`,type:`browser.screenshot`}}].forEach(e=>n.addNode(e)),i?.success(` 3 `)}function p(){n.setExecuting(!0),i?.loading(`...`,{duration:1500}),setTimeout(()=>{n.setExecuting(!1),i?.success(``)},1500)}function m(){if(n.nodes.length<2){i?.warning(` 2 `);return}let e=n.nodes[0],t=n.nodes[1];if(!e||!t){i?.error(``);return}let r={id:`test-edge-${Date.now()}`,source:e.id,target:t.id};n.addEdge(r),i?.success(``)}function h(){a?.warning({title:``,content:``,positiveText:``,negativeText:``,onPositiveClick:()=>{n.clearCanvas(),i?.success(``)}})}function g(){let e={nodes:[{id:`sample-1`,type:`custom`,position:{x:100,y:100},data:{label:``,type:`browser.open`}},{id:`sample-2`,type:`custom`,position:{x:300,y:100},data:{label:``,type:`browser.input`}},{id:`sample-3`,type:`custom`,position:{x:500,y:100},data:{label:``,type:`browser.click`}}],edges:[{id:`e1-2`,source:`sample-1`,target:`sample-2`},{id:`e2-3`,source:`sample-2`,target:`sample-3`}]};n.updateNodes(e.nodes),n.updateEdges(e.edges),i?.success(``)}function _(){let e={nodes:n.nodes,edges:n.edges},t=JSON.stringify(e,null,2);console.log(``,t),navigator.clipboard.writeText(t).then(()=>{i?.success(``)})}function v(){a?.error({title:``,content:``,positiveText:``,negativeText:``,onPositiveClick:()=>{n.clearCanvas(),t.resetPanel(),i?.success(``)}})}function y(){i?.info(``)}function x(){if(!i)return;let e=i.loading(`...`,{duration:0});setTimeout(()=>{e.destroy(),i.success(``)},2e3)}function S(){i?.error(``)}function C(){i?.info(``)}function w(){t.showEditorModal(`ConfigRenderer `,`ConfigRenderer 

1.  JSON Schema 
2.   11 inputtextareanumberselectswitchcheckboxradiocolorfilejson-editorcode-editor
3.  URLEmail
4.  
5.  


- src/newCode/config/editorConfig.ts
- src/newCode/components/ui/ConfigRenderer.vue
- src/newCode/components/ui/ConfigField.vue


<ConfigRenderer 
  :schema="editorConfigSchema" 
  v-model="config" 
  @change="handleConfigChange"
/>`,`markdown`)}function T(){i?.info(` ConfigField 
 
 min/max
 
 URL 
 Email 
 
 `)}function E(){let e=JSON.stringify({theme:`light`,autoSave:!0,gridSize:20,snapToGrid:!0,executionMode:`worker`,maxConcurrentNodes:5,defaultTimeout:30,serverUrl:`http://localhost:3000`},null,2);console.log(``,e),navigator.clipboard.writeText(e).then(()=>{i?.success(``)})}return(e,r)=>{let i=K(`n-button`),a=K(`n-space`);return G(),P(`div`,JS,[I(`div`,YS,[I(`section`,null,[r[7]||=I(`h3`,{class:`mb-2 text-sm font-semibold text-slate-700`},` `,-1),O(a,{vertical:``,size:8},{default:Y(()=>[O(i,{block:``,secondary:``,onClick:o},{default:Y(()=>[...r[3]||=[X(`  Modal `,-1)]]),_:1}),O(i,{block:``,secondary:``,onClick:s},{default:Y(()=>[...r[4]||=[X(`  `,-1)]]),_:1}),O(i,{block:``,secondary:``,onClick:c},{default:Y(()=>[...r[5]||=[X(`  `,-1)]]),_:1}),O(i,{block:``,secondary:``,onClick:l},{default:Y(()=>[...r[6]||=[X(``,-1)]]),_:1})]),_:1})]),I(`section`,null,[r[12]||=I(`h3`,{class:`mb-2 text-sm font-semibold text-slate-700`},` `,-1),O(a,{vertical:``,size:8},{default:Y(()=>[O(i,{block:``,secondary:``,onClick:r[0]||=e=>u(`small`)},{default:Y(()=>[...r[8]||=[X(` Small  `,-1)]]),_:1}),O(i,{block:``,secondary:``,onClick:r[1]||=e=>u(`medium`)},{default:Y(()=>[...r[9]||=[X(` Medium  `,-1)]]),_:1}),O(i,{block:``,secondary:``,onClick:r[2]||=e=>u(`large`)},{default:Y(()=>[...r[10]||=[X(` Large  `,-1)]]),_:1}),O(i,{block:``,secondary:``,onClick:d},{default:Y(()=>[...r[11]||=[X(``,-1)]]),_:1})]),_:1})]),I(`section`,null,[r[17]||=I(`h3`,{class:`mb-2 text-sm font-semibold text-slate-700`},` `,-1),O(a,{vertical:``,size:8},{default:Y(()=>[O(i,{block:``,secondary:``,onClick:f},{default:Y(()=>[...r[13]||=[X(`  `,-1)]]),_:1}),O(i,{block:``,secondary:``,onClick:p},{default:Y(()=>[...r[14]||=[X(`  `,-1)]]),_:1}),O(i,{block:``,secondary:``,onClick:m},{default:Y(()=>[...r[15]||=[X(`  `,-1)]]),_:1}),O(i,{block:``,secondary:``,onClick:h},{default:Y(()=>[...r[16]||=[X(`  `,-1)]]),_:1})]),_:1})]),I(`section`,null,[r[21]||=I(`h3`,{class:`mb-2 text-sm font-semibold text-slate-700`},` `,-1),O(a,{vertical:``,size:8},{default:Y(()=>[O(i,{block:``,secondary:``,onClick:g},{default:Y(()=>[...r[18]||=[X(`  `,-1)]]),_:1}),O(i,{block:``,secondary:``,onClick:_},{default:Y(()=>[...r[19]||=[X(`  `,-1)]]),_:1}),O(i,{block:``,secondary:``,onClick:v},{default:Y(()=>[...r[20]||=[X(`  `,-1)]]),_:1})]),_:1})]),I(`section`,null,[r[26]||=I(`h3`,{class:`mb-2 text-sm font-semibold text-slate-700`},`  UI  `,-1),O(a,{vertical:``,size:8},{default:Y(()=>[O(i,{block:``,secondary:``,onClick:y},{default:Y(()=>[...r[22]||=[X(``,-1)]]),_:1}),O(i,{block:``,secondary:``,onClick:x},{default:Y(()=>[...r[23]||=[X(`  `,-1)]]),_:1}),O(i,{block:``,secondary:``,onClick:S},{default:Y(()=>[...r[24]||=[X(`  `,-1)]]),_:1}),O(i,{block:``,secondary:``,onClick:C},{default:Y(()=>[...r[25]||=[X(`  `,-1)]]),_:1})]),_:1})]),I(`section`,null,[r[30]||=I(`h3`,{class:`mb-2 text-sm font-semibold text-slate-700`},`   `,-1),O(a,{vertical:``,size:8},{default:Y(()=>[O(i,{block:``,secondary:``,onClick:w},{default:Y(()=>[...r[27]||=[X(` ConfigRenderer  `,-1)]]),_:1}),O(i,{block:``,secondary:``,onClick:T},{default:Y(()=>[...r[28]||=[X(`  `,-1)]]),_:1}),O(i,{block:``,secondary:``,onClick:E},{default:Y(()=>[...r[29]||=[X(`  `,-1)]]),_:1})]),_:1})]),I(`section`,null,[r[31]||=I(`h3`,{class:`mb-2 text-sm font-semibold text-slate-700`},` `,-1),I(`div`,XS,[I(`div`,null,` Tab: `+J(B(t).activeTab),1),I(`div`,null,`: `+J(B(t).floatingPanelVisible),1),I(`div`,null,`: `+J(B(t).panelWidth)+`px`,1),I(`div`,null,`: `+J(B(t).panelSize),1),I(`div`,null,`: `+J(B(n).nodes.length),1),I(`div`,null,`: `+J(B(n).edges.length),1)])])])])}}}),[[`__scopeId`,`data-v-722cc154`]]),QS={},$S={xmlns:`http://www.w3.org/2000/svg`,width:`1em`,height:`1em`,viewBox:`0 0 24 24`,fill:`none`,stroke:`currentColor`,"stroke-width":`2`,"stroke-linecap":`round`,"stroke-linejoin":`round`};function eC(e,t){return G(),P(`svg`,$S,[...t[0]||=[I(`path`,{d:`M12 5v14`},null,-1),I(`path`,{d:`M5 12h14`},null,-1)]])}var tC=Z(QS,[[`render`,eC]]),nC={},rC={xmlns:`http://www.w3.org/2000/svg`,width:`1em`,height:`1em`,viewBox:`0 0 24 24`,fill:`currentColor`};function iC(e,t){return G(),P(`svg`,rC,[...t[0]||=[I(`path`,{d:`M4 20h16a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.93a2 2 0 0 1-1.66-.9l-.82-1.2A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13c0 1.1.9 2 2 2Z`},null,-1)]])}var aC=Z(nC,[[`render`,iC]]),oC={class:`h-full overflow-y-auto bg-white`},sC={class:`border-b border-slate-200 bg-white p-3`},cC={class:`flex items-center gap-2`},lC={class:`p-3 workflow-tree`},uC=V({__name:`WorkflowTreePanel`,setup(e){let t=Ge(),n=xe(),i=r(),a=x(),o=U(``),s=U([]),c=U([]),l=q(()=>a.treeData);W(()=>l.value,e=>{if(s.value.length>0)return;let t=e.find(e=>!e.isLeaf);t&&(s.value=[String(t.key)])},{immediate:!0}),W(()=>i.currentWorkflowId,e=>{e?c.value=[e]:c.value=[]},{immediate:!0});let u=q(()=>[{label:``,value:``},...a.folderPathList.map(e=>({label:e,value:e}))]),d=q(()=>{if(!o.value)return l.value;let e=t=>t.map(t=>{let n=String(t.label||``).toLowerCase().includes(o.value.toLowerCase());if(t.children){let r=e(t.children);if(r.length>0||n)return{...t,children:r}}else if(n)return t;return null}).filter(e=>e!==null);return e(l.value)});function f({option:e}){let n=e.meta,r=n?.type===`workflow`,i=n?.type===`folder`;return H(`div`,{class:`flex items-center justify-between w-full group`},[H(`span`,{class:`flex-1`},String(e.label||``)),n?.type===`workflow`&&n.updatedAt&&H(`span`,{class:`text-xs text-slate-400 ml-2`},H(Ue,{time:n.updatedAt,type:`relative`})),r&&H(ye,{onPositiveClick:()=>{n?.type===`workflow`&&(a.deleteWorkflow(n.workflowId),t?.success(` "${e.label}" `))},positiveText:``,negativeText:``},{trigger:()=>H(Pe,{size:`tiny`,text:!0,class:`opacity-0 group-hover:opacity-100 transition-opacity ml-2`,onClick:e=>{e.stopPropagation()}},{icon:()=>H(Je,{component:Qp,class:`text-red-500`})}),default:()=>` "${e.label}" `}),i&&H(ye,{onPositiveClick:()=>{n?.type===`folder`&&D(n.folderId,String(e.label||``))},positiveText:``,negativeText:``},{trigger:()=>H(Pe,{size:`tiny`,text:!0,class:`opacity-0 group-hover:opacity-100 transition-opacity ml-2`,onClick:e=>{e.stopPropagation()}},{icon:()=>H(Je,{component:Qp,class:`text-red-500`})}),default:()=>` "${e.label}" `})])}function p({option:e}){let t=e.isLeaf?Zf:aC,n=e.isLeaf?`text-blue-500`:`text-amber-500`;return H(Je,{component:t,class:`${n} text-base`})}function m({option:e}){return{onClick(){!e.isLeaf&&e.key&&g(e.key)},onContextmenu(t){t.preventDefault(),C(e,t)},onDblclick(){e.isLeaf&&w(e)}}}function h(e){s.value=e}function g(e){let t=String(e),n=s.value.indexOf(t);n>-1?s.value.splice(n,1):s.value.push(t)}function _(e){let t=e,n=new Set;for(;t;){let e=`folder-${t}`;s.value.includes(e)||s.value.push(e);let r=a.folders.find(e=>e.id===t);if(!r||!r.parentId||n.has(r.parentId))break;n.add(t),t=r.parentId}}function v(e){if(c.value=e,e.length===0)return;let t=e[0];if(!t)return;let n=y(t,l.value);if(!n||!n.meta)return;let r=n.meta;r?.type===`workflow`&&i.loadWorkflowById(r.workflowId)}function y(e,t){for(let n of t){if(n.key===e)return n;if(n.children){let t=y(e,n.children);if(t)return t}}return null}function b({dropPosition:e,node:t}){return!(e===`inside`&&t.isLeaf)}function S({node:e,dragNode:n,dropPosition:r}){let i=n.meta,o=e.meta;!i||!o||(a.handleTreeDrop({dragMeta:i,targetMeta:o,dropPosition:r}),r===`inside`&&o.type===`folder`&&_(o.folderId),t?.success(``))}function C(e,t){console.log(`:`,e,t)}function w(e){let t=e.meta;t?.type===`workflow`&&i.loadWorkflowById(t.workflowId)}function T(){let e=U(``),r=u.value.find(e=>e.value!==``)?.value??u.value[0]?.value??``,o=U(r);n?.create({title:``,content:()=>H(Re,{vertical:!0,size:`large`,style:{width:`100%`}},{default:()=>[H(`div`,{class:`text-sm text-slate-600 mb-1`},``),H(Oe,{value:e.value,placeholder:``,onUpdateValue:t=>{e.value=t}}),H(`div`,{class:`text-sm text-slate-600 mb-1 mt-2`},``),H(we,{value:o.value,options:u.value,placeholder:``,tag:!0,filterable:!0,onUpdateValue:e=>{o.value=e}})]}),positiveText:``,negativeText:``,onPositiveClick:()=>{if(!e.value.trim())return t?.warning(``),!1;let n=a.createWorkflow(e.value.trim(),o.value);i.loadWorkflowById(n.workflow_id),t?.success(` "${e.value}" `),n.folderId&&_(n.folderId),c.value=[n.workflow_id]}})}function E(){let e=U(``),r=U(u.value[0]?.value??``);n?.create({title:``,content:()=>H(Re,{vertical:!0,size:`large`,style:{width:`100%`}},{default:()=>[H(`div`,{class:`text-sm text-slate-600 mb-1`},``),H(Oe,{value:e.value,placeholder:``,onUpdateValue:t=>{e.value=t}}),H(`div`,{class:`text-sm text-slate-600 mb-1 mt-2`},``),H(we,{value:r.value,options:u.value,placeholder:``,tag:!0,filterable:!0,onUpdateValue:e=>{r.value=e}})]}),positiveText:``,negativeText:``,onPositiveClick:()=>{if(!e.value.trim())return t?.warning(``),!1;let n=r.value.trim().replace(/\/$/,``),i=e.value.trim(),o=n?`${n}/${i}`:i,s=a.folderPathList.includes(o),c=a.createFolder(i,n);_(c.id);let l=a.buildFolderPath(c.id)||c.name;s?t?.info(` "${l}" `):t?.success(` "${l}" `)}})}function D(e,n){let r=a.deleteFolder(e,!0);if(r.success){let e=r.deletedCount;e&&(e.folders>1||e.workflows>0)?t?.success(` "${n}" ${e.folders} ${e.workflows} `):t?.success(` "${n}" `)}else t?.error(r.message)}return(e,t)=>{let n=K(`n-tree`),r=K(`n-empty`);return G(),P(`div`,oC,[I(`div`,sC,[I(`div`,cC,[O(B(Oe),{value:o.value,"onUpdate:value":t[0]||=e=>o.value=e,placeholder:`...`,size:`small`,clearable:``,class:`flex-1`},{prefix:Y(()=>[O(B(Je),{component:ot})]),_:1},8,[`value`]),O(B(Se),{placement:`bottom`,trigger:`hover`},{trigger:Y(()=>[O(B(Pe),{size:`small`,secondary:``,circle:``,onClick:T},{icon:Y(()=>[O(B(Je),{component:tC})]),_:1})]),default:Y(()=>[t[1]||=X(`  `,-1)]),_:1}),O(B(Se),{placement:`bottom`,trigger:`hover`},{trigger:Y(()=>[O(B(Pe),{size:`small`,secondary:``,circle:``,onClick:E},{icon:Y(()=>[O(B(Je),{component:aC})]),_:1})]),default:Y(()=>[t[2]||=X(`  `,-1)]),_:1})])]),I(`div`,lC,[O(n,{data:d.value,"expanded-keys":s.value,"selected-keys":c.value,"node-props":m,"render-label":f,"render-prefix":p,"allow-drop":b,"block-line":``,selectable:``,draggable:``,"onUpdate:expandedKeys":h,"onUpdate:selectedKeys":v,onDrop:S},null,8,[`data`,`expanded-keys`,`selected-keys`]),l.value.length===0?(G(),L(r,{key:0,description:``,class:`mt-8`},{extra:Y(()=>[O(B(Pe),{size:`small`,onClick:T},{default:Y(()=>[...t[3]||=[X(`  `,-1)]]),_:1})]),_:1})):z(``,!0)])])}}}),dC={class:`h-full overflow-y-auto bg-white`},fC={class:`flex items-center gap-3 rounded-lg border-2 border-blue-400 bg-white px-4 py-3 shadow-2xl`,style:{width:`240px`,background:`linear-gradient(135deg, #ffffff 0%, #eff6ff 100%)`}},pC={class:`flex-1 overflow-hidden`},mC={class:`font-semibold text-slate-800`},hC={class:`border-b border-slate-200 bg-white p-3`},gC={key:0,class:`flex items-center justify-center p-8`},_C={key:1,class:`p-3`},vC={class:`flex items-center gap-2`},yC={class:`font-medium`},bC={class:`text-xs text-slate-400`},xC={class:`space-y-2`},SC=[`onMouseenter`,`onDragstart`,`onClick`],CC={class:`flex items-start gap-2`},wC={class:`flex-1 overflow-hidden`},TC={class:`font-medium text-slate-800`},EC={class:`mt-1 text-xs text-slate-500 line-clamp-2`},DC={key:0,class:`mt-2 flex flex-wrap gap-1`},OC=Z(V({__name:`NodeLibraryPanel`,setup(e){let t=U(``),n=U([]),i=r(),a=q(()=>i.isLoadingNodeList),o=U([]),s=U(null),c=U(null),l=U(``),u=U(null),d={:{icon:De(tp),color:`#3b82f6`},:{icon:De(rt),color:`#10b981`},:{icon:De(ap),color:`#f59e0b`},:{icon:De(lp),color:`#8b5cf6`}};function f(){try{let e=i.availableNodes,t=new Map;e.forEach(e=>{let n=e.category||``;t.has(n)||t.set(n,[]),t.get(n).push(e)}),o.value=Array.from(t.entries()).map(([e,t])=>{let n=d[e]||{icon:De(rt),color:`#6b7280`};return{id:e.toLowerCase().replace(/\s+/g,`-`),name:e,icon:n.icon,color:n.color,nodes:t.map(t=>({id:t.type,name:t.label,description:t.description||``,category:e,icon:t.icon?void 0:n.icon,tags:t.tags||[],inputs:t.inputs,outputs:t.outputs}))}}),n.value=o.value.map(e=>e.id),console.log(`:`,e.length,``)}catch(e){console.error(`:`,e)}}W(()=>i.nodeListLoadedAt,()=>{f()},{immediate:!0}),ce(()=>{f(),l.value=``,u.value=De(rt)});let p=q(()=>t.value?o.value.map(e=>{let n=e.nodes.filter(e=>{let n=t.value.toLowerCase();return e.name.toLowerCase().includes(n)||e.description.toLowerCase().includes(n)||e.tags?.some(e=>e.toLowerCase().includes(n))});return n.length>0?{...e,nodes:n}:null}).filter(e=>e!==null):o.value);function m(e,t){if(l.value=e.name,u.value=e.icon||t.icon||null,c.value&&t){let e=t.color,n=g(e,-20);c.value.style.background=`linear-gradient(135deg, ${e} 0%, ${n} 100%)`}}function h(e,t){t.dataTransfer&&(t.dataTransfer.effectAllowed=`copy`,t.dataTransfer.setData(`application/vueflow`,JSON.stringify(e)),s.value&&t.dataTransfer.setDragImage(s.value,120,30),console.log(`:`,e))}function g(e,t){let n=e.replace(`#`,``),r=Math.max(0,Math.min(255,parseInt(n.substr(0,2),16)+t)),i=Math.max(0,Math.min(255,parseInt(n.substr(2,2),16)+t)),a=Math.max(0,Math.min(255,parseInt(n.substr(4,2),16)+t));return`#${r.toString(16).padStart(2,`0`)}${i.toString(16).padStart(2,`0`)}${a.toString(16).padStart(2,`0`)}`}function _(e){console.log(`:`,e)}return(e,r)=>{let i=K(`n-icon`),o=K(`n-input`),d=K(`n-spin`),f=K(`n-tag`),g=K(`n-collapse-item`),v=K(`n-collapse`),y=K(`n-empty`);return G(),P(`div`,dC,[(G(),L(E,{to:`body`},[I(`div`,{ref_key:`dragPreviewRef`,ref:s,class:`pointer-events-none fixed`,style:{left:`0`,top:`0`,"z-index":`99999`,transform:`translate(-100vw, 0)`}},[I(`div`,fC,[I(`div`,{ref_key:`dragIconRef`,ref:c,class:`flex h-10 w-10 shrink-0 items-center justify-center rounded-lg shadow-md`,style:{background:`linear-gradient(135deg, #667eea 0%, #764ba2 100%)`}},[u.value?(G(),L(be(u.value),{key:0,class:`h-5 w-5 text-white`})):z(``,!0)],512),I(`div`,pC,[I(`div`,mC,J(l.value),1),r[2]||=I(`div`,{class:`mt-0.5 text-xs text-slate-500`},``,-1)])])],512)])),I(`div`,hC,[O(o,{value:t.value,"onUpdate:value":r[0]||=e=>t.value=e,placeholder:`...`,size:`small`,clearable:``},{prefix:Y(()=>[O(i,{component:ot})]),_:1},8,[`value`])]),a.value?(G(),P(`div`,gC,[O(d,{size:`medium`})])):(G(),P(`div`,_C,[O(v,{"expanded-names":n.value,"onUpdate:expandedNames":r[1]||=e=>n.value=e},{default:Y(()=>[(G(!0),P(je,null,Le(p.value,e=>(G(),L(g,{key:e.id,name:e.id},{header:Y(()=>[I(`div`,vC,[(G(),L(be(e.icon),{class:`h-4 w-4`,style:R({color:e.color})},null,8,[`style`])),I(`span`,yC,J(e.name),1),I(`span`,bC,`(`+J(e.nodes.length)+`)`,1)])]),default:Y(()=>[I(`div`,xC,[(G(!0),P(je,null,Le(e.nodes,t=>(G(),P(`div`,{key:t.id,class:`cursor-pointer rounded border border-slate-200 bg-white p-3 transition-all hover:border-blue-400 hover:shadow-sm`,draggable:`true`,onMouseenter:n=>m(t,e),onDragstart:e=>h(t,e),onClick:e=>_(t)},[I(`div`,CC,[I(`div`,{class:`flex h-8 w-8 shrink-0 items-center justify-center rounded`,style:R({backgroundColor:e.color+`20`})},[(G(),L(be(t.icon||e.icon),{class:`h-4 w-4`,style:R({color:e.color})},null,8,[`style`]))],4),I(`div`,wC,[I(`div`,TC,J(t.name),1),I(`div`,EC,J(t.description),1),t.tags&&t.tags.length>0?(G(),P(`div`,DC,[(G(!0),P(je,null,Le(t.tags,e=>(G(),L(f,{key:e,size:`tiny`,type:`info`},{default:Y(()=>[X(J(e),1)]),_:2},1024))),128))])):z(``,!0)])])],40,SC))),128))])]),_:2},1032,[`name`]))),128))]),_:1},8,[`expanded-names`]),p.value.length===0?(G(),L(y,{key:0,description:``,class:`mt-8`})):z(``,!0)]))])}}}),[[`__scopeId`,`data-v-5ff621ec`]]),kC={},AC={class:`w-4 h-4`,viewBox:`0 0 18 18`,fill:`none`,xmlns:`http://www.w3.org/2000/svg`};function jC(e,t){return G(),P(`svg`,AC,[...t[0]||=[I(`path`,{d:`M4 6H14M6 6V5C6 4.44772 6.44772 4 7 4H11C11.5523 4 12 4.44772 12 5V6M7.5 9V12M10.5 9V12M5 6H13V14C13 14.5523 12.5523 15 12 15H6C5.44772 15 5 14.5523 5 14V6Z`,stroke:`currentColor`,"stroke-width":`1.5`,"stroke-linecap":`round`,"stroke-linejoin":`round`},null,-1)]])}var MC=Z(kC,[[`render`,jC]]),NC={},PC={xmlns:`http://www.w3.org/2000/svg`,viewBox:`0 0 20 20`,fill:`currentColor`};function FC(e,t){return G(),P(`svg`,PC,[...t[0]||=[I(`path`,{"fill-rule":`evenodd`,d:`M5.23 7.21a.75.75 0 011.06.02L10 11.168l3.71-3.938a.75.75 0 111.08 1.04l-4.25 4.5a.75.75 0 01-1.08 0l-4.25-4.5a.75.75 0 01.02-1.06z`,"clip-rule":`evenodd`},null,-1)]])}var IC=Z(NC,[[`render`,FC]]),LC=[`onClick`,`disabled`,`title`],RC={class:`flex-auto overflow-hidden whitespace-nowrap text-ellipsis`},zC={class:`flex w-max`},BC={class:`border-r border-slate-100 shrink-0`,style:{width:`140px`}},VC={class:`p-1.5 space-y-0.5`},HC=[`onClick`,`onMouseenter`],UC={class:`truncate flex-1`},WC={class:`overflow-auto max-h-80 shrink-0`,style:{width:`180px`}},GC={class:`p-1.5 space-y-0.5`},KC=[`onClick`],qC={class:`block truncate`},JC=V({__name:`CascadedSelect`,props:{modelValue:{default:void 0},options:{default:()=>[]},groups:{default:()=>[]},placeholder:{default:``},disabled:{type:Boolean,default:!1},triggerClass:{default:``},dropdownClass:{default:``}},emits:[`update:modelValue`,`change`],setup(e,{emit:t}){let n=e,r=t,i=U(!1),a=U(``),o=q(()=>n.options.find(e=>e.value===n.modelValue)),s=q(()=>o.value?o.value.displayLabel||o.value.label:n.placeholder),c=q(()=>a.value?n.options.filter(e=>e.group===a.value):[]);W(()=>n.groups,e=>{if(e.length>0&&!a.value)if(o.value)a.value=o.value.group;else{let t=e[0];t&&(a.value=t.value)}},{immediate:!0}),W(i,e=>{e&&o.value&&(a.value=o.value.group)});function l(e){r(`update:modelValue`,e.value),r(`change`,e.value),i.value=!1}function u(e){return n.modelValue===e}return(t,r)=>(G(),L(v,{modelValue:i.value,"onUpdate:modelValue":r[0]||=e=>i.value=e,"width-mode":`auto`,offset:2},{trigger:Y(({toggle:t})=>[I(`button`,{onClick:t,class:N([`inline-flex items-center justify-between cursor-pointer select-none`,`h-8 rounded-md border transition-colors duration-200`,i.value?`border-slate-400 ring-2 ring-slate-100`:`border-slate-200 hover:border-slate-300`,n.triggerClass]),disabled:e.disabled,title:o.value?.title||o.value?.label},[I(`span`,RC,J(s.value),1),O(IC,{class:N([`w-3.5 h-3.5 transition-transform shrink-0`,i.value?`rotate-180`:``])},null,8,[`class`])],10,LC)]),default:Y(()=>[I(`div`,zC,[I(`div`,BC,[I(`div`,VC,[(G(!0),P(je,null,Le(e.groups,e=>(G(),P(`button`,{key:e.value,onClick:t=>a.value=e.value,onMouseenter:t=>a.value=e.value,class:N([`w-full flex items-center gap-2 px-3 py-2 text-sm rounded`,`transition-colors duration-150 text-left`,a.value===e.value?`bg-slate-100 text-slate-900 font-medium`:`text-slate-700 hover:bg-slate-50`])},[I(`span`,UC,J(e.label),1),O(at,{class:`w-3.5 h-3.5 shrink-0 text-slate-400`})],42,HC))),128))])]),I(`div`,WC,[I(`div`,GC,[(G(!0),P(je,null,Le(c.value,e=>(G(),P(`button`,{key:e.value,onClick:t=>l(e),class:N([`w-full px-3 py-2 text-sm rounded text-left`,`transition-colors duration-150`,u(e.value)?`bg-red-50 text-red-600 font-medium`:`text-slate-700 hover:bg-slate-50`])},[I(`span`,qC,J(e.label),1)],10,KC))),128))])])])]),_:1},8,[`modelValue`]))}}),YC={},XC={class:`w-4 h-4`,viewBox:`0 0 20 20`,fill:`none`,xmlns:`http://www.w3.org/2000/svg`};function ZC(e,t){return G(),P(`svg`,XC,[...t[0]||=[I(`path`,{d:`M4 10H16`,stroke:`currentColor`,"stroke-width":`1.5`,"stroke-linecap":`round`,"stroke-linejoin":`round`},null,-1)]])}var QC=Z(YC,[[`render`,ZC]]),$C={class:`flex items-center gap-2`},ew={class:`shrink-0 pt-0.5`},tw={class:`flex-1 flex flex-col gap-2 min-w-0`},nw={class:`w-full`},rw={key:0,class:`w-full`},iw={class:`flex items-center gap-1.5 w-full`},aw={class:`shrink-0 pt-0.5`},ow=V({__name:`ConditionItem`,props:{condition:{},showDelete:{type:Boolean,default:!1}},emits:[`update:condition`,`delete`],setup(e,{emit:t}){let n=e,r=t,i=q(()=>n.condition),a=q(()=>[{value:`string`,label:`String`},{value:`number`,label:`Number`},{value:`date`,label:`Date & Time`},{value:`boolean`,label:`Boolean`},{value:`array`,label:`Array`},{value:`object`,label:`Object`}]),o={"is equal to":`=`,"is not equal to":``,contains:``,"does not contain":``,"starts with":`^`,"ends with":`$`,"is greater than":`>`,"is less than":`<`,"is greater than or equal to":``,"is less than or equal to":``,exists:`?`,"does not exist":``,"is empty":``,"is not empty":`!`,"is true":``,"is false":``},s=q(()=>{let e=[];return Object.entries(p).forEach(([t,n])=>{n.forEach(n=>{e.push({value:n,label:u[n],displayLabel:o[n]||u[n],group:t,title:u[n]})})}),e});function c(e){return e==null?``:typeof e==`string`||typeof e==`number`?e:String(e)}function l(e){return![`exists`,`does not exist`,`is empty`,`is not empty`,`is true`,`is false`].includes(e)}function f(){r(`update:condition`,{...i.value})}function m(e){r(`update:condition`,{...i.value,field:e})}function h(e){r(`update:condition`,{...i.value,value:e})}return(t,n)=>(G(),P(`div`,$C,[I(`div`,ew,[O(JC,{modelValue:i.value.operator,"onUpdate:modelValue":n[0]||=e=>i.value.operator=e,options:s.value,groups:a.value,onChange:f,"trigger-class":`operator-trigger`,placeholder:`=`},null,8,[`modelValue`,`options`,`groups`])]),I(`div`,tw,[I(`div`,nw,[O(d,{"preview-mode":`dropdown`,"model-value":c(i.value.field),"onUpdate:modelValue":m,placeholder:` - input`,class:`field-input`},null,8,[`model-value`])]),l(i.value.operator)?(G(),P(`div`,rw,[I(`div`,iw,[O(d,{"preview-mode":`dropdown`,"model-value":c(i.value.value),"onUpdate:modelValue":h,placeholder:``,class:`value-input`},null,8,[`model-value`])])])):z(``,!0)]),I(`div`,aw,[e.showDelete?(G(),P(`button`,{key:0,onClick:n[1]||=e=>t.$emit(`delete`),class:`w-7 h-7 p-0 text-gray-400 bg-transparent border border-gray-200 rounded-md cursor-pointer flex items-center justify-center transition-all duration-150 hover:text-red-500 hover:bg-red-50 hover:border-red-200`,title:``},[O(QC,{class:`w-4 h-4`})])):z(``,!0)])]))}}),sw=Z(ow,[[`__scopeId`,`data-v-3660e9a3`]]),cw=V({__name:`Select`,props:{modelValue:{default:void 0},options:{default:()=>[]},optionLabel:{default:`label`},optionValue:{default:`value`},placeholder:{default:``},disabled:{type:Boolean,default:!1},size:{default:`medium`}},emits:[`update:modelValue`,`change`],setup(e,{emit:t}){let n=e,r=t,i=q({get:()=>n.modelValue,set:e=>r(`update:modelValue`,e)}),a=q(()=>n.options.map(e=>typeof e==`object`&&e?{label:e[n.optionLabel],value:e[n.optionValue]}:{label:e,value:e}));function o(e){r(`change`,e)}return(t,n)=>(G(),L(B(we),{value:i.value,"onUpdate:value":[n[0]||=e=>i.value=e,o],options:a.value,placeholder:e.placeholder,disabled:e.disabled,size:e.size,"consistent-menu-width":!1},ae({_:2},[Le(t.$slots,(e,n)=>({name:n,fn:Y(e=>[We(t.$slots,n,M(pe(e??{})))])}))]),1032,[`value`,`options`,`placeholder`,`disabled`,`size`]))}}),lw={},uw={class:`w-4 h-4`,viewBox:`0 0 18 18`,fill:`none`,xmlns:`http://www.w3.org/2000/svg`};function dw(e,t){return G(),P(`svg`,uw,[...t[0]||=[I(`path`,{d:`M9 4V14M4 9H14`,stroke:`currentColor`,"stroke-width":`2`,"stroke-linecap":`round`},null,-1)]])}var fw=Z(lw,[[`render`,dw]]),pw={class:`relative flex flex-col gap-3`},mw={class:`absolute right-0 top-[-40px]`},hw={class:`flex items-center justify-between mb-4`},gw={class:`text-sm font-semibold text-gray-800`},_w={class:`flex gap-2`},vw={key:0,class:`flex flex-col w-14 items-center`},yw={class:`flex-1 relative w-full min-h-[10px]`},bw={key:0,class:`absolute left-1/2 right-0 top-10 bottom-0 border-l border-t border-gray-300 rounded-tl-lg`},xw={class:`flex-1 relative w-full min-h-[10px]`},Sw={key:0,class:`absolute left-1/2 right-0 top-0 bottom-10 border-l border-b border-gray-300 rounded-bl-lg`},Cw={class:`flex-1 flex flex-col gap-3 min-w-0`},ww={class:`ml-29 mt-2`},Tw=Z(V({__name:`ConditionEditor`,props:{modelValue:{}},emits:[`update:modelValue`],setup(e,{emit:t}){let n=e,r=t,i=Ye({conditions:n.modelValue.conditions&&n.modelValue.conditions.length>=1?n.modelValue.conditions:[a()]});W(()=>n.modelValue,e=>{JSON.stringify(e)!==JSON.stringify(i)&&(i.conditions=e.conditions&&e.conditions.length>=1?e.conditions:[a()])},{deep:!0});function a(){return{logic:`and`,subConditions:[o()]}}function o(){return{field:``,dataType:`string`,operator:`is equal to`,value:``}}function s(){i.conditions.push(a()),p()}function c(e){i.conditions.length>1&&(i.conditions.splice(e,1),p())}function l(e,t){i.conditions[e]=t,p()}function u(e){let t=i.conditions[e];t&&(t.subConditions.push(o()),p())}function d(e,t){let n=i.conditions[e];n&&n.subConditions.length>1&&(n.subConditions.splice(t,1),p())}function f(e,t,n){let r=i.conditions[e];r&&(r.subConditions[t]=n,p())}function p(){r(`update:modelValue`,{conditions:i.conditions})}return(e,t)=>(G(),P(`div`,pw,[I(`div`,mw,[O(B(Pe),{size:`small`,type:`primary`,ghost:``,onClick:s},{icon:Y(()=>[O(fw)]),default:Y(()=>[t[0]||=X(`  `,-1)]),_:1})]),(G(!0),P(je,null,Le(i.conditions,(e,n)=>(G(),P(`div`,{key:n,class:`border border-gray-200 rounded-lg p-4 bg-white`},[I(`div`,hw,[I(`div`,gw,J(n===0?``:``),1),i.conditions.length>1?(G(),L(B(Pe),{key:0,onClick:e=>c(n),size:`tiny`,text:``},{icon:Y(()=>[O(QC,{class:`w-4 h-4`})]),_:1},8,[`onClick`])):z(``,!0)]),I(`div`,_w,[e.subConditions.length>1?(G(),P(`div`,vw,[I(`div`,yw,[e.subConditions.length>1?(G(),P(`div`,bw)):z(``,!0)]),O(cw,{modelValue:e.logic,"onUpdate:modelValue":t=>e.logic=t,options:[{label:``,value:`and`},{label:``,value:`or`}],onChange:t=>l(n,e),size:`small`,class:`logic-select`},null,8,[`modelValue`,`onUpdate:modelValue`,`onChange`]),I(`div`,xw,[e.subConditions.length>1?(G(),P(`div`,Sw)):z(``,!0)])])):z(``,!0),I(`div`,Cw,[(G(!0),P(je,null,Le(e.subConditions,(t,r)=>(G(),L(sw,{key:r,condition:t,"show-delete":e.subConditions.length>1,"onUpdate:condition":e=>f(n,r,e),onDelete:e=>d(n,r)},null,8,[`condition`,`show-delete`,`onUpdate:condition`,`onDelete`]))),128))])]),I(`div`,ww,[O(B(Pe),{onClick:e=>u(n),size:`small`,type:`primary`,text:``},{icon:Y(()=>[O(fw,{class:`w-3.5 h-3.5`})]),default:Y(()=>[t[1]||=X(`  `,-1)]),_:1},8,[`onClick`])])]))),128)),t[2]||=I(`div`,{class:`border border-gray-200 rounded-lg p-4 bg-gray-50`},[I(`span`,{class:`text-sm font-semibold text-gray-800`},``)],-1)]))}}),[[`__scopeId`,`data-v-f6591420`]]),Ew={class:`mb-6`},Dw={class:`mb-3 flex items-center gap-2 text-sm font-semibold text-slate-700`},Ow=V({__name:`IfNodeEditor`,props:{selectedNode:{},nodeConfig:{}},emits:[`update:params`],setup(e,{emit:t}){let n=e,r=t,{updateNode:i}=Hu(),a=q(()=>n.selectedNode.data.params?.config||{conditions:[]});function o(e){let t=n.selectedNode.data.params||{};i(n.selectedNode.id,{data:{...n.selectedNode.data,params:{...t,config:e}}}),r(`update:params`,{...t,config:e})}return(e,t)=>(G(),P(`div`,Ew,[I(`h4`,Dw,[O(rt,{class:`h-4 w-4`}),t[0]||=X(`  `,-1)]),O(Tw,{"model-value":a.value,"onUpdate:modelValue":o},null,8,[`model-value`])]))}}),kw={},Aw={xmlns:`http://www.w3.org/2000/svg`,viewBox:`0 0 24 24`,fill:`none`,stroke:`currentColor`,"stroke-width":`2`,"stroke-linecap":`round`,"stroke-linejoin":`round`};function jw(e,t){return G(),P(`svg`,Aw,[...t[0]||=[I(`ellipse`,{cx:`12`,cy:`5`,rx:`9`,ry:`3`},null,-1),I(`path`,{d:`M3 5v14c0 1.66 4 3 9 3s9-1.34 9-3V5`},null,-1),I(`path`,{d:`M3 12c0 1.66 4 3 9 3s9-1.34 9-3`},null,-1)]])}var Mw=Z(kw,[[`render`,jw]]),Nw={},Pw={xmlns:`http://www.w3.org/2000/svg`,viewBox:`0 0 24 24`,fill:`none`,stroke:`currentColor`,"stroke-width":`2`,"stroke-linecap":`round`,"stroke-linejoin":`round`};function Fw(e,t){return G(),P(`svg`,Pw,[...t[0]||=[I(`path`,{d:`M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z`},null,-1),I(`polyline`,{points:`14 2 14 8 20 8`},null,-1),I(`polyline`,{points:`10 13 8 15 10 17`},null,-1),I(`polyline`,{points:`14 13 16 15 14 17`},null,-1)]])}var Iw=Z(Nw,[[`render`,Fw]]),Lw={class:`flex items-start gap-2 bg-white`},Rw={class:`w-[100px] shrink-0 param-item-key`},zw={class:`mb-1 block text-xs font-medium text-slate-600`},Bw={key:0,class:`mt-1 text-xs text-red-500`},Vw={class:`flex-1 min-w-0`},Hw={class:`flex items-center justify-between`},Uw={class:`mb-1 block text-xs font-medium text-slate-600`},Ww=V({__name:`ParamItem`,props:{paramKey:{},value:{},keyTitle:{default:``},valueTitle:{default:``},keyPlaceholder:{default:` `},valuePlaceholder:{default:`: {{ .result.name }}`},keyError:{default:``},showDelete:{type:Boolean,default:!0},previewMode:{default:`dropdown`},density:{default:`default`}},emits:[`update:param-key`,`update:value`,`delete`],setup(e,{emit:t}){let n=t;function r(e){n(`update:param-key`,e)}function i(e){n(`update:value`,e)}function a(){n(`delete`)}return(t,n)=>(G(),P(`div`,Lw,[I(`div`,Rw,[I(`label`,zw,J(e.keyTitle),1),O(B(Oe),{value:e.paramKey,placeholder:e.keyPlaceholder,size:`small`,status:e.keyError?`error`:void 0,"onUpdate:value":r},null,8,[`value`,`placeholder`,`status`]),e.keyError?(G(),P(`div`,Bw,J(e.keyError),1)):z(``,!0)]),I(`div`,Vw,[I(`div`,Hw,[I(`label`,Uw,J(e.valueTitle),1),O(MC,{class:`h-4 w-4 text-slate-400 hover:text-red-500 active:text-red-500`,onClick:a})]),O(d,{"model-value":e.value,placeholder:e.valuePlaceholder,"preview-mode":e.previewMode,density:e.density,"show-tip":!1,"onUpdate:modelValue":i},null,8,[`model-value`,`placeholder`,`preview-mode`,`density`])])]))}});function Gw(e){if(e===null)return`null`;if(e===void 0)return`undefined`;let t=typeof e;if(t===`string`)return`string`;if(t===`number`)return`number`;if(t===`boolean`)return`boolean`;if(Array.isArray(e)){if(e.length===0)return`any[]`;let t=new Set(e.map(e=>Gw(e)));return t.size===1?`${Array.from(t)[0]}[]`:`any[]`}if(t===`object`){let t=e,n=Object.entries(t).map(([e,t])=>`    ${e}: ${Gw(t)};`).join(`
`);return n?`{\n${n}\n  }`:`Record<string, any>`}return`any`}function Kw(e){if(typeof e!=`string`)return null;let t=e.trim().match(/^\{\{\s*([^{}]+?)\s*\}\}$/);return t?t[0]:null}function qw(e,t,n=`MainParams`){if(!e||e.length===0)return`interface ${n} {
  [key: string]: any;
}`;let r=e.map(e=>{let n=e.key?.trim();if(!n)return``;let r=e.value?.trim()||``,i=Kw(r),a;if(i){let e=t[n];a=Gw(e)}else a=`string`;return`  ${n}: ${a};`}).filter(Boolean).join(`
`);return r?`interface ${n} {
${r}
}`:`interface ${n} {
  [key: string]: any;
}`}var Jw={class:`mb-6 space-y-6`},Yw={class:`mb-3 flex items-center justify-between`},Xw={class:`flex items-center gap-2 text-sm font-semibold text-slate-700`},Zw={key:0,class:`rounded-md border border-dashed border-slate-300 bg-slate-50/60 px-4 py-6 text-center text-sm text-slate-400`},Qw={key:1,class:`space-y-2`},$w={class:`flex flex-col gap-2`},eT={class:`flex items-center justify-between`},tT={class:`flex items-center gap-2 text-sm font-semibold text-slate-700`},nT={class:`flex items-center gap-2`},rT={class:`relative rounded-md border border-slate-200 bg-white overflow-hidden`},iT={class:`w-5 h-8 pt-3 absolute bottom-0 right-0`},aT={class:`mt-2 text-xs text-slate-500`},oT={key:0},sT={key:1},cT=`/**
 * 
 * @param {MainParams} params - 
 */
export async function main(params) {
  return {
    receivedKeys: Object.keys(params),
    example: params,
  };
}`,lT=Z(V({__name:`CodeNodeEditor`,props:{selectedNode:{},nodeConfig:{}},emits:[`update:params`],setup(e,{emit:t}){let n=e,r=t,{updateNode:i}=Hu(),{contextMap:a}=h(),o=b(),c=U(),u=null,d=null,f=U(!1),p=q({get(){return f.value?`declaration`:`code`},set(e){f.value=e===`declaration`}}),m=/^[A-Za-z][A-Za-z0-9_]*$/,g=q(()=>{let{config:e,...t}=n.selectedNode.data.params||{};return{...e||{},...t}}),_=U(g.value.dataItems||[]),v=U(g.value.code||cT),x=q(()=>te(_.value));W(()=>n.selectedNode.data.params,e=>{if(!e){_.value=[],v.value=cT;return}let{config:t,...n}=e,r={...t||{},...n};_.value=r.dataItems||[],v.value=r.code||cT},{deep:!0}),W([_,a],()=>{ne()},{deep:!0});function S(){_.value.push({key:``,value:``}),E()}function C(e){_.value.splice(e,1),E()}function w(e,t){_.value[e]&&(_.value[e].key=t,E())}function T(e,t){_.value[e]&&(_.value[e].value=t,E())}function E(){M({dataItems:_.value})}function D(e){v.value=e,M({code:e})}function k(e){f.value||D(e)}function A(){D(cT)}function j(){let e=f.value?x.value:v.value,t=f.value?`typescript`:`javascript`,r=`${n.selectedNode.data?.label||``} - ${f.value?``:``}`;o.openEditorPanelModal(r,e,t,f.value?void 0:e=>{D(e)})}function M(e){let t={...n.selectedNode.data.params||{}};delete t.config;let a={...t,...e};i(n.selectedNode.id,{data:{...n.selectedNode.data,params:a}}),r(`update:params`,a)}function ee(e){let t=_.value[e]?.key?.trim()||``;if(!t)return``;if(!m.test(t))return``;let n=_.value.findIndex((n,r)=>r!==e&&n.key.trim()===t);return n===-1?``:` ${n+1} `}function N(e,t){u=t,console.log(` Monaco `),ne()}function te(e){if(!e||e.length===0)return`interface MainParams {
  [key: string]: any;
}`;let t={};try{let n={};if(e.forEach(e=>{let t=e.key?.trim();t&&(n[t]=e.value||``)}),a.value&&a.value.size>0){let e=l(n,a.value);Object.keys(n).forEach(n=>{t[n]=e[n]})}}catch(e){console.warn(`:`,e)}return qw(e,t,`MainParams`)}function ne(){if(!u)return;d&&=(d.dispose(),null);let e=x.value.trim();if(!e){console.log(` `);return}console.log(` :
`,e);let t=u.Uri.parse(`file:///node_modules/@types/code-node/index.d.ts`);d=u.languages.typescript.javascriptDefaults.addExtraLib(e,t.toString())}return me(()=>{d&&=(d.dispose(),null)}),(e,t)=>(G(),P(`div`,Jw,[I(`div`,null,[I(`div`,Yw,[I(`h4`,Xw,[O(Mw,{class:`h-4 w-4`}),t[1]||=X(`  (params) `,-1)]),O(B(Pe),{size:`small`,type:`primary`,ghost:``,onClick:S},{icon:Y(()=>[O(fw,{class:`h-3.5 w-3.5`})]),default:Y(()=>[t[2]||=X(`  `,-1)]),_:1})]),_.value.length===0?(G(),P(`div`,Zw,` "" `)):(G(),P(`div`,Qw,[(G(!0),P(je,null,Le(_.value,(e,t)=>(G(),L(Ww,{key:t,"param-key":e.key,value:e.value,"key-error":ee(t),"onUpdate:paramKey":e=>w(t,e),"onUpdate:value":e=>T(t,e),onDelete:e=>C(t)},null,8,[`param-key`,`value`,`key-error`,`onUpdate:paramKey`,`onUpdate:value`,`onDelete`]))),128))]))]),I(`div`,$w,[I(`div`,eT,[I(`h4`,tT,[O(rt,{class:`h-4 w-4`}),t[3]||=X(`  `,-1)]),I(`div`,nT,[O(y,{class:`overflow-hidden`,size:`sm`,modelValue:p.value,"onUpdate:modelValue":t[0]||=e=>p.value=e,options:[{value:`code`,label:``,icon:rt},{value:`declaration`,label:``,icon:Iw}]},null,8,[`modelValue`,`options`]),O(B(Pe),{size:`tiny`,type:`primary`,ghost:``,onClick:A},{icon:Y(()=>[O(it,{class:`h-3.5 w-3.5`})]),default:Y(()=>[t[4]||=X(`  `,-1)]),_:1})])]),I(`div`,rT,[O(st,{ref_key:`codeEditorRef`,ref:c,"model-value":f.value?x.value:v.value,readonly:f.value,language:f.value?`typescript`:`javascript`,options:{minimap:{enabled:!1},lineNumbers:`off`,fontSize:13},class:`code-editor-container`,"onUpdate:modelValue":k,onReady:N},null,8,[`model-value`,`readonly`,`language`]),I(`div`,iT,[I(`button`,{type:`button`,class:`flex items-center justify-center w-full h-full border-l rounded-tl-md border-t border-slate-200 bg-white text-slate-500 transition-colors hover:border-slate-300 hover:text-slate-700 hover:bg-slate-100 rounded-r-md shrink-0`,title:``,onClick:j},[O(s,{class:`h-3 w-3`})])])]),I(`div`,aT,[f.value?(G(),P(`p`,sT,`  `)):(G(),P(`p`,oT,[...t[5]||=[X(`  `,-1),I(`code`,{class:`rounded bg-slate-100 px-1 py-0.5 font-mono text-emerald-600`},` export function main(params) `,-1),X(`  `,-1)]]))])])]))}}),[[`__scopeId`,`data-v-5cd3a2f0`]]),uT={key:0,class:`mb-6`},dT={class:`mb-3 flex items-center gap-2 text-sm font-semibold text-slate-700`},fT={class:`space-y-4`},pT=V({__name:`DefaultNodeEditor`,props:{nodeTypeConfig:{},modelValue:{},isDraggingVariable:{type:Boolean}},emits:[`update:param`],setup(e,{emit:t}){let n=t;function r(e,t){n(`update:param`,e,t)}return(t,n)=>e.nodeTypeConfig&&e.nodeTypeConfig.length>0?(G(),P(`div`,uT,[I(`h4`,dT,[O(rt,{class:`h-4 w-4`}),n[0]||=X(`  `,-1)]),I(`div`,fT,[(G(!0),P(je,null,Le(e.nodeTypeConfig,t=>(G(),L(B(_),{key:t.key,field:t,"model-value":e.modelValue?.[t.key]??t.default,"is-dragging-variable":e.isDraggingVariable,"onUpdate:modelValue":e=>r(t.key,e)},null,8,[`field`,`model-value`,`is-dragging-variable`,`onUpdate:modelValue`]))),128))])])):z(``,!0)}}),mT={class:`h-full overflow-y-auto variable-scroll`},hT={key:0,class:`flex h-full items-center justify-center text-slate-400`},gT={class:`text-center`},_T={key:1,class:`p-4`},vT={class:`flex gap-2 border-t border-slate-200 pt-4`},yT=V({__name:`NodeConfigTab`,props:{selectedNode:{},nodeConfig:{},nodeTypeConfig:{},isDraggingVariable:{type:Boolean}},emits:[`param-change`,`reset`,`delete`],setup(e,{emit:t}){let n=t;function r(e,t){n(`param-change`,e,t)}function i(e){Object.entries(e).forEach(([e,t])=>{let r=t&&typeof t==`object`?JSON.parse(JSON.stringify(t)):t;n(`param-change`,e,r),console.log(`[NodeConfigTab handleParamsUpdate]`,e,r)})}function a(){n(`reset`)}function o(){n(`delete`)}return(t,n)=>{let s=K(`n-icon`),c=K(`n-button`);return G(),P(`div`,mT,[e.selectedNode?(G(),P(`div`,_T,[e.selectedNode.type===`if`?(G(),L(Ow,{key:0,"selected-node":e.selectedNode,"node-config":e.nodeConfig,"onUpdate:params":i},null,8,[`selected-node`,`node-config`])):e.selectedNode.type===`code`?(G(),L(lT,{key:1,"selected-node":e.selectedNode,"node-config":e.nodeConfig,"onUpdate:params":i},null,8,[`selected-node`,`node-config`])):(G(),L(pT,{key:2,"node-type-config":e.nodeTypeConfig,"model-value":e.nodeConfig.params,"is-dragging-variable":e.isDraggingVariable,"onUpdate:param":r},null,8,[`node-type-config`,`model-value`,`is-dragging-variable`])),I(`div`,vT,[O(c,{size:`small`,onClick:a},{icon:Y(()=>[O(s,{component:it})]),default:Y(()=>[n[2]||=X(`  `,-1)]),_:1}),O(c,{type:`error`,size:`small`,secondary:``,onClick:o},{icon:Y(()=>[O(s,{component:MC})]),default:Y(()=>[n[3]||=X(`  `,-1)]),_:1})])])):(G(),P(`div`,hT,[I(`div`,gT,[O(pp,{class:`mx-auto mb-3 h-12 w-12 opacity-50`}),n[0]||=I(`p`,{class:`text-sm`},``,-1),n[1]||=I(`p`,{class:`mt-1 text-xs text-slate-500`},``,-1)])]))])}}}),bT={class:`h-full overflow-y-auto variable-scroll`},xT={key:0,class:`flex h-full items-center justify-center text-slate-400`},ST={class:`text-center`},CT={key:1},wT={class:`border-b border-slate-200 bg-slate-50 p-4`},TT={class:`flex items-start gap-3`},ET={class:`flex-1 overflow-hidden`},DT={class:`flex items-center gap-2`},OT={class:`font-semibold text-slate-800`},kT={class:`mt-1 text-xs text-slate-500`},AT={class:`mt-1 text-xs text-slate-400`},jT={class:`p-4`},MT={class:`mb-6`},NT={class:`mb-3 flex items-center gap-2 text-sm font-semibold text-slate-700`},PT={class:`space-y-4`},FT=V({__name:`GeneralSettingsTab`,props:{selectedNode:{},nodeConfig:{},nodeColor:{}},emits:[`update:label`,`update:description`,`update:color`],setup(e,{emit:t}){let n=t;function r(e){return{pending:``,running:``,success:``,error:``}[e]||e}function i(e){return{pending:`default`,running:`warning`,success:`success`,error:`error`}[e]||`default`}return(t,a)=>{let o=K(`n-tag`),s=K(`n-input`),c=K(`n-color-picker`);return G(),P(`div`,bT,[e.selectedNode?(G(),P(`div`,CT,[I(`div`,wT,[I(`div`,TT,[I(`div`,{class:`flex h-10 w-10 shrink-0 items-center justify-center rounded-lg`,style:R({backgroundColor:e.nodeColor+`20`})},[e.selectedNode.data.icon?(G(),L(be(e.selectedNode.data.icon),{key:0,class:`h-5 w-5`,style:R({color:e.nodeColor})},null,8,[`style`])):(G(),L(tp,{key:1,class:`h-5 w-5`,style:R({color:e.nodeColor})},null,8,[`style`]))],4),I(`div`,ET,[I(`div`,DT,[I(`h3`,OT,J(e.selectedNode.data.label),1),e.selectedNode.data.status?(G(),L(o,{key:0,type:i(e.selectedNode.data.status),size:`small`},{default:Y(()=>[X(J(r(e.selectedNode.data.status)),1)]),_:1},8,[`type`])):z(``,!0)]),I(`p`,kT,J(e.selectedNode.data.description||``),1),I(`p`,AT,`ID: `+J(e.selectedNode.id),1)])])]),I(`div`,jT,[I(`div`,MT,[I(`h4`,NT,[O(lp,{class:`h-4 w-4`}),a[5]||=X(`  `,-1)]),I(`div`,PT,[I(`div`,null,[a[6]||=I(`label`,{class:`mb-2 block text-sm font-medium text-slate-700`},[X(`  `),I(`span`,{class:`text-red-500`},`*`)],-1),O(s,{value:e.nodeConfig.label,placeholder:`...`,size:`small`,"onUpdate:value":a[0]||=e=>n(`update:label`,e)},null,8,[`value`])]),I(`div`,null,[a[7]||=I(`label`,{class:`mb-2 block text-sm font-medium text-slate-700`},`  `,-1),O(s,{value:e.nodeConfig.description,type:`textarea`,placeholder:`...`,rows:3,size:`small`,"onUpdate:value":a[1]||=e=>n(`update:description`,e)},null,8,[`value`])]),I(`div`,null,[a[8]||=I(`label`,{class:`mb-2 block text-sm font-medium text-slate-700`},`  `,-1),O(c,{value:e.nodeConfig.color,"show-alpha":!1,modes:[`hex`],"onUpdate:value":a[2]||=e=>n(`update:color`,e)},null,8,[`value`])])])])])])):(G(),P(`div`,xT,[I(`div`,ST,[O(pp,{class:`mx-auto mb-3 h-12 w-12 opacity-50`}),a[3]||=I(`p`,{class:`text-sm`},``,-1),a[4]||=I(`p`,{class:`mt-1 text-xs text-slate-500`},``,-1)])]))])}}});function IT(){let e=b(),t=Ge(),{findNode:n,updateNode:r,removeNodes:i}=Hu(),a=q(()=>{if(e.selectedNodeId)return n(e.selectedNodeId)}),o=q(()=>a.value?.data?.color||`#3b82f6`),s=U({label:``,description:``,color:`#3b82f6`,noInputs:!1,noOutputs:!1,params:{}});W(a,e=>{e&&(s.value={label:e.data.label||``,description:e.data.description||``,color:e.data.color||`#3b82f6`,noInputs:e.data.noInputs||!1,noOutputs:e.data.noOutputs||!1,params:e.data.params||{}})},{immediate:!0});function c(){a.value&&r(a.value.id,{data:{...a.value.data,...s.value}})}function l(e,t){s.value.params||(s.value.params={}),s.value.params[e]=t,c()}function u(){a.value&&(s.value={label:a.value.data.label||``,description:a.value.data.description||``,color:a.value.data.color||`#3b82f6`,noInputs:a.value.data.noInputs||!1,noOutputs:a.value.data.noOutputs||!1,params:a.value.data.params||{}}),t.info(``)}function d(){a.value&&(i([a.value.id]),e.clearNodeSelection(),t.success(``))}return{selectedNode:a,nodeColor:o,nodeConfig:s,handleConfigChange:c,handleParamChange:l,handleReset:u,handleDeleteNode:d}}function LT(e){return{string:`input`,number:`number`,boolean:`switch`,array:`textarea`,object:`textarea`,json:`textarea`,any:`textarea`}[e]||`input`}function RT(e){return{nodeTypeConfig:q(()=>{if(!e.value)return[];let t=e.value.data?.inputs;return!t||!Array.isArray(t)?[]:t.map(e=>{let t=!!(e.options&&e.options.length>0);return{key:e.name,label:e.description||e.name,type:t?`select`:LT(e.type),default:e.defaultValue??``,placeholder:t?``:e.description?`${e.description}...`:``,description:e.description,required:e.required,...t&&{options:e.options}}})})}}var zT={class:`flex h-full flex-col bg-white`},BT=V({__name:`NodeConfigPanel`,setup(e){let t=U(`node`),n=U(!1),{selectedNode:r,nodeColor:i,nodeConfig:a,handleConfigChange:o,handleParamChange:s,handleReset:c,handleDeleteNode:l}=IT(),{nodeTypeConfig:u}=RT(r);function d(e){a.value.label=e,o()}function f(e){a.value.description=e,o()}function p(e){a.value.color=e,o()}function m(e){console.log(`[NodeConfigPanel] :`,e),n.value=!0}function h(e){console.log(`[NodeConfigPanel] :`,e),n.value=!1}return ce(()=>{tt.on(`variable:drag-start`,m),tt.on(`variable:drag-end`,h)}),me(()=>{tt.off(`variable:drag-start`,m),tt.off(`variable:drag-end`,h)}),(e,o)=>{let m=K(`n-tab-pane`),h=K(`n-tabs`);return G(),P(`div`,zT,[O(h,{value:t.value,"onUpdate:value":o[0]||=e=>t.value=e,type:`line`,size:`small`,class:`border-b border-slate-200 node-config-tabs`},{default:Y(()=>[O(m,{name:`node`,tab:``},{default:Y(()=>[O(yT,{"selected-node":B(r),"node-config":B(a),"node-type-config":B(u),"is-dragging-variable":n.value,onParamChange:B(s),onReset:B(c),onDelete:B(l)},null,8,[`selected-node`,`node-config`,`node-type-config`,`is-dragging-variable`,`onParamChange`,`onReset`,`onDelete`])]),_:1}),O(m,{name:`general`,tab:``},{default:Y(()=>[O(FT,{"selected-node":B(r),"node-config":B(a),"node-color":B(i),"onUpdate:label":d,"onUpdate:description":f,"onUpdate:color":p},null,8,[`selected-node`,`node-config`,`node-color`])]),_:1})]),_:1},8,[`value`])])}}}),VT={},HT={fill:`none`,stroke:`currentColor`,viewBox:`0 0 24 24`,xmlns:`http://www.w3.org/2000/svg`};function UT(e,t){return G(),P(`svg`,HT,[...t[0]||=[I(`path`,{"stroke-linecap":`round`,"stroke-linejoin":`round`,"stroke-width":`2`,d:`M15 19l-7-7 7-7`},null,-1)]])}var WT=Z(VT,[[`render`,UT]]),GT={},KT={fill:`none`,stroke:`currentColor`,viewBox:`0 0 24 24`,xmlns:`http://www.w3.org/2000/svg`};function qT(e,t){return G(),P(`svg`,KT,[...t[0]||=[I(`path`,{"stroke-linecap":`round`,"stroke-linejoin":`round`,"stroke-width":`2`,d:`M9 5l7 7-7 7`},null,-1)]])}var JT=Z(GT,[[`render`,qT]]),YT={class:`flex h-full flex-col bg-white`},XT={key:0,class:`border-b border-slate-200 px-4 py-3`},ZT={class:`flex items-center justify-between`},QT={class:`text-sm font-semibold text-slate-900`},$T={class:`flex items-center gap-2`},eE=[`title`],tE={key:0,class:`mt-3 flex items-center justify-between`},nE={class:`text-xs text-slate-500`},rE={class:`h-7 flex items-center gap-0.5 px-1.5 bg-slate-100 rounded`},iE=[`disabled`],aE={class:`text-xs font-medium font-mono text-slate-700 min-w-[38px] text-center leading-none`},oE=[`disabled`],sE={class:`flex-1 overflow-y-auto`},cE={key:0,class:`flex h-full items-center justify-center px-4 text-center`},lE={key:1,class:`p-4 space-y-4`},uE={key:0,class:`space-y-2`},dE={class:`flex items-center justify-between text-xs`},fE={key:0,class:`flex items-center justify-between text-xs`},pE={class:`font-mono text-slate-700`},mE={key:1,class:`flex items-center justify-between text-xs`},hE={class:`font-mono text-slate-600`},gE={key:1,class:`rounded-lg border border-red-200 bg-red-50 p-3`},_E={class:`flex items-start gap-2`},vE={class:`flex-1 min-w-0`},yE={class:`mt-1 text-xs text-red-700 whitespace-pre-wrap break-words`},bE={key:2,class:`space-y-2`},xE={class:`rounded-lg border border-slate-200 bg-slate-50 p-3 overflow-auto variable-scroll max-h-96`},SE={class:`text-xs text-slate-700 whitespace-pre-wrap break-words font-mono`},CE={key:3,class:`rounded-lg border border-purple-200 bg-purple-50 p-3`},wE={class:`flex items-start gap-2`},TE={key:4,class:`rounded-lg border border-gray-200 bg-gray-50 p-3`},EE={class:`flex items-start gap-2`},DE=V({__name:`NodeResultPreviewPanel`,setup(e){let t=Ge(),n=r(),i=b(),a=U(1),o=q(()=>i.previewNodeId),s=q(()=>{let e=o.value;if(!e)return null;let t=n.nodes.find(t=>t.id===e);return t?t.data?.iterationHistory:null}),c=q(()=>!!s.value&&s.value.totalIterations>0),l=q(()=>{if(!c.value||!s.value)return null;let e=a.value,t=s.value.iterations;return e<1||e>t.length?null:t[e-1]}),u=q(()=>{let e=o.value;return e?c.value&&l.value?{status:l.value.executionStatus||`success`,result:l.value.executionResult,error:l.value.executionError,duration:l.value.executionDuration,timestamp:l.value.executionTimestamp}:n.getNodeExecutionStatus(e):null}),d=q(()=>{let e=o.value;if(!e)return``;let t=n.nodes.find(t=>t.id===e);return t?.data?.label||t?.label||``}),f=q(()=>{switch(u.value?.status){case`running`:return``;case`success`:return``;case`error`:return``;case`cached`:return``;case`skipped`:return``;default:return``}}),p=q(()=>{switch(u.value?.status){case`running`:return`bg-blue-100 text-blue-700`;case`success`:return`bg-green-100 text-green-700`;case`error`:return`bg-red-100 text-red-700`;case`cached`:return`bg-purple-100 text-purple-700`;case`skipped`:return`bg-gray-100 text-gray-700`;default:return`bg-slate-100 text-slate-700`}}),m=q(()=>{switch(u.value?.status){case`running`:return`text-blue-600`;case`success`:return`text-green-600`;case`error`:return`text-red-600`;case`cached`:return`text-purple-600`;case`skipped`:return`text-gray-600`;default:return`text-slate-600`}}),h=q(()=>{if(!u.value?.result)return``;let e=u.value.result;if(typeof e==`object`)try{return JSON.stringify(e,null,2)}catch{return String(e)}return String(e)});function g(e){return new Date(e).toLocaleString(`zh-CN`,{year:`numeric`,month:`2-digit`,day:`2-digit`,hour:`2-digit`,minute:`2-digit`,second:`2-digit`})}function _(){h.value&&navigator.clipboard.writeText(h.value).then(()=>{t.success(``)}).catch(()=>{t.error(``)})}function v(e){if(!c.value||!s.value)return;let t=s.value.totalIterations;e<1||e>t||(a.value=e,o.value&&n.setNodeIterationPage(o.value,e))}function y(){a.value>1&&v(a.value-1)}function x(){c.value&&s.value&&a.value<s.value.totalIterations&&v(a.value+1)}return W([o,s],()=>{c.value&&s.value?a.value=s.value.currentPage||1:a.value=1},{immediate:!0}),(e,t)=>(G(),P(`div`,YT,[o.value?(G(),P(`div`,XT,[I(`div`,ZT,[I(`div`,null,[I(`h3`,QT,J(d.value||o.value),1),t[0]||=I(`p`,{class:`mt-1 text-xs text-slate-500`},``,-1)]),I(`div`,$T,[c.value&&l.value?(G(),P(`span`,{key:0,class:`px-2 py-0.5 text-xs font-medium bg-blue-100 text-blue-700 rounded`,title:` ${a.value}${l.value.iterationIndex}`},`  `+J(a.value),9,eE)):z(``,!0),u.value?(G(),P(`div`,{key:1,class:N([`rounded-md px-2 py-1 text-xs font-medium`,p.value])},J(f.value),3)):z(``,!0)])]),c.value?(G(),P(`div`,tE,[I(`span`,nE,`  `+J(s.value?.totalIterations)+`  `,1),I(`div`,rE,[I(`button`,{class:`p-0 text-slate-600 hover:text-slate-900 disabled:text-slate-300 disabled:cursor-not-allowed transition-colors`,disabled:a.value<=1,onClick:y,title:``},[O(WT,{class:`h-3.5 w-3.5`})],8,iE),I(`span`,aE,J(a.value)+`/`+J(s.value?.totalIterations),1),I(`button`,{class:`p-0 text-slate-600 hover:text-slate-900 disabled:text-slate-300 disabled:cursor-not-allowed transition-colors`,disabled:a.value>=(s.value?.totalIterations||0),onClick:x,title:``},[O(JT,{class:`h-3.5 w-3.5`})],8,oE)])])):z(``,!0)])):z(``,!0),I(`div`,sE,[o.value?(G(),P(`div`,lE,[u.value?(G(),P(`div`,uE,[I(`div`,dE,[t[3]||=I(`span`,{class:`text-slate-500`},``,-1),I(`span`,{class:N([`font-medium`,m.value])},J(f.value),3)]),u.value.duration?(G(),P(`div`,fE,[t[4]||=I(`span`,{class:`text-slate-500`},``,-1),I(`span`,pE,J(u.value.duration)+`ms `,1)])):z(``,!0),u.value.timestamp?(G(),P(`div`,mE,[t[5]||=I(`span`,{class:`text-slate-500`},``,-1),I(`span`,hE,J(g(u.value.timestamp)),1)])):z(``,!0)])):z(``,!0),u.value?.status===`error`&&u.value.error?(G(),P(`div`,gE,[I(`div`,_E,[O(jp,{class:`h-4 w-4 flex-shrink-0 text-red-500 mt-0.5`}),I(`div`,vE,[t[6]||=I(`p`,{class:`text-xs font-medium text-red-800`},``,-1),I(`pre`,yE,J(u.value.error),1)])])])):z(``,!0),u.value?.result?(G(),P(`div`,bE,[I(`div`,{class:`flex items-center justify-between`},[t[7]||=I(`span`,{class:`text-xs font-medium text-slate-700`},``,-1),I(`button`,{onClick:_,class:`text-xs text-blue-600 hover:text-blue-700 hover:underline`},`  `)]),I(`div`,xE,[I(`pre`,SE,J(h.value),1)])])):z(``,!0),u.value?.status===`cached`?(G(),P(`div`,CE,[I(`div`,wE,[O(Fp,{class:`h-4 w-4 flex-shrink-0 text-purple-500 mt-0.5`}),t[8]||=I(`div`,null,[I(`p`,{class:`text-xs font-medium text-purple-800`},``),I(`p`,{class:`mt-1 text-xs text-purple-600`},`  `)],-1)])])):z(``,!0),u.value?.status===`skipped`?(G(),P(`div`,TE,[I(`div`,EE,[O(zp,{class:`h-4 w-4 flex-shrink-0 text-gray-500 mt-0.5`}),t[9]||=I(`div`,null,[I(`p`,{class:`text-xs font-medium text-gray-800`},``),I(`p`,{class:`mt-1 text-xs text-gray-600`},``)],-1)])])):z(``,!0)])):(G(),P(`div`,cE,[I(`div`,null,[O(_p,{class:`mx-auto h-12 w-12 text-slate-300`}),t[1]||=I(`p`,{class:`mt-3 text-sm text-slate-500`},``,-1),t[2]||=I(`p`,{class:`mt-1 text-xs text-slate-400`},`  `,-1)])]))])]))}}),OE={class:`space-y-1`},kE={class:`space-y-1 pl-4`},AE={class:`flex items-center gap-1`},jE={class:`flex h-7 w-7 shrink-0 items-center justify-center rounded bg-slate-200 text-xs font-medium text-slate-600`},ME={key:0,class:`pl-8`},NE={key:1,class:`pl-8`},PE={key:2,class:`pl-8`},FE=V({__name:`ArrayEditor`,props:{value:{}},emits:[`update:value`],setup(e,{emit:t}){let n=e,r=t,i=[{label:`String`,value:`string`},{label:`Number`,value:`number`},{label:`Boolean`,value:`boolean`},{label:`Object`,value:`object`},{label:`Array`,value:`array`}],a=U(!0),o=U([]);function s(){a.value=!a.value}function c(e){let t=o.value[e];t&&(t.expanded=!t.expanded)}function l(){o.value=(n.value||[]).map(e=>({type:u(e),value:e,expanded:!1}))}function u(e){if(Array.isArray(e))return`array`;if(e===null)return`string`;let t=typeof e;return t===`object`?`object`:t===`number`?`number`:t===`boolean`?`boolean`:`string`}function d(e){switch(e){case`string`:return``;case`number`:return 0;case`boolean`:return!1;case`object`:return{};case`array`:return[];default:return``}}W(()=>n.value,e=>{e&&l()},{immediate:!0,deep:!0});function f(){o.value.push({type:`string`,value:``,expanded:!1}),h()}function p(e){o.value.splice(e,1),h()}function m(e){e.value=d(e.type),e.expanded=!1,h()}function h(){let e=o.value.map(e=>e.value);r(`update:value`,e)}return(e,t)=>{let n=K(`n-icon`),r=K(`n-select`),l=K(`n-button`),u=K(`n-input`),d=K(`n-input-number`),g=K(`n-switch`),_=K(`ArrayEditor`,!0);return G(),P(`div`,OE,[I(`div`,{class:`flex cursor-pointer items-center gap-2 rounded bg-slate-100 px-2 py-1.5 hover:bg-slate-200`,onClick:s},[O(n,{component:a.value?IC:at,size:`14`},null,8,[`component`]),t[0]||=I(`span`,{class:`text-xs text-slate-600`},``,-1)]),Ce(I(`div`,kE,[(G(!0),P(je,null,Le(o.value,(e,t)=>(G(),P(`div`,{key:t,class:`space-y-1`},[I(`div`,AE,[I(`div`,jE,J(t),1),O(r,{value:e.type,"onUpdate:value":[t=>e.type=t,t=>m(e)],size:`small`,options:i,"consistent-menu-width":!1,class:`w-28`},null,8,[`value`,`onUpdate:value`]),e.type===`object`||e.type===`array`?(G(),L(l,{key:0,size:`tiny`,circle:``,secondary:``,onClick:e=>c(t),title:e.expanded?``:``},{icon:Y(()=>[O(n,{component:e.expanded?IC:at},null,8,[`component`])]),_:2},1032,[`onClick`,`title`])):z(``,!0),O(l,{size:`tiny`,circle:``,secondary:``,type:`error`,onClick:e=>p(t),title:``},{icon:Y(()=>[O(n,{component:Qp})]),_:1},8,[`onClick`])]),e.type!==`object`&&e.type!==`array`?(G(),P(`div`,ME,[e.type===`string`?(G(),L(u,{key:0,value:e.value,"onUpdate:value":[t=>e.value=t,h],size:`small`,placeholder:``},null,8,[`value`,`onUpdate:value`])):e.type===`number`?(G(),L(d,{key:1,value:e.value,"onUpdate:value":[t=>e.value=t,h],size:`small`,class:`w-full`,placeholder:``},{"minus-icon":Y(()=>[O(n,{component:QC})]),"add-icon":Y(()=>[O(n,{component:tC})]),_:1},8,[`value`,`onUpdate:value`])):e.type===`boolean`?(G(),L(g,{key:2,value:e.value,"onUpdate:value":[t=>e.value=t,h]},null,8,[`value`,`onUpdate:value`])):z(``,!0)])):z(``,!0),e.type===`object`&&e.expanded?(G(),P(`div`,NE,[O(WE,{value:e.value,"onUpdate:value":[t=>e.value=t,h]},null,8,[`value`,`onUpdate:value`])])):z(``,!0),e.type===`array`&&e.expanded?(G(),P(`div`,PE,[O(_,{value:e.value,"onUpdate:value":[t=>e.value=t,h]},null,8,[`value`,`onUpdate:value`])])):z(``,!0)]))),128)),O(l,{block:``,text:``,size:`small`,onClick:f,class:`text-slate-500! hover:text-slate-700!`},{icon:Y(()=>[O(n,{component:tC})]),default:Y(()=>[t[1]||=X(`  `,-1)]),_:1})],512),[[ee,a.value]])])}}}),IE={class:`space-y-1`},LE={class:`space-y-1`},RE={class:`flex items-center gap-1`},zE={class:`w-12`},BE={class:`w-16`},VE={key:0,class:`flex-1`},HE={key:0,class:`pl-4`},UE={key:1,class:`pl-4`},WE=V({__name:`ObjectEditor`,props:{value:{}},emits:[`update:value`],setup(e,{emit:t}){let n=e,r=t,i=[{label:`String`,value:`string`},{label:`Number`,value:`number`},{label:`Boolean`,value:`boolean`},{label:`Object`,value:`object`},{label:`Array`,value:`array`}],a=U(!0),o=U([]);function s(){a.value=!a.value}function c(e){let t=o.value[e];t&&(t.expanded=!t.expanded)}function l(){o.value=Object.entries(n.value||{}).map(([e,t])=>({key:e,type:u(t),value:t,expanded:!1}))}function u(e){if(Array.isArray(e))return`array`;if(e===null)return`string`;let t=typeof e;return t===`object`?`object`:t===`number`?`number`:t===`boolean`?`boolean`:`string`}function d(e){switch(e){case`string`:return``;case`number`:return 0;case`boolean`:return!1;case`object`:return{};case`array`:return[];default:return``}}W(()=>n.value,e=>{e&&l()},{immediate:!0,deep:!0});function f(){o.value.push({key:`newKey${Date.now()}`,type:`string`,value:``,expanded:!1}),h()}function p(e){o.value.splice(e,1),h()}function m(e){e.value=d(e.type),e.expanded=!1,h()}function h(){let e={};o.value.forEach(t=>{t.key&&(e[t.key]=t.value)}),r(`update:value`,e)}return(e,t)=>{let n=K(`n-icon`),r=K(`n-input`),l=K(`n-select`),u=K(`n-input-number`),d=K(`n-switch`),g=K(`n-button`),_=K(`ObjectEditor`,!0);return G(),P(`div`,IE,[I(`div`,{class:`flex cursor-pointer items-center gap-2 rounded bg-slate-100 px-2 py-1.5 hover:bg-slate-200`,onClick:s},[O(n,{component:a.value?IC:at,size:`14`},null,8,[`component`]),t[0]||=I(`span`,{class:`text-xs text-slate-600`},``,-1)]),Ce(I(`div`,LE,[(G(!0),P(je,null,Le(o.value,(e,t)=>(G(),P(`div`,{key:t,class:`space-y-1`},[I(`div`,RE,[I(`div`,zE,[O(r,{value:e.key,"onUpdate:value":[t=>e.key=t,h],size:`tiny`,placeholder:``,class:`flex-1`},null,8,[`value`,`onUpdate:value`])]),I(`div`,BE,[O(l,{value:e.type,"onUpdate:value":[t=>e.type=t,t=>m(e)],size:`tiny`,options:i,"consistent-menu-width":!1,class:`w-28`},null,8,[`value`,`onUpdate:value`])]),e.type!==`object`&&e.type!==`array`?(G(),P(`div`,VE,[e.type===`string`?(G(),L(r,{key:0,value:e.value,"onUpdate:value":[t=>e.value=t,h],size:`tiny`,placeholder:``},null,8,[`value`,`onUpdate:value`])):e.type===`number`?(G(),L(u,{key:1,value:e.value,"onUpdate:value":[t=>e.value=t,h],size:`tiny`,class:`w-full`,placeholder:``},{"minus-icon":Y(()=>[O(n,{component:QC})]),"add-icon":Y(()=>[O(n,{component:tC})]),_:1},8,[`value`,`onUpdate:value`])):e.type===`boolean`?(G(),L(d,{key:2,value:e.value,"onUpdate:value":[t=>e.value=t,h]},null,8,[`value`,`onUpdate:value`])):z(``,!0)])):z(``,!0),I(`div`,null,[e.type===`object`||e.type===`array`?(G(),L(g,{key:0,size:`tiny`,circle:``,secondary:``,onClick:e=>c(t),title:e.expanded?``:``},{icon:Y(()=>[O(n,{component:e.expanded?IC:at},null,8,[`component`])]),_:2},1032,[`onClick`,`title`])):z(``,!0),O(g,{size:`tiny`,circle:``,secondary:``,type:`error`,onClick:e=>p(t),title:``},{icon:Y(()=>[O(n,{component:Qp})]),_:1},8,[`onClick`])])]),e.type===`object`&&e.expanded?(G(),P(`div`,HE,[O(_,{value:e.value,"onUpdate:value":[t=>e.value=t,h]},null,8,[`value`,`onUpdate:value`])])):z(``,!0),e.type===`array`&&e.expanded?(G(),P(`div`,UE,[O(FE,{value:e.value,"onUpdate:value":[t=>e.value=t,h]},null,8,[`value`,`onUpdate:value`])])):z(``,!0)]))),128)),O(g,{block:``,text:``,size:`small`,onClick:f,class:`text-slate-500! hover:text-slate-700!`},{icon:Y(()=>[O(n,{component:tC})]),default:Y(()=>[t[1]||=X(`  `,-1)]),_:1})],512),[[ee,a.value]])])}}}),GE={class:`h-full overflow-y-auto bg-white`},KE={class:`border-b border-slate-200 bg-white p-3`},qE={class:`flex gap-2`},JE={class:`p-3`},YE={class:`space-y-2`},XE={class:`flex items-start justify-between`},ZE={class:`flex-1`},QE={class:`flex items-center gap-2`},$E={class:`font-medium text-lg font-mono underline text-blue-400`},eD={key:0,class:`mt-1 text-xs text-slate-500`},tD={class:`mt-2`},nD=V({__name:`VariableEditorPanel`,setup(e){let t=Ge(),n=xe(),r=x(),i=b(),{globalVariables:a}=Ze(r),o=U(``),s=U(!1),c=U(null),l=U({key:``,type:`string`,value:``,description:``}),u=q(()=>{if(!o.value)return a.value;let e=o.value.toLowerCase();return a.value.filter(t=>t.key.toLowerCase().includes(e)||t.description?.toLowerCase().includes(e))});function d(e){return{string:`success`,number:`info`,boolean:`warning`,object:`default`,array:`default`}[e]}function f(e){console.log(`:`,e.key,e.value),r.updateGlobalVariable(e.key,e),t?.success(` ${e.key} `)}function p(e){_e(()=>{f(e)},1e3)}function m(){c.value=null,l.value={key:``,type:`string`,value:``,description:``},s.value=!0}function h(e){c.value=e;let t=e.value;(e.type===`object`||e.type===`array`)&&(t=JSON.stringify(e.value,null,2)),l.value={key:e.key,type:e.type,value:t,description:e.description||``},s.value=!0}function g(){if(!l.value.key.trim())return t?.error(``),!1;if(a.value.some(e=>e.key===l.value.key&&e.key!==c.value?.key))return t?.error(``),!1;let e=l.value.value;if((l.value.type===`object`||l.value.type===`array`)&&typeof e==`string`)try{e=JSON.parse(e)}catch{return t?.error(`JSON `),!1}if(c.value)r.updateGlobalVariable(c.value.key,{key:l.value.key,type:l.value.type,value:e,description:l.value.description}),t?.success(``);else{let n={key:l.value.key,type:l.value.type,value:e,description:l.value.description};r.addGlobalVariable(n),t?.success(``)}return s.value=!1,!0}function _(){s.value=!1,c.value=null}function v(e){let t=l.value.type;if((e===`object`||e===`array`)&&t!==`object`&&t!==`array`)switch(e){case`object`:l.value.value=`{}`;break;case`array`:l.value.value=`[]`;break}else if((t===`object`||t===`array`)&&e!==`object`&&e!==`array`)switch(e){case`string`:l.value.value=``;break;case`number`:l.value.value=0;break;case`boolean`:l.value.value=!1;break}else if(e===`object`&&t===`array`)l.value.value=`{}`;else if(e===`array`&&t===`object`)l.value.value=`[]`;else switch(e){case`string`:l.value.value=``;break;case`number`:l.value.value=0;break;case`boolean`:l.value.value=!1;break}}function y(e){n?.warning({title:``,content:` "${e.key}" `,positiveText:``,negativeText:``,onPositiveClick:()=>{r.deleteGlobalVariable(e.key),t?.success(` ${e.key} `)}})}function S(){let e=JSON.stringify(a.value,null,2);i.openEditorPanelModal(` JSON `,e,`json`,e=>{try{let n=JSON.parse(e);if(!Array.isArray(n)){t?.error(`JSON `);return}for(let e of n){if(!e||typeof e!=`object`||!e.key||!e.type||!(`value`in e)){t?.error(` keytype  value `);return}if(![`string`,`number`,`boolean`,`object`,`array`].includes(e.type)){t?.error(` "${e.key}" ${e.type}`);return}}r.setGlobalVariables(n),t?.success(``)}catch(e){t?.error(`JSON ${e instanceof Error?e.message:``}`)}})}return(e,t)=>{let n=K(`n-icon`),r=K(`n-input`),i=K(`n-button`),f=K(`n-space`),b=K(`n-tag`),x=K(`n-input-number`),C=K(`n-switch`),w=K(`n-empty`),T=K(`n-form-item`),E=K(`n-select`),D=K(`n-form`),k=K(`n-modal`);return G(),P(`div`,GE,[I(`div`,KE,[O(f,{vertical:``,size:`small`},{default:Y(()=>[O(r,{value:o.value,"onUpdate:value":t[0]||=e=>o.value=e,placeholder:`...`,size:`small`,clearable:``},{prefix:Y(()=>[O(n,{component:ot})]),_:1},8,[`value`]),I(`div`,qE,[O(i,{secondary:``,size:`small`,onClick:m,class:`flex-1`},{icon:Y(()=>[O(n,{component:tC})]),default:Y(()=>[t[9]||=X(`  `,-1)]),_:1}),O(i,{secondary:``,size:`small`,onClick:S},{icon:Y(()=>[O(n,{component:rt})]),default:Y(()=>[t[10]||=X(` JSON  `,-1)]),_:1})])]),_:1})]),I(`div`,JE,[I(`div`,YE,[(G(!0),P(je,null,Le(u.value,e=>(G(),P(`div`,{key:e.key,class:`rounded border border-slate-200 bg-white p-3`},[I(`div`,XE,[I(`div`,ZE,[I(`div`,QE,[I(`span`,$E,J(e.key),1),O(b,{type:d(e.type),size:`small`},{default:Y(()=>[X(J(e.type),1)]),_:2},1032,[`type`])])]),O(f,{size:`small`},{default:Y(()=>[O(i,{size:`tiny`,circle:``,secondary:``,onClick:t=>h(e),title:``},{icon:Y(()=>[O(n,{component:nm})]),_:1},8,[`onClick`]),O(i,{size:`tiny`,circle:``,secondary:``,type:`error`,onClick:t=>y(e),title:``},{icon:Y(()=>[O(n,{component:Qp})]),_:1},8,[`onClick`])]),_:2},1024)]),e.description?(G(),P(`div`,eD,J(e.description),1)):z(``,!0),I(`div`,tD,[e.type===`string`?(G(),L(r,{key:0,value:e.value,"onUpdate:value":[t=>e.value=t,t=>p(e)],size:`small`,placeholder:`...`},null,8,[`value`,`onUpdate:value`])):e.type===`number`?(G(),L(x,{key:1,value:e.value,"onUpdate:value":[t=>e.value=t,t=>p(e)],size:`small`,class:`w-full`},{"minus-icon":Y(()=>[O(n,{component:QC})]),"add-icon":Y(()=>[O(n,{component:tC})]),_:1},8,[`value`,`onUpdate:value`])):e.type===`boolean`?(G(),L(C,{key:2,value:e.value,"onUpdate:value":[t=>e.value=t,t=>p(e)]},null,8,[`value`,`onUpdate:value`])):e.type===`object`?(G(),L(WE,{key:3,value:e.value,"onUpdate:value":[t=>e.value=t,t=>p(e)]},null,8,[`value`,`onUpdate:value`])):e.type===`array`?(G(),L(FE,{key:4,value:e.value,"onUpdate:value":[t=>e.value=t,t=>p(e)]},null,8,[`value`,`onUpdate:value`])):z(``,!0)])]))),128))]),B(a).length===0?(G(),L(w,{key:0,description:``,class:`mt-8`},{extra:Y(()=>[O(i,{size:`small`,onClick:m},{default:Y(()=>[...t[11]||=[X(``,-1)]]),_:1})]),_:1})):z(``,!0)]),O(k,{show:s.value,"onUpdate:show":t[8]||=e=>s.value=e,preset:`dialog`,title:c.value?``:``,"positive-text":c.value?``:``,"negative-text":``,onPositiveClick:g,onNegativeClick:_},{default:Y(()=>[O(D,{model:l.value,"label-placement":`left`,"label-width":`80`,"require-mark-placement":`left`},{default:Y(()=>[O(T,{label:``,required:``},{default:Y(()=>[O(r,{value:l.value.key,"onUpdate:value":t[1]||=e=>l.value.key=e,placeholder:`: baseUrl`,disabled:!!c.value},null,8,[`value`,`disabled`])]),_:1}),O(T,{label:``,required:``},{default:Y(()=>[O(E,{value:l.value.type,"onUpdate:value":[t[2]||=e=>l.value.type=e,v],options:[{label:``,value:`string`},{label:``,value:`number`},{label:``,value:`boolean`},{label:``,value:`object`},{label:``,value:`array`}]},null,8,[`value`])]),_:1}),O(T,{label:``,required:``},{default:Y(()=>[l.value.type===`string`?(G(),L(r,{key:0,value:l.value.value,"onUpdate:value":t[3]||=e=>l.value.value=e,placeholder:``},null,8,[`value`])):l.value.type===`number`?(G(),L(x,{key:1,value:l.value.value,"onUpdate:value":t[4]||=e=>l.value.value=e,class:`w-full`},null,8,[`value`])):l.value.type===`boolean`?(G(),L(C,{key:2,value:l.value.value,"onUpdate:value":t[5]||=e=>l.value.value=e},null,8,[`value`])):(G(),L(r,{key:3,value:l.value.value,"onUpdate:value":t[6]||=e=>l.value.value=e,type:`textarea`,placeholder:` JSON `,rows:3},null,8,[`value`]))]),_:1}),O(T,{label:``},{default:Y(()=>[O(r,{value:l.value.description,"onUpdate:value":t[7]||=e=>l.value.description=e,placeholder:``,type:`textarea`,rows:2},null,8,[`value`])]),_:1})]),_:1},8,[`model`])]),_:1},8,[`show`,`title`,`positive-text`])])}}}),rD={class:`h-full overflow-y-auto bg-white`},iD={class:`border-b border-slate-200 bg-white p-3`},aD={class:`p-4`},oD={class:`flex items-center justify-between gap-2`},sD=[`title`],cD={class:`flex items-center justify-between gap-2`},lD={class:`flex items-center gap-2`},uD={class:`text-xs text-slate-500`},dD={class:`text-xs text-slate-400 pr-1`},fD=V({__name:`HistoryPanel`,setup(e){let t=Ge(),n=xe(),i=r(),a=x(),o=nt(),s=U(`all`),c=[{label:``,value:`all`},{label:``,value:`running`},{label:``,value:`success`},{label:``,value:`failed`},{label:``,value:`cancelled`}],l=U([]),u=U(!1),d=q(()=>s.value===`all`?l.value:l.value.filter(e=>e.status===s.value));function f(e){return{running:`info`,success:`success`,failed:`error`,cancelled:`warning`}[e]}function p(e){return{running:`info`,success:`success`,failed:`error`,cancelled:`warning`}[e]}function m(e){return{running:``,success:``,failed:``,cancelled:``}[e]}function h(e){let t=new Date(e),n=new Date().getTime()-e;return n<6e4?``:n<36e5?`${Math.floor(n/6e4)} `:n<864e5?`${Math.floor(n/36e5)} `:n<6048e5?`${Math.floor(n/864e5)} `:t.toLocaleString(`zh-CN`,{year:`numeric`,month:`2-digit`,day:`2-digit`,hour:`2-digit`,minute:`2-digit`})}function g(e){if(!e.endTime)return``;let t=e.endTime-e.startTime,n=Math.floor(t/1e3),r=Math.floor(n/60);return r>0?`${r}  ${n%60} `:`${n} `}async function _(e){try{console.log(`:`,e);let n=(await i.vueFlowExecution.getHistory(e.workflowId)).find(t=>t.executionId===e.id);if(!n){t?.warning(``);return}let r=``,o=``,s=a.ensureFolderPath(o),c=a.workflows.find(e=>e.name===r&&e.folderId===s);c&&a.deleteWorkflow(c.workflow_id);let l=a.createWorkflow(r,o,`ID: ${e.id}\n: ${new Date(e.startTime).toLocaleString(`zh-CN`)}\n: ${e.workflowName}`);a.setCurrentWorkflow(l.workflow_id);let u={...n,nodeResults:new Map(Object.entries(n.nodeResults||{}))};i.loadExecutionStatus(u,n),t?.success(``)}catch(e){console.error(`:`,e),t?.error(``)}}async function v(e){n?.warning({title:``,content:` "${e.workflowName}" `,positiveText:``,negativeText:``,onPositiveClick:async()=>{try{await i.vueFlowExecution.deleteHistory(e.id);let n=l.value.indexOf(e);n>-1&&l.value.splice(n,1),t?.success(``)}catch(e){console.error(`:`,e),t?.error(``)}}})}function y(){n?.warning({title:``,content:``,positiveText:``,negativeText:``,onPositiveClick:async()=>{try{await i.vueFlowExecution.clearHistory(),l.value=[],t?.success(``)}catch(e){console.error(`:`,e),t?.error(``)}}})}async function b(){u.value=!0;try{l.value=(await i.vueFlowExecution.getHistory()).map(e=>({id:e.executionId,workflowId:e.workflowId,workflowName:a.getWorkflowById(e.workflowId)?.name||e.workflowId,status:e.success?`success`:`failed`,startTime:e.startTime,endTime:e.endTime,totalNodes:e.executedNodeCount+e.skippedNodeCount,successNodes:e.executedNodeCount,failedNodes:0,errorMessage:e.error}))}catch(e){console.error(`:`,e),t?.error(``)}finally{u.value=!1}}return ce(()=>{b(),o.on(`workflow:execution-completed`,e=>{console.log(`[HistoryPanel] `,e),b()}),o.on(`execution:error`,e=>{console.log(`[HistoryPanel] `,e),b()})}),(e,t)=>{let n=K(`n-select`),r=K(`n-icon`),i=K(`n-button`),a=K(`n-space`),o=K(`n-tag`),u=K(`n-timeline-item`),b=K(`n-timeline`),x=K(`n-empty`);return G(),P(`div`,rD,[I(`div`,iD,[O(a,{vertical:``,size:`small`},{default:Y(()=>[O(n,{value:s.value,"onUpdate:value":t[0]||=e=>s.value=e,options:c,size:`small`,placeholder:``},null,8,[`value`]),O(i,{block:``,secondary:``,size:`small`,onClick:y},{icon:Y(()=>[O(r,{component:Qp})]),default:Y(()=>[t[1]||=X(`  `,-1)]),_:1})]),_:1})]),I(`div`,aD,[O(b,null,{default:Y(()=>[(G(!0),P(je,null,Le(d.value,e=>(G(),L(u,{key:e.id,type:f(e.status),class:`group cursor-pointer rounded-lg p-1 -m-1 hover:bg-linear-to-r hover:from-blue-50 hover:to-indigo-50 hover:border-blue-200 border border-transparent mb-2`,onClick:t=>_(e)},{header:Y(()=>[I(`div`,oD,[I(`div`,{class:`min-w-0 flex-1 truncate text-sm font-medium text-slate-900`,title:e.workflowName},J(e.workflowName),9,sD),O(i,{size:`tiny`,circle:``,secondary:``,type:`error`,onClick:se(t=>v(e),[`stop`]),title:``,class:`opacity-0 group-hover:opacity-100`},{icon:Y(()=>[O(r,{component:Qp})]),_:1},8,[`onClick`])])]),default:Y(()=>[I(`div`,cD,[I(`div`,lD,[O(o,{type:p(e.status),size:`small`},{default:Y(()=>[X(J(m(e.status)),1)]),_:2},1032,[`type`]),I(`span`,uD,` : `+J(g(e)),1)]),I(`span`,dD,J(h(e.startTime)),1)])]),_:2},1032,[`type`,`onClick`]))),128))]),_:1}),l.value.length===0?(G(),L(x,{key:0,description:``,class:`mt-8`})):z(``,!0)])])}}}),pD={class:`mb-4`},mD={class:`mb-2.5`},hD={class:`text-sm font-medium text-slate-900`},gD={key:0,class:`mt-0.5 text-xs text-slate-500`},_D=V({__name:`ConfigSection`,props:{title:{},description:{}},setup(e){return(t,n)=>(G(),P(`div`,pD,[I(`div`,mD,[I(`h3`,hD,J(e.title),1),e.description?(G(),P(`p`,gD,J(e.description),1)):z(``,!0)]),I(`div`,null,[We(t.$slots,`default`)])]))}}),vD={},yD={xmlns:`http://www.w3.org/2000/svg`,viewBox:`0 0 24 24`,fill:`none`,stroke:`currentColor`,"stroke-width":`2`,"stroke-linecap":`round`,"stroke-linejoin":`round`,width:`14`,height:`14`};function bD(e,t){return G(),P(`svg`,yD,[...t[0]||=[I(`path`,{d:`M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z`},null,-1)]])}var xD=Z(vD,[[`render`,bD]]),SD={class:`space-y-3`},CD=[`onClick`],wD={class:`flex items-start gap-4`},TD={class:`flex-1`},ED={class:`flex items-center gap-2`},DD={class:`font-semibold text-slate-800`},OD={class:`mt-0.5 text-sm text-slate-600`},kD={class:`mt-2 flex flex-wrap gap-1.5`},AD={key:0,class:`flex h-6 w-6 shrink-0 items-center justify-center rounded-full bg-blue-500`},jD=V({__name:`ExecutionModeSelector`,props:{modelValue:{}},emits:[`update:modelValue`],setup(e){let t=[{value:`worker`,label:`Worker `,description:` Web Worker `,icon:xD,bg:`bg-blue-100`,text:`text-blue-600`,activeBg:`bg-blue-500`,activeText:`text-white`,badge:``,badgeClass:`bg-blue-100 text-blue-700`,tags:[``,``,``]},{value:`server`,label:`Server `,description:``,icon:ap,bg:`bg-green-100`,text:`text-green-600`,activeBg:`bg-green-500`,activeText:`text-white`,badge:``,badgeClass:``,tags:[``,``,``]}];return(n,r)=>(G(),P(`div`,SD,[(G(),P(je,null,Le(t,t=>I(`div`,{key:t.value,class:N([`group cursor-pointer rounded-xl border-2 p-4 transition-all`,e.modelValue===t.value?`border-blue-500 bg-blue-50 shadow-md`:`border-slate-200 bg-white hover:border-slate-300 hover:shadow-sm`]),onClick:e=>n.$emit(`update:modelValue`,t.value)},[I(`div`,wD,[I(`div`,{class:N([`flex h-12 w-12 shrink-0 items-center justify-center rounded-xl transition-all`,e.modelValue===t.value?`${t.activeBg} ${t.activeText}`:`${t.bg} ${t.text} group-hover:${t.activeBg}`])},[(G(),L(be(t.icon),{class:`h-6 w-6`}))],2),I(`div`,TD,[I(`div`,ED,[I(`h4`,DD,J(t.label),1),t.badge?(G(),P(`span`,{key:0,class:N([`rounded px-1.5 py-0.5 text-xs font-medium`,t.badgeClass])},J(t.badge),3)):z(``,!0)]),I(`p`,OD,J(t.description),1),I(`div`,kD,[(G(!0),P(je,null,Le(t.tags,e=>(G(),P(`span`,{key:e,class:`rounded-full bg-slate-100 px-2 py-0.5 text-xs text-slate-600`},J(e),1))),128))])]),e.modelValue===t.value?(G(),P(`div`,AD,[...r[0]||=[I(`svg`,{class:`h-4 w-4 text-white`,fill:`none`,stroke:`currentColor`,viewBox:`0 0 24 24`},[I(`path`,{"stroke-linecap":`round`,"stroke-linejoin":`round`,"stroke-width":`3`,d:`M5 13l4 4L19 7`})],-1)]])):z(``,!0)])],10,CD)),64))]))}}),MD={class:`flex gap-3`},ND=[`onClick`],PD={class:`mb-2 flex items-center justify-between`},FD={class:`font-medium text-slate-800`},ID={key:0,class:`flex h-5 w-5 items-center justify-center rounded-full bg-blue-500`},LD={class:`flex h-16 items-center justify-center rounded bg-slate-50 p-2`},RD={viewBox:`0 0 100 40`,class:`h-full w-full`},zD=[`d`,`stroke`],BD={class:`mt-2 text-xs text-slate-500`},VD=V({__name:`EdgeTypeSelector`,props:{modelValue:{}},emits:[`update:modelValue`],setup(e){let t=[{value:`default`,label:``,description:``,path:`M 13 20 C 40 5, 60 35, 87 20`},{value:`straight`,label:``,description:``,path:`M 13 20 L 87 20`},{value:`step`,label:``,description:``,path:`M 13 20 L 40 20 L 40 12 L 60 12 L 60 20 L 87 20`}];return(n,r)=>(G(),P(`div`,MD,[(G(),P(je,null,Le(t,t=>I(`div`,{key:t.value,class:N([`group flex-1 cursor-pointer rounded-lg border-2 p-3 transition-all`,e.modelValue===t.value?`border-blue-500 bg-blue-50 shadow-sm`:`border-slate-200 bg-white hover:border-slate-300`]),onClick:e=>n.$emit(`update:modelValue`,t.value)},[I(`div`,PD,[I(`span`,FD,J(t.label),1),e.modelValue===t.value?(G(),P(`div`,ID,[...r[0]||=[I(`svg`,{class:`h-3 w-3 text-white`,fill:`none`,stroke:`currentColor`,viewBox:`0 0 24 24`},[I(`path`,{"stroke-linecap":`round`,"stroke-linejoin":`round`,"stroke-width":`3`,d:`M5 13l4 4L19 7`})],-1)]])):z(``,!0)]),I(`div`,LD,[(G(),P(`svg`,RD,[r[1]||=I(`circle`,{cx:`10`,cy:`20`,r:`3`,fill:`#64748b`},null,-1),r[2]||=I(`circle`,{cx:`90`,cy:`20`,r:`3`,fill:`#64748b`},null,-1),I(`path`,{d:t.path,fill:`none`,stroke:e.modelValue===t.value?`#3b82f6`:`#94a3b8`,"stroke-width":`2`,"stroke-linecap":`round`},null,8,zD)]))]),I(`p`,BD,J(t.description),1)],10,ND)),64))]))}}),HD={class:`flex gap-3`},UD=[`onClick`],WD={class:`mb-2 flex items-center justify-between`},GD={class:`text-sm font-medium text-slate-800`},KD={key:0,class:`flex h-4 w-4 items-center justify-center rounded-full bg-blue-500`},qD={class:`flex h-20 items-center justify-center rounded bg-slate-50`},JD={viewBox:`0 0 60 60`,class:`h-full w-full`},YD=[`id`],XD=[`fill`],ZD=V({__name:`GridTypeSelector`,props:{modelValue:{}},emits:[`update:modelValue`],setup(e){let t=[{value:`dots`,label:``,pattern:()=>H(`circle`,{cx:5,cy:5,r:1,fill:`#94a3b8`})},{value:`lines`,label:``,pattern:()=>[H(`path`,{d:`M 10 0 L 0 0 0 10`,fill:`none`,stroke:`#94a3b8`,"stroke-width":.5})]}];return(n,r)=>(G(),P(`div`,HD,[(G(),P(je,null,Le(t,t=>I(`div`,{key:t.value,class:N([`group flex-1 cursor-pointer rounded-lg border-2 p-3 transition-all`,e.modelValue===t.value?`border-blue-500 bg-blue-50`:`border-slate-200 bg-white hover:border-slate-300`]),onClick:e=>n.$emit(`update:modelValue`,t.value)},[I(`div`,WD,[I(`span`,GD,J(t.label),1),e.modelValue===t.value?(G(),P(`div`,KD,[...r[0]||=[I(`svg`,{class:`h-2.5 w-2.5 text-white`,fill:`none`,stroke:`currentColor`,viewBox:`0 0 24 24`},[I(`path`,{"stroke-linecap":`round`,"stroke-linejoin":`round`,"stroke-width":`3`,d:`M5 13l4 4L19 7`})],-1)]])):z(``,!0)]),I(`div`,qD,[(G(),P(`svg`,JD,[I(`defs`,null,[I(`pattern`,{id:`grid-${t.value}`,width:`10`,height:`10`,patternUnits:`userSpaceOnUse`},[(G(),L(be(t.pattern)))],8,YD)]),I(`rect`,{width:`60`,height:`60`,fill:`url(#grid-${t.value})`},null,8,XD)]))])],10,UD)),64))]))}}),QD={class:`mb-2 block text-sm font-medium text-slate-700`},$D={class:`flex items-center gap-1`},eO=V({__name:`ColorPicker`,props:{modelValue:{},label:{}},emits:[`update:modelValue`],setup(e,{emit:t}){let n=e,r=t,i=U(!1),a=U(n.modelValue),o=U();W(()=>n.modelValue,e=>{a.value=e});let s=e=>{r(`update:modelValue`,e)},c=()=>{o.value&&(i.value=!0)};return(t,n)=>{let r=K(`n-color-picker`);return G(),P(`div`,null,[I(`label`,QD,J(e.label),1),I(`div`,$D,[I(`div`,{class:`h-7 w-7 shrink-0 rounded-md shadow-sm border border-slate-200`,style:R({backgroundColor:a.value}),onClick:c},null,4),O(r,{ref_key:`colorPickerRef`,ref:o,show:i.value,"onUpdate:show":n[0]||=e=>i.value=e,value:a.value,"onUpdate:value":[n[1]||=e=>a.value=e,s],"show-preview":!0},null,8,[`show`,`value`])])])}}}),tO={},nO={xmlns:`http://www.w3.org/2000/svg`,viewBox:`0 0 24 24`,fill:`none`,stroke:`currentColor`,"stroke-width":`2`,"stroke-linecap":`round`,"stroke-linejoin":`round`};function rO(e,t){return G(),P(`svg`,nO,[...t[0]||=[I(`polyline`,{points:`20 6 9 17 4 12`},null,-1)]])}var iO=Z(tO,[[`render`,rO]]),aO={},oO={class:`h-4 w-4`,fill:`none`,stroke:`currentColor`,viewBox:`0 0 24 24`,xmlns:`http://www.w3.org/2000/svg`};function sO(e,t){return G(),P(`svg`,oO,[...t[0]||=[I(`path`,{"stroke-linecap":`round`,"stroke-linejoin":`round`,"stroke-width":`2`,d:`M21 12a9 9 0 01-9 9m9-9a9 9 0 00-9-9m9 9H3m9 9a9 9 0 01-9-9m9 9c1.657 0 3-4.03 3-9s-1.343-9-3-9m0 18c-1.657 0-3-4.03-3-9s1.343-9 3-9m-9 9a9 9 0 019-9`},null,-1)]])}var cO=Z(aO,[[`render`,sO]]),lO={},uO={class:`h-4 w-4`,fill:`none`,stroke:`currentColor`,viewBox:`0 0 24 24`,xmlns:`http://www.w3.org/2000/svg`};function dO(e,t){return G(),P(`svg`,uO,[...t[0]||=[I(`path`,{"stroke-linecap":`round`,"stroke-linejoin":`round`,"stroke-width":`2`,d:`M13 10V3L4 14h7v7l9-11h-7z`},null,-1)]])}var fO=Z(lO,[[`render`,dO]]),pO={},mO={class:`h-4 w-4`,fill:`none`,stroke:`currentColor`,viewBox:`0 0 24 24`,xmlns:`http://www.w3.org/2000/svg`};function hO(e,t){return G(),P(`svg`,mO,[...t[0]||=[I(`path`,{"stroke-linecap":`round`,"stroke-linejoin":`round`,"stroke-width":`2`,d:`M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z`},null,-1)]])}var gO=Z(pO,[[`render`,hO]]),_O={class:`h-full flex flex-col bg-white`},vO={class:`shrink-0 border-b border-slate-200 bg-white px-4 pt-4`},yO={class:`flex items-center gap-2`},bO={class:`flex items-center gap-2`},xO={class:`flex items-center gap-2`},SO={class:`flex-1 overflow-y-auto p-4`},CO={class:`flex items-center justify-between rounded-lg bg-slate-50 p-3`},wO={class:`space-y-2`},TO={class:`flex items-center justify-between`},EO={class:`flex items-center gap-2`},DO={class:`flex items-center justify-between rounded-lg bg-slate-50 p-3`},OO={class:`space-y-3`},kO={class:`flex flex-wrap items-center gap-2`},AO={class:`space-y-2`},jO={class:`flex items-center justify-between`},MO={class:`flex items-center gap-2`},NO={class:`space-y-2`},PO={class:`flex items-center justify-between`},FO={class:`flex items-center gap-2`},IO={class:`grid grid-cols-2 gap-4`},LO={class:`flex items-center justify-between rounded-lg bg-slate-50 p-3`},RO={class:`flex items-center justify-between rounded-lg bg-slate-50 p-3`},zO={class:`space-y-4`},BO={class:`space-y-2`},VO={class:`flex items-center justify-between`},HO={class:`flex items-center gap-2`},UO={class:`space-y-2`},WO={class:`flex items-center justify-between`},GO={class:`flex items-center gap-2`},KO={class:`space-y-2`},qO={class:`flex items-center justify-between`},JO={class:`flex items-center gap-2`},YO={class:`flex items-center justify-between rounded-lg bg-slate-50 p-3`},XO={class:`space-y-4`},ZO={class:`hidden`},QO={class:`space-y-2`},$O={class:`flex items-center justify-between`},ek={class:`flex items-center gap-2`},tk={class:`space-y-2`},nk={class:`flex items-center justify-between`},rk={class:`flex items-center gap-2`},ik={class:`space-y-2`},ak={class:`flex items-center justify-between`},ok={class:`flex items-center gap-2`},sk={class:`flex items-center justify-between rounded-lg bg-slate-50 p-3`},ck={key:0,class:`space-y-2`},lk={class:`flex items-center justify-between`},uk={class:`flex items-center gap-2`},dk={key:1,class:`space-y-2`},fk={class:`flex items-center justify-between`},pk={class:`flex items-center gap-2`},mk={class:`space-y-4`},hk={class:`flex items-center justify-between rounded-lg bg-slate-50 p-3`},gk={class:`flex items-center justify-between rounded-lg bg-slate-50 p-3`},_k={key:0,class:`space-y-4`},vk={class:`space-y-2`},yk={class:`flex items-center justify-between`},bk={class:`flex items-center gap-2`},xk={class:`space-y-2`},Sk={class:`flex items-center justify-between`},Ck={class:`flex items-center gap-2`},wk={class:`grid grid-cols-2 gap-4`},Tk={class:`shrink-0 border-t border-slate-200 bg-slate-50 px-4 py-3`},Ek={class:`flex items-center justify-between`},Dk={class:`flex items-center gap-2 text-xs text-slate-500`},Ok=V({__name:`SettingsPanel`,setup(e){let t=Ge(),n=w(),{config:i}=Ze(n),a=r(),o=U(`general`),s=U(!1),c=U(null),l=U(``);W(()=>i.value.executionMode+i.value.serverUrl,async(e,t)=>{e&&e!==t&&(a.vueFlowExecution.cleanupChannel(),a.loadNodeList(),console.log(``))});async function u(){if(!i.value.serverUrl)return;s.value=!0,c.value=null,l.value=``;let e=i.value.serverUrl;e.startsWith(`http://`)?e=e.replace(`http://`,`ws://`):e.startsWith(`https://`)?e=e.replace(`https://`,`wss://`):!e.startsWith(`ws://`)&&!e.startsWith(`wss://`)&&(e=`ws://`+e);let n=null,r=null;try{n=new WebSocket(e),r=window.setTimeout(()=>{n&&n.readyState!==WebSocket.OPEN&&(n.close(),c.value=`error`,l.value=``,t?.error(``))},5e3),n.onopen=()=>{r&&clearTimeout(r),c.value=`success`,t?.success(``),s.value=!1,setTimeout(()=>{n&&n.readyState===WebSocket.OPEN&&n.close()},2e3)},n.onerror=()=>{r&&clearTimeout(r),c.value=`error`,l.value=``,t?.error(``),s.value=!1},n.onclose=()=>{r&&clearTimeout(r),s.value=!1}}catch(e){r&&clearTimeout(r),c.value=`error`,l.value=``,t?.error(`: `+(e instanceof Error?e.message:String(e))),s.value=!1}}function d(){n.resetConfig(),t?.success(``)}return(e,t)=>{let n=K(`n-tab-pane`),r=K(`n-tabs`),a=K(`n-switch`),f=K(`n-input-number`),p=K(`n-slider`),m=K(`n-input`),h=K(`n-button`),g=K(`n-radio-button`),_=K(`n-radio-group`);return G(),P(`div`,_O,[I(`div`,vO,[O(r,{value:o.value,"onUpdate:value":t[0]||=e=>o.value=e,type:`segment`,animated:``},{default:Y(()=>[O(n,{name:`general`,tab:``},{tab:Y(()=>[I(`div`,yO,[O(lp,{class:`h-4 w-4`}),t[44]||=I(`span`,null,``,-1)])]),_:1}),O(n,{name:`execution`,tab:``},{tab:Y(()=>[I(`div`,bO,[O(Jp,{class:`h-4 w-4`}),t[45]||=I(`span`,null,``,-1)])]),_:1}),O(n,{name:`canvas`,tab:``},{tab:Y(()=>[I(`div`,xO,[O(HS,{class:`h-4 w-4`}),t[46]||=I(`span`,null,``,-1)])]),_:1})]),_:1},8,[`value`])]),I(`div`,SO,[Ce(I(`div`,null,[O(_D,{title:``,description:``},{default:Y(()=>[I(`div`,CO,[t[47]||=I(`span`,{class:`text-sm font-medium text-slate-700`},``,-1),O(a,{value:B(i).autoSave,"onUpdate:value":t[1]||=e=>B(i).autoSave=e},null,8,[`value`])])]),_:1}),O(_D,{title:``,description:``},{default:Y(()=>[I(`div`,wO,[I(`div`,TO,[t[49]||=I(`label`,{class:`text-sm font-medium text-slate-700`},``,-1),I(`div`,EO,[O(f,{value:B(i).gridSize,"onUpdate:value":t[2]||=e=>B(i).gridSize=e,min:10,max:50,step:5,class:`w-24`},null,8,[`value`]),t[48]||=I(`span`,{class:`text-xs text-slate-500`},`px`,-1)])]),O(p,{value:B(i).gridSize,"onUpdate:value":t[3]||=e=>B(i).gridSize=e,min:10,max:50,step:5},null,8,[`value`])])]),_:1}),O(_D,{title:``,description:``},{default:Y(()=>[I(`div`,DO,[t[50]||=I(`span`,{class:`text-sm font-medium text-slate-700`},``,-1),O(a,{value:B(i).snapToGrid,"onUpdate:value":t[4]||=e=>B(i).snapToGrid=e},null,8,[`value`])])]),_:1})],512),[[ee,o.value===`general`]]),Ce(I(`div`,null,[O(_D,{title:``,description:``},{default:Y(()=>[O(jD,{modelValue:B(i).executionMode,"onUpdate:modelValue":t[5]||=e=>B(i).executionMode=e},null,8,[`modelValue`])]),_:1}),B(i).executionMode===`server`?(G(),L(_D,{key:0,title:``,description:` API `},{default:Y(()=>[I(`div`,OO,[O(m,{value:B(i).serverUrl,"onUpdate:value":t[6]||=e=>B(i).serverUrl=e,placeholder:`http://localhost:3001`},{prefix:Y(()=>[O(cO,{class:`text-slate-400`})]),_:1},8,[`value`]),I(`div`,kO,[O(h,{loading:s.value,disabled:!B(i).serverUrl,onClick:u},{icon:Y(()=>[O(fO)]),default:Y(()=>[t[51]||=X(`  `,-1)]),_:1},8,[`loading`,`disabled`]),c.value===null?z(``,!0):(G(),P(`div`,{key:0,class:N([`flex items-center gap-1.5 rounded-lg px-3 py-1.5 text-sm whitespace-nowrap`,c.value===`success`?`bg-green-50 text-green-700`:`bg-red-50 text-red-700`])},[c.value===`success`?(G(),L(Dp,{key:0,class:`w-4 h-4`})):(G(),L(gO,{key:1,class:`w-4 h-4`})),I(`span`,null,J(c.value===`success`?``:l.value),1)],2))])])]),_:1})):z(``,!0),O(_D,{title:``,description:``},{default:Y(()=>[I(`div`,AO,[I(`div`,jO,[t[53]||=I(`label`,{class:`text-sm font-medium text-slate-700`},``,-1),I(`div`,MO,[O(f,{value:B(i).maxConcurrent,"onUpdate:value":t[7]||=e=>B(i).maxConcurrent=e,min:1,max:10,step:1,class:`w-24`},null,8,[`value`]),t[52]||=I(`span`,{class:`text-xs text-slate-500`},``,-1)])]),O(p,{value:B(i).maxConcurrent,"onUpdate:value":t[8]||=e=>B(i).maxConcurrent=e,min:1,max:10,step:1},null,8,[`value`])])]),_:1})],512),[[ee,o.value===`execution`]]),Ce(I(`div`,null,[O(_D,{title:``,description:``},{default:Y(()=>[O(VD,{modelValue:B(i).edgeType,"onUpdate:modelValue":t[9]||=e=>B(i).edgeType=e},null,8,[`modelValue`])]),_:1}),O(_D,{title:``,description:``},{default:Y(()=>[I(`div`,NO,[I(`div`,PO,[t[55]||=I(`label`,{class:`text-sm font-medium text-slate-700`},``,-1),I(`div`,FO,[O(f,{value:B(i).edgeWidth,"onUpdate:value":t[10]||=e=>B(i).edgeWidth=e,min:1,max:5,step:.5,class:`w-24`},null,8,[`value`]),t[54]||=I(`span`,{class:`text-xs text-slate-500`},`px`,-1)])]),O(p,{value:B(i).edgeWidth,"onUpdate:value":t[11]||=e=>B(i).edgeWidth=e,min:1,max:5,step:.5},null,8,[`value`])])]),_:1}),O(_D,{title:``,description:``},{default:Y(()=>[I(`div`,IO,[O(eO,{modelValue:B(i).edgeColor,"onUpdate:modelValue":t[12]||=e=>B(i).edgeColor=e,label:``},null,8,[`modelValue`]),O(eO,{modelValue:B(i).edgeActiveColor,"onUpdate:modelValue":t[13]||=e=>B(i).edgeActiveColor=e,label:``},null,8,[`modelValue`])])]),_:1}),O(_D,{title:``,description:``},{default:Y(()=>[I(`div`,LO,[t[56]||=I(`span`,{class:`text-sm font-medium text-slate-700`},``,-1),O(a,{value:B(i).edgeAnimation,"onUpdate:value":t[14]||=e=>B(i).edgeAnimation=e},null,8,[`value`])])]),_:1}),O(_D,{title:``,description:``},{default:Y(()=>[I(`div`,RO,[t[57]||=I(`span`,{class:`text-sm font-medium text-slate-700`},``,-1),O(a,{value:B(i).edgeShowArrow,"onUpdate:value":t[15]||=e=>B(i).edgeShowArrow=e},null,8,[`value`])])]),_:1}),O(_D,{title:``,description:``},{default:Y(()=>[I(`div`,zO,[I(`div`,BO,[I(`div`,VO,[t[59]||=I(`label`,{class:`text-sm font-medium text-slate-700`},``,-1),I(`div`,HO,[O(f,{value:B(i).defaultZoom,"onUpdate:value":t[16]||=e=>B(i).defaultZoom=e,min:.1,max:4,step:.1,class:`w-24`},null,8,[`value`]),t[58]||=I(`span`,{class:`text-xs text-slate-500`},`x`,-1)])]),O(p,{value:B(i).defaultZoom,"onUpdate:value":t[17]||=e=>B(i).defaultZoom=e,min:.1,max:4,step:.1},null,8,[`value`]),t[60]||=I(`p`,{class:`text-xs text-slate-500`},``,-1)]),I(`div`,UO,[I(`div`,WO,[t[62]||=I(`label`,{class:`text-sm font-medium text-slate-700`},``,-1),I(`div`,GO,[O(f,{value:B(i).minZoom,"onUpdate:value":t[18]||=e=>B(i).minZoom=e,min:.1,max:1,step:.1,class:`w-24`},null,8,[`value`]),t[61]||=I(`span`,{class:`text-xs text-slate-500`},`x`,-1)])]),O(p,{value:B(i).minZoom,"onUpdate:value":t[19]||=e=>B(i).minZoom=e,min:.1,max:1,step:.1},null,8,[`value`])]),I(`div`,KO,[I(`div`,qO,[t[64]||=I(`label`,{class:`text-sm font-medium text-slate-700`},``,-1),I(`div`,JO,[O(f,{value:B(i).maxZoom,"onUpdate:value":t[20]||=e=>B(i).maxZoom=e,min:2,max:8,step:.5,class:`w-24`},null,8,[`value`]),t[63]||=I(`span`,{class:`text-xs text-slate-500`},`x`,-1)])]),O(p,{value:B(i).maxZoom,"onUpdate:value":t[21]||=e=>B(i).maxZoom=e,min:2,max:8,step:.5},null,8,[`value`])])])]),_:1}),O(_D,{title:``,description:``},{default:Y(()=>[I(`div`,YO,[t[65]||=I(`span`,{class:`text-sm font-medium text-slate-700`},``,-1),O(a,{value:B(i).showMiniMap,"onUpdate:value":t[22]||=e=>B(i).showMiniMap=e},null,8,[`value`])])]),_:1}),O(_D,{title:``,description:``},{default:Y(()=>[I(`div`,XO,[I(`div`,ZO,[t[70]||=I(`label`,{class:`mb-2 block text-sm font-medium text-slate-700`},``,-1),O(_,{value:B(i).autoLayoutDirection,"onUpdate:value":t[23]||=e=>B(i).autoLayoutDirection=e},{default:Y(()=>[O(g,{value:`LR`},{default:Y(()=>[...t[66]||=[I(`div`,{class:`flex items-center gap-1`},[I(`span`,null,``),I(`span`,{class:`text-xs`},``)],-1)]]),_:1}),O(g,{value:`RL`},{default:Y(()=>[...t[67]||=[I(`div`,{class:`flex items-center gap-1`},[I(`span`,null,``),I(`span`,{class:`text-xs`},``)],-1)]]),_:1}),O(g,{value:`TB`},{default:Y(()=>[...t[68]||=[I(`div`,{class:`flex items-center gap-1`},[I(`span`,null,``),I(`span`,{class:`text-xs`},``)],-1)]]),_:1}),O(g,{value:`BT`},{default:Y(()=>[...t[69]||=[I(`div`,{class:`flex items-center gap-1`},[I(`span`,null,``),I(`span`,{class:`text-xs`},``)],-1)]]),_:1})]),_:1},8,[`value`])]),I(`div`,QO,[I(`div`,$O,[t[72]||=I(`label`,{class:`text-sm font-medium text-slate-700`},``,-1),I(`div`,ek,[O(f,{value:B(i).autoLayoutNodeSpacing,"onUpdate:value":t[24]||=e=>B(i).autoLayoutNodeSpacing=e,min:20,max:400,step:10,class:`w-24`},null,8,[`value`]),t[71]||=I(`span`,{class:`text-xs text-slate-500`},`px`,-1)])]),O(p,{value:B(i).autoLayoutNodeSpacing,"onUpdate:value":t[25]||=e=>B(i).autoLayoutNodeSpacing=e,min:20,max:400,step:10},null,8,[`value`]),t[73]||=I(`p`,{class:`text-xs text-slate-500`},`  `,-1)]),I(`div`,tk,[I(`div`,nk,[t[75]||=I(`label`,{class:`text-sm font-medium text-slate-700`},``,-1),I(`div`,rk,[O(f,{value:B(i).autoLayoutRankSpacing,"onUpdate:value":t[26]||=e=>B(i).autoLayoutRankSpacing=e,min:20,max:600,step:10,class:`w-24`},null,8,[`value`]),t[74]||=I(`span`,{class:`text-xs text-slate-500`},`px`,-1)])]),O(p,{value:B(i).autoLayoutRankSpacing,"onUpdate:value":t[27]||=e=>B(i).autoLayoutRankSpacing=e,min:20,max:600,step:10},null,8,[`value`]),t[76]||=I(`p`,{class:`text-xs text-slate-500`},`  `,-1)]),I(`div`,ik,[I(`div`,ak,[t[78]||=I(`label`,{class:`text-sm font-medium text-slate-700`},``,-1),I(`div`,ok,[O(f,{value:B(i).autoLayoutPadding,"onUpdate:value":t[28]||=e=>B(i).autoLayoutPadding=e,min:0,max:300,step:10,class:`w-24`},null,8,[`value`]),t[77]||=I(`span`,{class:`text-xs text-slate-500`},`px`,-1)])]),O(p,{value:B(i).autoLayoutPadding,"onUpdate:value":t[29]||=e=>B(i).autoLayoutPadding=e,min:0,max:300,step:10},null,8,[`value`]),t[79]||=I(`p`,{class:`text-xs text-slate-500`},``,-1)]),I(`div`,sk,[t[80]||=I(`div`,{class:`flex flex-col`},[I(`span`,{class:`text-sm font-medium text-slate-700`},``),I(`span`,{class:`text-xs text-slate-500`},``)],-1),O(a,{value:B(i).autoLayoutFitView,"onUpdate:value":t[30]||=e=>B(i).autoLayoutFitView=e},null,8,[`value`])]),B(i).autoLayoutFitView?(G(),P(`div`,ck,[I(`div`,lk,[t[81]||=I(`label`,{class:`text-sm font-medium text-slate-700`},``,-1),I(`div`,uk,[O(f,{value:B(i).autoLayoutFitViewPadding,"onUpdate:value":t[31]||=e=>B(i).autoLayoutFitViewPadding=e,min:0,max:1,step:.05,class:`w-24`},null,8,[`value`])])]),O(p,{value:B(i).autoLayoutFitViewPadding,"onUpdate:value":t[32]||=e=>B(i).autoLayoutFitViewPadding=e,min:0,max:1,step:.05},null,8,[`value`]),t[82]||=I(`p`,{class:`text-xs text-slate-500`},` 0-1 `,-1)])):z(``,!0),B(i).autoLayoutFitView?(G(),P(`div`,dk,[I(`div`,fk,[t[84]||=I(`label`,{class:`text-sm font-medium text-slate-700`},``,-1),I(`div`,pk,[O(f,{value:B(i).autoLayoutFitViewDuration,"onUpdate:value":t[33]||=e=>B(i).autoLayoutFitViewDuration=e,min:0,max:1e3,step:50,class:`w-24`},null,8,[`value`]),t[83]||=I(`span`,{class:`text-xs text-slate-500`},`ms`,-1)])]),O(p,{value:B(i).autoLayoutFitViewDuration,"onUpdate:value":t[34]||=e=>B(i).autoLayoutFitViewDuration=e,min:0,max:1e3,step:50},null,8,[`value`]),t[85]||=I(`p`,{class:`text-xs text-slate-500`},``,-1)])):z(``,!0)])]),_:1}),O(_D,{title:``,description:``},{default:Y(()=>[I(`div`,mk,[I(`div`,hk,[t[86]||=I(`span`,{class:`text-sm font-medium text-slate-700`},``,-1),O(a,{value:B(i).showGrid,"onUpdate:value":t[35]||=e=>B(i).showGrid=e},null,8,[`value`])]),I(`div`,gk,[t[87]||=I(`div`,{class:`flex flex-col`},[I(`span`,{class:`text-sm font-medium text-slate-700`},``),I(`span`,{class:`text-xs text-slate-500`},``)],-1),O(a,{value:B(i).snapToGrid,"onUpdate:value":t[36]||=e=>B(i).snapToGrid=e},null,8,[`value`])]),B(i).showGrid?(G(),P(`div`,_k,[I(`div`,null,[t[88]||=I(`label`,{class:`mb-2 block text-sm font-medium text-slate-700`},``,-1),O(ZD,{modelValue:B(i).gridType,"onUpdate:modelValue":t[37]||=e=>B(i).gridType=e},null,8,[`modelValue`])]),I(`div`,vk,[I(`div`,yk,[t[90]||=I(`label`,{class:`text-sm font-medium text-slate-700`},``,-1),I(`div`,bk,[O(f,{value:B(i).gridGap,"onUpdate:value":t[38]||=e=>B(i).gridGap=e,min:10,max:50,step:5,class:`w-24`},null,8,[`value`]),t[89]||=I(`span`,{class:`text-xs text-slate-500`},`px`,-1)])]),O(p,{value:B(i).gridGap,"onUpdate:value":t[39]||=e=>B(i).gridGap=e,min:10,max:50,step:5},null,8,[`value`])]),I(`div`,xk,[I(`div`,Sk,[t[92]||=I(`label`,{class:`text-sm font-medium text-slate-700`},``,-1),I(`div`,Ck,[O(f,{value:B(i).gridSize,"onUpdate:value":t[40]||=e=>B(i).gridSize=e,min:10,max:50,step:5,class:`w-24`},null,8,[`value`]),t[91]||=I(`span`,{class:`text-xs text-slate-500`},`px`,-1)])]),O(p,{value:B(i).gridSize,"onUpdate:value":t[41]||=e=>B(i).gridSize=e,min:10,max:50,step:5},null,8,[`value`]),t[93]||=I(`p`,{class:`text-xs text-slate-500`},``,-1)]),I(`div`,wk,[O(eO,{modelValue:B(i).bgColor,"onUpdate:modelValue":t[42]||=e=>B(i).bgColor=e,label:``},null,8,[`modelValue`]),O(eO,{modelValue:B(i).gridColor,"onUpdate:modelValue":t[43]||=e=>B(i).gridColor=e,label:``},null,8,[`modelValue`])])])):z(``,!0)])]),_:1})],512),[[ee,o.value===`canvas`]])]),I(`div`,Tk,[I(`div`,Ek,[I(`div`,Dk,[O(iO,{class:`h-3.5 w-3.5 text-green-500`}),t[94]||=I(`span`,null,``,-1)]),O(h,{onClick:d},{icon:Y(()=>[O(it,{class:`h-4 w-4`})]),default:Y(()=>[t[95]||=X(`  `,-1)]),_:1})])])])}}}),kk={key:1,class:`flex h-full items-center justify-center text-slate-400`},Ak=Z(V({__name:`FloatingPanel`,setup(e){let t=b(),n={workflows:uC,"node-library":OC,"node-config":BT,"node-result-preview":DE,variables:nD,"execution-history":fD,"test-menu":ZS,settings:Ok},r={workflows:``,"node-library":``,"node-config":``,"node-result-preview":``,variables:``,"execution-history":``,"test-menu":``,settings:``},i=q(()=>t.activeTab&&n[t.activeTab]||null),a=q(()=>t.activeTab&&r[t.activeTab]||``);return(e,n)=>(G(),L(ue,{name:`slide-fade`},{default:Y(()=>[B(t).floatingPanelVisible?(G(),P(`div`,{key:0,class:`pointer-events-auto absolute bottom-0 left-0 top-0 z-20`,style:R({width:`${B(t).panelWidth}px`})},[O(B(f),{title:a.value,size:`full`,padding:`none`,closable:!0,"header-sticky":!0,class:`h-full rounded-none!`,onClose:B(t).closeFloatingPanel},{default:Y(()=>[B(t).activeTab?(G(),L(be(i.value),{key:0})):(G(),P(`div`,kk,[...n[0]||=[I(`div`,{class:`text-center`},[I(`p`,{class:`text-sm`},``)],-1)]]))]),_:1},8,[`title`,`onClose`])],4)):z(``,!0)]),_:1}))}}),[[`__scopeId`,`data-v-48d995df`]]),jk={class:`px-4 py-2 text-xs font-medium text-slate-600`},Mk=V({__name:`NodeInfoCard`,setup(e){let t=r();return(e,n)=>(G(),P(`div`,jk,`  `+J(B(t).nodeCount)+` `+J(B(t).edgeCount)+` `+J(B(t).isExecuting?``:``)+`FPS `+J(B(t).fps),1))}}),Nk={},Pk={xmlns:`http://www.w3.org/2000/svg`,viewBox:`0 0 24 24`,fill:`none`,stroke:`currentColor`,"stroke-width":`2`,"stroke-linecap":`round`,"stroke-linejoin":`round`};function Fk(e,t){return G(),P(`svg`,Pk,[...t[0]||=[I(`circle`,{cx:`12`,cy:`12`,r:`10`},null,-1),I(`line`,{x1:`12`,y1:`16`,x2:`12`,y2:`12`},null,-1),I(`line`,{x1:`12`,y1:`8`,x2:`12.01`,y2:`8`},null,-1)]])}var Ik=Z(Nk,[[`render`,Fk]]),Lk={},Rk={xmlns:`http://www.w3.org/2000/svg`,viewBox:`0 0 24 24`,fill:`none`,stroke:`currentColor`,"stroke-width":`2`,"stroke-linecap":`round`,"stroke-linejoin":`round`};function zk(e,t){return G(),P(`svg`,Rk,[...t[0]||=[I(`path`,{d:`M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z`},null,-1),I(`line`,{x1:`12`,y1:`9`,x2:`12`,y2:`13`},null,-1),I(`line`,{x1:`12`,y1:`17`,x2:`12.01`,y2:`17`},null,-1)]])}var Bk=Z(Lk,[[`render`,zk]]),Vk={},Hk={xmlns:`http://www.w3.org/2000/svg`,viewBox:`0 0 24 24`,fill:`none`,stroke:`currentColor`,"stroke-width":`2`,"stroke-linecap":`round`,"stroke-linejoin":`round`};function Uk(e,t){return G(),P(`svg`,Hk,[...t[0]||=[I(`circle`,{cx:`12`,cy:`12`,r:`10`},null,-1),I(`line`,{x1:`15`,y1:`9`,x2:`9`,y2:`15`},null,-1),I(`line`,{x1:`9`,y1:`9`,x2:`15`,y2:`15`},null,-1)]])}var Wk=Z(Vk,[[`render`,Uk]]),Gk={class:`mb-4 flex justify-center`},Kk={class:`mb-6 whitespace-pre-wrap text-center text-slate-600`},qk={class:`flex justify-center`},Jk=V({__name:`InfoModal`,setup(e){let t=b(),{infoModalVisible:n}=Ze(t),r=q(()=>({info:Ik,success:iO,warning:Bk,error:Wk})[t.infoModalContent.type]||Ik),i=q(()=>({info:`bg-blue-100`,success:`bg-green-100`,warning:`bg-yellow-100`,error:`bg-red-100`})[t.infoModalContent.type]||`bg-blue-100`),a=q(()=>({info:`text-blue-600`,success:`text-green-600`,warning:`text-yellow-600`,error:`text-red-600`})[t.infoModalContent.type]||`text-blue-600`);return(e,s)=>{let c=K(`n-button`);return G(),L(o,{modelValue:B(n),"onUpdate:modelValue":s[0]||=e=>ke(n)?n.value=e:null,title:B(t).infoModalContent.title,width:`md`,onClose:B(t).closeInfoModal},{footer:Y(()=>[I(`div`,qk,[O(c,{type:`primary`,onClick:B(t).closeInfoModal},{default:Y(()=>[...s[1]||=[X(`  `,-1)]]),_:1},8,[`onClick`])])]),default:Y(()=>[I(`div`,Gk,[I(`div`,{class:N([`flex h-16 w-16 items-center justify-center rounded-full`,i.value])},[(G(),L(be(r.value),{class:N([`h-8 w-8`,a.value])},null,8,[`class`]))],2)]),I(`div`,Kk,J(B(t).infoModalContent.content),1)]),_:1},8,[`modelValue`,`title`,`onClose`])}}}),Yk={class:`mb-4 flex items-center justify-between border-b border-slate-200 pb-3`},Xk={class:`flex items-center gap-2`},Zk={class:`flex items-center gap-2`},Qk={class:`h-[calc(100vh-220px)] overflow-hidden rounded border border-slate-200`},$k=[`placeholder`],eA={class:`flex justify-end gap-2`},tA=V({__name:`FullscreenEditorModal`,setup(e){let t=b(),{editorModalVisible:n}=Ze(t),r=Ge(),i=U(``),a=U(`javascript`),s=[{label:`JavaScript`,value:`javascript`},{label:`TypeScript`,value:`typescript`},{label:`JSON`,value:`json`},{label:`HTML`,value:`html`},{label:`CSS`,value:`css`},{label:`Python`,value:`python`},{label:`YAML`,value:`yaml`},{label:`Markdown`,value:`markdown`}],c={javascript:`JavaScript`,typescript:`TypeScript`,json:`JSON`,html:`HTML`,css:`CSS`,python:`Python`,yaml:`YAML`,markdown:`Markdown`};W(()=>t.editorModalVisible,e=>{e&&(i.value=t.editorModalContent.content,a.value=t.editorModalContent.language||`javascript`)});function l(){try{a.value===`json`?(i.value=JSON.stringify(JSON.parse(i.value),null,2),r?.success(``)):r?.warning(``)}catch{r?.error(``)}}function u(){navigator.clipboard.writeText(i.value).then(()=>{r?.success(``)})}function d(){console.log(``,i.value),r?.success(``),t.closeEditorModal()}function f(){t.closeEditorModal()}return(e,r)=>{let p=K(`n-select`),m=K(`n-button`);return G(),L(o,{modelValue:B(n),"onUpdate:modelValue":r[2]||=e=>ke(n)?n.value=e:null,title:B(t).editorModalContent.title,width:`full`,onClose:f},{footer:Y(()=>[I(`div`,eA,[O(m,{onClick:f},{default:Y(()=>[...r[6]||=[X(``,-1)]]),_:1}),O(m,{type:`primary`,onClick:d},{default:Y(()=>[...r[7]||=[X(``,-1)]]),_:1})])]),default:Y(()=>[I(`div`,Yk,[I(`div`,Xk,[O(p,{value:a.value,"onUpdate:value":r[0]||=e=>a.value=e,options:s,size:`small`,class:`w-32`},null,8,[`value`]),O(m,{size:`small`,secondary:``,onClick:l},{default:Y(()=>[...r[3]||=[X(`  `,-1)]]),_:1})]),I(`div`,Zk,[O(m,{size:`small`,secondary:``,onClick:u},{default:Y(()=>[...r[4]||=[X(``,-1)]]),_:1}),O(m,{size:`small`,type:`primary`,onClick:d},{default:Y(()=>[...r[5]||=[X(`  `,-1)]]),_:1})])]),I(`div`,Qk,[Ce(I(`textarea`,{"onUpdate:modelValue":r[1]||=e=>i.value=e,class:`h-full w-full resize-none bg-slate-50 p-4 font-mono text-sm leading-relaxed text-slate-800 outline-none`,placeholder:` ${c[a.value]} ...`},null,8,$k),[[fe,i.value]])])]),_:1},8,[`modelValue`,`title`])}}}),nA={class:`h-full flex flex-col`},rA={class:`shrink-0 border-b border-slate-200 px-4 py-3`},iA={class:`flex items-center justify-between gap-3`},aA={class:`flex items-center gap-2`},oA={class:`text-sm font-semibold text-slate-900 uppercase tracking-wide truncate`},sA={class:`flex items-center gap-2`},cA={key:0,class:`h-7 flex items-center relative`},lA={class:`flex-1 overflow-auto variable-scroll`},uA={class:`px-4 py-4`},dA={key:0,class:`flex items-center justify-center p-5`},fA={class:`text-[11px] text-slate-400 bg-slate-50 border border-dashed border-slate-200 rounded-md p-4 text-center`},pA={class:`text-[10px]`},mA={key:1},hA={class:`flex items-center justify-between pb-2 mb-2 border-b border-slate-200 min-w-[320px]`},gA={class:`flex items-center gap-1.5`},_A={class:`space-y-1`},vA={key:0,class:`shrink-0 flex items-center gap-2 pb-2`},yA={class:`w-32`},bA={class:`text-xs text-slate-500 font-mono`},xA={key:2,class:`flex items-center justify-center p-5 text-sm text-slate-400`},SA={key:1,class:`flex items-center justify-center p-5 text-sm text-slate-400`},CA=V({__name:`VariablePanel`,props:{title:{},variables:{},showSearch:{type:Boolean,default:!0},showViewModeToggle:{type:Boolean,default:!0},viewModeOptions:{default:()=>[{value:`schema`,label:`Schema`},{value:`json`,label:`JSON`}]},emptyText:{default:``},emptyHint:{default:``},defaultViewMode:{default:`schema`},enableDrag:{type:Boolean,default:!0},showJsonSelector:{type:Boolean,default:!0},expandAllJson:{type:Boolean,default:!1}},emits:[`update:viewMode`,`update:searchQuery`],setup(e,{expose:t,emit:n}){let r=e,i=n,a=U(r.defaultViewMode),o=U(null);function s(e){let t=[],n=e=>{t.push(e.id),e.children&&e.children.forEach(n)};return e.forEach(n),t}function c(e){let t=[],n=e=>{if(t.push(e.id),e.children&&e.children.length>0)if(e.valueType===`array`){let t=e.children[0];t&&n(t)}else e.children.forEach(n)};return e.forEach(n),t}function l(){let e=s(r.variables);o.value=new Set(e)}function u(){let e=c(r.variables);o.value=new Set(e)}function d(){o.value=new Set}function f(e,t){if(o.value===null){let e=r.variables.map(e=>e.id);o.value=new Set(e)}let n=o.value;t?n.add(e):n.delete(e),o.value=new Set(n)}function p(e){let t=r.variables.find(t=>t.id===e);if(!t)return;let n=c([t]);if(o.value===null){let e=r.variables.map(e=>e.id);o.value=new Set(e)}let i=o.value;n.forEach(e=>i.add(e)),o.value=new Set(i)}W(()=>r.defaultViewMode,e=>{e!==a.value&&(a.value=e)});let m=U(!1),h=U(``),g=U(null),_=U(null),v=()=>{a.value===`json`&&r.variables.length>0&&(!_.value||!r.variables.find(e=>e.id===_.value))&&(_.value=r.variables[0]?.id??null)};W(()=>a.value,e=>{i(`update:viewMode`,e),e===`json`&&v()}),W(()=>h.value,e=>{i(`update:searchQuery`,e)}),W(()=>r.variables,()=>{v()},{immediate:!0});let b=q(()=>{if(!h.value.trim())return r.variables;let e=h.value.toLowerCase().trim(),t=n=>{let r=n.label.toLowerCase().includes(e),i=n.children?.map(t).filter(e=>e!==null)||[];return r||i.length>0?{...n,children:i.length>0?i:n.children}:null};return r.variables.map(t).filter(e=>e!==null)}),x=q(()=>r.variables.map(e=>({label:e.label,value:e.id})));function S(e){if(e.children&&e.children.length>0)if(e.children.every(e=>{let t=e.label.trim();return/^\[\d+\]$/.test(t)})){let t=[];return e.children.forEach(e=>{let n=e.label.match(/^\[(\d+)\]$/);if(n&&n[1]){let r=parseInt(n[1],10);t[r]=S(e)}}),t}else{let t={};return e.children.forEach(e=>{t[e.label]=S(e)}),t}return e.value}let C=q(()=>{if(!_.value)return null;let e=r.variables.find(e=>e.id===_.value);return e?S(e):null}),w=q(()=>{if(r.variables.length===0)return null;let e=r.variables[0];return e?S(e):null}),T=q(()=>{let e=C.value;if(!e)return`0 items`;if(Array.isArray(e)){let t=e.length;return t===1?`1 item`:`${t} items`}if(typeof e==`object`&&e){let t=Object.keys(e).length;return t===1?`1 item`:`${t} items`}return`1 item`}),E=()=>{h.value||(m.value=!1)},D=async()=>{m.value=!0,await F(),g.value?.focus()};return t({viewMode:a,searchQuery:h,selectedVariableNode:_,clearSearch:()=>{h.value=``,m.value=!1}}),(t,n)=>(G(),P(`div`,nA,[I(`div`,rA,[I(`div`,iA,[I(`div`,aA,[I(`h3`,oA,J(e.title),1),We(t.$slots,`title-suffix`,{},void 0,!0)]),I(`div`,sA,[We(t.$slots,`title-right`,{},()=>[e.showSearch?(G(),P(`div`,cA,[I(`div`,{class:`overflow-hidden transition-all duration-200 ease-out`,style:R({width:m.value?`8rem`:`1.75rem`,opacity:m.value?1:0})},[Ce(O(B(Oe),{value:h.value,"onUpdate:value":n[0]||=e=>h.value=e,size:`small`,placeholder:`...`,class:`w-32 n-input-gray`,onBlur:E,onKeyup:n[1]||=j(e=>m.value=!1,[`escape`]),ref_key:`searchInputRef`,ref:g},{prefix:Y(()=>[O(ot,{class:`w-4 h-4 text-slate-400`})]),_:1},8,[`value`]),[[ee,m.value]])],4),Ce(I(`button`,{onClick:D,class:`absolute left-0 h-7 w-7 flex items-center justify-center text-slate-600 cursor-pointer transition-opacity duration-200`},[O(ot,{class:`w-4 h-4`})],512),[[ee,!m.value]])])):z(``,!0),e.showViewModeToggle?(G(),L(B(y),{key:1,modelValue:a.value,"onUpdate:modelValue":n[2]||=e=>a.value=e,options:e.viewModeOptions},null,8,[`modelValue`,`options`])):z(``,!0),We(t.$slots,`header-actions`,{},void 0,!0)],!0)])])]),I(`div`,lA,[We(t.$slots,`content`,{},()=>[I(`div`,uA,[a.value===`schema`?(G(),P(je,{key:0},[b.value.length===0?(G(),P(`div`,dA,[I(`div`,fA,[X(J(e.emptyText||``),1),n[4]||=I(`br`,null,null,-1),I(`span`,pA,J(e.emptyHint||``),1)])])):(G(),P(`div`,mA,[I(`div`,hA,[n[11]||=I(`span`,{class:`text-xs text-slate-500 font-medium`},``,-1),I(`div`,gA,[O(B(Pe),{size:`tiny`,text:``,onClick:u},{icon:Y(()=>[...n[5]||=[I(`span`,{class:`text-sm`},``,-1)]]),default:Y(()=>[n[6]||=X(`  `,-1)]),_:1}),O(B(Pe),{size:`tiny`,text:``,onClick:l},{icon:Y(()=>[...n[7]||=[I(`span`,{class:`text-sm`},``,-1)]]),default:Y(()=>[n[8]||=X(`  `,-1)]),_:1}),O(B(Pe),{size:`tiny`,text:``,onClick:d},{icon:Y(()=>[...n[9]||=[I(`span`,{class:`text-sm`},``,-1)]]),default:Y(()=>[n[10]||=X(`  `,-1)]),_:1})])]),I(`div`,_A,[(G(!0),P(je,null,Le(b.value,e=>(G(),L(ct,{key:e.id,node:e,level:0,"enable-drag":r.enableDrag,"expanded-node-ids":o.value??void 0,onToggle:f,onToggleWithFirst:p},null,8,[`node`,`enable-drag`,`expanded-node-ids`]))),128))])]))],64)):a.value===`json`?(G(),P(je,{key:1},[r.showJsonSelector?(G(),P(`div`,vA,[I(`div`,yA,[O(B(we),{value:_.value,"onUpdate:value":n[3]||=e=>_.value=e,options:x.value,size:`small`,placeholder:``},null,8,[`value`,`options`])]),I(`span`,bA,J(T.value),1)])):z(``,!0),C.value?(G(),L(ut,{key:1,data:C.value,"enable-drag":r.enableDrag,"expand-all":r.expandAllJson},null,8,[`data`,`enable-drag`,`expand-all`])):r.showJsonSelector?(G(),P(`div`,xA,`  `)):(G(),P(je,{key:3},[r.variables.length>0&&w.value?(G(),L(ut,{key:0,data:w.value,"enable-drag":r.enableDrag,"expand-all":r.expandAllJson},null,8,[`data`,`enable-drag`,`expand-all`])):(G(),P(`div`,SA,J(e.emptyText||``),1))],64))],64)):z(``,!0)])],!0)])]))}}),wA=Z(CA,[[`__scopeId`,`data-v-aff70aa8`]]),TA={},EA={class:`w-16 h-16 opacity-50`,viewBox:`0 0 64 64`,fill:`none`,xmlns:`http://www.w3.org/2000/svg`};function DA(e,t){return G(),P(`svg`,EA,[...t[0]||=[I(`rect`,{x:`16`,y:`16`,width:`32`,height:`32`,rx:`4`,class:`stroke-slate-300`,"stroke-width":`2`},null,-1),I(`circle`,{cx:`32`,cy:`32`,r:`4`,class:`fill-slate-300`},null,-1)]])}var OA=Z(TA,[[`render`,DA]]),kA={key:3,class:`text-xs text-slate-500`},AA={class:`max-w-md`},jA={class:`text-xs text-red-800 whitespace-pre-wrap break-words leading-relaxed`},MA=V({__name:`NodeExecutionStatus`,props:{status:{},isExecuting:{type:Boolean}},setup(e){function t(e){if(e<1e3)return`${e}ms`;if(e<6e4)return`${(e/1e3).toFixed(2)}s`;{let t=Math.floor(e/6e4),n=(e%6e4/1e3).toFixed(0);return`${t}m ${n}s`}}return(n,r)=>e.status&&!e.isExecuting?(G(),L(B(Se),{key:0,disabled:e.status.status!==`error`||!e.status.error,placement:`bottom`,trigger:`hover`,"theme-overrides":{color:`#fef2f2`,textColor:`#991b1b`,borderRadius:`8px`,padding:`12px`}},{trigger:Y(()=>[I(`div`,{class:N([`flex items-center gap-1.5 px-2 py-1 rounded-md text-xs`,{"bg-green-50":e.status.status===`success`,"bg-red-50":e.status.status===`error`,"bg-purple-50":e.status.status===`cached`,"cursor-help":e.status.status===`error`&&e.status.error}])},[e.status.status===`success`?(G(),P(je,{key:0},[O(Dp,{class:`h-3.5 w-3.5 text-green-600`}),r[0]||=I(`span`,{class:`font-medium text-green-700`},``,-1)],64)):e.status.status===`error`?(G(),P(je,{key:1},[O(jp,{class:`h-3.5 w-3.5 text-red-600`}),r[1]||=I(`span`,{class:`font-medium text-red-700`},``,-1)],64)):e.status.status===`cached`?(G(),P(je,{key:2},[O(Dp,{class:`h-3.5 w-3.5 text-purple-600`}),r[2]||=I(`span`,{class:`font-medium text-purple-700`},``,-1)],64)):z(``,!0),e.status.duration===void 0?z(``,!0):(G(),P(`span`,kA,J(t(e.status.duration)),1))],2)]),default:Y(()=>[I(`div`,AA,[r[3]||=I(`div`,{class:`text-xs font-semibold text-red-900 mb-1.5 border-b border-red-200 pb-1`},`  `,-1),I(`div`,jA,J(e.status.error),1)])]),_:1},8,[`disabled`])):z(``,!0)}}),NA={key:0,class:`flex flex-col items-center justify-center h-full px-8 py-12`},PA={class:`flex items-center justify-between w-full`},FA={class:`flex gap-2`},IA={class:`text-base font-semibold text-slate-900`},LA=[`disabled`],RA={key:0,class:`h-full flex flex-col`},zA={class:`flex items-center gap-2`},BA=[`title`],VA={key:0,class:`h-7 flex items-center gap-0.5 mr-1.5 px-1.5 bg-slate-100 rounded`},HA=[`disabled`],UA={class:`text-xs font-medium font-mono text-slate-700 min-w-[38px] text-center leading-none`},WA=[`disabled`],GA={key:2,class:`h-full flex flex-col`},KA={class:`shrink-0 flex items-center justify-between border-b border-slate-200 px-4 py-3`},qA={class:`flex-1 overflow-auto variable-scroll`},JA={key:0,class:`px-4 py-6`},YA={class:`rounded-lg border border-red-200 bg-red-50 p-3`},XA={class:`flex items-start gap-2`},ZA={class:`flex-1 min-w-0`},QA={class:`mt-1 text-xs text-red-700 whitespace-pre-wrap`},$A={key:1,class:`px-4 py-6`},ej=Z(V({__name:`NodeConfigModal`,setup(e){let t=b(),n=r(),i=Ge(),{findNode:a}=Hu(),{selectedNodeId:s}=Ze(t),{variableTree:c}=h(),l=nt(),u=q(()=>{if(s.value)return a(s.value)}),d=U(320),f=U(320),p=U(`output`),g=U(!1),_=U(``),v=U(``),x=U(null),S=U(`schema`),C=U(`json`),w=[{value:`schema`,label:`Schema`},{value:`json`,label:`JSON`}],T=[{value:`schema`,label:`Schema`},{value:`json`,label:`JSON`}],E=U(!1),D=U(1),k=q(()=>{if(!s.value)return null;let e=n.nodes.find(e=>e.id===s.value);return e?e.data?.iterationHistory:null}),A=q(()=>!!k.value&&k.value.totalIterations>0),j=q(()=>{if(!A.value||!k.value)return null;let e=D.value,t=k.value.iterations;return e<1||e>t.length?null:t[e-1]}),M=q(()=>{let e=s.value;return e?A.value&&j.value?{status:j.value.executionStatus||`success`,result:j.value.executionResult,error:j.value.executionError,duration:j.value.executionDuration,timestamp:j.value.executionTimestamp}:n.getNodeExecutionStatus(e):null}),ee=q(()=>!!M.value?.result),N=q(()=>{if(!ee.value||!M.value?.result)return[];try{let e=M.value.result,t=lt(e);return t?[t]:[]}catch(e){return console.error(`[NodeConfigModal] :`,e),[]}}),te=[{value:`output`,label:``},{value:`logs`,label:``}];W([s,k],()=>{A.value&&k.value?D.value=k.value.currentPage||1:D.value=1},{immediate:!0});let ne=()=>{if(M.value?.result)try{_.value=JSON.stringify(M.value.result,null,2),v.value=_.value}catch(e){console.error(`:`,e),_.value=`{}`,v.value=`{}`}else _.value=`{}`,v.value=`{}`;g.value=!0},re=()=>{try{let e=JSON.parse(_.value);u.value&&n.updateNode(u.value.id,{data:{...u.value.data,executionResult:e,executionTimestamp:Date.now()}}),v.value=_.value,g.value=!1,i.success(``)}catch(e){console.error(`JSON `,e),i.error(`JSON `)}},F=()=>{_.value=v.value,g.value=!1},ie=e=>{d.value=e.leftWidth,f.value=e.rightWidth};function ae(){if(!u.value){i.warning(``);return}let e=u.value.id;E.value=!0,tt.emit(`node:execute`,{nodeId:e}),console.log(`[NodeConfigModal] :`,e)}function oe(e){e.nodeId===s.value&&(E.value=!1,p.value=`output`,console.log(`[NodeConfigModal] :`,e))}function se(e){e.nodeId===s.value&&(E.value=!1,p.value=`output`,console.error(`[NodeConfigModal] :`,e))}function R(e){e.nodeId===s.value&&(E.value=!0)}function le(e){if(e.nodeId===s.value){E.value=!1;let t=n.nodes.find(t=>t.id===e.nodeId);t&&n.updateNode(e.nodeId,{data:{...t.data,executionStatus:`cached`,executionResult:e.cachedResult.outputs,executionDuration:e.cachedResult.duration,executionTimestamp:Date.now()}}),p.value=`output`,console.log(`[NodeConfigModal] :`,e)}}ce(()=>{l.on(`execution:node:start`,R),l.on(`execution:node:complete`,oe),l.on(`execution:node:error`,se),l.on(`execution:cache-hit`,le)}),me(()=>{l.off(`execution:node:start`,R),l.off(`execution:node:complete`,oe),l.off(`execution:node:error`,se),l.off(`execution:cache-hit`,le)});function ue(e){if(!A.value||!k.value)return;let t=k.value.totalIterations;e<1||e>t||(D.value=e,s.value&&n.setNodeIterationPage(s.value,e))}function de(){D.value>1&&ue(D.value-1)}function fe(){A.value&&k.value&&D.value<k.value.totalIterations&&ue(D.value+1)}function pe(){t.closeNodeConfigModal(),t.clearNodeSelection()}return(e,n)=>(G(),L(B(o),{modelValue:B(t).nodeConfigModalVisible,"onUpdate:modelValue":n[4]||=e=>B(t).nodeConfigModalVisible=e,title:``,width:`full`,padding:`none`,onClose:pe},{default:Y(()=>[u.value?(G(),L(B(m),{key:1,"show-back-button":!0,"center-width":500,"min-left-width":280,"min-right-width":320,"back-text":``,onResize:ie,onBack:pe},{left:Y(()=>[O(wA,{title:``,variables:B(c),"show-search":!0,"show-view-mode-toggle":!0,"view-mode-options":w,"default-view-mode":S.value,"onUpdate:viewMode":n[0]||=e=>S.value=e},null,8,[`variables`,`default-view-mode`])]),centerHeader:Y(()=>[I(`div`,PA,[I(`div`,FA,[O(Zf,{class:`h-5 w-5 text-white bg-blue-500 rounded-md p-1 overflow-hidden`}),I(`h2`,IA,J(u.value.data?.label)+` -  `,1)]),I(`button`,{class:`flex items-center gap-2 px-3 py-1.5 text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 rounded transition-colors disabled:opacity-50 disabled:cursor-not-allowed`,disabled:E.value||!u.value,onClick:ae},[E.value?(G(),L(Cp,{key:1,class:`h-4 w-4 animate-spin`})):(G(),L(Jp,{key:0,class:`h-4 w-4`})),I(`span`,null,J(E.value?`...`:``),1)],8,LA)])]),center:Y(()=>[O(BT)]),right:Y(()=>[g.value?(G(),P(`div`,RA,[I(`div`,{class:`shrink-0 flex items-center justify-between border-b border-slate-200 px-4 py-3`},[n[6]||=I(`span`,{class:`text-sm font-semibold text-slate-900`},``,-1),I(`div`,{class:`flex items-center gap-2`},[I(`button`,{class:`px-3 py-1.5 text-xs font-medium text-slate-700 bg-slate-200 hover:bg-slate-300 rounded transition-colors`,onClick:F},`  `),I(`button`,{class:`px-3 py-1.5 text-xs font-medium text-white bg-blue-600 hover:bg-blue-700 rounded transition-colors`,onClick:re},`  `)])]),O(st,{modelValue:_.value,"onUpdate:modelValue":n[1]||=e=>_.value=e,language:`json`,class:`flex-1`,options:{minimap:{enabled:!1},fontSize:13}},null,8,[`modelValue`])])):ee.value?(G(),L(wA,{key:1,title:``,variables:N.value,"show-search":!0,"show-view-mode-toggle":!0,"view-mode-options":T,"default-view-mode":C.value,"enable-drag":!1,"show-json-selector":!1,"expand-all-json":!0,"empty-text":``,"empty-hint":``,"onUpdate:viewMode":n[2]||=e=>C.value=e,ref_key:`rightVariablePanel`,ref:x},{"title-suffix":Y(()=>[I(`div`,zA,[A.value&&j.value?(G(),P(`span`,{key:0,class:`px-2 py-0.5 text-xs font-medium bg-blue-100 text-blue-700 rounded`,title:` ${D.value}${j.value.iterationIndex}`},`  `+J(D.value),9,BA)):z(``,!0),O(MA,{status:M.value,"is-executing":E.value},null,8,[`status`,`is-executing`])])]),"header-actions":Y(()=>[A.value?(G(),P(`div`,VA,[I(`button`,{class:`p-0 text-slate-600 hover:text-slate-900 disabled:text-slate-300 disabled:cursor-not-allowed transition-colors`,disabled:D.value<=1,onClick:de,title:``},[O(WT,{class:`h-3.5 w-3.5`})],8,HA),I(`span`,UA,J(D.value)+`/`+J(k.value?.totalIterations),1),I(`button`,{class:`p-0 text-slate-600 hover:text-slate-900 disabled:text-slate-300 disabled:cursor-not-allowed transition-colors`,disabled:D.value>=(k.value?.totalIterations||0),onClick:fe,title:``},[O(JT,{class:`h-3.5 w-3.5`})],8,WA)])):z(``,!0),I(`button`,{class:`p-1 text-slate-400 hover:text-slate-600 rounded transition-colors`,onClick:ne,title:``},[O(nm,{class:`h-4 w-4`})])]),_:1},8,[`variables`,`default-view-mode`])):(G(),P(`div`,GA,[I(`div`,KA,[O(B(y),{modelValue:p.value,"onUpdate:modelValue":n[3]||=e=>p.value=e,options:te},null,8,[`modelValue`])]),I(`div`,qA,[M.value?.status===`error`&&M.value.error?(G(),P(`div`,JA,[I(`div`,YA,[I(`div`,XA,[O(jp,{class:`h-4 w-4 shrink-0 text-red-500 mt-0.5`}),I(`div`,ZA,[n[7]||=I(`p`,{class:`text-xs font-medium text-red-800`},``,-1),I(`pre`,QA,J(M.value.error),1)])])])])):(G(),P(`div`,$A,[...n[8]||=[I(`p`,{class:`text-sm text-slate-500`},` Execute this node to view data or set mock data `,-1)]]))])]))]),_:1})):(G(),P(`div`,NA,[O(OA),n[5]||=I(`p`,{class:`mt-5 text-[15px] font-medium text-center text-slate-600`},`  `,-1)]))]),_:1},8,[`modelValue`]))}}),[[`__scopeId`,`data-v-83df70de`]]),tj={class:`flex h-full flex-1 overflow-hidden`},nj={class:`w-[360px] border-r border-slate-200 overflow-hidden shrink-0 bg-white`},rj={class:`flex-1 flex overflow-hidden`},ij={class:`flex-1 flex flex-col border-r border-slate-200`},aj={class:`flex-1 p-4 overflow-y-auto variable-scroll`},oj={class:`flex-1 flex flex-col`},sj={class:`flex items-center justify-between px-4 py-2 border-b border-slate-200 bg-slate-50/80 shrink-0`},cj={key:0,class:`flex items-center gap-1 text-[10px] text-slate-500`},lj=[`value`,`disabled`],uj=[`disabled`],dj=[`disabled`],fj={class:`flex-1 overflow-y-auto variable-scroll p-4`},pj={key:0,class:`p-3 bg-slate-50/50 border border-slate-200 rounded-md`},mj={key:1,class:`text-xs text-slate-400`},hj=V({__name:`VariableEditorModal`,setup(e){let t=b(),{selectedNodeId:n,variableEditorModalVisible:r,variableEditorModalContent:a}=Ze(t),s=U(null),u=U(``),d=U(0),f=U(`0`),{variableTree:p,contextMap:m}=h(),g=q(()=>{let e=u.value;return!e||typeof e!=`string`?!1:/\{\{\s*\$?[^{}]+?\s*\}\}/.test(e)}),_=q(()=>{let e=u.value;if(!e)return[];if(!g.value||!n.value||!m.value||m.value.size===0)return[e];try{let t=l({preview:e},m.value).preview;return Array.isArray(t)?t:t==null?[]:[t]}catch{return[``]}}),v=q(()=>_.value.length>1&&d.value>0),y=q(()=>_.value.length>1&&d.value<_.value.length-1);W(s,e=>{e&&te(u.value,!1)},{flush:`post`}),W(_,e=>{if(!e.length){d.value=0,f.value=`0`;return}d.value>e.length-1&&(d.value=e.length-1),f.value=String(d.value+1)},{immediate:!0}),W(d,e=>{if(!_.value.length){f.value=`0`;return}f.value=String(e+1)}),W(()=>a.value.value,e=>{r.value&&e!==void 0&&(u.value=e||``,te(u.value,!1))},{immediate:!0}),W(r,e=>{if(e){let e=a.value.value||``;u.value=e,te(e,!1),d.value=0,f.value=`0`}});function x(e){e||S()}function S(){t.closeVariableEditorModal()}function C(){let e=a.value.onSave;e&&e(u.value),S()}function w(){}function T(){}function E(){if(!s.value)return;let e=ne(s.value);e!==u.value&&(u.value=e,te(e,!0))}function D(e){e.preventDefault();let t=e.clipboardData?.getData(`text/plain`)||``;ie(t),E()}function k(e){if(!s.value)return;let t=e.detail;if(!t?.reference)return;let n=t.reference.trim();n&&(ie(n),E())}function A(){d.value<=0||--d.value}function j(){d.value>=_.value.length-1||(d.value+=1)}function M(e){if(!_.value.length){f.value=`0`;return}f.value=e.target.value.replace(/[^0-9]/g,``)}function ee(){if(!_.value.length){f.value=`0`;return}let e=f.value.trim();if(!e){f.value=String(d.value+1);return}let t=_.value.length,n=Number(e);if(Number.isNaN(n)){f.value=String(d.value+1);return}let r=Math.min(Math.max(Math.floor(n),1),t);d.value=r-1,f.value=String(r)}function N(e){e.key===`Enter`&&(e.preventDefault(),ee())}function te(e,t=!1){let n=s.value;if(!n)return;let r=null;t&&(r=re());let i=ae(e)||``;n.innerHTML!==i&&(n.innerHTML=i),t&&r!==null&&F(r)}function ne(e){return e.textContent?.replace(/\u00a0/g,` `).replace(/\u200B/g,``)??``}function re(){let e=s.value;if(!e)return null;let t=window.getSelection();if(!t||t.rangeCount===0)return null;let n=t.getRangeAt(0);if(!e.contains(n.endContainer))return null;let r=n.cloneRange();return r.selectNodeContents(e),r.setEnd(n.endContainer,n.endOffset),r.toString().length}function F(e){let t=s.value;if(!t)return;let n=window.getSelection();if(!n)return;let r=ne(t),i=Math.max(0,Math.min(e,r.length)),a=document.createTreeWalker(t,NodeFilter.SHOW_TEXT),o=a.nextNode(),c=0;for(;o;){let e=o.textContent?.length??0;if(c+e>=i){let e=i-c,t=document.createRange();t.setStart(o,e),t.collapse(!0),n.removeAllRanges(),n.addRange(t);return}c+=e,o=a.nextNode()}let l=document.createRange();l.selectNodeContents(t),l.collapse(!1),n.removeAllRanges(),n.addRange(l)}function ie(e){let t=s.value;if(!t)return;let n=window.getSelection();if(!n)return;if(n.rangeCount===0){t.appendChild(document.createTextNode(e));return}let r=n.getRangeAt(0);t.contains(r.startContainer)||(r.selectNodeContents(t),r.collapse(!1)),r.deleteContents();let i=document.createTextNode(e);r.insertNode(i);let a=document.createRange();a.setStart(i,i.length),a.collapse(!0),n.removeAllRanges(),n.addRange(a)}function ae(e){if(!e)return``;let t=/\{\{\s*\$?[^{}]+?\s*\}\}/g,n=0,r=``,i;for(;(i=t.exec(e))!==null;){let t=i[0],a=i.index;r+=oe(e.slice(n,a)),r+=`<span class="variable-token">${oe(t)}</span>`,n=a+t.length}return r+=oe(e.slice(n)),r}function oe(e){return e.replace(/&/g,`&amp;`).replace(/</g,`&lt;`).replace(/>/g,`&gt;`).replace(/"/g,`&quot;`).replace(/'/g,`&#39;`)}return(e,t)=>(G(),L(o,{"model-value":B(r),title:``,width:`full`,padding:`none`,"z-index":100,"onUpdate:modelValue":x,onClose:S},{icon:Y(()=>[O(c,{class:`w-4 h-4`})]),footer:Y(()=>[I(`div`,{class:`flex items-center justify-end gap-2`},[I(`button`,{class:`px-4 py-2 text-sm font-medium text-slate-700 bg-white border border-slate-300 rounded-md hover:bg-slate-50 transition-colors`,onClick:S},`  `),I(`button`,{class:`px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-md hover:bg-blue-700 transition-colors`,onClick:C},`  `)])]),default:Y(()=>[I(`div`,tj,[I(`div`,nj,[O(wA,{title:``,variables:B(p)},null,8,[`variables`])]),I(`div`,rj,[I(`div`,ij,[t[0]||=I(`div`,{class:`px-4 py-2 border-b border-slate-200 bg-slate-50/50 shrink-0`},[I(`div`,{class:`text-xs font-medium text-slate-600`},``),I(`div`,{class:`text-[10px] text-slate-400 mt-0.5`},[X(`  `),I(`span`,{class:`font-mono text-emerald-600`},`{{ . }}`),X(`  `)])],-1),I(`div`,aj,[I(`div`,{ref_key:`editorRef`,ref:s,contenteditable:`true`,class:`w-full h-full min-h-[200px] p-3 font-mono text-sm text-slate-700 bg-white border border-slate-200 rounded-md outline-none focus:border-slate-400 focus:ring-2 focus:ring-slate-200 whitespace-pre-wrap wrap-break-word`,onInput:E,onVariableDrop:k,onPaste:D,onFocus:w,onBlur:T},null,544)])]),I(`div`,oj,[I(`div`,sj,[t[2]||=I(`div`,{class:`text-xs font-semibold text-slate-600`},``,-1),_.value.length>1?(G(),P(`div`,cj,[t[1]||=I(`span`,{class:`font-medium`},`Page`,-1),I(`input`,{value:f.value,type:`text`,inputmode:`numeric`,pattern:`[0-9]*`,placeholder:`0`,disabled:!_.value.length,class:`h-5 w-7 rounded bg-white px-1 text-center text-[10px] font-medium text-slate-600 shadow-inner ring-1 ring-inset ring-slate-200 transition focus:outline-none focus:ring-2 focus:ring-slate-300 disabled:bg-slate-100 disabled:text-slate-400`,onInput:M,onBlur:ee,onKeydown:N},null,40,lj),I(`span`,null,`/ `+J(_.value.length||0),1),I(`button`,{type:`button`,class:`flex h-5 w-5 items-center justify-center text-slate-400 transition-colors hover:text-slate-700 disabled:cursor-not-allowed disabled:text-slate-300`,disabled:!v.value,"aria-label":``,onClick:se(A,[`stop`])},[O(at,{class:`h-3 w-3 -rotate-180`})],8,uj),I(`button`,{type:`button`,class:`flex h-5 w-5 items-center justify-center text-slate-400 transition-colors hover:text-slate-700 disabled:cursor-not-allowed disabled:text-slate-300`,disabled:!y.value,"aria-label":``,onClick:se(j,[`stop`])},[O(at,{class:`h-3 w-3`})],8,dj)])):z(``,!0)]),I(`div`,fj,[_.value.length?(G(),P(`div`,pj,[O(i,{value:u.value,"current-item-index":d.value,inline:``},null,8,[`value`,`current-item-index`])])):(G(),P(`p`,mj,[...t[3]||=[I(`span`,{class:`font-mono bg-gray-100 px-2 py-1 rounded`},`[empty]`,-1)]]))])])])])]),_:1},8,[`model-value`]))}}),gj={class:`relative flex h-full flex-col`},_j={class:`flex-1 overflow-hidden`},vj={class:`absolute z-10 bottom-4 right-6 flex items-center gap-2`},yj=Z(V({__name:`EditorPanelModal`,setup(e){let t=b(),{editorPanelModalVisible:n,editorPanelContent:r}=Ze(t),i=Ge(),a=U(null),s=U(``),c=U(`javascript`),l=q(()=>!!r.value.onSave),u=q(()=>({minimap:{enabled:!0},fontSize:14,lineNumbers:`on`,wordWrap:`off`,automaticLayout:!0,scrollBeyondLastLine:!1}));function d(e,t){console.log(`[EditorPanelModal] `)}W(()=>n.value,e=>{e&&(s.value=r.value.content||``,c.value=r.value.language||`javascript`)},{immediate:!0});function f(){r.value.onSave?(r.value.onSave(s.value),i.success(``),t.closeEditorPanelModal()):i.warning(``)}function p(){t.closeEditorPanelModal()}return(e,t)=>{let i=K(`n-button`);return G(),L(B(o),{modelValue:B(n),"onUpdate:modelValue":t[1]||=e=>ke(n)?n.value=e:null,title:B(r).title||``,width:`full`,padding:`none`,onClose:p},{default:Y(()=>[I(`div`,gj,[I(`div`,_j,[O(st,{ref_key:`editorRef`,ref:a,modelValue:s.value,"onUpdate:modelValue":t[0]||=e=>s.value=e,language:c.value,readonly:!l.value,options:u.value,onReady:d},null,8,[`modelValue`,`language`,`readonly`,`options`])]),I(`div`,vj,[O(i,{size:`small`,onClick:p},{default:Y(()=>[X(J(l.value?``:``),1)]),_:1}),l.value?(G(),L(i,{key:0,size:`small`,type:`primary`,onClick:f},{default:Y(()=>[...t[2]||=[X(`  `,-1)]]),_:1})):z(``,!0)])])]),_:1},8,[`modelValue`,`title`])}}}),[[`__scopeId`,`data-v-1fe309da`]]),bj={class:`pointer-events-none absolute bottom-3 left-1/2 -translate-x-1/2`},xj={class:`pointer-events-auto`},Sj={class:`absolute bottom-2 right-10`},Cj=V({__name:`CanvasView`,setup(e){let n=r(),i=w(),a=b(),o=x(),{config:s}=Ze(i),{infoModalVisible:c,editorModalVisible:l,nodeConfigModalVisible:u,variableEditorModalVisible:d,editorPanelModalVisible:f}=Ze(a),{fitView:p,getSelectedNodes:m,removeSelectedElements:h}=Hu(),g=Ge(),_=nt(),v=n.vueFlowExecution,y=Ye({visible:!1,position:{x:320,y:220},startHandle:void 0}),C=U(null),T=U(null),E=U(null);a.activeTab=`node-library`,ce(()=>{setTimeout(()=>{n.loadNodeList()},400)});function D(e,t){if(!T.value)return{x:e,y:t};let n=T.value.getBoundingClientRect();return{x:e-n.left,y:t-n.top}}function k(){_.emit(`history:undo`,void 0)}function A(){_.emit(`history:redo`,void 0)}function j(){p({padding:.2,duration:300})}function M(){_.emit(`canvas:request-auto-layout`,{direction:s.value.autoLayoutDirection,nodesep:s.value.autoLayoutNodeSpacing,ranksep:s.value.autoLayoutRankSpacing,padding:s.value.autoLayoutPadding,fitView:s.value.autoLayoutFitView,fitViewPadding:s.value.autoLayoutFitViewPadding,fitViewDuration:s.value.autoLayoutFitViewDuration,forNodeSpacing:s.value.autoLayoutNodeSpacing})}function ee(){i.updateConfig({showMiniMap:!s.value.showMiniMap})}function N(){console.log(`[CanvasView] `),v.pause(),g.info(``)}function P(){console.log(`[CanvasView] `),v.resume(),g.info(``)}function te(){console.log(`[CanvasView] `),v.stop(),g.warning(``),n.setExecuting(!1)}async function ne(e){E.value?.syncToStore&&(E.value.syncToStore(),console.log(`[CanvasView]  Store`),await F());let t=o.currentWorkflow;if(!t){g.warning(``);return}if(!t.nodes||t.nodes.length===0){g.warning(``);return}if(!v.isInitialized.value){v.ensureChannel(),g.loading(`...`,{duration:0});let e=0;for(;!v.isInitialized.value&&e<50;)await new Promise(e=>setTimeout(e,100)),e++;if(g.destroyAll(),!v.isInitialized.value){g.error(``);return}}n.setExecuting(!0);try{let n=[];if(e&&e.length>0)n=e;else{let e=m.value||[];e.length>1&&(n=e.map(e=>e.id))}let r={workflow_id:t.workflow_id,name:t.name,description:t.description,selectedNodeIds:n,nodes:t.nodes.map(e=>({id:e.id,type:e.type||`custom`,label:e.data?.label||e.label,position:e.position?{x:e.position.x,y:e.position.y}:void 0,parentNode:e.parentNode||e.parentId,data:e.data})),edges:t.edges.map(e=>({id:e.id,source:e.source,target:e.target,sourceHandle:e.sourceHandle,targetHandle:e.targetHandle,data:e.data}))},i=JSON.parse(JSON.stringify(r));console.log(`[CanvasView] :`,i),await v.execute(i,{useCache:!0,timeout:6e4,globalVariables:o.getGlobalVariableJson()})}catch(e){console.error(`[CanvasView] :`,e)}finally{n.setExecuting(!1)}}_.on(`node:execute`,async({nodeId:e})=>{console.log(`[CanvasView] :`,e),await ne([e])}),_.on(`node:added`,({node:e})=>{console.log(`[CanvasView] :`,e)}),_.on(`node:clicked`,({node:e})=>{console.log(`[CanvasView] :`,e,e.data?.label),y.visible=!1}),_.on(`node:double-clicked`,({node:e})=>{console.log(`[CanvasView] :`,e.data?.label),![`connector`,`note`].includes(e.type||``)&&(a.selectNode(e.id),h())}),_.on(`node:context-menu`,({node:e})=>{console.log(`[CanvasView] :`,e.data?.label)}),_.on(`canvas:clicked`,()=>{console.log(`[CanvasView] `),a.clearNodeSelection(),a.clearNodePreview()});let re;_.on(`edge:connect-start`,e=>{re=e&&(e.handleType===`source`||e.handleType===`target`)?{nodeId:e.nodeId,handleId:e.handleId,handleType:e.handleType}:void 0}),_.on(`edge:connection-failed`,({position:e})=>{console.log(`[CanvasView] `,e);let t=D(e.x,e.y);console.log(`[CanvasView] `,t),y.visible=!0,y.position=t,y.startHandle=re||void 0,F(()=>{C.value?.focus()})});function ie(e){let{nodeId:t,startHandle:n}=e||{};if(console.log(`[CanvasView] :`,t,`startHandle:`,n),!T.value){console.warn(`[CanvasView] `),g.warning(``);return}let r=T.value.getBoundingClientRect(),i=r.left+y.position.x,a=r.top+y.position.y;_.emit(`quick-menu:select-node`,{nodeId:t,screenPosition:{x:i,y:a},startHandle:n??y.startHandle??void 0})}_.on(`execution:start`,e=>{console.log(`[CanvasView] :`,e),g.loading(`...`,{duration:0})}),_.on(`execution:complete`,e=>{console.log(`[CanvasView] :`,e),g.destroyAll(),e.success&&g.success(` ${Math.round(e.duration/1e3)}s`)}),_.on(`execution:error`,e=>{console.error(`[CanvasView] :`,e),g.destroyAll(),g.error(`: ${e.error}`)}),_.on(`execution:node:start`,({nodeId:e})=>{console.log(`[CanvasView] :`,e),n.updateNode(e,{data:{...n.nodes.find(t=>t.id===e)?.data,executionStatus:`running`}})}),_.on(`execution:node:complete`,({nodeId:e,result:t})=>{console.log(`[CanvasView] :`,e,t);let r=n.nodes.find(t=>t.id===e);if(n.updateNode(e,{data:{...r?.data,executionStatus:`success`,executionResult:t}}),n.pushNodeResult({id:e,preview:JSON.stringify(t,null,2).slice(0,200)}),a.previewNodeId===e){let n={status:`success`,result:t,timestamp:Date.now(),duration:r?.data?.executionDuration};a.showNodePreview(e,n)}}),_.on(`execution:node:error`,({nodeId:e,error:t})=>{console.error(`[CanvasView] :`,e,t);let r=n.nodes.find(t=>t.id===e);if(n.updateNode(e,{data:{...r?.data,executionStatus:`error`,executionError:t}}),a.previewNodeId===e){let n={status:`error`,error:t,timestamp:Date.now(),duration:r?.data?.executionDuration};a.showNodePreview(e,n)}}),_.on(`execution:progress`,({progress:e})=>{console.log(`[CanvasView] :`,Math.round(e*100)+`%`)}),_.on(`execution:cache-hit`,({nodeId:e,cachedResult:t})=>{console.log(`[CanvasView] :`,e);let r=n.nodes.find(t=>t.id===e);if(n.updateNode(e,{data:{...r?.data,executionStatus:`cached`}}),a.previewNodeId===e){let n=Date.now(),r={status:`cached`,result:t.outputs,timestamp:n,duration:t.duration};a.showNodePreview(e,r)}}),_.on(`execution:iteration:update`,({nodeId:e,iterationData:t})=>{console.log(`[CanvasView]  ${e}  ${t.iterationIndex+1} :`,t),t.iterationIndex===0&&(console.log(`[CanvasView]  ${e} `),n.clearNodeIterationHistory(e)),n.appendNodeIterationHistory(e,t)}),_.on(`execution:result:preview`,e=>{console.log(`[CanvasView] :`,e),a.showNodePreview(e.nodeId,e.result)});let{enableShortcut:ae,hasFoucsInput:oe}=Ze(a);t(`Tab`,e=>{ae.value&&!e.ctrlKey&&!e.shiftKey&&!e.altKey&&(e.preventDefault(),a.toggleFloatingPanel(),console.log(`[CanvasView] Tab :`,a.floatingPanelVisible?``:``))},{dedupe:!0}),t(`Escape`,e=>{if(oe.value&&!e.ctrlKey&&!e.shiftKey&&!e.altKey){if(e.preventDefault(),f.value){a.closeEditorPanelModal(),console.log(`[CanvasView] Escape `);return}if(u.value){a.closeNodeConfigModal(),console.log(`[CanvasView] Escape `);return}if(l.value){a.closeEditorModal(),console.log(`[CanvasView] Escape `);return}if(c.value){a.closeInfoModal(),console.log(`[CanvasView] Escape `);return}if(d.value){a.closeVariableEditorModal(),console.log(`[CanvasView] Escape `);return}a.closeFloatingPanel(),console.log(`[CanvasView] Escape `)}},{dedupe:!0});let se=S({passive:!1,onEventFired(e){e.altKey&&e.shiftKey&&e.key===`f`&&e.type===`keydown`&&e.preventDefault()}})[`Alt+Shift+F`];return W(se,e=>{e&&ae.value&&(console.log(`[CanvasView] Ctrl+Shift+F `),M())}),(e,t)=>{let n=K(`n-layout-content`),r=K(`n-layout`);return G(),L(r,{"has-sider":``,class:`h-full`},{default:Y(()=>[O(qS),O(n,{class:`relative overflow-hidden`},{default:Y(()=>[O(Ak),I(`div`,{ref_key:`canvasContainerRef`,ref:T,class:`absolute inset-0`},[O(B(Qx),{ref_key:`vueFlowCanvasRef`,ref:E,"custom-node-component":bm,"show-background":!0,"show-controls":!0,"show-mini-map":B(s).showMiniMap},null,8,[`show-mini-map`])],512),I(`div`,bj,[I(`div`,xj,[O(OS,{onUndo:k,onRedo:A,onFitView:j,onAutoLayout:M,onToggleMiniMap:ee,onExecuteWorkflow:ne,onPauseExecution:N,onResumeExecution:P,onStopExecution:te})])]),I(`div`,Sj,[O(Mk)]),O(RS,{ref_key:`quickMenuRef`,ref:C,onClose:t[0]||=e=>y.visible=!1,onSelectNode:ie,visible:y.visible,position:y.position,"start-handle":y.startHandle},null,8,[`visible`,`position`,`start-handle`])]),_:1}),O(Jk),O(tA),O(ej),O(hj),O(yj)]),_:1})}}}),wj=V({__name:`CanvasPreview`,setup(e){return(e,t)=>(G(),L(Cj))}});export{wj as default};
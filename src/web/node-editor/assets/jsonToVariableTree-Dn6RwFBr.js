import{F as e,Ft as t,H as n,I as r,L as i,M as a,Mt as o,N as s,P as c,Pt as l,R as u,U as d,W as f,at as ee,j as p,jt as m,l as h,pt as te,rt as g,st as _,wt as v}from"./index-DIItrjPD.js";import{t as y}from"./_plugin-vue_export-helper-DEnkkObV.js";import{a as b,i as x,n as S,o as C,r as w,t as T}from"./IconCopyReference-rLVYJUoO.js";var E={},D={t:`1762605194920`,class:`icon`,viewBox:`0 0 1024 1024`,version:`1.1`,xmlns:`http://www.w3.org/2000/svg`,"p-id":`7514`,stroke:`currentColor`,fill:`currentColor`};function O(t,n){return g(),u(`svg`,D,[...n[0]||=[e(`path`,{d:`M728.223744 520.22784a42.467328 42.467328 0 0 1-11.393024 20.503552L374.90688 882.65728c-16.662528 16.662528-43.677696 16.662528-60.340224 0s-16.662528-43.677696 0-60.340224L626.449408 510.43328 314.614784 198.598656c-16.662528-16.662528-16.662528-43.677696 0-60.340224 16.661504-16.662528 43.676672-16.662528 60.3392 0L716.879872 480.18432c10.860544 10.860544 14.642176 26.120192 11.343872 40.04352z`,"p-id":`7515`},null,-1)]])}var ne=y(E,[[`render`,O]]),k={xmlns:`http://www.w3.org/2000/svg`,viewBox:`0 0 24 24`,fill:`none`,stroke:`currentColor`,"stroke-width":`2`,"stroke-linecap":`round`,"stroke-linejoin":`round`,class:`w-4 h-4`},A=f({name:`IconPin`,__name:`IconPin`,setup(t){return(t,n)=>(g(),u(`svg`,k,[...n[0]||=[e(`path`,{d:`M12 17v-5`},null,-1),e(`path`,{d:`M9 2h6a1 1 0 0 1 1 1v7h3l-4 4-4-4h3V3a1 1 0 0 1 1-1z`},null,-1),e(`path`,{d:`M9 22h6`},null,-1)]]))}}),j={class:`flex items-center gap-1.5`},M={key:0,class:`text-purple-600 text-xs`},N={key:1,class:`text-emerald-600 text-xs`},P={key:2,class:`text-blue-600 text-xs`},F={key:3,class:`text-[10px] opacity-70`},I={key:4,class:`text-[10px] opacity-70`},L={key:5,class:`text-[10px] opacity-70`},R={key:1,class:`w-3 h-3 shrink-0`},z=[`title`],B={class:`text-[10px] px-2 py-0.5 rounded-full bg-slate-100 text-slate-500 opacity-0 group-hover:opacity-100 transition-opacity shrink-0`},V={key:0,class:`space-y-0.5`},H=f({name:`VariableTreeItem`,__name:`VariableTreeItem`,props:{node:{},level:{default:0},enableDrag:{type:Boolean,default:!0},expandedNodeIds:{}},emits:[`toggle`,`toggleWithFirst`,`pin`,`unpin`],setup(f,{emit:y}){let E=y,D=f,O=c(()=>D.expandedNodeIds?D.expandedNodeIds.has(D.node.id):k.value),k=v(D.level<1),H=c(()=>Array.isArray(D.node.children)&&D.node.children.length>0),{showDragFollower:U,dragPosition:W,dropTargetState:G,dragFollowerStyle:K,isCtrlPressed:q,startDrag:J}=b({eventName:`variable-drop`}),Y=c(()=>{let e=D.node.value;return e===null?`null`:e===void 0?`undefined`:Array.isArray(e)?`Array(${e.length})`:typeof e==`object`?`Object(${Object.keys(e).length})`:typeof e==`string`?`"${e}"`:String(e)}),X=c(()=>({string:`text-green-600`,number:`text-blue-600`,boolean:`text-orange-600`,null:`text-slate-400 italic`,undefined:`text-slate-400 italic`,array:`text-slate-500`,object:`text-slate-500`})[D.node.valueType]||`text-slate-600`),re=c(()=>{let e=[];if(D.node.reference){let t=D.node.reference;D.node.id.startsWith(`pinned_`)?e.unshift({label:`取消顶固`,value:``,color:`#f59e0b`,icon:A,layout:`horizontal`,onClick:()=>{E(`unpin`,t)}}):e.unshift({label:`顶固`,value:``,color:`#f59e0b`,icon:A,layout:`horizontal`,onClick:()=>{E(`pin`,D.node)}})}if(e.push({label:`复制 Key`,value:D.node.label,color:`#a855f7`,icon:w,layout:`horizontal`,onClick:()=>{$(D.node.label)}}),D.node.valueType!==`node`&&e.push({label:`复制 Value`,value:Y.value,color:`#059669`,icon:S,layout:`horizontal`,onClick:()=>{$(String(D.node.value))}}),D.node.reference){let t=D.node.reference;e.push({label:`复制引用`,value:t,color:`#0284c7`,icon:T,layout:`vertical`,onClick:()=>{$(t)}})}return e});function Z(){if(D.expandedNodeIds){let e=!O.value;E(`toggle`,D.node.id,e)}else k.value=!k.value}function ie(){H.value&&(D.level===0&&!O.value&&D.expandedNodeIds!==void 0?E(`toggleWithFirst`,D.node.id):Z())}function ae(e){if(!D.enableDrag||!D.node.reference)return;let t=D.node.reference.trim(),n={payload:{reference:t,type:D.node.valueType,label:D.node.label},reference:t,isReplace:e.ctrlKey||e.metaKey};J(e,n)}let Q=h();function $(e){navigator.clipboard.writeText(e).then(()=>{Q.success(`已复制到剪贴板`)}).catch(()=>{Q.error(`复制失败`)})}return(c,h)=>{let v=_(`VariableTreeItem`,!0);return g(),u(`div`,null,[(g(),r(s,{to:`body`},[m(G)===`default`?i(``,!0):(g(),u(`div`,{key:0,class:`fixed pointer-events-none z-10001 w-8 h-8 flex items-center justify-center`,style:l({left:m(W).x+`px`,top:m(W).y+`px`,transform:`translate(-50%, -50%)`})},[d(C,{class:`w-5 h-5 text-slate-800`})],4)),m(U)?(g(),u(`div`,{key:1,class:o([`fixed pointer-events-none z-10000 scale-100 px-3 py-1 text-xs font-medium rounded-lg shadow-lg backdrop-blur`,[m(q)?`bg-purple-100/95 border-2 border-purple-400 text-purple-700`:m(G)===`empty`?`bg-emerald-100/95 border-2 border-emerald-400 text-emerald-700`:m(G)===`hasContent`?`bg-blue-100/95 border-2 border-blue-400 text-blue-700`:`bg-red-100/95 border-2 border-red-400 text-red-700`]]),style:l(m(K))},[e(`div`,j,[m(q)?(g(),u(`span`,M,`⟳`)):m(G)===`empty`?(g(),u(`span`,N,`⇱`)):m(G)===`hasContent`?(g(),u(`span`,P,`↓`)):i(``,!0),n(` `+t(f.node.label)+` `,1),m(q)?(g(),u(`span`,F,`替换`)):m(G)===`empty`?(g(),u(`span`,I,`吸附左侧`)):m(G)===`hasContent`?(g(),u(`span`,L,`插入位置`)):i(``,!0)])],6)):i(``,!0)])),d(x,{items:re.value},{default:te(()=>[e(`div`,{class:o([`flex items-center gap-2 px-2 py-1 rounded-md transition-colors duration-150 group hover:bg-slate-100/70`,{"cursor-pointer":H.value}]),style:l({paddingLeft:`${f.level*12+6}px`}),onClick:ie},[H.value?(g(),u(`button`,{key:0,class:`w-3 h-3 flex items-center justify-center text-slate-400 hover:text-slate-600 transition-colors shrink-0`,onClick:p(Z,[`stop`])},[d(ne,{class:o([`transition-transform`,{"rotate-90":O.value}])},null,8,[`class`])])):(g(),u(`span`,R)),e(`span`,{class:o([`px-2 py-0.5 text-xs font-medium text-slate-800 bg-white/90 rounded-lg shadow-sm border border-slate-200 shrink-0 transition-all duration-150 hover:shadow-md`,{"cursor-grab":f.node.reference&&D.enableDrag,"cursor-default":!D.enableDrag||!f.node.reference}]),onMousedown:p(ae,[`stop`])},t(f.node.label),35),f.node.valueType===`node`?i(``,!0):(g(),u(a,{key:2},[h[4]||=e(`span`,{class:`text-xs text-slate-300 shrink-0`},`:`,-1),e(`span`,{class:o([X.value,`text-xs truncate flex-1 min-w-0 font-mono`]),title:Y.value},t(Y.value),11,z),e(`span`,B,t(f.node.valueType),1)],64))],6)]),_:1},8,[`items`]),O.value&&H.value?(g(),u(`div`,V,[(g(!0),u(a,null,ee(f.node.children,e=>(g(),r(v,{key:e.id,node:e,level:f.level+1,"enable-drag":D.enableDrag,"expanded-node-ids":D.expandedNodeIds,onToggle:h[0]||=(e,t)=>E(`toggle`,e,t),onToggleWithFirst:h[1]||=e=>E(`toggleWithFirst`,e),onPin:h[2]||=e=>E(`pin`,e),onUnpin:h[3]||=e=>E(`unpin`,e)},null,8,[`node`,`level`,`enable-drag`,`expanded-node-ids`]))),128))])):i(``,!0)])}}});function U(e){return e===null?`null`:e===void 0?`undefined`:Array.isArray(e)?`array`:typeof e}function W(e){return`{{ ${e} }}`}function G(e,t=`data`){let n=U(e),r=t,i;if(t===`data`)i=`root`;else{let e=t.split(`.`),n=e[e.length-1]||``;i=/^\d+$/.test(n)?`[${n}]`:n}if(Array.isArray(e)){let a=e.map((e,n)=>{let r=`${t}.${n}`;return G(e,r)});return{id:r,label:t===`data`?`root`:i,valueType:n,reference:W(t),value:e,children:a.length>0?a:void 0}}if(typeof e==`object`&&e){let a=Object.entries(e).map(([e,n])=>{let r=`${t}.${e}`;return G(n,r)});return{id:r,label:t===`data`?`root`:i,valueType:n,reference:W(t),value:e,children:a.length>0?a:void 0}}return{id:r,label:t===`data`?`root`:i,valueType:n,reference:W(t),value:e}}export{H as n,G as t};